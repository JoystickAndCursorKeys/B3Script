{"version":3,"file":"basicworker.js","mappings":"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","sources":["webpack://B3/./tmp/basicworker.js"],"sourcesContent":["//src/sys/modules/basic/worker/sys.js\n//src/sys/modules/basic/worker/basicarray.js\n//src/sys/modules/basic/worker/basicerrorhandler.js\n//src/sys/modules/basic/worker/coding/codingeditor.js\n//src/sys/modules/basic/worker/basicruntime.js\n//src/sys/modules/basic/worker/extendedcommands.js\n//src/sys/modules/basic/worker/pgmmanager.js\n//src/sys/modules/basic/worker/basiccommands.js\n//src/sys/modules/basic/worker/basicparser.js\n//src/sys/modules/basic/worker/basictokenizer.js\n//src/sys/modules/basic/worker/input.js\n//src/sys/modules/basic/worker/processes.js\n//src/sys/modules/basic/worker/commandhelp.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//src/sys/modules/basic/worker/workerbootstrap_static.js\n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n\n// ## sys.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/sys.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/sys.js\n\nvar sys = {\n  appName: \"unknown\",\n  unique: 0\n\n};\n\nconsole = sys;\n\n/* LOGGER */\n\nfunction init_sys() {\n\n  function post( type, message ) {\n    postMessage( { type: type, message: message } );\n  }\n\n  sys.post = post;\n\n  sys.log = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      var args2 = [];\n\n      for( var i=0; i<args.length ; i++) {\n        args2.push( JSON.stringify( args[ i ]) );\n      }\n      post(\"syslog\",args2 );\n\n  }\n\n  sys.logerr = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post(\"syserr\",args );\n\n  }\n\n  sys.load = function( rt, path, device ) {\n\n      post(\"load\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n  sys.loaddata = function( rt, path, type, label ) {\n\n      post(\"loaddata\", { processId: rt.processId, path:path, type: type, label: label } );\n\n  }\n\n  sys.save = function( rt, path, device, data ) {\n\n      post(\"save\", { processId: rt.processId, path:path, device: device , data: data } );\n\n  }\n\n  sys.delete = function( rt, path, device ) {\n\n      post(\"delete\", { processId: rt.processId, path:path, device: device  } );\n\n  }\n\n  sys.dir = function( rt, path, device ) {\n\n      post(\"dir\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n\n  sys.setcfg = function( cfg ) {\n      this.cfg = cfg;\n  }\n\n  sys.listfs = function( rt  ) {\n\n      post(\"listfs\", { processId: rt.processId } );\n\n  }\n\n  sys.poststatus = function( procId, status  ) {\n\n      post(\"status\", { procId: procId, status: status } );\n\n  }\n\n  sys.setfs = function( rt, path  ) {\n\n      this.fs = path;\n      post(\"setfs\", { path: path, processId: rt.processId } );\n\n  }\n\n  sys.setDisplayMode = function( rt, m ){\n    post( \"displaymode\", { processId: rt.processId, m:m } );\n  }\n\n  sys.blinkMode = function( m ){\n    post( \"blinkMode\", { m:m } );\n  }\n\n  sys.html = {}\n\n  sys.html.executeFunction = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"htmldofun\",args );\n\n  }\n\n  sys.html.html = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"html\",args );\n\n  }\n\n  sys.html.htmlnode = function() {\n\n    var args = Array.prototype.slice.call(arguments);\n    post( \"htmlnode\",args );\n\n  }\n\n\n  sys.html.get = function() {\n\n    post( \"htmlget\", args );\n    return { wait_for_result: true }\n\n  }\n\n  sys.export = function( code, destination ) {\n    post( \"export\", { code: code, destination: destination } );\n  }\n\n  sys.signalHideMenu = function( flag ) {\n    post( \"signalHideMenu\", { hide: flag } );\n  }\n\n}\n\nfunction start_sys() {\n  sys.log(\"Starting wsys\");\n\n  sys.processes = new processes( sys );\n  sys.input = new Input( sys );\n  sys.out = new TextArea( sys );\n  sys.bout = new BitMap( sys );\n  sys.pfields = new Playfields( sys );\n  sys.audio = new Audio( sys );\n  sys.rootProcId = -1;\n\n  /* APPLICATION */\n\n  /* HANDLERS */\n  self.onmessage = function( obj ) {\n\n      try {\n        var data = obj.data;\n\n        if( data.type == \"keydown\" ) {\n\n          sys.input.inputKeyHandler( data );\n          sys.audio.flagUserInput();\n\n        }\n        else if( data.type == \"message\") {\n          var id = data.processId;\n          var runtime = sys.processes.get( id );\n\n          runtime.receiveMessage( data.message, data.messageObject );\n\n          //TODO, index of runtime.\n        }\n        else if( data.type == \"interrupt\") {\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.interrupt( 0, data.sub, data.data );\n\n          //TODO, index of runtime.\n        }\n        else if( data.type == \"loadpgm\" ) {\n\n          sys.log(\"Received 'loadpgm' message. Loaded \" + data.pgmData.length + \" bytes..\" );\n\n          var editor = new Editor( sys );\n          var runtime = new BasicRuntime( sys, editor );\n          sys.log(\"Context created, parsing program\");\n\n          var ok = runtime.bootPGM( data.pgmData, data.QPath  );\n          sys.log(\"Parsed program => RUN\");\n\n          if( ok ) {\n            runtime.runPGM();\n            sys.log(\"Program started...\");\n          }\n          else {\n            runtime.stop();\n          }\n\n          var id = sys.processes.register( runtime );\n          sys.log(\"Basic program registered as process \" + id + \".\");\n\n          if( sys.rootProcId == -1 ) {\n            sys.rootProcId = id;\n          }\n          pgmman.addRuntime( runtime );\n\n\n        }\n        else if( data.type == \"inittxtarea\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) )\n\n          sys.out.attach( data.w, data.h );\n\n\n        }\n        else if( data.type == \"initcolors\" ) {\n\n          sys.log( \"init colors with: \" + JSON.stringify( data ) )\n\n          sys.out.setDefault( data.colors.fg, data.colors.bg );\n          sys.out.control( 18, data.colors.border );\n          sys.out.reset();\n\n        }\n        else if( data.type == \"systeminfo\" ) {\n\n          sys.log( \"systeminfo with: \" + JSON.stringify( data ).substr(0,50) + \"...\" );\n          sys.screenModes = data.modes;\n          sys.displayMode = data.mode;\n          sys.windowWidth = data.windowWidth;\n          sys.windowHeight = data.windowHeight;\n\n        }\n        else if( data.type == \"setcfg\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n\n          sys.setcfg( data.cfg );\n\n        }\n        else if( data.type == \"initbitmap\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n          sys.bout.attach( data.w, data.h );\n\n        }\n        else if( data.type == \"clipboardCopy\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"clipboard\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Copied program to clipboard\");\n            runtime.printReady();\n          }\n          sys.log( \"clipboard copy\" )\n\n        }\n        else if( data.type == \"export\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"disk\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Export program to disk\");\n            runtime.printReady();\n          }\n          sys.log( \"Export to disk\" )\n\n        }\n        else if( data.type == \"showList\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = data.list;\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"list\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = [\"LIST\",\"\"];\n          for (const l of runtime.program)\n            {\n\n              var lineNr = parseInt(l[0]);\n\n              list.push( l[2] );\n            }\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"renumber\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.renumberProgram( 10,10 );\n\n          var list = [\"RENUMBER\"];\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"new\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n\n            var output = [\"NEW\", \"\"];\n            runtime.enterListMode( output );\n          }\n        }\n        else if( data.type == \"pastpgm\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n            runtime.resetConsole();\n\n            var result = runtime.textLinesToBas( data.data.split(\"\\n\") );\n            var pgm = result.pgm;\n            runtime.setProgram( pgm );\n\n            if( result.exception ) {\n              throw result.exception;\n            }\n\n          }\n        }\n        else if( data.type == \"vars\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var varList = runtime.getFullVarList();\n          varList.unshift( \"\" );\n          varList.unshift( \"VARS\" );\n\n          runtime.enterListMode( varList );\n\n        }\n        else if( data.type == \"datablocks\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = runtime.getDataBlocks();\n          var blockList = [\"DATABLOCKS\",\"\"];\n\n          for( var i=0;i<list.length;i++) {\n            blockList.push( list[i] );\n          }\n\n          runtime.enterListMode( blockList );\n\n        }\n        else if( data.type == \"stopMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n            runtime.toggleMenu();\n          }\n          else {\n            runtime.toggleMenu();\n          }\n\n        }\n        else if( data.type == \"toggleMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n          runtime.toggleMenu();\n\n        }\n        else if( data.type == \"help\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"HELP\");\n            runtime.printHelp();\n            runtime.printLine(\"\");\n            runtime.printLine(\"For more help type:\");\n            runtime.printLine(\"HELP <option>\");\n            runtime.printLine(\"\");\n            runtime.printReady();\n          }\n\n        }\n        else if( data.type == \"run\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"RUN\");\n            runtime.runPGM();\n          }\n        }\n        else if( data.type == \"stop\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n          }\n        }\n        else if( data.type == \"resetConsole\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.resetConsole();\n          }\n        }\n        else if( data.type == \"colorReset\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.colorReset( data.colors );\n          }\n        }\n        else if( data.type == \"clearScreen\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n          }\n        }\n        else {\n          var type = obj.data;\n          if(! type ) {\n            type = \"????\";\n          }\n          else {\n            type=type.type;\n            if(! type ) {\n              type = \"????\";\n            }\n          }\n          sys.logerr( \"Ignored unclassified message type (\"+type+\") for 'APP://\"+sys.appName+\"':  \" + JSON.stringify( obj.data ) );\n          //postMessage( self.onAppMessage( obj ) );\n        }\n      }\n      catch( e ) {\n        if( e.message ) {\n          sys.logerr( e.message + \" at \" + e.fileName + \":\"+ e.lineNumber );\n        }\n        else if ( e.clazz ) {\n          sys.logerr( e.clazz + \": \" + e.detail + \" at \"+ e.lineNr );\n          sys.out.writeln( \"?\" + e.clazz + \" error at \" + e.lineNr );\n        }\n\n        sys.logerr( JSON.stringify( e ) );\n\n      }\n\n    }\n}\n\ninit_sys();\n\n//--EOC \n\n// ## basicarray.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicarray.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicarray.js\n\nclass  BasicArray {\n\n  constructor( name, indices, defaultValue  ) {\n    this.name = name;\n    this.indices = indices;\n    this.buffer = null;\n    this.defaultValue = defaultValue;\n  }\n\n  getIndexCount() {\n    return this.indices.length;\n  }\n\n  _check( indices ) {\n    if( indices.length != this.indices.length ) {\n      throw \"BasicArray:00:index dimension mismatch:For array \" + this.name;\n    }\n    for( var i=0; i<indices.length; i++) {\n      if ( indices[i] > this.indices[ i ]) {\n        var detail = \"\\\"\" + this.name + \"[\" + indices[i] + \"]\"+\"\\\" does not exist\";\n        if( indices.length > 1) {\n          detail = \"\\\"\" + this.name + \"\\\" with index \" + indices[i] + \" does not exist\";\n          detail += \" for index dimension \" + i;\n        }\n        throw \"BasicArray:01:index out of bounds:\" + detail;\n      }\n      else if ( indices[i] < 0) {\n        throw \"BasicArray:02:index smaller then zero:For array \" + this.name;\n      }\n\n    }\n  }\n\n  set( indices, val ) {\n    this._check( indices );\n    if( this.buffer == null ) {\n      this.buffer = [];\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        ptr[ indices[ i ]] = val;\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          ptr[ indices[ i ]] = [];\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n  get( indices ) {\n    this._check( indices );\n\n    if( this.buffer == null ) {\n      return this.defaultValue;\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        return ptr[ indices[ i ]];\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          return this.defaultValue;\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n}\n\n//--EOC \n\n// ## basicerrorhandler.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicerrorhandler.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicerrorhandler.js\n\nclass ErrorHandler {\n\n  newError( clazz, detail, context, lineNr ) {\n    return { context: context, clazz: clazz, detail: detail, lineNr: lineNr };\n  }\n\n  throwError( clazz, detail, context, lineNr ) {\n    throw this.newError( clazz, detail, context, lineNr );\n  }\n\n\n  fromSimpleExternalError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n\n    var parts = s.split(\":\");\n    if( !parts.length == 3) {\n      return undefined;\n    }\n\n    var err = this.newError( parts[2], parts[3], context, lineNr );\n\n    err.extCode0 = parts[0];\n    err.extCode1 = parts[1];\n\n    return err;\n\n  }\n\n  fromSerializedError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n    if( ! this.isSerializedError( s ) ) {\n      return this.newError( \"unknown\", null, context, lineNr );\n    }\n    var parts = s.substr(1).split(\"@\");\n    if( parts.length == 1 ) {\n        return this.newError( parts[0], null, context, lineNr );\n    }\n    return this.newError( parts[0], parts[1], context, lineNr );\n\n  }\n\n  isSerializedError( e ) {\n    if( typeof e != \"string\" ) {\n      return false;\n    }\n    return e.startsWith( \"@\" );\n  }\n\n  isError( e ) {\n    if( Object.prototype.toString.call( e ) === '[object Object]' ) {\n      var ctx = e[ \"context\" ];\n      var clss = e[ \"clazz\" ];\n      var dtl = e[ \"detail\" ];\n\n      if( !( clss === undefined ) ) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\n//--EOC \n\n// ## coding/codingeditor.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/coding/codingeditor.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/coding/codingeditor.js\n\nclass Editor {\n\n  constructor( sys ) {\n    this.sys = sys;\n    this.output = sys.out;\n    this.keyMode = \"insert\";\n\n    //this.lineMarkers = [ 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0 ];\n  }\n\n\n  addRunTime( rt ) {\n    this.runTime = rt;\n  }\n\n  keyHandlerForCLE( e ) {\n\n      if( e.keyLabel == \"Enter\"  && !e.shiftKey ) {\n        var command = sys.out.getCurrentLine();\n        this.output.writeln(\"\");\n\n        this.runTime.executeInteractiveLine( command );\n\n      }\n      else if( e.keyLabel == \"Enter\" && e.shiftKey ) {\n\n        this.output.ScrollDownByCurrentLine();\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            this.output.backspace();\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowUp\" && !e.ctrlKey) {\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && !e.ctrlKey) {\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowUp\" && e.ctrlKey ) {\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && e.ctrlKey ) {\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey ) {\n        this.output.cursorMove(\"left\");\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"line-start\");\n      }\n      else if( e.keyLabel == \"Home\" && e.shiftKey && !e.ctrlKey ) {\n        this.output.clear();\n      }\n      else if( e.keyLabel == \"End\" && !e.ctrlKey ) {\n        this.output.jumpTo(\"line-end\");\n      }\n      else if( e.keyLabel == \"Home\" && e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"home\");\n      }\n      else if( e.keyLabel == \"End\" && e.ctrlKey ) {\n        this.output.jumpTo(\"end\");\n      }\n      else if( e.keyLabel == \"Tab\" ) {\n        if( this.keyMode == \"insert\") {\n          this.output.insert(  \"        \" );\n        }\n        else {\n          this.output.write(  \"        \" );\n        }\n\n      }\n      else if( e.keyLabel == \"Insert\" ) {\n\n        if( this.keyMode == \"insert\") {\n          this.keyMode = \"overwrite\";\n        }\n        else {\n          this.keyMode = \"insert\";\n        }\n        this.output.setCursorMode( this.keyMode )\n      }\n      else {\n        if( e.key != null ) {\n          if( this.keyMode == \"insert\") {\n            this.output.insert( e.key );\n          }\n          else {\n            this.output.write( e.key );\n          }\n        }\n      }\n\n  }\n\n\n  interactiveKeyHandler( e ) {\n    this.keyHandlerForCLE( e );\n  }\n}\n\n//--EOC \n\n// ## basicruntime.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicruntime.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicruntime.js\n\nclass BasicRuntime {\n\n  constructor( sys, editor ) {\n\n    this.debugFlag = false;\n    this.sys = sys;\n    this.editor = editor;\n    this.editor.addRunTime( this );\n    this.listSpeed = 15;\n\n    this.output = sys.out;\n    this.bitmap = sys.bout;\n    this.playfields = sys.pfields;    \n    this.input = sys.input;\n    this.audio = sys.audio;\n    this.input.setHandler( this );\n    this.input.setInterActive( false);\n    this.html = sys.html;\n    this.menuEnable = false;\n\n    this.program = [];\n    this.runFlag = false;\n    this.isWaitingFlag = false;\n    this.waitingTime = 0;\n\n    this.waitForMessageFlag = false;\n    this.waitForMessageVariable = null;\n    this.executeLineFlag = false;\n    this.goPlayExampleFlag = false;\n\n    this.inputFlag = false;\n    this.inputCommand = false;\n    this.listFlag = false;\n    this.immersiveFlag = false;\n    this.statusChanged = false;\n\n    this.gosubReturn = [];\n    this.nullTime = new Date().getTime();\n\n    this.turboMode = false;\n    this.cmdCountPerCycleDefault = 20000;\n    this.cmdCountPerCycleTurbo = 20000;\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n\n    var c = this.output;\n    this.commands = new BasicCommands( this );\n    this.extendedcommands = new ExtendedCommands( this.commands, this );\n\n    this.erh = new ErrorHandler();\n    this.vars = {};\n    this.functions = [];\n    this.data = [];\n    this.loadedData = { default: [] };\n    this.loadedLabel = null;\n\n    this.kbBuffer = [];\n\n    this.yPos = -1;\n\n    this.SHORTLINE = 0;\n    this.LONGLINESTART = 1;\n    this.LONGLINEEND = 2;\n\n    this.forContext = { default:[] }\n\n    this.outputCallBacksAll = {\n        lineOverFlow: { clazz: this, method: \"cbLineOverFlow\" },\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    this.outputCallBacksClScr = {\n        lineOverFlow: undefined,\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    //this.setTurbo( true );\n    this.synchClock( );\n    this.exitMode = \"stay\";\n\n    this.code2colMap = [];\n    var km = this.code2colMap;\n\n    km[0x90] = 0;\n    km[0x05] = 1;\n    km[0x1c] = 2;\n    km[0x9f] = 3;\n    km[0x9c] = 4;\n    km[0x1e] = 5;\n    km[0x1f] = 6;\n    km[0x9e] = 7;\n\n    km[0x81] = 8;\n    km[0x95] = 9;\n    km[0x96] = 10;\n    km[0x97] = 11;\n    km[0x98] = 12;\n    km[0x99] = 13;\n    km[0x9a] = 14;\n    km[0x9b] = 15;\n\n    this.symbolTable = {};\n\n    this.symbolTable.up     = 0x91;\n    this.symbolTable.down   = 0x11;\n    this.symbolTable.left   = 157;\n    this.symbolTable.right  = 29;\n    this.symbolTable[\"reverse on\"]  = 0x12;\n    this.symbolTable[\"reverse off\"]  = 0x92;\n    this.symbolTable[\"clear\"]  = 0x93;\n    this.symbolTable[\"home\"]  = 0x13;\n    this.symbolTable.black  = 144;\n    this.symbolTable.white  = 5;\n    this.symbolTable.red  = 28;\n    this.symbolTable.cyan  = 159;\n    this.symbolTable.purple  = 156;\n    this.symbolTable.green  = 30;\n    this.symbolTable.blue  = 31;\n    this.symbolTable.yellow  = 158;\n    this.symbolTable.orange  = 129;\n    this.symbolTable.brown  = 149;\n    this.symbolTable.pink  = 150; // light red\n    this.symbolTable.grey1  = 151;  //dark grey\n    this.symbolTable.grey2  = 152;\n    this.symbolTable[\"light green\"]  = 153;\n    this.symbolTable[\"light blue\"]  = 154;\n    this.symbolTable.grey3  = 155; //light grey\n\n\n    var backmap = []\n    var mapInfo = Object.entries(this.symbolTable);\n    for( var i=0; i<mapInfo.length; i++) {\n      backmap[ mapInfo[i][1]] = mapInfo[i][0];\n    }\n    this.symbolTableBM = backmap;\n\n  }\n\n  flagStatusChange() {\n    this.statusChanged = true;\n  }\n\n  clearInputCommand() {  /* for GET and GETKEY, for input we use something else */\n    this.inputCommand = false;\n  }\n\n  flagInputCommand() {  /* for GET and GETKEY, for input we use something else */\n    this.inputCommand = true;\n  }\n\n  setWaiting( time ) {  /* for GET and GETKEY, for input we use something else */\n    this.isWaitingFlag = true;\n    this.waitingTime = time;\n  }\n\n  clearWaiting() {  /* for GET and GETKEY, for input we use something else */\n    this.isWaitingFlag = false;\n  }\n\n\n  getScopeVars( s ) {\n    return s.vars;\n  }\n\n  getFullVarList() {\n    var scopes = this.getFullScopes();\n    var varList = [];\n\n    for( var si = 0; si< scopes.length; si++ ) {\n\n      var fullscope = scopes[si];\n      var vars = this.getScopeVars( fullscope.scope );\n      var names = Object.getOwnPropertyNames( vars );\n\n      for( var i=0;i<names.length;i++) {\n        var name = names[i];\n        var value = vars[ name ];\n        var path = fullscope.path;\n        if( path == \"\" ) { path = \"\"; }\n        else { path += \"/\"; }\n        if( ! name.startsWith( \"@array_\" ) ) {\n            if( name.endsWith(\"$\") ) {\n                varList.push( path + name + \" = \\\"\" + value + \"\\\"\" );\n            }\n            else {\n                varList.push( path + name + \" = \" + value );\n            }\n        }\n        else {\n            var descr = \"\";\n            for( var ii=0; ii<value.indices.length; ii++ ) {\n              if( ii>0 ) { descr += \",\"; }\n              descr += value.indices[  ii ];\n\n            }\n            varList.push( name.substr(7) + \" = array with dim(\" + descr + \")\" );\n        }\n      }\n    }\n\n    return varList;\n  }\n\n  getFullScopes() {\n    var scopes = [];\n    var path = \"\";\n    for( var si = 0 ; si < this.scopes.length; si++ ) {\n      var scope = this.scopes[si].name;\n\n      if( si > 0) {\n        if( path != \"\" ) {\n          path += \"/\";\n        }\n        path += scope;\n      }\n\n      scopes.push( { path: path, scope: this.scopes[si]  } );\n    }\n\n    return scopes;\n  }\n\n  cpuNeeded() {\n    if (this.runFlag ) { return 1; }\n    else if (this.listFlag ) { return .8; }\n    return .1;\n\n  }\n\n  getStatus() {\n\n    var status = \"\";\n    var lineNr;\n    if( this.runFlag ) {\n      lineNr = this.program[ this.runPointer ][0];\n      status = \"running[\" + lineNr + \"]\";\n    }\n    else {\n      status = \"stopped\";\n    }\n\n    if( this.runFlag && this.inputFlag ) {\n      status = \"running[\" + lineNr + \"]/input\";\n    }\n    else if( !this.runFlag && this.listFlag ) {\n      status = \"stopped/listing\";\n    }\n\n    var vlen = Object.getOwnPropertyNames( this.getVars() ).length;\n\n\n    this.statusChanged = false;\n\n    return {\n      status: status,\n      pgmLen: this.program.length,\n      varLen: vlen,\n      displayMode: this.sys.displayMode\n    }\n  }\n\n  dir( path, device ) {\n    this.sys.dir( this, path, device );\n    this.startWaitForMessage( \"dir\" )\n  }\n\n  listfs() {\n    this.sys.listfs( this );\n    this.startWaitForMessage( \"listfs\" )\n  }\n\n  setfs( path ) {\n    this.sys.setfs( this, path );\n    this.startWaitForMessage( \"path\" )\n  }\n\n  load( path, start, device ) {\n    this.sys.load( this, path, device );\n    this.startWaitForMessage( \"load\" )\n    this.autoStartAfterLoad = start;\n\n  }\n\n  loaddata( path, type, label ) {\n    this.sys.loaddata( this, path, type, label );\n    this.startWaitForMessage( \"loaddata\" )\n\n  }\n\n  save( path0, device ) {\n\n    var data = this.getProgramAsText();\n    var path = path0;\n    if( path0 == null ) {\n      path = \"default.bas\";\n    }\n    this.sys.save( this, path, device, data );\n    this.startWaitForMessage( \"save\" )\n  }\n\n  deleteFile( path, device ) {\n\n    this.sys.delete( this, path, device );\n    this.startWaitForMessage( \"delete\" )\n  }\n\n\n  startWaitForMessage( variable ) {\n    this.waitForMessageFlag = true;\n    this.waitForMessageVariable = variable;\n  }\n\n\n  keyInterrupt( _type, _data ) {\n    this.interrupt( 0, _type, {} );\n  }\n\n  interrupt( _ix, _type, _data ) {\n\n\n\n    if( _ix == 0 && this.interruptFlag0 ) {\n        return; //allready in an interrupt0\n    }\n\n    if( _ix == 1 && this.interruptFlag1 ) {\n        return; //allready in an interrupt1\n    }\n\n\n    var line, useLabel;\n    if( _ix == 0 ) {\n\n      line = this.handlers.interrupt0;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag0 = true;\n      useLabel = this.handlers.interrupt0ParamIsLabel;\n    }\n    else {\n\n      line = this.handlers.interrupt1;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag1 = true;\n      useLabel = this.handlers.interrupt1ParamIsLabel;\n    }\n\n\n    this.newScope( \"interrupt\" + _ix,\n      { runPointer: this.runPointer, runPointer2: this.runPointer2 } );\n\n    var variables = Object.entries( _data );\n    this.setVar( \"itr0$\".toUpperCase(), _type.toUpperCase() );\n    for( var i=0; i<variables.length; i++) {\n      this.setVar( variables[i][0].toUpperCase(), variables[i][1] );\n    }\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n\n    if( useLabel ) {\n\n      line = this.labels[line];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n        break;\n      }\n    }\n\n    if(!found ) {\n      throw \"@invalid interrupt handler\";\n    }\n\n  }\n\n  receiveMessage( _message, _data ) {\n\n    this.vars[ this.waitForMessageVariable ] = _message;\n    this.waitForMessageFlag = false;\n\n    if( _message.startsWith( \"displaymode:\" )) {\n        this.output.reInit( _data.textW, _data.textH );\n        this.bitmap.reInit( _data.bitmapW, _data.bitmapH );\n        //this.playfields.reInit( _data.playfields );\n        this.sys.displayMode = _data.mode;    \n        this.playfields.enable( _data.pfEnabled ); \n        this.playfields.set( _data.playfields ); \n        \n\n    }\n    else if( _message.startsWith( \"pfinit:current:\" )) {\n        /*\n            Reinit current playfield\n            Other ones are only stored in webworker\n\n        */\n        \n        this.output.set( _data.textW, _data.textH, _data.cells );\n        this.playfields.set( _data.playfields );\n\n    }\n    else if( _message.startsWith( \"pfinit:other:\" )) {\n        \n        this.playfields.set( _data.playfields );\n    \n    }\n    else if( _message.startsWith( \"pfselect:\" )) {\n        \n        this.output.set( _data.textW, _data.textH, _data.cells );\n    \n    }    \n    else if( _message == \"load:error\" ) {\n\n      if( this.runFlag == false ) {\n          this.printError(\"load\", false, undefined, _data.reason );\n      }\n    }\n    else if( _message == \"load:completed\" ) {\n\n      sys.log(\"Received 'load:completed' message. Loaded \" + _data.pgmData.length + \" bytes..\" );\n\n      var ok = this.bootPGM( _data.pgmData, _data.path  );\n      sys.log(\"Parsed program => RUN\");\n\n      if( ok && this.autoStartAfterLoad ) {\n        this.output.control( 24 )\n        this.runPGM();\n        sys.log(\"Program started...\");\n      }\n      else {\n        this.stop();\n      }\n    }\n    else if( _message == \"loaddata:completed\" ) {\n\n      sys.log(\"Received 'loaddata:completed' message. Loaded \" + _data.data.length + \" bytes..\" );\n\n      this.insertData( _data.data, _data.type, _data.label  );\n\n    }\n    else if( _message == \"loaddata:error\" ) {\n\n      sys.log(\"Received 'loaddata:error' message. Error \" + _data.reason );\n\n      this.printError(\"loaddata\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"delete:completed\" ) {\n\n      sys.log(\"Received 'delete:completed' message.\" );\n\n    }\n    else if( _message == \"delete:error\" ) {\n\n      sys.log(\"Received 'delete:error' message. Error \" + _data.reason );\n\n      this.printError(\"delete\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"save:completed\" ) {\n\n      sys.log(\"Received 'save:completed' message.\" );\n\n      if( !this.isRunning() ) {\n      }\n    }\n    else if( _message == \"save:error\" ) {\n\n      sys.log(\"Received 'save:error' message. Error \" + _data.reason );\n\n      this.printError(\"save\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"dir:completed\" ) {\n\n      sys.log(\"Received 'dir:completed' message.\" );\n\n      var list = [\"\",\"Directory of: \\\"\" + _data.title + \"\\\" on \" + _data.fs, \"\" ];\n\n      for( var i=0; i<_data.files.length; i++) {\n          list.push( _data.files[i].fname );\n      }\n\n      list.push( _data.files.length + \" files\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"dir:error\" ) {\n\n      sys.log(\"Received 'dir:error' message. Error \" + _data.reason );\n\n      this.printError(\"dir\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"listfs:completed\" ) {\n\n      sys.log(\"Received 'listfs:completed' message.\" );\n\n      var list = [\"\", \"Default Filesystem: \\\"\" + _data.currentFs + \"\\\"\", \"\", \"Devices:\", \"\" ];\n\n      //var fs = fsList[i];\n\n\n      for( var i=0; i<_data.fs.length; i++) {\n\n          var fs = _data.fs[i];\n          var str = \"\\\"\" + fs.name + \"\\\"\";\n          var deviceNumberLen = (fs.device + \"\").length;\n          str = str + \"                  \".substr( 0,(18-str.length-deviceNumberLen) ) + fs.device;\n\n\n          list.push(\"     \" + str );\n      }\n\n      list.push( \"\" );\n      list.push( _data.fs.length + \" Filesystem Devices Found\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"setfs:completed\" ) {\n\n      if( !this.isRunning() ) {\n        if( _data.status == \"ok\" ) {\n        }\n        else {\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n        }\n\n      }\n      else {\n        if( _data.status != \"ok\" ) {\n\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n          this.stop();\n        }\n      }\n    }\n\n    if( this.stopAfterMessage ) {\n      this.stopAfterMessage = false;\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n    }\n\n    if( !this.isRunning() && this.listFlag == false ) {\n      this.printReady();\n    }\n\n  }\n\n  stop() {\n    if( this.runFlag ) {\n      this.runStop();\n    }\n    if( this.listFlag ) {\n      this.listStop();\n    }\n  }\n\n  interactiveKeyHandler( e ) {\n\n    if( this.runFlag == true ) {\n      if( e.keyLabel == \"Enter\" ) {\n\n        var cxy = this.output.getCursorPos();\n\n        var string = this.output.getLineFrom( this.inputStartInputPosX, cxy[1]);\n        this.output.writeln(\"\");\n\n        this.handleLineInput( string, true );\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n        var x = this.output.getCursorPos()[0];\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            if( x > this.inputStartInputPosX ) {\n                this.output.backspace();\n            }\n            else {\n              this.output.delete();\n            }\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey) {\n        var cx = this.output.getCursorPos();\n        if( cx[0] > this.inputStartInputPosX ) {\n          this.output.cursorMove(\"left\");\n        }\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey ) {\n        var xy = this.output.getCursorPos();\n\n        this.output.setCursorPos( this.inputStartInputPosX, xy[1]);\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey)) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( e.keyLabel == \"End\" ) {\n        this.output.jumpTo(\"text-end-all\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n        var xy = this.output.getCursorPos();\n        if( xy[0]< this.inputStartInputPosX ) {\n          this.output.setCursorPos( this.inputStartInputPosX, xy[1] );\n        }\n      }\n      else {\n        if( e.key != null ) {\n          this.output.write( e.key );\n        }\n      }\n    }\n    else {\n      this.editor.interactiveKeyHandler( e );\n    }\n  }\n\n  toggleMenu()  {\n    this.menuEnable = !this.menuEnable;\n\n    if( this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n    else {\n      this.sys.signalHideMenu( true );\n    }\n  }\n\n  HandleStopped( startingProgram ) {\n\n    this.clearWaiting();\n    this.input.setInterActive( true);\n    this.input.flush();\n    if( !startingProgram && this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n\n    this.flagStatusChange();\n  }\n\n  importPGMHandler( content, filename ) {\n    var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n    this.fileName = filename;\n\n    this.program = pgm;\n    this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n  }\n\n  bootPGM( content, filename ) {\n    try {\n      var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n      this.fileName = filename;\n\n      this.program = pgm;\n      this.setProgram( pgm );\n\n      this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n      return true;\n    }\n    catch ( e ) {\n      var tmp = 1;\n\n      var pgm = this.textLinesToBas( \"\" ).pgm;\n      this.program = pgm;\n      this.HandleStopped( false );\n      this.printError(\"parsing syntax\", false, e.lineNr, e.detail );\n      this.printReady();\n      return false;\n\n    }\n  }\n\n\n/*  exportPGM() {\n    var exportName = \"program.bas\";\n    if( this.fileName ) {\n      exportName = this.fileName;\n    }\n\n    var text = this.getProgramAsText();\n    this.DESKTOP.requestDownload( text, exportName );\n  }\n*/\n\n  exitProgram() {\n    this.closeWindow( this.windowId );\n  }\n\n\n  enterListMode( list ) {\n    this.listFlag = true;\n    this.list = list;\n    this.listPointer = 0;\n    this.printLine(\"\");\n    this.listFlagBakInteractive = this.input.getInterActive();\n    this.input.setInterActive( false );\n    this.flagStatusChange();\n  }\n\n  setExitMode( v ) {\n    this.exitMode = v;\n  }\n\n  synchClock() {\n\n    //var clock = new Date().getTime();\n    var nullClock = new Date();\n    nullClock.setHours(0);\n    nullClock.setSeconds(0);\n    nullClock.setMinutes(0);\n    nullClock.setMilliseconds(0);\n\n    this.nullTime = nullClock;\n\n  }\n\n  setTurbo( on ) {\n    if( on ) {\n      this.cmdCountPerCycle = this.cmdCountPerCycleTurbo ;\n      this.turboMode = true;\n      return;\n    }\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n    this.turboMode = false;\n  }\n\n  setProgram( pgm ) {\n    this.program = pgm;\n    this.runFlag = false;\n    this.HandleStopped( true );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n\n    this.flagStatusChange();\n\n  }\n\n  appendProgram( pgm ) {\n\n    for(var i=0; i<pgm.length; i++) {\n      var exists = -1;\n\n      for(var j=0; j<this.program.length; j++) {\n        if( this.program[j][0] == pgm[i][0] ) {\n          exists = j;\n        }\n      }\n\n      if( exists>-1 ) {\n        this.program[ exists ] = pgm[ i ];\n      }\n      else {\n        this.program.push( pgm[ i ] );\n      }\n    }\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    this.program.sort( sortF );\n\n    this.runFlag = false;\n    this.HandleStopped( false );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n    //this.output.clearCursor();\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  getProgramState() {\n    return {\n      runFlag: this.runFlag,\n      inputFlag: this.inputFlag,\n      vars: this.vars,\n      functions: this.functions,\n      forContext: this.forContext,\n      runPointer: this.runPointer,\n      runPointer2: this.runPointer2\n    }\n  }\n\n  setProgramState( pgmState ) {\n      this.runFlag = pgmState.runFlag;\n      this.HandleStopped( false );\n      this.inputFlag = pgmState.inputFlag;\n      this.vars = pgmState.vars;\n      this.functions = pgmState.functions;\n      this.forContext = pgmState.forContext;\n      this.runPointer = pgmState.runPointer;\n      this.runPointer2 = pgmState.runPointer2;\n  }\n\n  _setByteBits( bits ) {\n\n   var byte = 0b00000000;\n\n   for( var i=0; i<8; i++) {\n     if(i>0) {\n       byte = byte >> 1;\n     }\n     if( bits[i]) {\n       byte = byte | 128;\n     }\n   }\n   return byte;\n  }\n\n  _getByteBits( byte ) {\n    var masks = [\n      0b00000001,0b00000010,0b00000100,0b00001000,\n      0b00010000,0b00100000,0b01000000,0b10000000\n    ];\n\n   var results = [ false, false, false, false, false, false, false, false ];\n\n   for( var i=0; i<8; i++) {\n\n     results[ i ] = (byte & masks[i]) > 0;\n\n   }\n\n   return results;\n  }\n\n  upperFirst( s ) {\n    if( s ) {\n      if ( s.length > 1 ) {\n          return s.substr(0,1).toUpperCase() + s.substr( 1 );\n      }\n    }\n    return s;\n  }\n\n  printError( s, supressLine, explicitline, detail ) {\n\n    var line1 = (\"?\" + this.upperFirst( s ) + \" error\" + this.onLineStr());\n\n    if( explicitline ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error in \" + explicitline ) );\n    }\n    if( supressLine ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error\") );\n    }\n\n    this.output.writeln(  line1 );\n    if( detail ) {\n      this.output.writeln(  \">> \" + detail );\n    }\n\n  }\n\n  printInfo( s ) {\n\n    this.sys.log(  ( s + this.onLineStr()).toUpperCase() );\n\n  }\n\n  printHelp() {\n    this.extendedcommands[\"_stat_help\"]([]);\n  }\n\n  printLine( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n  print( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n//{ fg: 5, bg:1, border: 7 }\n  colorReset( colors ) {\n    this.output.setDefault( colors.fg, colors.bg );\n    this.output.control( 18, colors.border );\n    this.output.colorReset();\n  }\n\n  resetConsole() {\n    var wh = this.output.getDimensions();\n\n    //this.output.textArea(  wh[0], wh[1], -1, -1 );\n\n    this.output.reset();\n    //this.output.setPos(0,0);\n  }\n\n  clearScreen() {\n    this.output.clear();\n    this.output.setPos(0,0);\n  }\n\n  getMillis() {\n    var millis=new Date().getTime() - this.nullTime;\n    return millis;\n  }\n\n  getJiffyTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    var jiffis = Math.floor(millis / (1000 / 60));\n\n    return jiffis % 5184000;\n  }\n\n  getTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    millis = millis % 86400000;\n\n    var hours = Math.floor(millis / 3600000);\n    millis = millis - (hours * 3600000 );\n    var minutes = Math.floor(millis / 60000);\n    millis = millis - (minutes * 60000 );\n    var seconds = Math.floor(millis / 1000);\n    //millis = millis - (seconds * 1000 );\n    return [hours,minutes,seconds];\n  }\n\n  reset( hard, muteReady ) {\n    this.output.clearScreen();\n    this.output.writel(\"Ready.\");\n\n    this.inputFlag = false;\n    this.runFlag = false;\n    this.listFlag = false;\n\n    this.clrPGM();\n    this.setTurbo( false );\n  }\n\n  compressPGMText( pgmTxt ) {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var kws = p.getKeyWordCodes();\n    var txt2 = pgmTxt;\n\n    for( var i=0; i<kws.length; i++) {\n      var kw = kws[i];\n      if( !(kw===undefined || kw === null )) {\n          txt2 = txt2.replaceAll( kw.toLowerCase() , String.fromCharCode(i));\n      }\n    }\n\n    return txt2;\n  }\n\n\n  getProgramAsTextNoPETSCII() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        text +=  this.prepareLineForExportNoPETSCII( l[2].trim(), true );\n      }\n    return text;\n  }\n\n  getProgramSize() {\n    return this.program.length;\n  }\n\n  getProgramAsText() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        //text +=  this.prepareLineForExport( l[2].trim() );\n        if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n            text += \"\\n\";\n        }\n        text += l[2].trim();\n      }\n    return text;\n  }\n\n  prepareLineForExport( txt0 ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      if( c<31 || c==92 || c>=126 ) {\n        var symdef = this.symbolTableBM[ c ];\n        if( ! ( symdef === undefined ) ) {\n            dst += \"{\" + symdef + \"}\";\n        }\n        else {\n            dst += \"{\"+c+\"}\"\n        }\n\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n    }\n    return dst.toLowerCase();\n  }\n\n  replaceAll( src, str1, str2 ) {\n\n    var rv = src;\n    while( rv.indexOf( str1 ) > -1 ) {\n      rv = rv.replace( str1, str2 );\n    }\n    return rv;\n  }\n\n\n  rebuildNoPETSCIILineString( raw )\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var noPetsciiLine = this.prepareLineForExportNoPETSCII( raw, false );\n    var rec = p.parseLine( noPetsciiLine );\n    return rec;\n  }\n\n\n  prepareLineForExportNoPETSCII( txt0, toLower ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n    var last= \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      var cc = txt.charAt( i );\n      if( c<31 || c==92 || c>=94 ) {\n\n        var prevCharIsQuote = false, nextCharIsQuote=false;\n        if( (i+1)<txt.length) {\n          var cc2 = txt.charAt( i+1 );\n          if( cc2 == \"\\\"\" ) {\n            nextCharIsQuote = true;\n          }\n        }\n        if( last == \"\\\"\" ) {\n            prevCharIsQuote = true;\n          }\n\n        if( prevCharIsQuote && !nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\");\\\"\";\n        }\n        else if( prevCharIsQuote && nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\")\";\n            i++;\n        }\n        else if( !prevCharIsQuote && nextCharIsQuote ) {\n            dst += \"\\\";CHR$(\"+c+\")\";\n            i++;\n        }\n\n        else {\n            dst += \"\\\";CHR$(\"+c+\");\\\"\";\n        }\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n      last = cc;\n    }\n\n    var dst2= this.replaceAll( dst, \";\\\"\\\";\",\";\");\n\n    if( toLower ) { return dst2.toLowerCase(); }\n    return dst2;\n  }\n\n  ResolveStringSymbolToCode( x ) {\n\n    if(this.symbolTable[x]) {\n      return this.symbolTable[x];\n    }\n\n    return x;\n  }\n\n  prepareLineForImport( txt0 ) {\n    var txt;\n    txt = txt0.trim(); //.toUpperCase();\n    var dst = \"\";\n\n    var i=0; while( i<txt.length ) {\n      var c = txt.charCodeAt( i );\n      if( c == 123 ) {\n        i++;\n        var num = \"\";\n        while( i < txt.length ) {\n            c = txt.charCodeAt( i );\n            if( c == 125 ) {\n              i++;\n              break;\n            }\n            num += String.fromCharCode( c );\n\n            if( this.debugFlag ) {\n              console.log(\"found ESC seq char \" + String.fromCharCode( c ) );\n              console.log(\"found ESC seq char code \" + c);\n            }\n            i++;\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"found ESC seq \" + num);\n        }\n\n        num = this.ResolveStringSymbolToCode(num.toLowerCase());\n\n        if( this.debugFlag ) {\n          console.log(\"found resolved ESC seq \" + num);\n        }\n\n        dst += String.fromCharCode( parseInt( num, 10) );\n      }\n      else if( c == 8221 || c == 8220) { //looks like a double quote\n        dst += \"\\\"\";\n        i++;\n      }\n      else {\n        dst += txt.charAt( i );\n        i++;\n      }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"dst:\" + dst);\n    }\n\n    return dst;\n  }\n\n  getProgramLines() {\n\n    return this.program;\n  }\n\n  padZeros2( x ) {\n    var s = x + \"\";\n    for(var i=s.length; i<2; i++) {\n      s=\"0\"+s;\n    }\n    return s;\n  }\n\n  evalExpressionPart( p ) {\n    var val=0;\n\n    if( p.type==\"num\" ) {\n      if( p.data == \".\" ) {\n        val = 0;\n      }\n      else if((\"\"+p.data).indexOf(\".\") >= 0) {\n        val = parseFloat(p.data);\n      }\n      else {\n        val = parseInt(p.data);\n      }\n    }\n    else if( p.type==\"str\" ) {\n      val = p.data;\n    }\n    else if( p.type==\"var\" ) {\n      if(p.data.startsWith(\"TI\")) {\n        val = this.getMillis();\n        if(p.data.endsWith(\"$\")) {\n          val = this.getTime();\n          val = \"\" +\n            this.padZeros2(val[0]) +\n            this.padZeros2(val[1]) +\n            this.padZeros2(val[2]);\n        }\n      }\n      else if(p.data == \"CURRENTLINE\") {\n        val = this.runPointer;\n        if( val != -1 ) {\n          val = parseInt( this.program[ val ][0] );\n        }\n      }\n      else if(p.data == \"PI\") {\n        val = Math.PI;\n      }\n      else {\n        val = this.vars[ p.data ];\n      }\n      if( val == undefined ) {\n        val = 0;\n        if( this.scopes[0].vars[ p.data ] ) {\n          val = this.scopes[0].vars[ p.data ];\n        }\n      }\n    }\n    else if( p.type==\"array\" ) {\n      var varIntName = \"@array_\" + p.data;\n      var arr = this.vars[ varIntName ];\n\n      if( arr === undefined ) {\n        if( this.scopes[0].vars[ varIntName ] ) {\n          arr = this.scopes[0].vars[ varIntName ];\n        }\n        if( arr === undefined ) {\n          throw \"@no such array@Array '\"+ varIntName+\"' does not exist\";\n        }\n      }\n\n      if( arr.getIndexCount() != p.indices.length ) {\n          throw \"@bad subscript@Array index dimensions do not match\";\n      }\n\n      var indices = [];\n      for( var ai=0; ai<p.indices.length; ai++) {\n        indices[ai] = this.evalExpression( p.indices[ ai ] );\n      }\n\n      val = arr.get( indices );\n      if( val === undefined ) {\n        val = 0;\n      }\n\n    }\n    else if( p.type==\"expr\" ) {\n      val = this.evalExpression( p );\n    }\n    else if( p.type==\"funCall\" ) {\n\n      var values = [];\n      for( var j=0; j<p.params.length; j++) {\n        var par = this.evalExpression( p.params[j] );;\n        values.push( {value: par} );\n      }\n      try {\n        var commands = this.commands;\n        var ecommands = this.extendedcommands;\n        var cmds = this.commands;\n\n        var nFunName = \"_fun_\" + p.functionName.toLowerCase().replace(\"$\",\"_DLR_\");\n\n        var stc = commands[ nFunName ];\n        if( stc === undefined ) {\n\n          stc = ecommands[ nFunName ];\n\n          if( stc === undefined ) {\n\n            stc = ecommands[ nFunName ];\n\n            this.printError(\"no such function: \" + p.functionName);\n            console.log(\"Cannot find functionName \" + nFunName );\n\n            throw \"@no such function \" + p.functionName;\n\n          }\n          else {\n            cmds = ecommands;\n          }\n        }\n\n        val = cmds[ nFunName ]( values );\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n    else if( p.type==\"defFnCall\" ) {\n\n      try {\n        var fName = p.functionName;\n        var parValue = this.evalExpression( p.params[0] );\n        var restore = null;\n\n        if( this.functions[ fName ] === undefined ) {\n          throw \"@undef'd function\";\n        }\n        var functRecord = this.functions[ fName ];\n\n        if(!(  this.vars[ functRecord.par ] === undefined )) {\n          restore= this.vars[ functRecord.par ];\n        }\n\n        this.vars[ functRecord.par ] = parValue;\n        val  = this.evalExpression( functRecord.expr );\n\n        if( restore != null ) {\n          this.vars[ restore.name ] = restore;\n        }\n        else {\n          this.vars[ functRecord.par ] = 0; //TODO, actually should delete it\n        }\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n\n    return val;\n  }\n\n  evalExpression( expr ) {\n\n    if( expr == null ) {\n      return null;\n    }\n\n    if( expr.parts.length == 0 ) {\n      return null;\n    }\n\n    var val = this.evalExpressionPart( expr.parts[ 0 ] );\n\n    for( var i=1; i<expr.parts.length; i++) {\n      var p = expr.parts[ i ];\n      if( p.op == \"+\" ) {\n        val += this.evalExpressionPart( p );\n      }\n      else if( p.op == \"^\" ) {\n        val = Math.pow( val, this.evalExpressionPart( p ) );\n      }\n      else if( p.op == \"-\" ) {\n        val -= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"*\" ) {\n        val *= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"/\" ) {\n        if( this.evalExpressionPart( p ) == 0) {\n          throw \"@division by zero\";\n        }\n        val /= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"%\" ) {\n        val %= this.evalExpressionPart( p );\n      }\n      else if( p.op == \";\" ) {\n        val += (\"\" + this.evalExpressionPart( p ));\n      }\n      else if( p.op == \"OR\"  ) {\n          val |= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"AND\"  ) {\n          val &= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"<\" ) {\n        if( val < (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">\" ) {\n        if( val > (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"=\" ) {\n        if( val == (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<>\" ) {\n        if( val != (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<=\" ) {\n        if( val <= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">=\" ) {\n        if( val >= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n\n      else {\n        throw \"@syntax@unknown operator '\"+p.op+\"'\";\n      }\n    }\n\n    if( expr.negate ) {\n      return -val;\n    }\n    if( expr.binaryNegate ) {\n      if( val == 0 ) {\n        return -1;\n      }\n      return 0;\n    }\n    return val;\n  }\n\n  exitInputState() {\n    var con = this.output;\n    var p = this.program;\n\n    this.inputFlag = false;\n\n\n    var l = this.program[ this.runPointer ];\n    var cmds = l[1];\n\n    this.input.setInterActive( false);\n\n    this.runPointer2++;\n\n    if( this.runPointer2 >=  cmds.length ) {\n\n      this.runPointer2 = 0;\n      this.runPointer++;\n\n      if( this.runPointer >=  p.length ) {\n\n        this.runFlag = false;\n\n        this.HandleStopped( false );\n\n        this.printLine(\"\");\n        this.printReady();\n\n      }\n\n    }\n\n\n  }\n\n  cycle() {\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n    var WAIT_SPECIFIC_TIME = 50;\n\n    var c = this.output;\n\n    var cmdCount = this.cmdCountPerCycle;\n    var lineNumber = -1;\n    try {\n\n      if( this.bitmap.isActive() ) {\n        this.bitmap.triggerFlush();\n      }\n      if( this.output.isActive() && this.output.changeCount() > 0) {\n        this.output.triggerFlush();\n      }\n\n      if( !this.runFlag ||\n            this.inputFlag ||\n            this.listFlag\n             ) {\n\n        if( this.listFlag ) {\n           var countdown = this.listSpeed;\n           while( this.listPointer < this.list.length && countdown-- > 0 ) {\n               this.listCodeLine( this.list[ this.listPointer ] );\n               this.listPointer++;\n           }\n           if (  this.listPointer >= this.list.length ){\n             this.listStop();\n             this.flagStatusChange();\n           }\n\n        }\n      }\n      else {\n\n        if(this.debugFlag) console.log(\"START CYCLE------------------------------\" );\n\n        var p = this.program;\n\n        while (true) {\n\n\n          if( this.waitForMessageFlag ) {\n              break;\n              //return this.statusChanged;\n          }\n\n          if(this.debugFlag) console.log(\"START CYCLE LOOP-------------\" );\n          var l = p[ this.runPointer ];\n          lineNumber = l[0];\n\n          if( l === undefined ) {\n            var t=1;\n          }\n          var bf = this.runPointer2;\n          if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n          if(this.debugFlag) console.log(\" cmdCount = \" + cmdCount);\n          var rv = this.runCommands( l[1], cmdCount );\n\n          if(! ( this.traceVars === undefined )) {\n              for( var tvi=0; tvi<this.traceVars.length; tvi++) {\n                var thisVar = this.traceVars[ tvi ];\n                var thisValue = this.vars[ thisVar ];\n                var oldValue = this.traceOldValues[ thisVar ];\n\n                if( ! ( thisValue === undefined )) {\n                  if( oldValue != thisValue ) {\n                    this.traceList.push(\n                      \"TRC(\" + lineNumber + \") \" + thisVar + \"=\" + thisValue\n                    );\n\n                    this.traceOldValues[ thisVar ] = thisValue;\n                  }\n\n                }\n              }\n          }\n\n          //console.log(\" rv = \", rv);\n          var af = rv[ 1 ];\n\n          if( rv[0] == MIDLINE_INTERUPT) {\n            this.runPointer2 = af;\n          }\n\n          var executedCount = rv[2];\n\n          if(this.debugFlag) console.log(\" bf = \" + bf, \" af = \" + af);\n          if(this.debugFlag) console.log(\" executedCount = \" + executedCount);\n          if(this.debugFlag) console.log(\" rv = \" + rv);\n\n          cmdCount = cmdCount - executedCount;\n\n          if( rv[0]<=0 ) {\n            if(this.debugFlag) console.log(\" PGM END!!!!\" );\n            this.runFlag = false;\n            var e = null;\n            if( rv.length >= 4 ) {\n              e = rv[3];\n            }\n            this.printLine(\"\");\n            this.printReady();\n            this.HandleStopped( false );\n            if( rv[0] == END_W_ERROR ) {\n\n              this.setVar(\"LINE\", lineNumber );\n              console.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n              console.log(\"PARAMETER DUMP:\", this.vars );\n              console.log(\"FUNCTION DUMP:\", this.functions );\n            }\n            if(this.debugFlag) console.log(\"CYCLE RETURN END\");\n            //return this.statusChanged;\n            break;\n          }\n          else if( rv[0] == LINE_FINISHED ) {\n            this.runPointer ++;\n            this.runPointer2 = 0;\n            if(this.debugFlag) console.log(\" new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n            if( this.runPointer >=  p.length ) {\n              if(this.debugFlag) console.log( \"end program\");\n\n              this.setVar(\"LINE\", lineNumber );\n\n              if( !this.waitForMessageFlag ) {\n                this.runFlag = false;\n                this.HandleStopped( false );\n                this.printReady();\n              }\n              else {\n                this.stopAfterMessage = true;\n              }\n              break;\n            }\n          }\n          else if( rv[0] == TERMINATE_W_JUMP ) {\n\n            if(this.debugFlag) console.log(\" jump to new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n          }\n          else if( rv[0] == PAUSE_F_INPUT ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 INPUT\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }\n          else if( rv[0] == WAIT_SPECIFIC_TIME ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 SPECIFIC TIME\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }\n\n          if( cmdCount<=0 ) {\n            if(this.debugFlag) console.log(\"Breaking cmdCount=\" + cmdCount)\n            break;\n          }\n\n        }\n\n        if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n      }\n\n    }\n    catch (e) {\n      //c.clearCursor();\n\n      sys.log(\"DEBUG: \", typeof e );\n\n      this.setVar(\"LINE\", lineNumber );\n\n\n      if( this.erh.isError( e ) ) {\n        var err = e;\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else if( this.erh.isSerializedError( e ) ) {\n        var err = this.erh.fromSerializedError( e );\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else {\n        var err = this.erh.fromSimpleExternalError( e, undefined, undefined );\n\n        if( err ) {\n\n            this.setVar(\"ERR\", err.clazz );\n            this.setVar(\"ERRDETAIL\", err.detail  );\n            this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else {\n\n            this.setVar(\"ERR\", \"unexpected\" );\n            this.setVar(\"ERRDETAIL\", \"unexpected\"  );\n            this.printError( \"unexpected\", undefined, undefined, e );\n        }\n\n      }\n\n      this.printReady();\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n      sys.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n      sys.log(\"PARAMETER DUMP:\", this.vars );\n      sys.log(\"FUNCTION DUMP:\", this.functions );\n\n    }\n\n    var pi = this.procIf;\n\n    var cstate = pi.STATE_CLI;\n\n    if( this.isWaitingFlag  ) { cstate = pi.STATE_WAITING ;}\n    else if( this.inputFlag  ) { cstate = pi.STATE_INPUT ;}\n    else if( this.runFlag | this.listFlag ) { cstate = pi.STATE_RUNNING; }\n\n    return [ this.statusChanged, cstate, this.waitingTime ];\n  }\n\n  doReturn() {\n\n    var oldPointers = this.gosubReturn.pop();\n    if( oldPointers === undefined ) {\n      throw \"@return without gosub\";\n    }\n\n    this.runPointer2 = oldPointers[ 1 ];\n    this.runPointer = oldPointers[ 0 ];\n\n    //this.goto( oldLine );\n  }\n\n\n  doInterruptReturn() {\n\n    if( this.scope.name == \"interrupt0\" ) {\n      this.interruptFlag0 = false; // TODO interrupt, take from scope which flag\n    }\n    else {\n      this.interruptFlag1 = false; // TODO interrupt, take from scope which flag\n    }\n\n    this.runPointer = this.scope.data.runPointer;\n    this.runPointer2 = this.scope.data.runPointer2;\n\n    this.closeScope();\n\n  }\n\n\n\n\n  gosub( line0, runPointer2 ) {\n\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var retLine = null;\n    var retCmd = null;\n\n    var line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    this.runPointer2 = runPointer2;\n\n    if( ( this.runPointer2 + 1) < this.program[ this.runPointer ][1].length ) {\n      retCmd = this.runPointer2 + 1;\n      retLine = this.runPointer;\n    }\n    else {\n      if( (this.runPointer+1) < len ) {\n        retCmd=0;\n        retLine = this.runPointer+1 ;\n      }\n      else {\n        retCmd=9999;\n        retLine = this.runPointer;\n      }\n    }\n\n    this.gosubReturn.push( [ retLine, retCmd ] );\n    this.goto( line );\n  }\n\n  goto( line0 ) {\n\n    //console.log( \"goto line \" + line)\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n    var line;\n\n    line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n      }\n    }\n\n    if(!found ) {\n      throw \"@undef'd statement\";\n    }\n\n    if(!this.runFlag ) {\n      this.startAsGoto = true;\n      this.runPGM();\n    }\n  }\n\n  listStop() {\n    if( this.listFlag ) {\n      if( this.runFlag ) {\n        this.listFlag = false;\n        this.input.setInterActive( this.listFlagBakInteractive );\n      }\n      else {\n        var c = this.output;\n        this.listFlag = false;\n        this.HandleStopped( false );\n        this.printLine( \"\" );\n        this.printReady();\n      }\n    }\n  }\n\n\n  runStop() {\n    if( this.runFlag ) {\n      var c = this.output;\n      this.runFlag = false;\n      this.handlers.interrupt0 = undefined;\n      this.handlers.interrupt1 = undefined;\n\n      this.HandleStopped( false );\n\n      console.log( \"break in \" + this.program[ this.runPointer ][0] );\n\n      this.setVar( \"LINE\", this.program[ this.runPointer ][0] );\n      this.setVar(\"ERR\", \"BREAK\" );\n\n      this.printLine(\"\");\n      this.printLine( \"break in \" + this.program[ this.runPointer ][0]);\n      this.printReady();\n    }\n  }\n\n  isRunning() {\n    return this.runFlag;\n  }\n\n  isListing() {\n    return this.listFlag;\n  }\n\n  isInput() {\n    return this.inputFlag;\n  }\n\n  isReady() {\n    return !this.runFlag && !this.listFlag && ! this.executeLineFlag;\n  }\n\n\n  getDataBlocks() {\n    var list = [];\n\n    var mapInfo = Object.entries( this.loadedData );\n    for( var i=0; i<mapInfo.length; i++) {\n      if( mapInfo[i][1].length > 0) {\n        list.push( mapInfo[i][0] + \": \" + mapInfo[i][1].length  );\n      }\n\n    }\n\n    return list;\n\n  }\n\n  readData() {\n\n    if( this.dataPointer >= this.data.length ) {\n      return undefined;\n    }\n\n    var result = this.data[ this.dataPointer ];\n    this.dataPointer++;\n\n    return result;\n  }\n\n\n  getDataLength() {\n\n    return this.data.length;\n\n  }\n\n  setData( label0 ) {\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n\n    this.data = this.loadedData[ label ];\n    this.dataPointer = 0;\n\n  }\n\n  insertData( data, type, label0 ) {\n\n    //this.loadedData = { default: [] };\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n    this.loadedLabel = label;\n    this.dataPointer = 0;\n\n    var arr = [];\n    this.loadedData[label ] = arr;\n\n    var typeParts = type.split(\":\");\n    var typeData = typeParts[0].toUpperCase();\n    var dataSyntax = typeParts[1].toUpperCase();\n\n    this[\"parseSimpleData\" + typeData + \"_\" + dataSyntax]( data, arr );\n\n    this.data = arr;\n  }\n\n\n  parseSimpleDataI_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n\n  parseSimpleDataS_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  parseSimpleDataS_LINES( data, toArr ) {\n    var data2;\n    data2 = data.split(\"\\n\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  printChar( c  ) {\n    this.output.write( c );\n  }\n\n  listCodeLine( rawLine ) {\n    if( rawLine === undefined ) {\n        this.printLine( \"???\" );\n        return;\n    }\n\n    this.printLine( rawLine );\n\n  }\n\n  rebuildLineString( nr, raw,\n      removePadding,\n      renumbering,\n      addSmartPadding,\n      shortenKeywords)\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n\n    var tokens = p.getTokens( raw, false, false );\n\n    if( ! ( renumbering === undefined )) {\n\n\n\n      var nopadTokens = [];\n      for( i = 0; i<tokens.length; i++) {\n        if( tokens[i].type != \"pad\") {\n          nopadTokens.push( tokens[ i ] );\n        }\n      }\n\n      var foundGoto = false;\n      var foundGotoParIndex = -1;\n\n      for( i = 0; i<nopadTokens.length; i++) {\n\n          if( i>1 ) {\n            if( nopadTokens[i].type == \"num\" &&\n                nopadTokens[i-1].type == \"name\" && nopadTokens[i-1].data == \"THEN\" ) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n            else if( nopadTokens[i].type == \"num\" &&\n                  nopadTokens[i-1].type == \"name\" &&\n                  ( nopadTokens[i-1].data == \"GOTO\" || nopadTokens[i-1].data == \"GOSUB\" )) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n        }\n\n        if( nopadTokens[i].type == \"num\" && foundGoto &&  i == foundGotoParIndex ) {\n          var newLine = renumbering[ \"old_\" + nopadTokens[i].data ];\n          if( newLine == undefined ) { newLine = 99999;}\n          nopadTokens[i].data =newLine;\n          foundGoto = false;\n        }\n      }\n    }\n    tokens[0].data = nr;\n    var newString;\n\n    newString = nr;\n    if( removePadding ) {\n      newString = nr + \" \" ;\n    }\n    for( var i = 1 ; i< tokens.length; i++) {\n      if( removePadding ) {\n         if( tokens[i].type == \"pad\" ) {\n           continue;\n         }\n       }\n\n       if( shortenKeywords ) {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"PRINT\" ) {\n           tokens[i].data = \"?\";\n         }\n       }\n       else {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"?\" ) {\n           tokens[i].data = \"PRINT\";\n         }\n      }\n\n      if( tokens[i].type == \"str\" ) {\n        newString += \"\\\"\" + tokens[i].data + \"\\\"\";\n      }\n      else if( tokens[i].type == \"name\" && addSmartPadding == true) {\n        newString += tokens[i].data + \" \";\n      }\n      else if( tokens[i].type == \"num\" && addSmartPadding == true) {\n        if( tokens[i].data.length == 1 ) {\n            newString += \" \" + tokens[i].data;\n        }\n        else {\n            newString += tokens[i].data;\n        }\n      }\n      else {\n        newString += tokens[i].data;\n      }\n\n    }\n\n    var rec = p.parseLine( newString );\n\n    return rec;\n  }\n\n  lineIsData( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"DATA\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsRem( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"REM\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsSub( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"SUB\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  renumberProgram( start, gap ) {\n\n    var p = this.program;\n\n    var newLineNr = start;\n    var renumbering = {};\n    var lineNumbers = [];\n\n    var method = \"sub\";\n\n    if( method  == \"plain\" ) {\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n      }\n    }\n    else if( method  == \"data\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n      //data\n      var kNumber = Math.ceil( newLineNr / 1000 );\n      var newLineNr2 = 1000 * ( kNumber  );\n      if( newLineNr2 - newLineNr  < 100 ) {\n        newLineNr2+=1000;\n      }\n      newLineNr = newLineNr2;\n\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( !data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n    }\n    else if( method  == \"rem\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsRem( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    else if( method  == \"sub\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsSub( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    //newLineNr = start;\n    for( var i=0; i<p.length; i++) {\n        newLineNr = lineNumbers[ i ]\n        var line = p[ i ];\n        var lRec = this.rebuildLineString( newLineNr, line[2], true, renumbering, true );\n\n        line[0] = newLineNr;\n        line[1] = lRec.commands;\n        line[2] = lRec.raw.trim();\n\n        //newLineNr += gap;\n    }\n  }\n\n  PETSCIIreplace( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildNoPETSCIILineString( line[2] );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  compressProgram( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n       var lRec = this.rebuildLineString( line[0], line[2], true, undefined, false, keywordCompress );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  normalizeProgram() {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildLineString( line[0], line[2], true, undefined, true );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  clrPGM() {\n    this.vars = {};\n    this.functions = [];\n    this.restoreDataPtr();\n  }\n\n  restoreDataPtr() {\n    this.dataPointer = 0;\n    this.data = this.loadedData[ \"default\" ];\n  }\n\n  normalizeData( dataRec ) {\n    var data = dataRec.data;\n\n    if( dataRec.type == \"num\" ) {\n      if( (typeof data).toLowerCase() == \"string\" ) {\n        data = parseInt( data );\n      }\n    }\n    else {\n      if( (typeof data).toLowerCase() == \"number\" ) {\n        data = \"\" + data ;\n      }\n    }\n\n    return data;\n  }\n\n  runPGM() {\n\n    this.executeLineFlag = false;\n    this.stopAfterMessage = false;\n\n    if( this.startAsGoto ) {\n        this.startAsGoto = false;\n\n        var bak1 = this.runPointer;\n        var bak2 = this.runPointer2;\n\n        this.runPGM();\n\n        this.runPointer = bak1;\n        this.runPointer2 = bak2;\n\n\n        return;\n    }\n\n    this.input.setInterActive( false);\n    this.input.flush();\n\n    var c = this.output;\n    var p = this.program;\n\n    this.loadedData[ \"default\" ] = [];\n    this.restoreDataPtr();\n\n    this.gosubReturn = [];\n    this.scopes = [];\n    this.newScope( \"global\", {} );\n    this.functions = [];\n    this.handlers = {}\n    this.labels = {};\n    this.traceList = [];\n    this.traceOldValues = {};\n\n    var normalize = this.normalizeData;\n\n    for( var i=0; i<p.length; i++) {\n\n        var line = p[ i ];\n        var commands = line[1];\n\n        for( var j=0; j<commands.length; j++) {\n\n          var command = commands[j];\n\n          if( command.type  == \"control\" && command.controlKW == \"data\") {\n            for( var k=0; k<command.params.length; k++) {\n              this.loadedData[ \"default\" ].push( normalize( command.params[k] ) );\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"on\") {\n            if( command.params[0] == \"interrupt1\") {\n              this.handlers.interrupt1 = command.params[1];\n              this.handlers.interrupt1ParamIsLabel = command.label;\n            }\n            else if( command.params[0] == \"interrupt0\") {\n              this.handlers.interrupt0 = command.params[1];\n              this.handlers.interrupt0ParamIsLabel = command.label;\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"sub\") {\n            var label = command.label;\n            this.labels[ label ] = parseInt(line[0]);\n          }\n        }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"data dump:\",this.data);\n    }\n\n\n    if( this.program.length > 0) {\n      this.runFlag = true;\n      this.inputFlag = false;\n      this.waitingTime = 0;\n      this.isWaitingFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n\n    }\n    else {\n      this.runFlag = false;\n      this.inputFlag = false;\n      this.waitingTime = 0;\n      this.isWaitingFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n      this.input.setInterActive( true);\n    }\n\n    this.flagStatusChange();\n  }\n\n  getVars() {\n    return this.vars;\n  }\n\n\n\n\n  doForInit( from, to, step, varName, cmdPointer, cmdArrayLen, linePointersLen ) {\n\n    var ctx = this.forContext;\n\n    if( this.vars[ varName ] === undefined ) {\n      this.vars[ varName ] = 0;\n    }\n    this.vars[ varName ] = this.evalExpression( from );\n\n    ctx.default.push( varName );\n    ctx[varName] = {};\n\n    var ctxv = ctx[varName];\n    ctxv.to = this.evalExpression( to );\n\n    if( step == null ) {\n        ctxv.step = 1;\n    }\n    else {\n      ctxv.step = this.evalExpression( step );\n    }\n\n    ctxv.jumpTo =\n      { line: this.runPointer,\n        cmdPointer: cmdPointer+1 }\n    if( ctxv.jumpTo.cmdPointer >= cmdArrayLen )  {\n\n      if( this.runPointer == -1) {\n        throw \"@syntax@Can't find command after 'FOR'\";\n      }\n      else {\n        if( ( this.runPointer + 1) >= linePointersLen ) {\n          throw \"@syntax@Can't find command after 'FOR', on next line\";\n        }\n        ctxv.jumpTo.line++;\n        ctxv.jumpTo.cmdPointer = 0;\n      }\n    }\n\n  }\n\n  doForNext( nextVarName ) {\n    var ctx = this.forContext;\n    if( ctx.default.length == 0 ) {\n      throw \"@syntax@Next without for\";\n    }\n    var varName = ctx.default[ctx.default.length-1];\n    if( nextVarName  != null ) {\n      varName = nextVarName;\n    }\n\n    var ctxv = ctx[varName];\n\n    this.vars[ varName ] += ctxv.step;\n    if( ctxv.step > 0) {\n      if(this.vars[ varName ]<=ctxv.to) {\n\n        return ctxv.jumpTo;\n      }\n    }\n    else if( ctxv.step == 0) {\n      return ctxv.jumpTo;\n    }\n    else {\n      if(this.vars[ varName ]>=ctxv.to) {\n        return ctxv.jumpTo;\n      }\n    }\n\n    ctx.default.pop();\n    return -1;\n  }\n\n  onLineStr() {\n\n    var line = this.retreiveLine();\n    if( line == -1 || line == \"\") { return \"\"; }\n\n    return \" in \" + line;\n\n  }\n\n  retreiveRuntimeLine() {\n    if( this.runPointer > -1 ) {\n      var line = this.program[this.runPointer];\n      return line[0];\n    }\n    return -1;\n  }\n\n\n  retreiveLine() {\n    if( this.runFlag ) {\n      return this.retreiveRuntimeLine();\n    }\n    else {\n      if( this[\"parseLineNumber\"] === undefined ) {\n        return -1;\n      }\n      if( this.parseLineNumber == -1) { return \"\"; }\n      return this.parseLineNumber;\n    }\n    return -1;\n  }\n\n\n  commandToString( cmd ) {\n    if( cmd.type == \"control\" )  {\n      return cmd.controlKW.toUpperCase();\n    }\n    else if( cmd.type == \"call\" ) {\n      return cmd.statementName;\n    }\n    else if( cmd.type == \"assignment\" )  {\n      return \"assign ->\" + cmd.var;\n    }\n    return \"????\";\n  }\n\n  runCommands( cmds, limit ) {\n    /* return values\n      false -> error or end program\n      true  -> executed ok\n\n      should return\n      end_w_error\n      terminate_program\n      line_finished\n      goto_gosub\n    */\n\n    var commands = this.commands;\n    var ecommands = this.extendedcommands;\n    var EXPR = 0, PAR = 1;\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n    var WAIT_SPECIFIC_TIME = 50;\n\n    var end = cmds.length;\n    var i=this.runPointer2;\n    var cnt=0;\n\n    if(!(limit == undefined )) {\n      //nothing\n    }\n    else {\n      limit = 9999; //reaching to infinite (max on line maybe  40)\n    }\n\n    while( i<end && cnt<limit ) {\n\n\n      var cmd=cmds[i];\n\n      var l=this.program[this.runPointer];\n      if( l ) {\n        if(parseInt(l[0]) == 3155 ) {\n          console.log(\"bump\");\n        }\n      }\n\n      if( cmd.type == \"control\" )  {\n        var cn = cmd.controlKW;\n        if( cn == \"goto\" ) {\n          this.goto( cmd.params[0] );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"end\" ) {\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"stop\" ) {\n          this.printInfo(\"break\");\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"gosub\" ) {\n          this.gosub( cmd.params[0], i );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"on\" ) {\n          var onCommand = cmd.params[ 0 ];\n\n          if( onCommand != \"interrupt0\"  && onCommand != \"interrupt1\" ) {\n            var onExpr = cmd.params[ 1 ];\n            var onLineNrs = cmd.params[ 2 ];\n\n            var value = this.evalExpression( onExpr );\n            if( (value-1)>=0 && (value-1)<onLineNrs.length ) {\n              if( onCommand == \"goto\" ) {\n                this.goto( onLineNrs[ (value-1) ] );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n              else if( onCommand == \"gosub\" ) {\n                this.gosub( onLineNrs[ (value-1) ], i );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n            }\n          }\n\n          //if not jumping, do nothing\n        }\n        else if( cn == \"return\" ) {\n\n          if( this.interruptFlag0 || this.interruptFlag1) {\n\n            this.doInterruptReturn();\n\n          }\n          else {\n            this.doReturn();\n          }\n\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"if\" ) {\n          var IF_ERROR = -1;\n          var IF_TRUE = 1;\n          var IF_FALSE = 0;\n\n          var ifresult = this.evalExpression( cmd.params[0] );\n          if( ifresult != IF_FALSE ) {\n             //return [MIDLINE_INTERUPT,i+1];\n          }\n          else  {\n             return [LINE_FINISHED,i+1,cnt+1];\n          }\n        }\n        else if( cn == \"data\" ) {\n          //Nothing\n        }\n        else if( cn == \"rem\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"sub\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"for:init\" ) {\n          this.doForInit( cmd.params[0], cmd.params[1], cmd.params[2], cmd.variable, i, cmds.length );\n        }\n        else if( cn == \"for:next\" ) {\n\n          var jump = this.doForNext( cmd.nextVar );\n\n          if( !(jump === -1 ) ) {\n\n            if( jump.line != -1 ) {\n                if( this.runPointer == jump.line ) {\n                  i = jump.cmdPointer;\n                  cnt++;\n                  continue;\n                }\n                else {\n                  this.runPointer = jump.line;\n                  this.runPointer2 = jump.cmdPointer;\n                }\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n            }\n            else {\n              i = jump.cmdPointer;\n              cnt++;\n              continue;\n            }\n          }\n        }\n        else if( cn == \"dim\" ) {\n          var vars = this.vars;\n\n          for( var ix=0; ix<cmd.params.length; ix++) {\n\n            var indices = [];\n            for( var ai=0;ai<cmd.params[ix].length;ai++){\n              indices[ai] = this.evalExpression( cmd.params[ix][ai] );\n            }\n\n            var arrRec = new BasicArray( cmd.arrayNames[ix], indices, 0 );\n\n            var varIntName = \"@array_\" + cmd.arrayNames[ix];\n\n            if( ! ( this.vars[ varIntName ] === undefined )) {\n              this.printError( \"redim'd array\" );\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ varIntName ] = arrRec;\n          }\n\n        }\n        else if( cn == \"def\" ) {\n          this.functions[ cmd.params[0] ] = {\n            par: cmd.params[1],\n            expr: cmd.params[2]\n          };\n        }\n        else {\n          this.printError( \"illegal ctrl token '\" + cn  +\"'\");\n          return [END_W_ERROR,i+1,cnt+1];\n        }\n      }\n      else if( cmd.type == \"call\" )  {\n        var values = [];\n        var pardefs = [];\n        var mycommands = commands;\n        var stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n        if( stc === undefined ) {\n          //cmd.statementName.toLowerCase().startsWith(\"x\") )\n          mycommands = ecommands;\n\n          stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n          if( stc === undefined ) { }\n          else {\n            if( mycommands.enabled == false &&\n              cmd.statementName.toLowerCase() != \"xon\") {\n                  this.printError( \"extended not enabled\" );\n                  return [END_W_ERROR,i+1,cnt+1];\n            }\n          }\n        }\n\n        var intf = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()];\n        if( !( intf === undefined ) ) {\n            pardefs = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()]();\n        }\n        else {\n          for( var j=0; j<cmd.params.length; j++) {\n            pardefs[j] = EXPR;\n          }\n        }\n\n        for( var j=0; j<cmd.params.length; j++) {\n          if( pardefs[j] == EXPR ) {\n\n            var p = this.evalExpression( cmd.params[j] );  //NOTE this one gets the trailing ;, from a \"PRINT ;\" command\n\n            if( p != null ) {\n              values.push( { type: \"value\", value: p } );\n            }\n          }\n          else if( pardefs[j] == PAR ) {\n            var varName = cmd.params[j].parts[0].data;\n            var varType0 = cmd.params[j].parts[0].type;\n\n            if( varType0 == \"array\" ) {\n\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType0 + \":\" + varType } );\n\n\n            }\n            else {\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType } );\n\n            }\n\n          }\n          else { /*RAW*/\n            //values.push( cmd.params[j].parts );\n            values.push( cmd.params[j] );\n\n          }\n        }\n        try {\n          //var stc = ;\n          if( stc === undefined ) {\n            this.printError(\"syntax\");\n            return [END_W_ERROR,i+1,cnt+1];\n          }\n          else {\n\n              this.inputCommand  = false;\n\n              mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()]( values );\n\n              if( this.inputFlag ) {  //}|| this.inputCommand ) {\n                return [PAUSE_F_INPUT,i+1,cnt+1];\n              }\n              else if ( this.isWaitingFlag )  {\n                return [WAIT_SPECIFIC_TIME,i+1,cnt+1];\n              }\n          }\n\n        }\n        catch ( e ) {\n          console.log(e);\n\n          if( this.erh.isSerializedError( e ) ) {\n            var err = this.erh.fromSerializedError( e );\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else if( this.erh.isError( e ) ) {\n            var err = e;\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else {\n            this.printError(\"unexpected \" + e );\n          }\n\n          return [END_W_ERROR,i+1,cnt];\n        }\n      }\n      else if( cmd.type == \"assignment\" )  {\n        if( cmd.arrayAssignment ) {\n          var varIntName = \"@array_\" + cmd.var;\n          if( this.vars[ varIntName ] === undefined ) {\n            this.printError(\"bad subscript\",false, false, \"No such Array\");\n            //printError( s, supressLine, explicitline, detail ) {\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var arr = this.vars[ varIntName ];\n          if( cmd.indices.length != arr.getIndexCount() ) {\n            this.printError(\"bad subscript\",false, false, \"Wrong dimensions\");\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var indices = [];\n          for( var ai=0;ai<cmd.indices.length;ai++){\n            indices[ai] = this.evalExpression( cmd.indices[ai] );\n          }\n\n          if( cmd.var.endsWith(\"%\") ) {\n              arr.set( indices, Math.floor( this.evalExpression( cmd.expression ) ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n          else {\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n\n        }\n        else { //single var (not an array)\n          if( this.vars[ cmd.var ] === undefined ) {\n            if(cmd.var.startsWith(\"TI\")) {\n              this.printError(\"syntax\");\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ cmd.var ] = 0;\n          }\n          if(cmd.var.endsWith(\"%\")) {\n            this.vars[ cmd.var ] = Math.floor( this.evalExpression( cmd.expression ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n          else {\n            this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n        }\n      }\n      //cnt++;\n      i++;\n      cnt++;\n    }\n\n    if( i== cmds.length ) {\n      return [LINE_FINISHED,i,cnt];\n    }\n\n    return [MIDLINE_INTERUPT,i,cnt];\n\n  }\n\n  newScope( name, data ) {\n    var scope = { name: name, vars: {}, data: data };\n    this.scopes.push( scope );\n    this.vars = scope.vars;\n    this.scope = scope;\n  }\n\n  closeScope() {\n    this.scopes.pop();\n    this.vars = this.scopes[ this.scopes.length - 1 ].vars;\n  }\n\n\n  getArray( a ) {\n   return this.vars[  \"@array_\" + a ];\n  }\n\n  setVar( a, b ) {\n    this.vars[ a ] = b;\n  }\n\n  getTraceList() {\n    if( this.traceList === undefined ) {\n      return [];\n    }\n\n    return this.traceList;\n  }\n\n  setTraceVar( v ) {\n    if( this.traceVars === undefined ) {\n        this.traceVars = [];\n    }\n    this.traceVars.push( v.toUpperCase() );\n\n  }\n\n  resetTraceVar( v ) {\n    this.traceVars = undefined;\n  }\n\n\n  old( ) {\n    this.program = this.oldProgram;\n  }\n\n  new( ) {\n    this.oldProgram = this.program ;\n    this.program = [];\n  }\n\n  removePgmLine( linenr ) {\n\n    var pgm2 = [];\n\n    for( var i=0; i<this.program.length; i++) {\n      var pl=this.program[i];\n      if( pl[0] != linenr ) {\n        pgm2.push(pl);\n      }\n    }\n    this.program = pgm2;\n\n  }\n\n\n  padSpaces6( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<6; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n  padSpaces8( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<8; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n\n  insertPgmLine( linenr, commands, handlers, raw ) {\n\n    this.insertPgmLineLocal( linenr, commands, handlers, raw, this.program );\n  }\n\n  insertPgmLineLocal( linenr, commands, handlers, raw, myProgram ) {\n\n    for( var i=0; i<myProgram.length; i++) {\n      var pl=myProgram[i];\n      if( pl[0] == linenr ) {\n        myProgram[i] = [linenr, commands, raw.trim() ];\n        return;\n      }\n    }\n\n    myProgram.push( [linenr, commands, raw.trim(), handlers ]);\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    myProgram.sort( sortF );\n\n  }\n\n  textLinesToBas( lines ) {\n\n    var myProgram = [];\n    var exception = undefined;\n\n    if( this.debugFlag ) {\n      console.log( \"textLinesToBas\" );\n    }\n    for( var i = 0; i<lines.length; i++ ) {\n\n      var line = this.prepareLineForImport( lines[ i ] );\n      var p = new Parser( this.commands, this.extendedcommands );\n      p.init();\n\n      var l = null;\n\n      try {\n          l = p.parseLine( line );\n      }\n      catch ( e ) {\n        if( exception === undefined ) {\n            exception = e;\n        }\n\n        try {\n          l = p.parseErrorLine( line );\n        }\n        catch ( e ) {\n            this.printError( \"unexpected text (at \"+i+\")\", true );\n            console.log(\"Illegal Line: \", line );\n        }\n      }\n\n      if( l == null ) {\n        continue;\n      }\n      if( l.lineNumber != -1 ) {\n        if( l.commands.length > 0) {\n          this.insertPgmLineLocal( l.lineNumber, l.commands, l.handlers, l.raw,  myProgram);\n          //this.program[ l.lineNumber ] = [l.commands,l.raw];\n        }\n        else {\n          throw \"Error, no commands on line \" + l.lineNumber;\n        }\n      }\n      else {\n        throw \"Error, command must start with number to be part of program\";\n      }\n\n      if( this.debugFlag ) {\n        console.log(\"program:\",myProgram);\n        console.log(\"Line: \", l );\n      }\n    }\n    return { pgm: myProgram, exception: exception };\n  }\n\n  printReady() {\n    this.printLine(\"Ready.\");\n  }\n\n\n  startConsoleDataInput( vars ) {\n\n    if( this.debugFlag ) {\n      console.log(\"inputvars=\",vars);\n    }\n    this.inputFlag = true;\n    this.inputVars = vars;\n    this.input.setInterActive( true);\n    this.inputVarsPointer = 0;\n    this.output.write( \"? \");\n    this.inputStartInputPosX = this.output.getCursorPos()[0];\n\n    this.flagStatusChange();\n\n  }\n\n  executeInteractiveLine( str ) {\n    this.handleLineInput( str, false );\n  }\n\n  handleLineInput( str, isInputCommand ) {\n\n    if( this.debugFlag ) {\n      console.log(\"handleLineInput: start debug / isInputCommand=\" + isInputCommand + \" -------------\");\n    }\n\n    if( isInputCommand ) {\n\n        var input=str;\n        var qMark = input.indexOf(\"?\");\n        while( qMark > -1 ) {\n          input = input.substr(qMark+2);\n          qMark = input.indexOf(\"?\");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: start debug / input, name -------------\");\n          console.log( \"InputVarsPointer:\" , this.inputVarsPointer );\n          console.log( \"InputVars:\" , this.inputVars );\n\n          console.log( \"Input String:\" ,input );\n          console.log( \"Input Vars[current]:\" ,this.inputVars[ this.inputVarsPointer ] );\n        }\n\n\n        var vName = this.inputVars[ this.inputVarsPointer ];\n        if( vName.indexOf(\"$\") >-1 ) {\n            this.setVar( this.inputVars[ this.inputVarsPointer ], input.trim() );\n        }\n        else {\n          var num = parseFloat( input.trim() );\n\n          if( isNaN( num ) ) {\n            this.printLine(\"?redo from start\");\n            this.printChar( \"? \");\n            return;\n          }\n          this.setVar( this.inputVars[ this.inputVarsPointer ], num );\n        }\n\n        this.inputVarsPointer++;\n        if( this.inputVarsPointer >= this.inputVars.length ) {\n\n          this.exitInputState();\n        }\n        else {\n          this.printChar( \"?? \");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: end debug -------------\");\n        }\n        return;\n    }\n\n    this.executeLineFlag = true;\n\n    if( this.debugFlag ) {\n      console.log( str );\n    }\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    try {\n      var l = p.parseLine( str );\n    }\n    catch( e ) {\n\n      this.parseLineNumber = -1;\n      if( this.erh.isError( e ) ) {\n        this.parseLineNumber = e.lineNr;\n        this.printError( e.clazz, true, undefined, e.detail );\n      }\n      else {\n        this.printError( \"syntax\", true );\n      }\n      this.printReady();\n    }\n    if( l == null ) {\n      if( this.debugFlag ) {\n        console.log(\"handleLineInput: end debug -------------\");\n      }\n\n      this.executeLineFlag = false;\n      return;\n    }\n\n    if( l.lineNumber != -1 ) {\n      if( l.commands.length > 0) {\n        this.insertPgmLine( l.lineNumber, l.commands, l.handlers, l.raw);\n      }\n      else {\n        this.removePgmLine( l.lineNumber  );\n      }\n    }\n    else {\n      this.runPointer = -1;\n      this.runPointer2 = 0;\n\n      try {\n        this.runCommands( l.commands );\n      }\n      catch( e ) {\n\n        this.parseLineNumber = -1;\n\n        if( this.erh.isSerializedError( e ) ) {\n          var err = this.erh.fromSerializedError( e );\n          this.parseLineNumber = err.lineNr;\n          this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else if( this.erh.isError( e ) ) {\n          var err = e;\n          this.printError( err.clazz );\n          this.parseLineNumber = err.lineNr;\n        }\n        else {\n          this.printError(\"unexpected \" + e );\n        }\n\n        this.runFlag = false;\n      }\n\n      if( ! this.runFlag && ! this.listFlag && !this.waitForMessageFlag) {\n        this.printReady();\n      }\n\n    }\n\n    this.executeLineFlag = false;\n\n    if( this.debugFlag ) {\n      console.log(\"program:\",this.program);\n      console.log(\"Line: \", l );\n\n      console.log(\"handleLineInput: end debug -------------\");\n    }\n  }\n\n}\n\n//--EOC \n\n// ## extendedcommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/extendedcommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/extendedcommands.js\n\nclass ExtendedCommands {\n\n  constructor( basicCmds, runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.playfields = runtime.playfields;\n    this.audio = runtime.audio;\n    this.html = runtime.html;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n    this.basicCmds = basicCmds;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n\n  getAllCategories() {\n    var categoryIndexes = this.basicCmds.getCategories();\n    var categoryIndexes2 = this.getCategories( categoryIndexes );\n\n    return new CommandHelp().getCategoriesNormalize( categoryIndexes2 );\n  }\n\n  getCategories( categoryIndexes ) {\n\n    return new CommandHelp().getCategoriesIntermediate( categoryIndexes, this );\n\n  }\n\n\n\n  /************************ commands ************************/\n\n\n  _stat_info_help() { return \"general:Show help on commands:[<Help Category Index>]\"; }\n\n  _stat_help( pars ) {\n\n  this.output.writeln(\"\");\n  var catRecord = this.getAllCategories();\n  var lst = catRecord[0];\n  var catLists = catRecord[1];\n  var hlpctx = 1000;\n\n  if( pars.length == 1 ) {\n    hlpctx = pars[0].value;\n  }\n\n  if( hlpctx == 1000 ) {\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help Categories:\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      this.output.writeln( i + \" \" + lst[i].toUpperCase() );\n    }\n  }\n  else {\n\n    var lbl = lst[ hlpctx ];\n    lst = catLists[ lbl ];\n    if(lst === undefined ) {\n      this.erh.throwError( \"invalid help index\" );\n    }\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help on Category: \\\"\" + lbl.toUpperCase() + \"\\\"\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      //this.context.printLine( ((hlpctx * 100) + i) + \" \" + lst[i] );\n      var attr = lst[i].attribs;\n      var padLen = 11-lst[i].name.length;\n      var pad = \"               \".substr(0,padLen );\n\n\n      if( attr.description ) {\n          this.output.writeln( \" \" + lst[i].name  + pad + \" ; \" + attr.description );\n      }\n      else {\n          this.output.writeln( \" \" + lst[i].name  );\n      }\n      if( attr.input ) {\n        var lines = attr.input.split(\"\\n\");\n\n        this.output.writeln( \"               input : \" + lines[0] );\n        for( var l=1; l<lines.length; l++) {\n            var line = lines[ l ];\n\n            this.output.writeln( \"                       \" + line );\n          }\n          this.output.writeln( \"\" );\n        }\n\n        if( attr.output ) {\n          var lines = attr.output.split(\"\\n\");\n\n          this.output.writeln( \"               output : \" + lines[0] );\n          for( var l=1; l<lines.length; l++) {\n              var line = lines[ l ];\n\n              this.output.writeln( \"                       \" + line );\n            }\n            this.output.writeln( \"\" );\n        }\n      }\n    }\n  this.output.writeln(\"\");\n\n  }\n\n  _if_cls() {\n    var EXPR = 0, PAR = 1, RAW=2;\n    return [RAW];\n  }\n\n  _stat_info_cls() { return \"general:Clears the screen:[<ResetScreenFlag>]\"; }\n\n  _stat_cls( pars ) {\n    var reset = false;\n\n    if( pars.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length == 1 ) {\n      if( pars[0].parts[0].data.toUpperCase() == \"RESET\" ) {\n          reset = true;\n      }\n      else {\n        throw \"parameters\";\n      }\n    }\n\n    if( reset ) {\n      this.output.control( 12 );\n    }\n    else {\n      this.output.control( 24 );\n    }\n  }\n\n  _stat_info_reset() { return \"general:Resets the audio and the terminal:[ <Mode> (0=screen, 1=audio, 2=all) ]\"; }\n  _stat_reset( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.reset();\n      this.audio.reset();\n      this.runtime.resetTraceVar();\n      return;\n    }\n\n    var mode = pars[0].value;\n\n    if( mode != 0 && mode != 1 && mode != 2 ) {\n      this.erh.throwError( \"mode\", \"only 0, 1, 2 supported\" );\n      return\n    }\n\n    if( mode == 0) {\n      this.output.reset();\n    }\n    if( mode == 1) {\n      this.audio.reset();\n    }\n    else  {\n      this.output.reset();\n      this.audio.reset();\n    }\n\n  }\n\n\n  _stat_info_menu() { return \"general:Enable the programmers menu\"; }\n  _stat_menu( pars ) {\n\n    if( pars.length == 0 ) {\n      this.runtime.toggleMenu();\n      return;\n    }\n\n  }\n\n  _stat_info_reverse() { return \"print:Reverse the print output:<ReverseFlag>\"; }\n\n  _stat_reverse( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.control( 65 );\n      return;\n    }\n\n    var reverse = pars[0].value;\n    if( reverse <0 || reverse >1 ) {\n      return;\n    }\n\n    this.output.control( 64 + reverse );\n  }\n\n  _stat_info_beep() { return \"sound:Make a short sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_beep( pars ) {\n\n\n    if( pars.length == 0 ) {\n      this.audio.playBeep( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playBeep( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n\n  _stat_info_sound() { return \"sound:Make a pre defined sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_sound( pars ) {\n\n    if( pars.length == 0 ) {\n      this.audio.playSound( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playSound( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n  _stat_info_setadr() { return \"sound:Define Attach,Decay and Release:<Channel>, <AttackT>, <decayT>, <releaseT>\"; }\n  _stat_setadr( pars ) {\n\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, attackT, decayT, releaseT\" );\n      return\n    }\n\n    this.audio.attackDecayRelease(\n       pars[0].value,\n       pars[1].value,\n       pars[2].value,\n       pars[3].value\n      );\n\n  }\n\n  _stat_info_volume() { return \"sound:Change the audio volume:<Volume>\"; }\n  _stat_volume( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected volume\" );\n      return\n    }\n\n    this.audio.volume( pars[0].value );\n\n  }\n\n  _stat_info_chfreq() { return \"sound:Change the channel audio frequency:<Channel, Frequency>\"; }\n  _stat_chfreq( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, frequency\" );\n      return\n    }\n\n    this.audio.channelFrequency( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chvolume() { return \"sound:Change the channel audio volume:<Channel>, <Volume>\"; }\n  _stat_chvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chsvolume() { return \"sound:Change the channel sustain volume:<Channel>, <Volume>\"; }\n  _stat_chsvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelSustainVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_addfx() { return \"sound:Add a Sound FX part to the channel:<Channel>, <Type>, <Value>, <Time>\"; }\n  _stat_addfx( pars ) {\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, type, value and time(ms)\" );\n      return\n    }\n\n    this.audio.addEffect(\n        pars[0].value,\n        pars[1].value,\n        pars[2].value,\n        pars[3].value\n       );\n\n  }\n\n  _stat_info_clearfx() { return \"sound:Clear a sound effect:<Channel>\"; }\n  _stat_clearfx( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected channel\" );\n      return\n    }\n\n    this.audio.clearEffect( pars[0].value  );\n\n  }\n\n  _stat_info_playfx() { return \"sound:Change the channel sustain volume:<Channel> [,<Frequency> ]\"; }\n  _stat_playfx( pars ) {\n\n    if( pars.length < 1 || pars.length >2 ) {\n      this.erh.throwError( \"parameter count\", \"expected <Channel> [,<Frequency> ]\" );\n      return\n    }\n\n    var freq = 0;\n    if( pars.length >1 ) {\n      freq = pars[1].value;\n    }\n\n    this.audio.playEffect( pars[0].value, freq );\n\n  }\n\n\n  _stat_info_textarea() { return \"print:Limit text to certain area: <CollSize>,<RowSize>\\n [,<xOffset>,<yOffset>]\"; }\n  _stat_textarea( pars ) {\n\n    var result;\n\n    if( pars.length != 2 && pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected cols, rows [, xoffset, yoffset ]\" );\n      return\n    }\n\n    var cols = Math.round( pars[0].value );\n    var rows = Math.round( pars[1].value );\n\n    var wh = this.output.getDimensions();\n\n    var xo, yo;\n    xo = -1, yo = -1;\n    if( pars.length == 4) {\n      var xo = Math.round( pars[2].value );\n      var yo = Math.round( pars[3].value );\n    }\n\n    if( cols > 0 && rows > 0  && cols <= wh[0] && rows <= wh[1] ) {\n\n        var divx = wh[0] - cols;\n        var divy = wh[1] - rows;\n\n        if( xo > 0 && xo > divx ) {\n          this.erh.throwError( \"parameter\", \"xo to big\");\n        }\n        if( yo > 0 && yo > divy ) {\n          this.erh.throwError( \"parameter\", \"yo to big\");\n        }\n\n        this.output.textArea(  cols, rows, xo, yo );\n\n        return\n    }\n\n  }\n\n  _stat_info_gcolor() { return \"graphics:Set graphics pen color index:<Color Index>\"; }\n  _stat_gcolor( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected color\" );\n      return\n    }\n\n    if( pars.length == 1) {\n        var col = Math.round( pars[0].value );\n        if( col > 0 && col < 32) {\n            this.bitmap.setLineColor(  col );\n        }\n        return\n    }\n\n  }\n\n  _stat_info_fcolor() { return \"graphics:Set graphics fill color index:<Color Index>\"; }\n  _stat_fcolor( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected color\" );\n      return\n    }\n\n    if( pars.length == 1) {\n        var col = Math.round( pars[0].value );\n        if( col > 0 && col < 32) {\n            this.bitmap.setFillColor(  col );\n        }\n        return\n    }\n\n  }\n\n  _stat_info_origin() { return \"graphics:Specify origin of graphics console:<X0>,<Y0>,<Dx>,<Dy>\"; }\n  _stat_origin( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 4 (x0,y0,dx,dy), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    if( pars[2].value != 1 && pars[2].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dx must be 1 or -1\" );\n      return;\n    }\n\n    if( pars[3].value != 1 && pars[3].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dy must be 1 or -1\" );\n      return;\n    }\n\n    this.bitmap.origin(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_line() { return \"graphics:Draw a line:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_line( pars ) {\n    if( pars.length != 4 && pars.length != 2 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 or 4 ([x0,y0,] y1,y1), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    if( pars.length == 2 ) {\n\n      this.bitmap.line(\n        undefined, undefined,\n        pars[0].value,\n        pars[1].value\n      );\n      return;\n    }\n\n    this.bitmap.line(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_box() { return \"graphics:Draw a filled rectangle:<X>,<Y>,<W>,<H>\"; }\n  _stat_box( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 4 (x,y,w,h), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.fillRect(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_plot() { return \"graphics:Plot a pixel:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_plot( pars ) {\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 (x,y), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.plot( pars[0].value, pars[1].value );\n  }\n\n  \n_if_center() {\n    var EXPR = 0, PAR = 1, RAW=2;\n    return [RAW];\n}\n\nisNumber(value) {\n  return typeof value === 'number' && isFinite(value);\n}\n\nnormalizeIfNumber( x )  {\n  if( this.isNumber( x ) ) {\n    if ( x >= 0 ) {\n      return \" \" + x;\n    }\n  }\n  return \"\" + x;\n}\n\n\n  _stat_info_center() { return \"print:Print center text or values to the console:<Value>[;<Value>][;]\"; }\n  _stat_center( pars ) {\n\n    var runtime = this.runtime;\n    var con= this.output;\n\n    if( pars.length == 0 ) {\n      con.nl();\n      return;\n    }\n    else if( pars.length == 1 ) {\n      if( pars[0].parts.length == 0 ) {\n        con.nl();\n        return;\n      }\n    }\n\n    var newLine = true;\n    var value;\n    for( var i=0; i<pars.length; i++) {\n\n      newLine = true;\n      if( i<(pars.length-1)) {\n        newLine = false;\n      }\n\n      if( i>0) {\n        con.write( \"         \" );\n      }\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \";\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              //console.log( \"i=\"+i+\" newline: set to false\");\n          newLine = false;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n\n      value = runtime.evalExpression( exparts2 );\n\n      if( i == 0) {\n        //this.output.center( string, inhibitNL );\n        con.center( this.normalizeIfNumber( value ), true );\n      }\n      else {\n        con.center( \"\" + value , true);\n      }\n      if( newLine ) { con.nl(); runtime.setWaiting( 1 ); }\n\n    }\n\n  }\n\n\n  _stat_info_gtext() { return \"experimental:Write text at position x,y:<X>,<Y>,<Text>\"; }\n  _stat_gtext( pars ) {\n\n    var string;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected x,y and text parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.gtext( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n\n  _stat_info_immediate() { return \"poke:Set flag to flush the render pipeline after each poke:<RenderImmediateFlag>\"; }\n  _stat_immediate( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameters\", \"expected 1 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.setPokeFlush( pars[0].value != 0 );\n  }\n\n\n  _stat_info_pokeccl() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>,<FGColor>,<BGColor>\"; }\n  _stat_pokeccl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length < 3 ) {\n      this.erh.throwError( \"parameters\", \"expected at least 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    var fg = undefined;\n    var bg = undefined;\n\n    if( pars.length >= 4 ) { fg = pars[3].value; }\n    if( pars.length >= 5 ) { bg = pars[4].value; }\n    this.output.pokeccl( pars[0].value, pars[1].value, pars[2].value, fg, bg );\n  }\n\n  _stat_info_pokec() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>\"; }\n  _stat_pokec( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokec( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n  _stat_info_pokecl() { return \"poke:Put color directly into the screen buffer:<X>,<Y>,<FGColor>[,<BGColor>]\"; }\n  _stat_pokecl( pars ) {\n\n    var row = -1, col = -1;\n    var bg = undefined;\n\n    if( pars.length != 3 &&  pars.length != 4 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 or 4 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 4 ) {\n      bg = pars[3].value;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, pars[2].value, bg );\n  }\n\n  _stat_info_pokebcl() { return \"poke:Put background color directly into the screen buffer:<Y>,<X>,<BGColor>\"; }\n  _stat_pokebcl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, undefined, pars[2].value );\n  }\n\n\n  _int_checkPlayfieldNo( no ) {\n\n    if( no != 0 && \n        no != 1 &&\n        no != 2 &&\n        no != 3 &&\n        no != 4 &&\n        no != 5 \n         ) {\n      this.erh.throwError( \"parameters\", \"Value must be 0,1,2,3,4 or 5\" );\n      return;\n    }\n  }\n\n\n\n _stat_info_pfinit() { \n      return  \"playfield:(re)Initialize of playfield buffer: <pfIndex>, <Cols>, <Rows>\"; \n    }\n\n  _stat_pfinit( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.init( \n        this.runtime.processId,\n        pars[0].value, \n        0,0, \n        pars[1].value, pars[2].value,\n        pars[1].value, pars[2].value \n    );\n\n    this.runtime.startWaitForMessage( \"pfinit\" )\n  }\n\n  _stat_info_playfield() { return \"playfield:Select current playfield:<Nr> ; 0 to 3\"; }\n  _stat_playfield( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 1 ) {\n      this.erh.throwError( \"parameters\", \"expected 1 parameter, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.select( \n              this.runtime.processId,\n              pars[0].value );\n    this.runtime.startWaitForMessage( \"pfselect\" );\n  }\n\n  _stat_info_pfscroll() { \n      return  \"playfield:Set scroll pos of playfield view: <pfIndex>, <sX>, <sY>\"; \n    }\n\n  _stat_pfscroll( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.scrollpos( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value, pars[2].value\n    );\n\n  }\n\n  _stat_info_pfview() { \n      return  \"playfield:Initialize size of playfield view: <pfIndex>, <X>, <Y>, <W>, <H>\"; \n    }\n\n  _stat_pfview( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 5 ) {\n      this.erh.throwError( \"parameters\", \"expected 5 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.viewdefine( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value, pars[2].value,\n        pars[3].value, pars[4].value\n    );\n\n  }\n\n\n \n\n\n  _stat_info_pfenable() { \n      return  \"playfield:Enable  a playfield to be visible: <pfIndex>, <OnOfFlag>\"; \n    }\n\n  _stat_pfenable( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.setEnable( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value\n    );\n\n  }\n\n  _stat_info_locate() { return \"print:Set the cursor position:<Y>,<X>\"; }\n  _stat_locate( pars ) {\n\n    var row = undefined, col = undefined;\n\n    if( pars.length > 2 ) {\n      this.erh.throwError( \"too many parameters\", \"expected max 2, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    if( pars.length >= 1 ) {\n      row = pars[0].value;\n    }\n\n    if( pars.length >= 2 ) {\n      col = pars[1].value;\n    }\n\n    this.output.setCursorPos( col, row );\n  }\n\n  _stat_info_hide() { return \"general:Hide the terminal\"; }\n  _stat_hide( pars ) {\n    this.output.control( 25 );\n  }\n\n\n  _if_html() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_html() { return \"html:Unsupported command\"; }\n  _stat_html( pars ) {\n    var html = this.html;\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    var newLine = true;\n    var value;\n    var contentIx = 0;\n    var handleIx = -1;\n    var htmlHandle = null;\n    var htmlValue = \"\";\n    var htmlAppend = false;\n\n    if( pars.length == 2) {\n      contentIx = 1;\n      handleIx = 0;\n    }\n\n    for( var i=0; i<pars.length && i<2; i++) {\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \"+\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              htmlAppend = true;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n      value = this.runtime.evalExpression( exparts2 );\n\n      if( i == handleIx ) {\n        htmlHandle =  value;\n      }\n      else {\n        htmlValue = value;\n      }\n    }\n\n    this.html.html(\n        {\n          htmlHandle: htmlHandle,\n          htmlValue: htmlValue,\n          htmlAppend: htmlAppend\n        }\n      );\n  }\n\n  _stat_info_htmlnode() { return \"html:Unsupported command\"; }\n  _stat_htmlnode( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var node = pars[0];\n\n    this.html.htmlnode( node );\n\n  }\n\n\n  _stat_info_htmlbg() { return \"html:Unsupported command\"; }\n  _stat_htmlbg( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var url = pars[0].value;\n\n    this.html.executeFunction( \"body.style.backgroundImage\", url );\n\n  }\n\n  _stat_info_color() { return \"print:Sets the console color index:<PenColor>[, <PaperColor>\\n[, <BorderColor>]]\"; }\n  _stat_color( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length == 1) {\n        var col = pars[0].value;\n        this.output.control( 16, col );\n        return\n    }\n\n    var bgcol = pars[1].value;\n    var col = pars[0].value;\n    this.output.control( 16, col   );\n    this.output.control( 17, bgcol );\n\n    if( pars.length == 3) {\n        var border = pars[2].value;\n        this.output.control( 18, border );\n        return\n    }\n\n  }\n\n  _stat_info_display() { return \"general:Set the console display mode:<DisplayModeNumber>\"; }\n  _stat_display( pars ) {\n\n    var result;\n    var modes = this.sys.screenModes;\n\n    if( pars.length == 0) {\n\n        var list = [ ];\n\n\n        for( var i=0 ; i<modes.length ; i++) {\n          if( modes[ i] ) {\n            list.push( i + \":   \" + modes[i]);\n          }\n        }\n        //list.push( \"Current Mode: \" + this.sys.displayMode );\n\n        this.runtime.enterListMode( list );\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many variables\", \"expected one parameter only\" );\n    }\n\n    var mode = pars[0].value;\n    if( modes[mode] === undefined ) {\n      this.erh.throwError( \"Invalid mode\", \"No such display mode\" );\n    }\n    this.sys.setDisplayMode( this.runtime, mode );\n    this.sys.blinkMode( !this.runtime.isRunning() );\n    this.runtime.flagStatusChange();\n    this.runtime.startWaitForMessage( \"displaysize\" )\n\n\n  }\n\n\n  _stat_info_gfilter() { return \"experimental:Add a html filter to the display:<FilterString>\"; }\n  _stat_gfilter( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n        this.erh.throwError( \"too many variables\", \"expected one parameter only\" );\n    }\n\n    var filter = pars[0].value;\n   \n    this.output.setFilter( filter );\n\n  }\n\n  _stat_info_border() { return \"general:Changes the border color:<ColorIndex>\"; }\n  _stat_border( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many parameters\", \"expected one parameter only\" );\n    }\n\n    var bcol = pars[0].value;\n    this.output.control( 18, bcol );\n\n  }\n\n  _stat_info_export() { return \"program:Export program for download\"; }\n  _stat_export( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"export needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"disk\" );\n  }\n\n  _stat_info_copy() { return \"program:Copy program to clipboard\"; }\n  _stat_copy( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"copy needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"clipboard\" );\n    this.runtime.printLine(\"Copied \" + this.runtime.getProgramSize() + \" program lines to the clipboard\" );\n  }\n\n\n  _stat_info_txtcopy() { return \"experimental:Copy data to clipboard:<StringData$>\"; }\n  _stat_txtcopy( pars ) {\n    if( pars.length != 1) {\n        this.erh.throwError( \"parameter count\", \"dcopy needs 1 parameter\" );\n    }\n\n    this.sys.export( pars[0].value + \"\", \"clipboard\" );\n\n  }\n\n\n\n  _fun_info_peekcl() { return \"poke:Get color information directly from from screen buffer:<Y>,<X>[,<Mode]\"; }\n  _fun_peekcl( pars ) {\n\n    var row = -1, col = -1;\n    var mode = 0;\n\n    if( pars.length != 3  && pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 or 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 3 ) {\n      mode = pars[2].value;\n    }\n    return this.output.peekcl( pars[0].value, pars[1].value, mode );\n  }\n\n\n  _fun_info_peekc() { return \"poke:Get a character directly into from screen buffer:<Y>,<X>\"; }\n  _fun_peekc( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 parameters, not \" + pars.length );\n      return;\n    }\n\n    return this.output.peekc( pars[0].value, pars[1].value );\n  }\n\n\n  _fun_info_ucbase() { return \"string:Return unicode-set base character code:<SetName$>\"; }\n  _fun_ucbase( pars ) {\n\n    if( pars.length != 1 ) {\n      this.erh.throwError( \"parameters\", \"UCBASE() needs one parameter\" );\n    }\n\n    var baseLabel = pars[0].value;\n\n    if( baseLabel.toLowerCase() == \"box\" ) {\n      return parseInt( \"2500\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"blocks\" ) {\n      return parseInt( \"2580\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"symbol\" ) {\n      return parseInt( \"2b00\", 16 ); //can be too wide\n    }\n    else if( baseLabel.toLowerCase() == \"legacy\" ) {\n      return parseInt( \"1fb00\", 16 );\n    }\n    return 0;\n  }\n\n  _fun_info_uc_DLR_() { return \"string:Create unicode character:<UnicodeHexCode$>\"; }\n  _fun_uc_DLR_( pars ) {\n\n    if( pars[0].value ) {\n      if( typeof pars[0].value == \"string\" ) {\n          return String.fromCodePoint( parseInt( pars[0].value, 16 ) );\n      }\n      return String.fromCodePoint( pars[0].value);\n    }\n    return \"?\";\n  }\n\n  _fun_info_dc_DLR_() { return \"print:Return device control char. sequence:<Parameter1>, <Parameter2>\"; }\n  _fun_dc_DLR_( pars ) {\n\n    var val = \"\";\n\n    val = String.fromCodePoint( 17 ) + String.fromCodePoint( pars[0].value) + String.fromCodePoint( pars[1].value);\n\n    return val;\n  }\n\n  _fun_info_html_DLR_() { return \"html:Unsupported function\"; }\n  _fun_html_DLR_( pars ) {\n    return\n      this.html.get();\n  }\n\n\n  _fun_info_width() { return \"general:Return the console width in pixels\"; }\n  _fun_width( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_height() { return \"general:Return the console height in pixels\"; }\n  _fun_height( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[1];\n  }\n\n  _fun_info_cols()  { return \"print:Return the console width in columns\"; }\n  _fun_cols( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"cols() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_columns() { return \"print:Return the console width in columns\"; }\n  _fun_columns( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"columns() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_rows() { return \"print:Return the console height in rows\"; }\n  _fun_rows( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"rows() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[1];\n  }\n\n}\n\n//--EOC \n\n// ## pgmmanager.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/pgmmanager.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/pgmmanager.js\n\nclass BasicProgramManager {\n\n  constructor() {\n    this.rt = [];\n  }\n\n  addRuntime = function( ctx ) {\n\n    this.rt.push( ctx );\n\n  }\n\n}\n\nvar pgmman = new BasicProgramManager();\n\n//--EOC \n\n// ## basiccommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basiccommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basiccommands.js\n\nclass BasicCommands {\n\n  constructor( runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n\n    this.keyLabelCodes = {};\n\n    this.randnrs = [];\n    for(var i=0; i<10000;i++) {\n      this.randnrs.push( Math.random() );\n    }\n    this.randIndex = 0;\n    this.randStep = 1;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getCategories() {\n\n    return new CommandHelp().getCategoriesIntermediate( [{},{}], this );\n\n  }\n\n\n  /************************ commands ************************/\n\n  _stat_info_new() { return \"program:Delete the current program from memory:\"; }\n  _stat_new( pars ) {\n\n    this.runtime.new();\n  }\n\n  _stat_info_list() { return \"program:List the basic program\"; }\n  _stat_list( pars ) {\n\n    var start = 0;\n    var end   = 999999;\n    var parts = [];\n\n    var mode = \"noparam\";\n\n    if( pars.length==1 ) {\n      parts = pars[0].parts;\n    }\n\n    if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data >=0 ) {\n      start = parts[0].data;\n      end = parts[0].data;\n    }\n    else if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data <0 ) {\n      /*NOTE, this will stop working if RAW changes to return uniop + posnum */\n      end = -parts[0].data;\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"num\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n      end = parts[1].data;\n\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"uniop\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n    }\n\n    var runtime = this.runtime;\n    var list = [];\n    for (const l of runtime.program)\n      {\n\n        var lineNr = parseInt(l[0]);\n        if(  l[0] == null || (lineNr>= start && lineNr<= end) ) {\n          if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n              list.push( \"\" );\n          }\n          list.push( l[2] );\n        }\n      }\n\n      this.runtime.enterListMode( list );\n  }\n\n\n  _if_get() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_getkey() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_read() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_input() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW];\n  }\n\n  _if_list() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _if_run() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_read() { return \"io:Read a value from the data::<Data$ or Data>\"; }\n  _stat_read( pars ) {\n    var p0 = pars[ 0 ];\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var data = this.runtime.readData();\n    if( data === undefined ) { this.erh.throwError( \"out of data\" ); }\n\n    if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"string\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"string\" ) {\n\n          data = parseInt ( data );\n\n          if( isNaN( data ) ) {\n            this.erh.throwError( \"expected number\" );\n          }\n          this.runtime.setVar(\n            p0.value, data );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  \"\" + data  );\n    }\n\n  }\n\n  _stat_info_get() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_get( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\"); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, \"???\" );\n      }\n    }\n\n    this.runtime.flagInputCommand();\n  }\n\n  _stat_info_getkey() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_getkey( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\" ); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, k.keyLabel );\n      }\n    }\n\n    this.runtime.flagInputCommand();\n  }\n\n  _stat_info_input() { return \"io:Waits for the user to type in a value::<Value>\"; }\n  _stat_input( pars ) {\n\n    var vars = [];\n    var con = this.output;\n\n    for( var i=0; i<pars.length; i++) {\n      if( i == 0 ) {\n        var par = pars[0];\n\n        if( par.parts.length == 2 ) {\n          if( par.parts[0].type == \"str\" ) {\n            con.write( par.parts[0].data );\n            if( par.parts[1].type == \"var\" && par.parts[1].op == \";\" ) {\n              vars.push( par.parts[1].data );\n            }\n          }\n        }\n        else if( par.parts.length == 1 ) {\n          vars.push( par.parts[0].data );\n        }\n\n      }\n      else {\n        sys.log( \"PARS[\"+i+\"]\", pars[i] );\n        if( pars[i].parts[0].type != \"var\" ) {\n\n          this.erh.throwError( \"not a var\", \"parameter \" + i);\n        }\n        vars.push( pars[i].parts[0].data );\n      }\n    }\n\n    this.runtime.startConsoleDataInput( vars );\n\n  }\n\n  _stat_info_restore() { return \"io:Set the READ-pointer, to the beginning:\"; }\n  _stat_restore( pars ) {\n    this.runtime.restoreDataPtr();\n  }\n\n  _stat_info_waitms() { return \"program:Wait a certain time:<MilliSeconds>\"; }\n  _stat_waitms( pars ) {\n    this.runtime.setWaiting( pars[0].value );\n  }\n\n  _stat_info_load() { return \"program:Load a program in memory:<FileName>\"; }\n  _stat_load( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \\\"\" + pars[0].value + \"\\\"\" );\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", false, -1 );\n    }\n    else {\n      if( pars.length == 1) {\n        result = runtime.load( pars[0].value, false, -1 );\n      }\n      else if( pars.length == 2) {\n        result = runtime.load( pars[0].value, false, pars[1].value );\n      }\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_setdata() { return \"experimental:Set data pointer:[<Label>]\"; }\n  _stat_setdata( pars ) {\n\n    var runtime = this.runtime;\n    var label = null;\n\n    if( pars.length > 1  ) {\n      this.erh.throwError( \"parameters\", \"Setdata takes one optional parameter\" );\n    }\n\n    if( pars.length == 1 ) {\n      label = pars[0].value ;\n    }\n\n    var list = runtime.setData( label );\n\n  }\n\n  _stat_info_datablocks() { return \"experimental:Dump data blocks in memory\"; }\n  _stat_datablocks( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n\n    if( pars.length != 0 ) {\n      this.erh.throwError( \"parameters\", \"Listdata takes no parameterss\" );\n    }\n\n    var list = runtime.getDataBlocks();\n    runtime.enterListMode( list );\n\n  }\n\n  _stat_info_loaddata() { return \"experimental:Load data in memory:<Filename> [, <Type>, <Label>]\"; }\n  _stat_loaddata( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n    var label = null;\n    var type = \"I:CSV\";\n    runtime.printLine(\"\");\n\n    if( pars.length != 1 && pars.length != 2 && pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"loaddata takes one mandatory and two optional parameters\" );\n    }\n\n    if( pars.length >= 2 ) {\n      type = pars[1].value ;\n    }\n\n    if( type.indexOf(\":\") < 0) {\n      this.erh.throwError( \"invalid type specification\", \"Expected <Type>:<FileSyntax>. Example: \\\"I:CSV\\\"\" );\n    }\n\n    if( pars.length == 3 ) {\n      label = pars[2].value ;\n    }\n\n    result = runtime.loaddata( pars[0].value, type, label );\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_dir() { return \"program:List a files on the current file system:[<Path> [,<Device>]]\"; }\n  _stat_dir( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.dir( \"\" );\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.dir( pars[0].value, -1 );\n      return;\n    }\n    else if( pars.length == 2) {\n      runtime.dir( pars[0].value, pars[1].value );\n      return;\n    }\n\n    this.erh.throwError( \"parameter\", \"dir takes 0,1 or 2 parameter(s)\"  );\n\n    this.aSync = true;\n\n  }\n\n  _stat_info_fs() { return \"program:Set or List (the) filesystem(s):[<FileSystem$>]\"; }\n  _stat_fs( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      runtime.listfs();\n    }\n    else if( pars.length == 1) {\n      runtime.setfs( pars[0].value );\n    }\n\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_renumber() { return \"program:Renumber the current program\"; }\n  _stat_renumber( pars ) {\n\n    var runtime = this.runtime;\n    runtime.renumberProgram( 10,10 );\n\n  }\n\n  _stat_info_vars() { return \"program:List all variables to the screen\"; }\n  _stat_vars( pars ) {\n\n\n    var runtime = this.runtime;\n\n    var varList = runtime.getFullVarList();\n    this.runtime.enterListMode( varList );\n\n  }\n\n\n  _stat_info_tracevar() { return \"program:Trace variable changes:[<VariableName$>]\"; }\n  _stat_tracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.getTraceList();\n      this.runtime.enterListMode( traceList );\n\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.setTraceVar( pars[0].value );\n      return;\n    }\n\n  }\n\n  _stat_info_clrtracevar() { return \"program:Stop tracing variables\"; }\n  _stat_clrtracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.resetTraceVar();\n    }\n  }\n\n\n  _stat_info_boot() { return \"program:Load and run a program:<FileName>\"; }\n  _stat_boot( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \" + pars[0].value);\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", true, -1 );\n    }\n    else {\n      result = runtime.load( pars[0].value, true, -1 );\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_save() { return \"program:Save the current program:<FileName>\"; }\n  _stat_save( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n        runtime.save( null );\n    }\n    else if ( pars.length == 1 ){\n      runtime.save( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.save( pars[0].value, pars[1].value );\n    }\n  }\n\n  _stat_info_delete() { return \"program:Delete a file:<FileName>\"; }\n  _stat_delete( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length != 1 && pars.length != 2) {\n        this.erh.throwError( \"parameter\", \"delete without filename\" );\n    }\n    else if ( pars.length == 1 ){\n      runtime.deleteFile( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.deleteFile( pars[0].value, pars[1].value );\n    }\n  }\n\n\n\n\n  _stat_info_run() { return \"program:Run the current program\"; }\n  _stat_run( pars ) {\n    var runtime = this.runtime;\n\n    runtime.runPGM();\n  }\n\n\n  _if_print() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  isNumber(value) {\n    return typeof value === 'number' && isFinite(value);\n  }\n\n  normalizeIfNumber( x )  {\n    if( this.isNumber( x ) ) {\n      if ( x >= 0 ) {\n        return \" \" + x;\n      }\n    }\n    return \"\" + x;\n  }\n\n  _stat_info_print() { return \"print:Print text or values to the console:<Value>[;<Value>][;]\"; }\n  _stat_print( pars ) {\n\n    var runtime = this.runtime;\n    var con= this.output;\n\n    if( pars.length == 0 ) {\n      con.nl();\n      return;\n    }\n    else if( pars.length == 1 ) {\n      if( pars[0].parts.length == 0 ) {\n        con.nl();\n        return;\n      }\n    }\n\n    var newLine = true;\n    var value;\n    for( var i=0; i<pars.length; i++) {\n\n      newLine = true;\n      if( i<(pars.length-1)) {\n        newLine = false;\n      }\n\n      if( i>0) {\n        con.write( \"         \" );\n      }\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \";\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              //console.log( \"i=\"+i+\" newline: set to false\");\n          newLine = false;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n\n      value = runtime.evalExpression( exparts2 );\n\n      if( i == 0) {\n        con.write( this.normalizeIfNumber( value ) );\n      }\n      else {\n        con.write( \"\" + value );\n      }\n      if( newLine ) { con.nl(); runtime.setWaiting( 1 ); }\n\n    }\n\n  }\n\n  _stat_info_clr() { return \"program:Clear all variables\"; }\n  _stat_clr( pars ) {\n    return this.runtime.clrPGM();\n  }\n\n  /************************ functions ************************/\n\n  _fun_info_datalen() { return \"experimental:Return length of current datablock\"; }\n  _fun_datalen( pars ) {\n    var runtime = this.runtime;\n    return runtime.getDataLength();\n  }\n\n  _fun_info_chr_DLR_() { return \"string:Return ascii character:<Ascii Code>\"; }\n  _fun_chr_DLR_( pars ) {\n    return String.fromCharCode( pars[0].value );\n  }\n\n  _fun_info_str_DLR_() { return \"string:Converts number to string: <Number>[,<Base>[,<Trim>]]\"; }\n  _fun_str_DLR_( pars ) {\n\n    if( pars.length <1 || pars.length >3  ) {\n      this.erh.throwError( \"parameter\", \"str$() takes 1,2 or 3 parameters\"  );\n    }\n\n    var number = pars[0].value;\n    var base = 10;\n    var trim = false;\n\n    if( pars.length>=2  ) {\n      base = pars[1].value;\n    }\n\n    if( pars.length==3  ) {\n      trim = ( pars[1].value > 0);\n    }\n\n    var numberStr = number.toString(base);\n\n    if( number >=0 && !trim) {\n      return \" \" +  numberStr;\n    }\n\n    return numberStr;\n  }\n\n  _fun_info_abs() { return \"math:Absolute value\"; }\n  _fun_abs( pars ) {\n    if( pars[0].value < 0 ) {\n      return -pars[0].value;\n    }\n    return pars[0].value;\n  }\n\n  _fun_info_len() { return \"string:Length of a string\"; }\n  _fun_len( pars ) {\n    return pars[0].value.length;\n  }\n\n  _fun_info_asc() { return \"string:ASCII value of a character\"; }\n  _fun_asc( pars ) {\n    if( (typeof pars[0].value).toUpperCase() == \"STRING\" ) {\n\n      if ( pars[0].value.length > 0) {\n          return pars[0].value.charCodeAt(0);\n      }\n    }\n    return 0;\n  }\n\n  _fun_info_val() { return \"string:Retrieve number from string\"; }\n  _fun_val( pars ) {\n    var base = 10;\n\n    if( pars.length==2  ) {\n      base = pars[1].value;\n    }\n\n    if(base < 2 || base > 16) {\n      this.erh.throwError( \"base\", \"base should be inbetween 2 and 16\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n  _fun_info_hex2dec() { return \"string:Retrieve number from hexadecimal string\"; }\n  _fun_hex2dec( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX2DEC() needs one parameter\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n\n  _fun_info_hex_DLR_() { return \"string:Format a number as a hexadecimal string\"; }\n  _fun_hex_DLR_( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX$() needs one parameter\" );\n    }\n\n    var hexString = (pars[0].value * 1).toString(16);\n\n    return hexString;\n }\n\n\n\n\n  _fun_info_exp() { return \"math:Exponent\"; }\n  _fun_exp( pars ) {\n    return Math.exp( pars[0].value );\n  }\n\n  intGetNextRand() {\n    this.randIndex = (this.randIndex + this.randStep) % this.randnrs.length;\n    return this.randnrs[ this.randIndex ];\n  }\n\n  intSeedRand( x0 ) {\n\n    if( x0 < 0) {\n      var x = -x0;\n      var base = Math.floor( x * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n    else {\n\n      const minute = 1000 * 60;\n      const hour = minute * 60;\n      const day = hour * 24;\n      const year = day * 365;\n\n      const d = new Date();\n      let seedModifier = Math.round(d.getTime() / year);\n\n      x = -x;\n      var base = Math.floor( seedModifier * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n\n  }\n\n\n  _fun_info_pad_DLR_() { return \"string:Add string padding:<String>, <padChar>,<Length>[,<PadLeft>]\"; }\n  _fun_pad_DLR_( pars ) {\n\n    if( pars.length < 3 || pars.length >4 ) {\n      this.erh.throwError( \"syntax\", \"pad$() takes 3 or 4 parameters\" );\n    }\n\n    var str = pars[0].value;\n    var ch = pars[1].value;\n    var len = pars[2].value;\n    var left = true;\n\n    if( pars.length == 4 ) {\n      left= pars[3].value;\n\n      if( left !== 0 ) {\n        left = true;\n      }\n      else { left = false; }\n    }\n\n    var dest = \"\";\n\n    var strLen = str.length;\n    var toPad = len-strLen;\n    for( var i = 0; i<toPad ; i++) {\n      dest += ch;\n    }\n\n    if( left ) {\n      dest = dest + str;\n    }\n    else {\n      dest = str + dest;\n    }\n\n    return dest;\n  }\n\n\n  _fun_info_rnd() { return \"math:Random number between 0 and 1:<SeedOrMode> (0=JS, 1=Seed, NoValue=Default)\"; }\n  _fun_rnd( pars ) {\n\n    if( pars.length >1) {\n      this.erh.throwError( \"syntax\", \"rnd takes one parameter\" );\n    }\n\n    if( pars.length == 1) {\n\n      if( pars[0].value == 0 ) {\n        return Math.random();\n      }\n      this.intSeedRand( pars[0].value );\n    }\n\n    return this.intGetNextRand();\n  }\n\n  _fun_info_sqr() { return \"math:Square Root\"; }\n  _fun_sqr( pars ) {\n    return Math.sqrt( pars[0].value);\n  }\n\n  _fun_info_log() { return \"math:Logaritm\"; }\n  _fun_log( pars ) {\n    return Math.log( pars[0].value);\n  }\n\n  _fun_info_pos() { return \"print:Position\"; }\n  _fun_pos( pars ) {\n    return this.runtime.getLinePos();\n  }\n\n  _fun_info_left_DLR_() { return \"string:Left part of the string\"; }\n  _fun_left_DLR_( pars ) {\n      //? LEFT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr(0,pars[1].value);\n  }\n\n  _fun_info_right_DLR_() { return \"string:Right part of the string\"; }\n  _fun_right_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr( s.length - pars[1].value );\n  }\n\n  _fun_info_mid_DLR_() { return \"string:A substring\"; }\n  _fun_mid_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      if( pars.length == 3) {\n        return s.substr( pars[1].value-1, pars[2].value );\n      }\n      else if( pars.length == 2) {\n        return s.substr( pars[1].value-1 );\n      }\n  }\n\n  _fun_info_sin() { return \"math:Sinus\"; }\n  _fun_sin( pars ) {\n    return Math.sin( pars[0].value);\n  }\n\n  _fun_info_tri() { return \"math+:Triangle\"; }\n  _fun_tri( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    if( v<=0.5 ) {\n        return v*2;\n    }\n    else if( v<=1 ) {\n        return 1-((v-0.5) * 2);\n    }\n  }\n\n  _fun_info_saw() { return \"math+:Saw Tooth\"; }\n  _fun_saw( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    return v;\n\n  }\n\n  _fun_info_tan() { return \"math:Tangent\"; }\n  _fun_tan( pars ) {\n    return Math.tan( pars[0].value);\n  }\n\n  _fun_info_atn() { return \"math:ATan function\"; }\n  _fun_atn( pars ) {\n    return Math.atan( pars[0].value);\n  }\n\n  _fun_info_cos() { return \"math:Cosinus\"; }\n  _fun_cos( pars ) {\n    return Math.cos( pars[0].value);\n  }\n\n  _fun_info_spc() { return \"string:Spaces for padding:<SizeOfPadding>\"; }\n  _fun_spc( pars ) {\n    var out=\"\";\n    for( var i=0; i<pars[0].value; i++) {\n      out+=\" \";\n    }\n    return out;\n  }\n\n  _max(x,m) {\n    if( x<m ) {  return x; }\n    return m;\n  }\n\n\n\n  _fun_info_int() { return \"math:Convert to Integer\"; }\n  _fun_int( pars ) {\n    return Math.floor( pars[0].value );\n  }\n\n  _fun_info_range() { return \"math+:Keep in range:<V>,<MIN>,<MAX>\"; }\n  _fun_range( pars ) {\n\n    if( pars.length <3) {\n      this.erh.throwError( \"parameter\", \"expected 3 parameters\" );\n    }\n    var v = pars[0].value ;\n    var min = pars[1].value ;\n    var max = pars[2].value ;\n\n    if( v<min ) { return min; }\n    if( v>max ) { return max; }\n    return v;\n  }\n\n\n  _fun_info_tab() { return \"print:Tab cursor Xpos to the right:<NumberOfTabs>\"; }\n  _fun_tab( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length <1) {\n      this.erh.throwError( \"syntax\", \"missing parameter 0\" );\n    }\n    var p = pars[0].value;\n    if( p<0 || p > 255 ) {\n      this.erh.throwError( \"illegal quantity\", \"value must be in-between 0 and 255\" );\n    }\n\n    for( var i=0; i<pars[0].value ; i++) {\n        this.output.write( \" \" );\n    }\n\n    return \"\";\n  }\n\n  _fun_info_sgn() { return \"math:Sign of number\"; }\n  _fun_sgn( pars ) {\n    var x = pars[0].value;\n\n    if( x<0 ) { return -1; }\n    else if( x>0 ) { return 1; }\n    return 0;\n  }\n\n  _fun_info_millis() { return \"time:Current time in milliseconds\"; }\n  _fun_millis( pars ) {\n    return this.runtime.getMillis( );\n  }\n\n  _fun_info_jiffies() { return \"time:Current time in 'jiffies'\"; }\n  _fun_jiffies( pars ) {\n    return this.runtime.getJiffyTime( );\n  }\n}\n\n//--EOC \n\n// ## basicparser.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicparser.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicparser.js\n\nclass Parser {\n\n  constructor( cmds, ecmds ) {\n    this.commands = cmds;\n    this.extendedcommands = ecmds;\n    this.erh = new ErrorHandler();\n    this.debugFlag = false;\n  }\n\n  init() {\n\n\t  this.CTRL_KW = [\"IF\",\"THEN\",\"GOTO\",\"AND\", \"NOT\", \"OR\",  \"GOSUB\", \"RETURN\", \"FOR\", \"TO\", \"NEXT\", \"STEP\", \"DATA\", \"REM\", \"GOSUB\", \"DIM\", \"END\", \"LET\", \"STOP\", \"DEF\", \"FN\", \"ON\", \"SUB\", \"INTERRUPT0\", \"INTERRUPT1\" ];\n    this.SHORTCUT_KW = [\"?\"];\n\n    this.KEYWORDS = this.commands.getStatements();\n\n    var more = this.extendedcommands.getStatements();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.commands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.extendedcommands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n     for( var i=0; i<this.CTRL_KW.length; i++) {\n       this.KEYWORDS.push( this.CTRL_KW[ i ] );\n     }\n\n     for( var i=0; i<this.SHORTCUT_KW.length; i++) {\n       this.KEYWORDS.push( this.SHORTCUT_KW[ i ] );\n     }\n     //this.padArray( this.KWCODES, 256 );\n\n     if( this.debugFlag ) { console.log(\"KEYWORDS:\" , this.KEYWORDS ); }\n\n     this.screenCodes2CTRLTable = [];\n     var tab = this.screenCodes2CTRLTable;\n\n     tab['\\x93'] = '\\x13';\n     tab['\\xd3'] = '\\x93';\n  }\n\n  getKeyWordCodes() {\n\n    this.throwError( null, \"(Extended) Keywords not yet supported\", \"extended disabled\" );\n    return this.KWCODES;\n  }\n\n  padArray( arr, nr ) {\n    var missing = nr - arr.length;\n    while( missing > 0) {\n      arr.push( null );\n      missing--;\n    }\n  }\n\n  throwError( ctx, detail, clazz ) {\n\n    var clazz2 = clazz;\n    if( clazz2 === undefined ) {\n      clazz2 = \"syntax\";\n    }\n\n    if( ctx ) {\n      console.log(\" Exception \" + clazz + \" at line \" + ctx.lineNumber+ \" \" + detail );\n    }\n\n    if( ctx ) {\n      if( ! ( ctx.lineNumber == undefined ) ) {\n        this.erh.throwError( clazz2, detail, ctx, ctx.lineNumber );\n      }\n    }\n\n    this.erh.throwError( clazz2, detail, undefined, -1 );\n\n  }\n\n  upperCaseNameTokens( tokens ) {\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type == \"name\" ) {\n\t\t\t\t\ttoken.data = token.data.toUpperCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens;\n\t}\n\n\tremovePadding( tokens ) {\n\t\tvar tokens2 = [];\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type != \"pad\" ) {\n\t\t\t\t\ttokens2.push( token );\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens2;\n\t}\n\n  mergeCompTokens( tokens ) {\n\t\tvar tokens2 = [];\n\n    /* Convert token sequences like (\"<\",\"=\")\n       into single token \"<=\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( i>0 ) {\n        var token2 = tokens[i-1];\n\t\t\t\tif( ( token.type == \"comp\" || token.type == \"eq\" ) &&\n            ( token2.type == \"comp\" || token2.type == \"eq\" ) ) {\n\t\t\t\t\ttoken2.type = \"@@removeme\";\n          token.data = token2.data + token.data;\n          token.type = \"comp\";\n          if( token.data == \"><\" ) {\n            token.data = \"<>\";\n          }\n          else if( token.data == \"=<\" ) {\n            token.data = \"<=\";\n          }\n          else if( token.data == \"=>\" ) {\n            token.data = \">=\";\n          }\n\n  \t\t\t}\n\t\t\t}\n\n      if( ( token.type == \"name\"  && token.data == \"OR\" ) ||\n        ( token.type == \"name\"  && token.data == \"AND\" ) ||\n        ( token.type == \"name\"  && token.data == \"NOT\" )) {\n          token.type = \"bop\";\n        }\n\n\t\t}\n\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens[i].type!=\"@@removeme\") {\n        tokens2.push( tokens[i] );\n      }\n    }\n\n\t\treturn tokens2;\n\t}\n\n\n\n  mergeBrokenUpTokens( tokens ) {\n\n    var splits = [];\n\n    //console.log(\"tokens\",tokens)\n    //standard\n    splits.push( { p1: \"REST\", p2: \"OR\", p3: \"E\", whole: \"RESTORE\" } );\n    splits.push( { p1: \"S\", p2: \"TO\", p3: \"P\", whole: \"STOP\" } );\n\n\n    //extended\n//    splits.push( { p1: \"Dsk\", p2: \"OR\", p3: \"T\", whole: \"DXPORT\" } );\n//    splits.push( { p1: \"LXP\", p2: \"OR\", p3: \"T\", whole: \"LXPORT\" } );\n    splits.push( { p1: \"IMP\", p2: \"OR\", p3: \"T\", whole: \"IMPORT\" } );\n    splits.push( { p1: \"EXP\", p2: \"OR\", p3: \"T\", whole: \"EXPORT\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"URL\", whole: \"LGETURL\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"NAME\", whole: \"LGETNAME\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"ID\", whole: \"LGETID\" } );\n    splits.push( { p1: \"GO\", p2: \"TO\", p3: null, whole: \"GOTO\" } );\n    splits.push( { p1: \"GO\", p2: \"SUB\", p3: null, whole: \"GOSUB\" } );\n\n    splits.push( { p1: \"GO\", p2: \"LINK\", p3: null, whole: \"GOLINK\" } );\n    splits.push( { p1: \"WINDOW\", p2: \"S\", p3: null, whole: \"WINDOWS\" } );\n    splits.push( { p1: \"UN\", p2: \"TAG\", p3: null, whole: \"UNTAG\" } );\n    splits.push( { p1: \"LINK\", p2: \"S\", p3: null, whole: \"LINKS\" } );\n    splits.push( { p1: \"DE\", p2: \"LET\", p3: \"E\", whole: \"DELETE\" } );\n    splits.push( { p1: \"LDE\", p2: \"LET\", p3: \"E\", whole: \"LDELETE\" } );\n    splits.push( { p1: \"TDE\", p2: \"LET\", p3: \"E\", whole: \"TDELETE\" } );\n    splits.push( { p1: \"B\", p2: \"OR\", p3: \"DER\", whole: \"BORDER\" } );\n    splits.push( { p1: \"G\", p2: \"COLOR\", p3: \"S\", whole: \"GCOLORS\" } );\n    splits.push( { p1: \"CHAR\", p2: \"COL\", p3: null, whole: \"CHARCOL\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"CP\", p3: null, whole: \"SFRAMECP\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPX\", p3: null, whole: \"SFRAMEFLIPX\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPY\", p3: null, whole: \"SFRAMEFLIPY\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FX\", p3: null, whole: \"SFRAMEFX\" } );\n    splits.push( { p1: \"TAG\", p2: \"S\", p3: null, whole: \"TAGS\" } );\n    splits.push( { p1: \"X\", p2: \"ON\", p3: null, whole: \"XON\" } );\n    splits.push( { p1: \"S\", p2: \"POS\", p3: null, whole: \"SPOS\" } );\n    splits.push( { p1: \"S\", p2: \"POKE\", p3: null, whole: \"SPOKE\" } );\n    splits.push( { p1: \"WJ\", p2: \"IF\", p3: \"FY\", whole: \"WJIFFY\" } );\n    splits.push( { p1: \"REF\", p2: \"OR\", p3: \"MAT\", whole: \"REFORMAT\" } );\n\n\n    var tokens2 = []; //tokens;\n\n    for( var i=0; i<tokens.length; i++) {\n      tokens2.push( tokens[ i ]);\n    }\n\n    for( var i=0; i<splits.length; i++) {\n      var r=splits[i];\n      tokens2 = this.mergeTokenRange( tokens2, r );\n    }\n\n    if( this.debugFlag ) {  console.log( tokens2 ); }\n    return tokens2;\n  }\n\n\n  mergeTokenRange( tokens, record ) {\n\t\tvar tokens2 = [];\n    var tokens3 = [];\n\n    /* Convert \"S\",\"TO\",\"P\" into \"STOP\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      tokens2[i] = tokens[i];\n\t\t}\n\n    for( \tvar i=1;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( record.p3 == null ) {\n        if(\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n             if(\n                tokens2[i-1].data == record.p1 &&\n                tokens2[i-0].data == record.p2 ) {\n                  tokens2[i-1].data = record.whole;\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n      else {\n        if(i<2) {\n          continue;\n        }\n        if(\n          ( tokens2[i-2].type == \"name\" || tokens2[i-2].type == \"bop\" ) &&\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n\n             if( tokens2[i-2].data == record.p1 &&\n                tokens2[i-1].data == record.p2 &&\n                tokens2[i-0].data == record.p3 ) {\n                  tokens2[i-2].data = record.whole;\n                  tokens2[i-1].type = \"removeme\";\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n\t\t}\n\n    var j=0;\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens2[i].type != \"removeme\" ) {\n          tokens3[j] = tokens2[i];\n          j++;\n      }\n\t\t}\n\n\t\treturn tokens3;\n\t}\n\n\tparseFunParList( context ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar params = [];\n\t\tvar even = true;\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"sep\", data: \"@@@all\" });\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tendTokens.push();\n\n\t\twhile( true ) {\n\n\t\t\tvar token;\n\n      if( tokens.length > 0) {\n        if( tokens[0].type==\"bracket\" && tokens[0].data==\")\") {\n          break;\n        }\n      }\n\n\t\t\tif( even ) {\n        var expr = this.parseBoolExpression( context, endTokens );\n        expr.type = \"expr\";\n\t\t\t\tparams.push( expr );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoken = tokens.shift();\n\n\t\t\t\tif( token.type==\"sep\" ) {\n\t\t\t\t\t//all ok, next par\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected ',' or ')', got '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tpeekIfNextIsOpenBracket( context ) {\n\n\t\tvar tokens = context.tokens;\n\n\t\tif( tokens.length > 0 ) {\n\t\t\tif( tokens[0].type == \"bracket\" && tokens[0].data == \"(\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tparseSubExpression( context ) {\n\n\t\tvar token = context.tokens.shift();\n\n\t\tif( !(token.type == \"bracket\" && token.data == \"(\")) {\n\t\t\tthis.throwError( context, \"parsing subexpression, expected \\\"bracket\\\", not '\" + token.data + \"'\");\n\t\t}\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tvar expr = this.parseBoolExpression( context, endTokens );\n\t\tcontext.tokens.shift();\n\n\t\texpr.type = \"expr\";\n\t\treturn expr;\n\t}\n\n\n  tokensToString( token )  {\n    var str = \"\";\n\n    if(token.data == \"@@@all\") {\n        str = str + \"'\" + token.type + \"'\";\n    }\n    else {\n      //str = str + \"'\" + token.type + \"/\" + token.data + \"'\";\n      str = str + \"'\" + token.data + \"'\";\n    }\n\n    return str;\n  }\n\n  endTokensToString( endTokenArray )  {\n    var str = \"\";\n\n    for( var et=0; et<endTokenArray.length; et++) {\n      var endToken = endTokenArray[et];\n\n      if( str != \"\") { str+= \" \";}\n      str += this.tokensToString( endToken );\n    }\n    return str;\n  }\n\n  isEndToken( token, endTokenArry ) {\n\n    for( var et=0; et<endTokenArry.length; et++) {\n      var endToken = endTokenArry[et];\n\n      if( token.type == endToken.type && token.data == endToken.data ) {\n        return true;\n      }\n      else if( token.type == endToken.type && endToken.data == \"@@@all\" ) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n\n  parseSimpleExpression( context, endTokens ) {\n\n    var endLoop;\n\t\tvar tokens = context.tokens;\n\n    if( tokens.length == 0) {\n      return undefined;\n    }\n\n\t\tvar token, returnValue=undefined;\n\t\ttoken = tokens.shift();\n\n\t\tif( !token ) {\n\t\t\tthis.throwError( context, \"empty simple expression\");\n\t\t}\n\n    endLoop = this.isEndToken( token, endTokens );\n    if( endLoop ) {\n      this.throwError( context, \"empty simple expression\");\n    }\n\n\n    if( token.type == \"op\" && token.data == \"-\" ) {\n\t\t\t\tvar pair = this.parseSimpleExpression( context, endTokens );\n        pair[0].data = -pair[0].data;\n        return pair;\n\t\t}\n\n\t\tif( token.type == \"num\" ) {\n        returnValue= { type: \"num\", data: token.data };\n\t\t}\n\t\telse if( token.type == \"str\" ) {\n\t\t\t\treturnValue= { type: \"str\", data: token.data };\n\t\t}\n\n\n    token = tokens.shift();\n    if( token ) {\n      endLoop = this.isEndToken( token, endTokens );\n      if( ! endLoop ) {\n        endLoop = context.tokens.length == 0;\n      }\n      if( !endLoop ) {\n        this.throwError( context, \"Empty simple expression end expected\");\n      }\n    }\n\n\t\treturn [returnValue, token];\n\t}\n\n\n  parseBoolExpression( context, endTokens0 ) {\n\n    var endTokens = [];\n    var tokens = context.tokens;\n\n    for( var i=0; i < endTokens0.length; i++ ) {\n      endTokens.push( endTokens0[ i ] );\n    }\n\n    endTokens.push( { type: \"bop\", data: \"OR\" });\n    endTokens.push( { type: \"bop\", data: \"AND\" });\n\n    var first = true;\n    var eList = [];\n    var op = null;\n    while( true ) {\n\n      var expr = this.parseExpression( context, endTokens );\n      if( first && tokens.length == 0) {\n        return expr;\n      }\n      first = false;\n\n      var opData = null;\n      if( op != null ) {\n          opData = op.data;\n      }\n\n      //if( expr.parts.length == 1) {\n      //    expr.parts[0].op = opData;\n      //    expr.parts[0].dbg = \"1\";\n      //    eList.push(  expr.parts[0] );\n      //}\n      //else {\n          expr.op = opData;\n          expr.type = \"expr\";\n          expr.dbg = \"1\";\n          eList.push(  expr );\n      //}\n\n      if( tokens.length > 0) {\n        if( tokens[0].type == \"bop\" ) {\n          var op = tokens.shift();\n          continue;\n        }\n      }\n      break;\n    }\n\n    if( eList.length == 1 ) {\n        eList[0].dbg2 = \"len=1\";\n        return eList[0];\n    }\n\n\n    var retExpr = {\n      negate: false,\n      binaryNegate: false,\n      type: \"expr\",\n      parts: [],\n      op: null\n    };\n\n    for( i=0; i<eList.length; i++) {\n      retExpr.parts.push( eList[ i ] );\n    }\n\n    return retExpr;\n\n  }\n\n\tparseExpression( context, endTokens ) {\n\n\t\tvar tokens = context.tokens;\n    if( tokens.length == 0) {\n      return null;\n    }\n\n\t\tvar expression = {\n\t\t\t\t\tparts: [],\n          negate: false,\n          binaryNegate: false\n\t\t};\n\n\t\tvar index = 0;\n\t\tvar even = true;\n\t\tvar op = null;\n\t\tvar parts = expression.parts;\n    var first = true;\n    var negate = false;\n\n    var binaryNegate = false;\n\n\n\t\twhile( true ) {\n\t\t\tvar token, part;\n\t\t\ttoken = tokens.shift();\n\n\t\t\tif( !token ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n      var endLoop = this.isEndToken( token, endTokens );\n      if( endLoop ) {\n\n        tokens.unshift( token );\n        break;\n      }\n\n\t\t\tif( even ) {\n\n\t\t\t\tif( token.type == \"num\" ) {\n\t\t\t\t\tpart = { type: \"num\", data: token.data, op: op };\n          if( negate ) {\n            part.data = -part.data;\n          }\n\t\t\t\t\tparts.push( part );\n          first = false;\n          negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type == \"str\" ) {\n\t\t\t\t\tpart = { type: \"str\", data: token.data, op: op };\n\t\t\t\t\tparts.push( part );\n          if( negate ) {\n            this.throwError( context, \"found negation on a string\", \"type mismatch\");\n          }\n          first = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"bracket\" && token.data==\"(\") {\n\t\t\t\t\t\ttokens.unshift( token );\n\n            var subEndTokens = [];\n            subEndTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\t\t\t\t\tvar expr = this.parseSubExpression( context, subEndTokens );\n            expr.op = op;\n            expr.negate = negate;\n            expr.binaryNegate = binaryNegate;\n\t\t\t\t\t\tparts.push ( expr );\n            first = false;\n            negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"name\" ) {\n\n\t\t\t\t\t\tvar name = token.data;\n\t\t\t\t\t\tvar isFunctionCallOrArray = this.peekIfNextIsOpenBracket( context );\n            var isUserDefinedFunctionCall = (name == \"FN\");\n\n\t\t\t\t\t\tif( isFunctionCallOrArray ) { /*We have a function or an Array */\n\n\t\t\t\t\t\t\ttoken = tokens.shift();\n\t\t\t\t\t\t\tvar parameters = this.parseFunParList( context );\n              tokens.shift();\n\n              part = { type: \"funCall\", params: parameters, op: op, functionName: name };\n\n              if( this.KEYWORDS.indexOf( name ) == -1 ) {\n                //isArray  example: x=a(5)\n                part = { type: \"array\", data: name, op: op, indices: parameters };\n\n              }\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            else if( isUserDefinedFunctionCall ) {\n\n              token = tokens.shift();\n              name = token.data;\n\n              token = tokens.shift();\n              var parameters = this.parseFunParList( context ); //TODO limit to 1 par\n              tokens.shift();\n\n              part = { type: \"defFnCall\", params: parameters, op: op, functionName: name };\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n            }\n\t\t\t\t\t\telse { /* we have an variable*/\n\n\t\t\t\t\t\t\tpart = { type: \"var\", data: token.data, op: op };\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n              else {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            negate = false;\n            first = false;\n\t\t\t\t}\n        else if( token.type==\"op\" && token.data==\"-\" ) {\n          negate = ! negate;\n          continue;\n        }\n        else if( token.type==\"bop\" && token.data==\"NOT\" && first ) {\n          binaryNegate = ! binaryNegate;\n          expression.binaryNegate = binaryNegate;\n          if( this.debugFlag ) {\n            console.log(\"NOT\")\n          }\n          continue;\n        }\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"number\\\", \\\"string\\\", \\\"symbol\\\" or \\\"bracket\\\", not \" + token.data);\n\t\t\t\t}\n        op = null;\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\tif( token.type == \"op\" || token.type == \"comp\" || token.type == \"eq\" || token.type == \"bop\" ) {\n\t\t\t\t\top = token.data;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"operator\\\" or one of (\"+\n          this.endTokensToString(endTokens)+\n          \"), not '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\n\t\t}\n\n    if( op != null ) {\n      part = { type: \"uniop\", data: null, op: op };\n      parts.push ( part );\n    }\n\n\t\tif( expression.parts == null ) {\n\t\t\treturn null;\n\t\t}\n\n    var newParts;\n    newParts = this.groupParts( expression.parts, \"^\" );\n    newParts = this.groupParts( newParts, \"/\" );\n    newParts = this.groupParts( newParts, \"*\" );\n    newParts = this.groupParts( newParts, \"+\" );\n    newParts = this.groupParts( newParts, \"-\" );\n\n    var oldExpression = expression;\n    expression = {\n          parts: newParts,\n          negate: oldExpression.negate,\n          binaryNegate: oldExpression.binaryNegate\n    };\n\n\t\treturn expression;\n\t}\n\n\n  groupParts( parts0 , op ) {\n\n    var parts1=[], parts2=[];\n\n    for( var i=0; i<parts0.length; i++ ) {\n      parts1.push( parts0[ i ] );\n    }\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( i>0 && part.op == op ) {\n        var prevPart = parts1[ i-1 ];\n\n        var subExpr = {\n          negate: false,\n          binaryNegate: false,\n          type: \"expr\",\n          parts: [],\n          op: prevPart.op\n        };\n\n        subExpr.parts[ 0 ] = prevPart;\n        subExpr.parts[ 0 ].op = null;\n        subExpr.parts[ 1 ] = part;\n\n        parts1[i-1] = null;\n        parts1[ i ] = subExpr;\n\n      }\n    }\n\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( part != null ) {\n        parts2.push( part );\n      }\n    }\n\n    return parts2;\n  }\n\n  normalizeStatementName( x ) {\n    if(x == \"?\") {\n      return \"print\";\n    }\n    return x;\n  }\n\n  parseAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = false;\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n  }\n\n  parseArrayAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = true;\n\n    //token = tokens.shift();\n    var indices = this.parseFunParList( context );\n    command.indices = indices;\n\n    tokens.shift();\n    if( this.debugFlag ) {\n      console.log(\"tokens after:\",tokens)\n    }\n\n    token = tokens.shift();\n    if( token === undefined ) {\n      token = { type: \"@@@notoken\" };\n    }\n\n    if( token.type != \"eq\") {\n      this.throwError( context, \"Expected =\");\n    }\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n\n  }\n\n  parseControlStructure(  context, preTokens, commands, command, handlers, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    if( true ) {\n\n      command.type = \"control\";\n      var controlToken = nameToken;\n      command.controlKW = nameToken.toLowerCase();\n      if( token.type != \"@@@notoken\") {\n        tokens.unshift( token );\n      }\n\n      if( controlToken == \"LET\") {\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"LET expects var name\");\n        }\n        nameToken = token.data;\n\n        token = tokens.shift();\n        if( token === undefined ) {\n          token = { type: \"@@@notoken\" };\n        }\n\n/*        if( token.type != \"bracket\") { #TODO array assignments, ex: LET a(8) = 2\n          this.throwError( context, \"LET expects =\");\n        }\n*/\n\n        if( token.type == \"eq\") {\n\n          this.parseAssignment( context, preTokens, commands, command, nameToken, token );\n        }\n        else if( token.type == \"bracket\" && token.data==\"(\" ) {\n\n          this.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n        }\n        else {\n          this.throwError( context, \"Unexpected data after 'LET': '\" + token.data + \"'\" );\n        }\n\n      }\n      else if( controlToken == \"DIM\") {\n\n        var first = true;\n        command.params = [];\n        command.arrayNames = [];\n\n        while( true ) {\n\n          token = tokens.shift();\n          if(!first ) {\n            if( token === undefined ) {\n              break;\n            }\n            if( ! ( token.type == \"sep\" && token.data == \",\" )) {\n              tokens.unshift( token );\n              break;\n            }\n            token = tokens.shift();\n          }\n\n          if( token.type != \"name\" ) {\n            this.throwError( context, \"DIM expects var name\");\n          }\n\n          nameToken = token.data;\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\"(\") ) {\n            this.throwError( context, \"DIM expects (\");\n          }\n\n          var indices = this.parseFunParList( context );\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\")\") ) {\n            this.throwError( context, \"DIM expects )\");\n          }\n\n          command.params.push( indices );\n          command.arrayNames.push( nameToken );\n\n          first = false;\n        }\n\n        commands.push( command );\n      }\n      else if( controlToken == \"DEF\") {\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"FN\" ) ) {\n          this.throwError( context, \"DEF expects FN\");\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"DEF FN expects function name\");\n        }\n        var fName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \"(\" )) {\n          this.throwError( context, \"DEF FN expects function name and ->( varname )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"name\"  )) {\n          this.throwError( context, \"DEF FN expects function name and ( ->varname )\");\n        }\n        var varName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \")\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname -> )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname ) -> =\");\n        }\n\n\n        endTokens = [];\n        var expr_fn = this.parseBoolExpression( context, endTokens );\n\n        if( this.debugFlag ) {\n          console.log(\"expr = \" + expr_fn );\n        }\n\n        command.params=[];\n        command.params[0] = fName;\n        command.params[1] = varName;\n        command.params[2] = expr_fn;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"GOTO\" || controlToken == \"GOSUB\") {\n        var num = -1;\n\n        token = tokens.shift();\n\n        if( token === undefined ) {\n          this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n        }\n\n        if( token.type != \"num\") {\n          //this.throwError( context, \"GOTO/GOSUB expects number\", \"undef'd statement\");\n\n          if( token.type != \"name\") {\n              this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n          }\n\n          var label = token.data;\n\n          token = tokens.shift();\n          if( token !== undefined ) {\n            if( token.type != \"cmdsep\") {\n              this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n            }\n          }\n\n          command.params=[];\n          command.params[0] = label;\n          command.label = true;\n          commands.push( command );\n          return;\n\n        }\n        num = parseInt(token.data);\n        token = tokens.shift();\n        if( token !== undefined ) {\n          if( token.type != \"cmdsep\") {\n            this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n          }\n        }\n\n        command.params=[];\n        command.params[0] = num;\n        command.label = false;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"ON\" ) {\n        var nums = [];\n        var onInterrupt = false;\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        endTokens.push( { type: \"name\", data: \"GOSUB\" });\n\n        token = tokens.shift();\n        var onExpr = null;\n\n        if( token.type == \"name\" && (token.data == \"INTERRUPT0\" || token.data == \"INTERRUPT1\")) {\n          onInterrupt = true;\n          onExpr = {\n            type: \"control\",\n            data: token.data\n          }\n        }\n        else {\n          tokens.unshift( token );\n          onExpr = this.parseBoolExpression( context, endTokens );\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"ON expects GOTO/GOSUB\");\n        }\n\n        if( !onInterrupt ) {\n          if( !( token.data == \"GOTO\" || token.data == \"GOSUB\" )) {\n            this.throwError( context, \"ON expects GOTO/GOSUB\");\n          }\n        }\n        else {\n          if( !( token.data == \"GOTO\" )) {\n            this.throwError( context, \"ON INTERRUPT expects GOTO\");\n          }\n        }\n\n        var onType = token.data;\n\n        token = tokens.shift();\n\n        var labelFlag = false;\n        var label = \"\";\n        var num0;\n\n        if( token.type != \"num\") {\n\n            if( token.type != \"name\") {\n                this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n            }\n\n            labelFlag = true;\n            label = token.data;\n\n        }\n        else {\n          num0  = parseInt(token.data);\n        }\n\n        nums.push( num0 );\n\n        if( !onInterrupt ) {\n          while ( true ) {\n\n            token = tokens.shift();\n            if( token == undefined ) { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( !( token.type == \"sep\" && token.data == \",\" )) {\n              this.throwError( context, \"ON GOTO/GOSUB expects numberlist\");\n            }\n\n            token = tokens.shift();\n            if( token.type != \"num\") {\n              this.throwError( context, \"GOTO/GOSUB expects number\");\n            }\n            nums.push(  parseInt(token.data) );\n          }\n\n          if( nums.length > 1 ) {\n            this.throwError( context, \"ON INTERUPT GOTO expects only a single line number\");\n          }\n\n          command.params=[];\n          command.params[0] = onType.toLowerCase();\n          command.params[1] = onExpr;\n          command.params[2] = nums;\n          commands.push( command );\n        }\n        else {\n\n          command.params=[];\n          command.params[0] = onExpr.data.toLowerCase();\n          if ( labelFlag ) {\n              command.params[1] = label;\n          }\n          else {\n              command.params[1] = num0;\n          }\n          command.label = labelFlag;\n\n          commands.push( command );\n\n        }\n\n      }\n      else if( controlToken == \"RETURN\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"END\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"STOP\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"FOR\") {\n\n        var variable, expr_from, expr_to, expr_step;\n        var endTokens = [];\n\n        token = tokens.shift();\n        if( token.type != \"name\" ) {\n          this.throwError( context,\n                \"For expects variable, no var found, found \" + token.type+\"/\"+token.data);\n        }\n\n        variable = token.data;\n\n        token = tokens.shift();\n        if( !( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context,\n                \"For expects '=', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"TO\" });\n\n        expr_from = this.parseBoolExpression( context, endTokens );\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"TO\" ) ) {\n          this.throwError( context, \"For expects 'to', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"name\", data: \"STEP\" });\n\n        expr_to = this.parseBoolExpression( context, endTokens );\n        expr_step = { parts: [ { data: \"1\", op: null, type: \"num\"} ] };\n\n        token = tokens.shift();\n        if( !( token === undefined ) ) {\n          if( token.type == \"name\" && token.data == \"STEP\") {\n\n              endTokens = [];\n              endTokens.push( { type: \"cmdsep\", data: \":\" });\n              expr_step = this.parseBoolExpression( context, endTokens );\n          }\n          else {\n            if(! ( token.type == \"cmdsep\" && token.data == \":\")) {\n              throw \"FOR: unexpected token '\" + token.data +\"'\";\n            }\n          }\n        }\n\n        command.controlKW = \"for:init\";\n        command.params=[];\n        command.params[0] = expr_from;\n        command.params[1] = expr_to;\n        command.params[2] = expr_step;\n        command.variable = variable;\n        commands.push( command );\n        if( this.debugFlag ) {\n          console.log(\"command=\", command);\n        }\n\n      }\n      else if( controlToken == \"NEXT\") {\n\n        var variable;\n\n        var explicit = false;\n        while( true ) {\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n\n          if( token.type != \"name\" ) {\n            throw \"Next expected variable, not '\" +token.data+ \"'\";\n          }\n\n          var nextcommand = {\n            controlKW: \"for:next\",\n            nextVar: token.data,\n            lineNumber: command.lineNumber,\n            type: command.type\n          };\n\n          commands.push( nextcommand );\n          explicit = true;\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n          if( !( token.type == \"sep\" && token.data == \",\" )) {\n            throw \"Expected comma, found '\" + token.data + \"'\";\n          }\n        }\n\n        if( ! explicit ) {\n          command.controlKW = \"for:next\";\n          command.nextVar = null;\n          commands.push( command );\n        }\n\n      }\n      else if( controlToken == \"IF\") {\n\n        var expr1, expr2, comp;\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"THEN\" });\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        var expr1 = this.parseBoolExpression( context, endTokens );\n        command.params= [ expr1 ];\n\n        token = tokens.shift();\n\n        if( token.type == \"name\" && token.data == \"GOTO\") {\n          var insert = {};\n          insert.data = \"GOTO\";\n          insert.type = \"name\";\n          tokens.unshift( insert );\n        } else {\n          if( tokens.length > 0 ) {\n            if( tokens[0].type == \"num\" ) {\n              var insert = {};\n              insert.data = \"GOTO\";\n              insert.type = \"name\";\n              tokens.unshift( insert );\n            }\n          }\n        }\n\n        //var block = this.parseLineCommands( context );\n        var result = this.parseLineCommands( context );\n        var block = result.commands;\n\n        if( this.debugFlag ) {\n          console.log( block );\n        }\n\n        commands.push( command );\n\n        for( var bi=0; bi<block.length; bi++) {\n          commands.push( block[bi] );\n        }\n\n      }\n      else if( controlToken == \"DATA\") {\n\n        var dataArray = [];\n        var endTokens;\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"sep\", data: \",\" });\n\n        while ( true ) {\n            var pair = this.parseSimpleExpression( context, endTokens );\n\n            var expr1 = pair[0];\n\n\n            if( expr1 === undefined ) {\n              throw \"DATA: expected data\";\n            }\n\n            dataArray.push( expr1 );\n\n            token = pair[1];\n            if( token === undefined ) {\n              break;\n            }\n            if( token.type == \"cmdsep\" && token.data == \":\" ) {\n              break;\n            }\n            else if( token.type == \"sep\" && token.data ==\",\") {\n              continue;\n            }\n            else {\n              this.throwError( context, \"data unknown token found \" + token.type+\"/\"+token.data);\n            }\n        }\n\n        command.params=dataArray;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"SUB\") {\n\n        var label = \"\";\n        token = tokens.shift();\n        if( token == null ) { throw \"SUB expected label\"; }\n\n        if( token.type != \"name\" ) {\n          throw \"SUB expected label not '\" +token.data+ \"'\";\n        }\n\n        label = token.data.toUpperCase();\n\n        token = tokens.shift();\n        if( token != null ) { throw \"SUB unexpected data after label\"; }\n\n        command.label = label;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"REM\" ) {\n\n        while( true ) {\n\n            token = tokens.shift();\n            if( token == null ) { break ; }\n        }\n\n        commands.push( command );\n\n      }\n      else {\n        this.throwError( context, command.controlKW + \" not implemented\");\n      }\n    }\n  }\n\n  parseStatementCall(  context, preTokens, commands, command, nameToken, token0 ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.statementName = this.normalizeStatementName( nameToken );\n    command.type = \"call\";\n\n\n    if( token.type != \"@@@notoken\") {\n      tokens.unshift( token );\n    }\n\n    command.params = [];\n\n    while ( true ) {\n\n      var endCommand = false;\n      var endTokens = [];\n      endTokens.push( { type: \"sep\", data: \"@@@all\" });\n      endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n      var expression = this.parseBoolExpression( context, endTokens );\n      if( this.debugFlag ) {\n        console.log( expression );\n      }\n\n      if( expression != null ) {\n        command.params.push( expression );\n\n        token = tokens.shift();\n        if( token != undefined ) {\n          if( token === undefined ) {\n            endCommand = true;\n          }\n          if( token.type == \"cmdsep\" ) {\n            endCommand = true;\n          }\n          else if( token.type == \"sep\") {\n            continue;\n          }\n          else {\n            this.throwError( context, \"Unexpected characters in statement call: '\" + token.data +\"'\");\n          }\n        }\n        else {\n          endCommand = true;\n        }\n\n      }\n      else {\n        endCommand = true;\n      }\n\n      if( endCommand  ) {\n        commands.push( command );\n        break;\n      }\n    }\n  }\n\n\tparseLineCommands( context, preTokens ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar commands = [];\n    var handlers = {};\n\n\t\tvar i=1;\n\t\twhile( true ) {\n\n\t\t\tvar command = {};\n\t\t\tvar token;\n      var keyword = false;\n      var control = false;\n\n\t\t\tcommand.lineNumber = context.lineNumber;\n\n\t\t\ttoken = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif( token.type == \"cmdsep\" ) {\n\t\t\t\t/* empty command */\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif( token.type != \"name\" ) {\n\t\t\t\tif( token.type != \"trash\" ) {\n          this.throwError( context, \"Unexpected token, expected symbolname, got '\" + oken.data +\"'\") ;\n        }\n        else {\n          this.throwError( context, \"Unexpected character, expected \\\"symbolname\\\", got \" + token.detail ) ;\n        }\n\t\t\t}\n\n\t\t\tvar nameToken = token.data;\n\t\t\tvar cmdType = \"unknown\";\n\n\t\t\tif( this.CTRL_KW.indexOf( token.data ) > -1) {\n\t\t\t\t\tcontrol = true;\n\t\t\t}\n\n      if( this.KEYWORDS.indexOf( token.data ) > -1 || token.data == \"XON\") {\n\t\t\t\t\tkeyword = true;\n\t\t\t}\n      else {\n        if( this.SHORTCUT_KW.indexOf( token.data ) > -1) {\n  \t\t\t\t\tkeyword = true;\n  \t\t\t}\n      }\n\n\t\t  token = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\ttoken = { type: \"@@@notoken\" };\n\t\t\t}\n\n      if (  control ) {\n\n        this.parseControlStructure( context, preTokens, commands, command, handlers, nameToken, token );\n\n      }\n\t\t\telse if( token.type == \"eq\") {\n\n\t\t\t\tthis.parseAssignment( context, preTokens, commands, command, nameToken, token );\n\t\t\t}\n      else if( token.type == \"bracket\" && token.data==\"(\" && !keyword ) {\n\n\t\t\t\tthis.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n\t\t\t}\n      else {\n          if( !keyword ) {\n            console.log(\"Dump: \",context, preTokens, commands, command, nameToken, token);\n            this.throwError( context, \"no such command: \" + nameToken );\n          }\n          this.parseStatementCall( context, preTokens, commands, command, nameToken, token );\n\n      }\n\n\t\t}\n\n    var result = {\n        commands: commands,\n        handlers: handlers\n      };\n\n    return result;\n\t}\n\n  logTokens( tokens ) {\n    if( !this.debugFlag ) { return ; }\n\n    var tokensStr = \"\";\n    for( var i=0; i<tokens.length; i++) {\n      var tok = tokens[i];\n      var tokStr = tok.type + \":\" + tok.data;\n      if( tokensStr != \"\" ) {\n        tokensStr += \", \";\n      }\n      tokensStr += tokStr;\n    }\n\n    console.log( tokensStr );\n\n\n    for( var i=0; i<tokens.length; i++) {\n        var tok = tokens[i];\n        console.log(\"token: \",tok);\n    }\n\n  }\n\n\n\n\n  parseErrorLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n\n    errContext=\"tokenizer\";\n    detail=\"init\";\n\t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n    detail=\"parsing tokens\";\n    var tokens = toker.tokenize();\n    if( this.debugFlag ) {\n      console.log(\"Tokens after tokenizer\");\n    }\n    this.logTokens( tokens );\n\n    detail=\"internal\";\n    tokens = this.upperCaseNameTokens( tokens );\n    tokens = this.removePadding( tokens );\n    tokens = this.mergeCompTokens( tokens );\n    tokens = this.mergeBrokenUpTokens( tokens );\n\n\n    if( this.debugFlag ) {\n      console.log(\"Tokens after merge\");\n    }\n    this.logTokens( tokens );\n\n    if( tokens.length == 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif( tokens[0].type == \"num\" ) {\n\t\t\tlineRecord.lineNumber = tokens[0].data;\n      lineNr = tokens[0].data;\n      var lineRest = line.substr( lineNr.length );\n      return this.parseLine( lineNr + \" REM[ERROR] \" + lineRest  );\n    }\n    else {\n      throw \"Expected line number, when reparsing line with error\";\n    }\n\n  }\n\n  parseLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n    try {\n      errContext=\"tokenizer\";\n      detail=\"init\";\n  \t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n      detail=\"parsing tokens\";\n      var tokens = toker.tokenize();\n      if( this.debugFlag ) {\n        console.log(\"Tokens after tokenizer\");\n      }\n      this.logTokens( tokens );\n\n      detail=\"internal\";\n      tokens = this.upperCaseNameTokens( tokens );\n      tokens = this.removePadding( tokens );\n      tokens = this.mergeCompTokens( tokens );\n      tokens = this.mergeBrokenUpTokens( tokens );\n\n\n      if( this.debugFlag ) {\n        console.log(\"Tokens after merge\");\n      }\n      this.logTokens( tokens );\n\n      if( tokens.length == 0 ) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tif( tokens[0].type == \"num\" ) {\n  \t\t\tlineRecord.lineNumber = tokens[0].data;\n        lineNr = tokens[0].data;\n        tokens.shift();\n      }\n\n  \t\tvar context = {\n        tokens: tokens,\n        lineNumber: lineRecord.lineNumber\n      }\n\n      errContext = \"parser\";\n      detail=\"parsing commands\";\n      var result = this.parseLineCommands( context );\n      var commands = result.commands;\n      lineRecord.commands = commands;\n      lineRecord.raw = line;\n      lineRecord.handlers = result.handlers;\n      return lineRecord;\n    }\n    catch ( e ) {\n\n      if( this.erh.isError( e ) ) {\n        if( e.lineNr == -1 ) {\n          if( lineNr != -1 ) {\n            e.lineNr = lineNr;\n          }\n        }\n        throw e;\n      }\n      this.throwError( null, errContext + \" error (\" +e+ \") while \" + detail );\n    }\n  }\n\n  getTokens( line, merge, noPadding  ) {\n\n    try {\n      var toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n      var tokens = toker.tokenize();\n      if( noPadding) { tokens = this.removePadding( tokens ); }\n      if( merge ) {tokens = this.mergeCompTokens( tokens ); }\n      this.logTokens( tokens );\n      return tokens;\n    }\n    catch ( e ) {\n      console.log( e );\n      this.throwError(null,\"getTokens error\",\"internal\");\n    }\n  }\n}\n\n//--EOC \n\n// ## basictokenizer.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basictokenizer.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basictokenizer.js\n\nclass StringReader {\n\n\tconstructor( strIn ) {\n\t\t\tthis.buffer = strIn;\n\t\t\tthis.index = 0;\n\t\t\tthis.lineIndex = 1;\n\t\t\tthis.line = 1;\n\t\t\tvar a={}; a.b=strIn;\n\n\t}\n\n\tpeek() {\n\t\treturn this.buffer.substr( this.index,1 );\n\t}\n\tpeek2() {\n\t\treturn this.buffer.substr( this.index,2 );\n\t}\n\n\n\tunconsume( x ) {\n\t\tthis.index -= x;\n\t}\n\n\tconsume() {\n\n\t\tvar c = this.buffer.substr( this.index,1 );\n\t\tthis.index ++;\n\t\tif( c == \"\\n\") {\n\t\t\tthis.line++;\n\t\t\tthis.lineIndex = 1;\n\t\t}\n\n\t}\n\n\tEOF() {\n\t\tvar len = this.buffer.length;\n\t\tif( this.index < len ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n\nclass Tokenizer {\n\n\tconstructor( reader, keywords ) {\n\t\t\tthis.tokens = [];\n\t\t\tthis.reader = reader;\n\t\t\tthis.keywords = keywords;\n\t\t\tthis.greedy = false;\n\t}\n\n\tisOpChar( ctx ) {\n\n\t\tvar rv = ctx.c.match(\"[+]|[-]|[*]|[/]|[\\\\%]|[\\\\^]|[;]\") != null;\n\n\t\treturn [rv,0];\n\n\t}\n\n\tisCompChar( ctx ) {\n\n\t\tvar rv =  (ctx.c == \"<\" || ctx.c == \">\");\n\t\treturn [rv,0];\n\t}\n\n\tisEqChar( ctx ) {\n\t\t\tif( ctx.c == \"=\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisNameChar( ctx  ) {\n\n\t\t//console.log(\"SEQ: \" + ctx.seq);\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\t\tvar rv = ctx.c.match(\"[a-zA-Z0-9$%?]\") != null;\n\n\t\tif( ctx.c== \"%\" ) {\n\t\t\t\trv = false;\n\t\t\t\tif( ctx.prev != null ) {\n\t\t\t\t\tvar varNameChar = ctx.prev.match(\"[a-zA-Z0-9]\") != null;\n\t\t\t\t\tif( varNameChar ) {\n\t\t\t\t\t\tctx.endFound = true;\n\t\t\t\t\t\trv = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\n\t\tif( ctx.c==\"$\" ) {\n\t\t\tctx.endFound = true;\n\t\t}\n\n\t\tif( this.greedy ) {\n\t\t\tif( this.keywords.indexOf( ctx.seq.toUpperCase() ) >-1 ) {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\telse if( ! (ctx.seq === undefined )) {\n\t\t\t\tvar trappedKW = false;\n\t\t\t\tvar trapped = null;\n\t\t\t\tfor( var i=0; i<this.keywords.length; i++) {\n\t\t\t\t\tvar kw = this.keywords[i];\n\t\t\t\t\tif( ctx.seq.toUpperCase().indexOf( kw ) > 0 )  {\n\t\t\t\t\t\ttrappedKW = true;\n\t\t\t\t\t\ttrapped = kw;\n\t\t\t\t\t\treturn [rv, kw.length ];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn [rv,0];\n\t}\n\n\tisNumChar( ctx  ) {\n\t\treturn [(ctx.c.match(\"[0-9\\.~]\") != null),0];\n\t}\n\n\tisPadChar( ctx  ) {\n\t\t\tif( ctx.c == \" \" || ctx.c == \"\\t\" || ctx.c == \"\\n\" || ctx.c == \"\\r\") {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\n\t\t\treturn [false,0];\n\t}\n\n\tisCommandSepChar( ctx  ) {\n\t\t\tif( ctx.c == \":\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisSepChar( ctx  ) {\n\t\t\tif( ctx.c == \",\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\tisAnyChar( ctx  ) {\n\t\t\treturn [true,0]; /* Will be executed last */\n\t}\n\n\tisBracket( ctx  ) {\n\t\tif( ctx.c == \"(\" || ctx.c == \")\" || ctx.c == \"[\" || ctx.c == \"]\") {\n\t\t\treturn [true,0];\n\t\t}\n\t\treturn [false,0];\n\t}\n\n\n\tisStrChar( ctx ) {\n\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\n\t\tif( ctx.index == 0) {\n\t\t\tif( ctx.c==\"\\\"\" ) {\n\t\t\t\tctx.inString = true;\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t\t}\n\t\telse if( ctx.inString ) {\n\t\t\tif ( ctx.index > 0 && ctx.c==\"\\\"\") {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\treturn [true,0];\n\t\t}\n\n\t\treturn [false,0];\n\n\t}\n\n\tnormalizeToken( tok0 ) {\n\t\tvar tok = tok0;\n\n\t\ttok.type = tok0.type;\n\n\t\tif( tok.type == \"str\" ) {\n\t\t\t\ttok.data = tok0.data.substr(1,tok0.data.length-2);\n\t\t}\n\t\treturn tok;\n\t}\n\n\treadChars( read, type0, compareF, tokenType ) {\n\t\tvar tok = { type: type0, data : \"\" }\n\t\tvar ctx = { index:0, prev: null, seq: \"\" };\n\n\t\twhile(!read.EOF()) {\n\n\t\t\tvar c = read.peek();\n\n\t\t\tctx.seq += c;\n\t\t\tctx.c = c;\n\n\t\t\tvar rv = this[compareF ] ( ctx );\n\t\t\tif( rv[1] > 0 ) {\n\t\t\t\t\tread.unconsume( rv[1]-1 );\n\t\t\t\t\tctx.seq = ctx.seq.substr(0,ctx.seq.length-rv[1]) ;\n\t\t\t\t\ttok.data = ctx.seq;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( !rv[0] ) {\n\t\t\t\treturn this.normalizeToken( tok );\n\t\t\t}\n\t\t\ttok.data += c;\n\t\t\tread.consume();\n\n\t\t\tctx.index++;\n\t\t\tctx.prev = c;\n\n\t\t\tif( tokenType == \"chr\") {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn this.normalizeToken( tok );\n\t}\n\n\n\ttokenize() {\n\t\tvar read = this.reader;\n\n\t\tvar _this = this;\n\t\tvar tokens = [];\n\n\t\tvar parseRules = [];\n\t\tvar TYPEIX = 0;\n\t\tvar FUNCIX = 1;\n\t\tvar STRINGTYPEIX = 2;\n\n\t\tparseRules.push([\"pad\", \t\t\"isPadChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"str\", \t\t\"isStrChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"num\", \t\t\"isNumChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"name\", \t\t\"isNameChar\"\t, \"str\"] );\n\t\tparseRules.push([\"op\", \t\t\t\"isOpChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"comp\", \t\t\"isCompChar\"  , \"chr\"] );\n\t\tparseRules.push([\"eq\", \t\t\t\"isEqChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"bracket\", \"isBracket\"   , \"chr\"] );\n\t\tparseRules.push([\"sep\", \t\t\"isSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"cmdsep\", \t\"isCommandSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"trash\", \t\"isAnyChar\"   , \"chr\"] );\n\n\t\twhile( !read.EOF() ) {\n\t\t\tvar c = read.peek();\n\t\t\tvar tokenFound = false;\n\n\t\t\tfor( var i=0; i<parseRules.length; i++) {\n\t\t\t\tvar rule = parseRules[ i ];\n\n\t\t\t\tvar ctx = { index: 0, c:c }\n\t\t\t\tvar rv = this[rule[FUNCIX]]( ctx );\n\t\t\t\tif( rv[0] ) {\n\t\t\t\t\t\tvar tok = this.readChars( read, rule[TYPEIX], rule[FUNCIX], rule[STRINGTYPEIX] );\n\n\t\t\t\t\t\tif( tok.type == \"name\") {\n\t\t\t\t\t\t\ttok.data = tok.data.toUpperCase();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( tok.type == \"trash\") {\n\t\t\t\t\t\t\ttok.detail = \"'\" + tok.data + \"' (ASCII-code=\" + tok.data.charCodeAt(0) + \")\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttokens.push( tok );\n\t\t\t\t\t\ttokenFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//do nothing\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!tokenFound) {\n\t\t\t\tthrow \"syntax error, unexpected character: '\" + c + \"' =>\" + read.line + \":\" + read.lineIndex;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n}\n\n//--EOC \n\n// ## input.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/input.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/input.js\n\nclass Input {\n\n  constructor( sys ) {\n    this.keyPress = [];\n    this.interactive = false;\n    this.sys = sys;\n  }\n\n  setHandler( hc ) {\n    this.handlerClazz = hc;\n  }\n\n  setInterActive( flag ) {\n\n    this.interactive = flag;\n    this.sys.blinkMode( flag  );\n\n  }\n\n\n  getInterActive() {\n\n    return this.interactive;\n\n  }\n\n\n  flush() {\n    this.keyPress = [];\n  }\n\n  inputKeyHandler( e )  {\n\n    var hc = this.handlerClazz;\n\n    if( e.keyLabel == \"Escape\" ) {\n        hc[\"stop\"]();\n        return;\n    }\n\n    hc[\"keyInterrupt\"]( \"keypress\", e );\n\n    if( !this.interactive ) {\n        this.keyPress.push( e );\n    }\n    else {\n        hc[\"interactiveKeyHandler\"]( e );\n      }\n  }\n\n  getKey() {\n    var key = this.keyPress.shift();\n    if( key ) {\n      return key;\n    }\n    return null;\n  }\n\n}\n\nclass MutedInput {\n\n  setHandler( hc ) {}\n  setActive( flag ) {}\n  getKey() { return null; }\n  inputKeyHandler(e) {}\n  getKey() { return null;}\n\n}\n\n//--EOC \n\n// ## processes.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/processes.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/processes.js\n\nclass processes {\n\n\tconstructor( sys ) {\n\n\t\tconst STATE_NULL \t\t= 9660;\n\t\tconst STATE_LASTSTATE = 9661;\n\t\tconst STATE_CLI = \t\t9670;\n\t\tconst STATE_RUNNING = 9671;\n\t\tconst STATE_INPUT \t= 9672;\n\t\tconst STATE_WAITING = 9673;\n\n\t\tthis.STATE_NULL \t\t\t= STATE_NULL;\n\t\tthis.STATE_LASTSTATE \t= STATE_LASTSTATE;\n\t\tthis.STATE_CLI \t\t\t\t= \t\tSTATE_CLI;\n\t\tthis.STATE_RUNNING \t\t= STATE_RUNNING;\n\t\tthis.STATE_INPUT \t\t\t= STATE_INPUT;\n\t\tthis.STATE_WAITING \t\t= STATE_WAITING;\n\n\t\tthis.sys = sys;\n\t\tthis.processes = [];\n\n\t\tvar _this = this;\n    var processes = _this.processes;\n\n\t\tthis.idlerInterval = null;\n\t\tthis.runInterval = null;\n\t\tthis.waitTimeOut = null;\n\n\t\tvar lastState = STATE_NULL;\n\t\tvar state = STATE_NULL;\n\n\t\tthis.avgIdlerTime = 10;\n\n\t\tvar changeState = function( newState, data ) {\n\n\t\t\t\tif( newState == STATE_INPUT ) {\n\t\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t}\n\t\t\t\telse if( newState == STATE_WAITING ) {\n\t\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t\t_this.startWaitingTimeOut( data );\n\t\t\t\t}\n\t\t\t\telse if( newState == STATE_CLI ) {\n\t\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t\t_this.killWaitingTimeOut();\n\t\t\t\t}\n\t\t\t\telse if( newState == STATE_RUNNING ) {\n\t\t\t\t\t_this.killWaitingTimeOut();\n\t\t\t\t\t_this.startRuntimeInterval( data );\n\t\t\t\t}\n\n\t\t\t\tlastState = state;\n\t\t\t\tstate = newState;\n\t\t}\n\n\t\tvar flags, pstate, update, wtime, p;\n\n\t\tthis.idlerFunction = function()  {\n\t\t\tvar m1 = new Date().getTime();\n\n\t\t\tif( state == STATE_RUNNING  || state == STATE_WAITING ) {\n\t\t\t\treturn; //don't steal cycles from running or waiting timer\n\t\t\t}\n\n\t\t\tp = processes[0];\n\n\t\t\tvar running = p.cpuNeeded();\n\t\t\tif( running>.1 ) { //we do not get this from cycle.  At least not in good time.\n\t\t\t\tvar stat = p.getStatus();\n\t\t\t\t_this.sys.poststatus( 0, stat );\n\n\t\t\t\tchangeState( STATE_RUNNING, running );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tflags = p.cycle();\n\n\t\t\tupdate = flags[ 0 ];\n\t\t\tpstate = flags[ 1 ];\n\t\t\twtime = flags[ 2 ];\n\n\t\t\tif( update ) {\n\t\t\t\tvar stat = p.getStatus();\n\t\t\t\t_this.sys.poststatus( 0, stat );\n\t\t\t}\n\n\t\t\tif( pstate != state ) {\n\t\t\t\tchangeState( pstate, wtime );\n\t\t\t}\n\n\t\t\tvar m2 = new Date().getTime();\n\t\t\tvar m3 = m2-m1;\n\n\t\t\t_this.avgIdlerTime = ((_this.avgIdlerTime * 99) + m3) / 100;\n\t\t}\n\n\t\tthis.runningFunction = function()  {\n\n\t\t\tif( state != STATE_RUNNING ) {\n\t\t\t\treturn; //should never get here\n\t\t\t}\n\n\t\t\t//p = processes[0];\n\t\t\tflags = p.cycle();\n\n\t\t\tpstate = flags[ 1 ];\n\t\t\twtime = flags[ 2 ];\n\n\t\t\tif( pstate != state ) {\n\t\t\t\tchangeState( pstate, wtime );\n\t\t\t}\n\n\t\t}\n\n\t\tthis.waitingFunction = function()  {\n\n\t\t\t_this.runInterval = null;\n\t\t\tp.clearWaiting();\n\t\t\tchangeState( lastState, 0 );\n\n\t\t\tif( state == STATE_RUNNING ) {\n\t\t\t\t_this.runningFunction();\n\t\t\t}\n\t\t}\n\n\t\tchangeState( STATE_CLI );\n}\n\n\tstartIdlerInterval()  {\n\t\tif( this.idlerInterval == null ) {\n\t\t\t\t //this.sys.log(\"Starting process interval (first register)\");\n\t\t\t\t this.idlerInterval = setInterval( this.idlerFunction, 200) ;\n\t\t}\n\t}\n\n\tstartRuntimeInterval( cpu )  {\n\t\tif( this.runInterval == null ) {\n\t\t\t\t //this.sys.log(\"Starting running interval \" + cpu);\n\n\t\t\t\t var iv = Math.floor( 220 - (200*cpu) );\n\t\t\t\t //this.sys.log(\"Starting running interval# \" + iv);\n\n\t\t\t\t this.runInterval = setInterval( this.runningFunction, iv) ;\n\t\t}\n\t}\n\n\tkillRuntimeInterval()  {\n\t\tif( this.runInterval != null ) {\n\t\t\t\t //this.sys.log(\"Stopping running interval\");\n\t\t\t\t clearInterval( this.runInterval ) ;\n\t\t\t\t this.runInterval = null;\n\t\t}\n\t}\n\n\tstartWaitingTimeOut( t )  {\n\t\tif( this.waitTimeOut == null ) {\n\t\t\t\t //this.sys.log(\"Starting waiting timeout \" + t);\n\t\t\t\t this.waitTimeOut = setTimeout( this.waitingFunction, t, t ) ;\n\t\t}\n\t}\n\n\tkillWaitingTimeOut()  {\n\t\tif( this.waitTimeOut != null ) {\n\t\t\t\t //this.sys.log(\"Stopping running wait timeout!!\");\n\t\t\t\t clearTimeout( this.waitTimeOut ) ;\n\t\t\t\t this.waitTimeOut = null;\n\t\t}\n\t}\n\n/*\n\n\n\t\tvar togglerSpeedFunction = function()  {\n\n\t\t\tfastloop = false;\n\n\t\t\tfor( var i=0; i<processes.length; i++ ) {\n\t\t\t\tvar p = processes[i];\n\t\t\t\tvar psl = psleep[i];\n\n\t\t\t\tif( p ) {\n\n\t\t\t\t\t\tvar cpuHungry =  processes[ i ].cpuNeeded();\n\t\t\t\t\t\tvar found = _this.fastProcesses[ i ];\n\n\t\t\t\t\t\tif( !cpuHungry ) {\n\t\t\t\t\t\t\tvar debugPoint = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( cpuHungry && !found) {\n\t\t\t\t\t\t\t_this.fastProcesses[ i ] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if( !cpuHungry && found) {\n\t\t\t\t\t\t\t\t_this.fastProcesses[ i ] = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( _this.fastProcesses[ i ] ) {\n\t\t\t\t\t\t\tfastloop = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\t\tvar cycleFunction = function()  {\n\n\t\t\tvar flags, upd, wait, time;\n\n\t\t\tvar m = null;\n\n\t\t\tfor( var i=0; i<processes.length; i++ ) {\n\t\t\t\tvar p = processes[i];\n\t\t\t\tvar psl = psleep[i];\n\n\t\t\t\tif( p ) {\n\n\t\t\t\t\tif( psl > 0 ) {\n\n\t\t\t\t\t\tif( m === null ) {\n\t\t\t\t\t\t\tm = new Date().getTime();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( m<psl ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpsleep[i] = 0;\n\t\t\t\t\t\tp.clearWaiting();\n\t\t\t\t\t}\n\n\t\t\t\t\tflags = p.cycle();\n\n\t\t\t\t\tupd = flags[ 0 ];\n\t\t\t\t\twait = flags[ 1 ];\n\n\t\t\t\t\tif( wait ) {\n\t\t\t\t\t\tvar time = flags[ 2 ];\n\n\t\t\t\t\t\tif( m === null ) {\n\t\t\t\t\t\t\t\tvar m = new Date().getTime();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpsleep[i] = m + time  + 10;\n\t\t\t\t\t}\n\n\t\t\t\t\tif( upd ) {\n\t\t\t\t\t\tvar stat = processes[ i ].getStatus();\n\t\t\t\t\t\t_this.sys.poststatus( i, stat );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( fastloop ) {\n\t\t\t\tsetTimeout( cycleFunction, 10 );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsetTimeout( cycleFunction, 100 );\n\t\t\t}\n\n\t\t};\n\n\n\t\tchangeState\n\n\t\tsetInterval( togglerSpeedFunction, 100) ;\n\t\tsetTimeout( cycleFunction, 100 );\n\n\n*/\n\n\n\tgetTicks() {\n\t\treturn this.count;\n\t}\n\n\tget( id ) {\n\t\treturn this.processes[ id ];\n\t}\n\n\tregister( obj ) {\n\n\t\tvar newId = this.processes.length;\n\n\t\tthis.processes.push( obj );\n\t\t//this.processesSleep.push( 0 );\n\t\t//this.fastProcesses.push( false );\n\n\t\tobj.processId = newId;\n\t\tobj.procIf = this;\n\n\t\tthis.startIdlerInterval();\n\n\t\treturn newId;\n\t}\n\n\n\tgetRoot() {\n\n\t\treturn this.processes[ 0 ];\n\t}\n}\n\n//--EOC \n\n// ## commandhelp.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/commandhelp.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/commandhelp.js\n\nclass CommandHelp {\n\n\tconstructor() {}\n\n\n  getCategoriesNormalize(  categoryIndexesInt ) {\n    var categoryIndexes = [\n      Object.getOwnPropertyNames( categoryIndexesInt[0] ),\n      categoryIndexesInt[1]\n    ];\n    return categoryIndexes;\n  }\n\n  getCategoriesIntermediate(  categoryIndexes, clazz ) {\n\n\n    var stats = clazz.getStatements( true );\n    var funs = clazz.getFunctions( true );\n\n    var cat = categoryIndexes[ 0 ];\n    var catLists = categoryIndexes[ 1 ];\n\n    if( cat[ \"general\" ] === undefined ) { cat[ \"general\" ] = 0; catLists[ \"general\" ] = []; }\n\n    for( var i=0;i<stats.length;i++) {\n      var rname = stats[i];\n      var si = rname.replace(\"_stat_\",\"_stat_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) )  { \n          catlabel = clazz[ si ](); \n          var tmp=12;\n      }\n      else { \n        catlabel = \"general\"; \n      }\n\n      var f_attribs = {};\n      if( catlabel.indexOf(\":\") >0 ) {\n\n        var partsLen = catlabel.split(\":\" ).length;\n\n        f_attribs.description =  catlabel.split(\":\" )[1];\n        f_attribs.input =   catlabel.split(\":\" )[2];\n        f_attribs.output =  catlabel.split(\":\" )[3];\n\n        catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_stat_\",\"\").toUpperCase();\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    for( var i=0;i<funs.length;i++) {\n      var rname = funs[i];\n      var si = rname.replace(\"_fun_\",\"_fun_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) ) { catlabel = clazz[ si ](); }\n      else { catlabel = \"general\"; }\n      var f_attribs = {};\n\n      if( catlabel.indexOf(\":\") >0 ) {\n\n          var partsLen = catlabel.split(\":\" ).length;\n\n          f_attribs.description =  catlabel.split(\":\" )[1];\n          f_attribs.input =   catlabel.split(\":\" )[2];\n          f_attribs.output =  catlabel.split(\":\" )[3];\n\n          catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_fun_\",\"\").replace(\"_DLR_\",\"$\").toUpperCase() + \"()\";\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    //var cats = Object.getOwnPropertyNames( cat );\n\n    return [cat,catLists];\n  }\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/textarea.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n\nclass TextArea {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.cursorOn = false;\n\t\tthis.cols = 80;\n\t\tthis.rows = 30;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.hidden = false;\n\n\t\tthis.dc = false;\n\t\tthis.dcCmd = false;\n\n\t\tthis.colors ={};\n\t\tthis.reverse = false;\n\n\t\tthis.defaultFG = 5;\n\t\tthis.defaultBG = 0;\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.initialized = false;\n\n\t\tthis.changes = { all: false, list: [] };\n\t\tthis.pokeFlush = true;\n\n\t\t//this.textArea( this.cols , this.rows , -1, -1 );\n\t}\n\n\tisActive() {\n    \treturn this.initialized && !this.hidden;\n  \t}\n\n\treInit( w, h ) {\n\t\tthis._int_initMode( w, h );\n\t}\n\n\tset( w, h, cells ) {\n\t\tthis._int_initMode( w, h );\n\t\tthis._int_setCells( cells );\n\n\t}\n\n\tdestroy() {\n\t\tthis.cellel = undefined;\n\n\t\tthis.changes = { all: false, list: [] };\n\t\tthis.initialized = false;\n\t}\n\n\n  /* Adding changes, to be posted to MT throught flush */\n\t_int_addChangeAll() {\n\n\t\tthis.changes.all = true;\n\t\tthis.changes.list = [];\n\n\t }\n\n\n\n\tchangeCount() {\n\t\t if( this.changes.all ) { return 65535; }\n\t\t return this.changes.list.length;\n\t }\n\n\t/* Adding single change, to be posted to MT throught flush */\n\t_int_addChange( area ) {\n\n\t\tif(  this.changes.all ) {\n\t\t\tif( this.changes.list.length > 0 ) {\n\t\t\t\t\tthis.changes.list = [];\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar clist = this.changes.list;\n\t\tif( clist.length > 0 ) {\n\t\t\tvar lc = clist[ clist.length -1 ];\n\t\t\tvar nc = area;\n\t\t\tif( lc.y1 == lc.y2 && nc.y1 == nc.y2 && lc.y1 == nc.y1) {\n\t\t\t\tif( nc.x1 == lc.x2 +1 ) {\n\t\t\t\t\t\tvar x2 = lc.x2;\n\t\t\t\t\t\tvar temp=1;\n\t\t\t\t\t\tvar changesTargetArray = lc.cells[0];\n\t\t\t\t\t\tfor( var i=0; i<area.cells[0].length; i++) {\n\t\t\t\t\t\t\tvar cell = area.cells[0][i];\n\t\t\t\t\t\t\tchangesTargetArray.push( cell );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlc.x2 = nc.x2;\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.changes.list.push( area );\n\n\t }\n\n\t /* Force flush to MT the whole buffer */\n\t_int_flushAll() {\n\t\tthis.changes.all = true;\n\t\tthis.changes.list = [];\n\n\t\tthis._int_flush();\n\t}\n\n  \t/* Utility function to prepare input for addChange (which itself prepares for flush )*/\n\t_int_getArea( x1, y1, x2, y2 ) {\n\n\tvar cells = [];\n\n\tfor( var y=y1; y<=y2; y++) {\n\t\t\tvar row = [];\n\t\t\tfor( var x=x1; x<=x2; x++) {\n\t\t\t\trow.push( this.cellel[ y][ x] );\n\t\t\t}\n\t\t\tcells.push( row );\n\t\t}\n\n\t\tvar area =\n\t\t{\n\t\t\t cells: cells,\n\t\t\t x1: x1,\n\t\t\t y1: y1,\n\t\t\t x2: x2,\n\t\t\t y2: y2\n\t\t};\n\n\t\treturn area;\n\n\t}\n\n   /* Flush local changes to Main Thread for actual display updates*/\n\t _int_flush() {\n\n\t\t\tif( this.changes.all ) {\n\t\t\t\tthis.sys.post( \"textupdate-all\",\n\t\t\t\t\t\t{\n \t\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\t\tcells: this.cellel,\n\t\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t\t} );\n\n\t\t\t\tthis.changes.all = false;\n\n\n\t\t\t}\n\t\t\telse if( this.changes.list.length > 0 ) {\n\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  this.changes.list,\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\t\t\t\tthis.changes.list = [];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  [],\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\n\t\t\t}\n\n\t\t}\n\n\tattach( w, h ) {\n\t\tthis._int_initMode( w, h);\n\t}\n\n\tsetPokeFlush( flag ) {\n\t  this.pokeFlush = flag;\n\t}\n\n\n\tpeekc( x, y ) {\n\n\t\tvar cell = this.cellel[y][x];\n     \treturn cell.txt.codePointAt(0);\n\n\t}\n\n\tpeekcl( x, y, m ) {\n\n\t\tvar cell = this.cellel[y][x];\n\n\t\tif( m== 0 ) {\n\t\t\treturn cell.fg;\n\t\t}\n\t\telse if( m== 1 ) {\n\t\t\treturn cell.bg;\n\t\t}\n\t\telse  {\n\t\t\treturn cell.fg + (16*cell.bg);\n\t\t}\n\t}\n\n\tpokec( x, y , c ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\n\t}\n\n\tpokecl( x, y , fg, bg ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\t}\n\n\n\tpokeccl( x, y , c, fg, bg ) {\n\n\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t}\n\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t}\n\t}\n\n\n\ttriggerFlush() {\n\n\t\tthis._int_flush();\n\t}\n\n\n\t_int_initMode( w, h ) {\n\n\t\tif( this.initialized ) {\n\t\t\t\tthis.destroy();\n\t\t}\n\t\tvar sys = this.sys;\n\t\t//var msgs = sys.init.queuedMessages; TODO, what to do with queued messages\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.rows = h;\n\t\tthis.cols = w;\n\n\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.cellel = [];\n\t\tfor( var y=0; y<this.rows; y++) {\n\t\t\tvar rowArray = [];\n\t\t\tfor( var x=0; x<this.cols; x++) {\n\t\t\t\t\tvar cell = {\n\t\t\t\t\t\ttxt: \" \",\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t\t}\n\t\t\t\t\trowArray.push( cell );\n\t\t\t\t}\n\t\t\t\tthis.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\t\t  var _this = this;\n\n\t\tthis._int_flushAll();\n\n\t\tthis.sys.log(\"TEXTAREA w Ready.\");\n\n\t\tthis.initialized = true;\n\t\tthis.pokeFlush = true;\n\t\t/* if true then all pokes in \"character memory\" will be flushed immediately to the */\n\t\t/*main browswer process */\n\t}\n\n\t_int_setCells( srcCells ) {\n\n\t\tthis.cellel = [];\n\t\tfor( var y=0; y<this.rows; y++) {\n\t\t\t\tvar rowArray = [];\n\t\t\t\tfor( var x=0; x<this.cols; x++) {\n\t\t\t\t\tvar cell = {\n\t\t\t\t\t\ttxt: srcCells[ y ][ x ].txt,\n\t\t\t\t\t\tfg:  srcCells[ y ][ x ].fg,\n\t\t\t\t\t\tbg:  srcCells[ y ][ x ].bg\n\t\t\t\t\t}\n\t\t\t\t\trowArray.push( cell );\n\t\t\t\t}\n\t\t\t\tthis.cellel.push( rowArray );\n\t\t\t}\n\n\t\tthis.changes = { all: false, list: [] };\n\t}\n\n\n\tgetDimensions() {\n\t\t\treturn [this.cols, this.rows ];\n\t}\n\n\tgetCurrentLine() {\n\t\tvar y = this.y;\n\t\tvar str = \"\";\n\t\tfor( var i = 0; i< this.acols; i++) {\n\t\t\tvar xi = i + this.ax0;\n\t\t\tstr += this.cellel[ y ][ xi ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\tgetLineFrom( x0, y ) {\n\n\t\tvar str = \"\";\n\t\tvar x2 = this.acols + this.ax0 - 1;\n\n\t\tfor( var i = x0; i< x2; i++) {\n\t\t\tstr += this.cellel[ this.ay0 + y ][ i ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\t/* Commands and functions to modify the text area buffer */\n\n\n\tsetDefault( fg, bg ) {\n\t\tthis.defaultBG = bg;\n\t\tthis.defaultFG = fg;\n\n\t}\n\n\n\tcolorReset() {\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\t//this.cellel = [];\n\t\tvar fg = this.defaultFG;\n\t\tvar bg = this.defaultBG;\n\n\t\tfor( var ay=0; ay<this.rows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = ay;\n\t\t\tfor( var ax=0; ax<this.cols; ax++) {\n\n\t\t\t\tvar x = ax;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x];\n\n\t\t\t\tcell.fg = fg;\n\t\t\t\tcell.bg = bg;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis._int_flushAll();\n\t}\n\n\treset() {\n\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.pokeFlush = true;\n\t\tthis.clear();\n\n\t}\n\n\ttextArea( w, h, xo, yo ) {\n\t\tvar divx = this.cols - w;\n\t\tvar divy = this.rows - h;\n\n\t\tif( xo < 0 ) {\n\t\t\t\tthis.ax0 = Math.floor(divx / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ax0 = xo;\n\t\t}\n\n\t\tif( yo < 0 ) {\n\t\t\t\tthis.ay0 = Math.floor(divy / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ay0 = yo;\n\t\t}\n\n\t\tthis.acols = w;\n\t\tthis.arows = h;\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\t}\n\n\tclear() {\n\n\t\t//this.cellel = [];\n\t\tfor( var ay=0; ay<this.arows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = this.ay0 + ay;\n\t\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\t\tvar x = this.ax0 + ax;\n\n\t\t\t\tvar cell = {\n\t\t\t\t\ttxt: \" \",\n\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t}\n\t\t\t\tthis.cellel[ y ][ x] = cell;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\n\t\tthis._int_flushAll();\n\t}\n\n\n\tjumpTo( destination ) {\n\t\tif( destination == \"home\" ) {\n\t\t\tthis.y = this.ay0;\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\tif( destination == \"end\" ) {\n\t\t\tthis.y = this.ay0 + this.arows - 1;\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"line-start\" ) {\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\telse if( destination == \"line-end\" ) {\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"text-end\" ) {\n\n\t\t\t/* where is the last char -> maxX */\n\t\t\tvar c = \"DC\";\n\t\t\tvar oldx = this.x;\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\n\t\t\tvar maxX = this.x;\n\t\t\t/*-reset, and jump to end of next text area-*/\n\t\t\tthis.x = oldx;\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x< ((this.ax0 + this.acols)-1) && c != \" \") {\n\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\n\n\t\t\t/*make sure we did not jump past last char*/\n\t\t\tif( this.x > maxX ) {\n\t\t\t\tthis.x = maxX;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-end-all\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-start\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x> this.ax0 && c != \" \") {\n\t\t\t\t\t\tthis.x--;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\t\t}\n\n\t\tthis._int_flush();\n\t}\n\n\tcursorMove( dir ) {\n\t\tif( dir == \"up\" ) {\n\t\t\tif( this.y>this.ay0) {\n\t\t\t\tthis.y--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"down\" ) {\n\t\t\tif( this.y< ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.y++;\n\t\t\t}\n\t\t\telse if( this.y== ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t}\n\t\tif( dir == \"left\" ) {\n\t\t\tif( this.x>this.ax0) {\n\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"right\" ) {\n\t\t\tif( this.x< ((this.ax0 + this.acols)-1)) {\n\t\t\t\tthis.x++;\n\t\t\t}\n\t\t}\n\t\tthis._int_flush();\n\t}\n\n\tbackspace() {\n\t\tif( this.x != this.ax0 ) {\n\t\t\t\tthis.x--;\n\t\t}\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tdelete() {\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tnl() {\n\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\n\t\t\tif( ya >= this.arows ) {\n\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\n\t\t\t\tthis._int_flushAll();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_nl() {\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\t\t\tif( ya >= this.arows ) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\t\t\t\treturn { scroll: true }\n\t\t\t}\n\t\t\treturn { scroll: false }\n\n\t}\n\n\twriteln( str ) {\n\n\t\t\tfor( var i=0; i<str.length; i++) {\n\t\t\t\tvar c = str.substr(i,1);\n\t\t\t\tthis.__int_write_direct_ch( c );\n\t\t\t}\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t\tthis._int_flush();\n\t}\n\n\t_int_write( str, insert ) {\n\t\tfor (const c of str) {\n\t\t\tthis.__int_write_direct_ch( c, insert );\n\t\t}\n\t}\n\n\twrite( str ) {\n\t\t\tthis._int_write( str );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\tinsert( str ) {\n\t\t\tthis._int_write( str, true );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\n\n\t__int_scrollLinesDownFrom( y  ) {\n\n\t\t\tfor( var yy=this.rows-1; yy>y; yy-- ) {\n\t\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\t\tvar cell1 = this.cellel[ yy-1  ][ xx ];\n\t\t\t\t\tvar cell2 = this.cellel[ yy  ]  [ xx];\n\n\t\t\t\t\tcell2.fg = cell1.fg;\n\t\t\t\t\tcell2.bg = cell1.bg;\n\t\t\t\t\tcell2.txt = cell1.txt;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\tvar cell1 = this.cellel[ yy  ][ xx ];\n\n\t\t\t\tcell1.txt = \" \";\n\n\t\t\t}\n\n\t\t\tthis._int_addChangeAll();\n\n\t}\n\n\n\tScrollDownByCurrentLine() {\n\n\t\tif( (this.y ) < (this.rows-1) ) {\n\t\t\tthis.__int_scrollLinesDownFrom( this.y );\n\t\t\tthis._int_flush();\n\t\t}\n\t}\n\n\t__int_scrollLineRightFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x1; i>x0; i--) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i-1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\t}\n\n\t__int_scrollLineLeftFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x0; i<x1; i++) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i +1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\n\n\t}\n\n\t__int_write_direct_ch( ch, insert ) {\n\n\t\tvar code = ch.codePointAt(0);\n\n\t\tif( this.dc && this.dcCmd ) {\n\n\t\t\tthis.dc = false;\n\t\t\tthis.dcCmd = false;\n\t\t\tthis._int_control( this.dcCmdCode, code );\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( this.dc && !this.dcCmd ) {\n\t\t\tthis.dcCmd = true;\n\t\t\tthis.dcCmdCode = code;\n\t\t\treturn;\n\t\t}\n\n\t\tif( code == 17 ) {\n\t\t\t//DC1\n\t\t\tthis.dc = true;\n\t\t\tthis.dcCmd = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar cell = this.cellel[ this.y ][ this.x ];\n\n\t\tif( cell == null ) {\n\t\t\tconsole.log( \"cell at \" + this.x + \",\" + this.y +\" == null \");\n\t\t\treturn;\n\t\t}\n\n\t\tvar area;\n\n\t\tif( insert ) {\n\t\t\tthis.__int_scrollLineRightFrom( this.x, this.y );\n\n\t\t\tarea = this._int_getArea( this.x, this.y, this.ax0 + this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\n\t\t}\n\n\t\tcell.txt = ch;\n\n\t\tif( !this.reverse  ) {\n\t\t\tcell.fg = this.colors.txtColor;\n\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t}\n\t\telse {\n\t\t\tcell.bg = this.colors.txtColor;\n\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t}\n\n\t\tvar oldx = this.x;\n\t\tvar oldy = this.y;\n\n\t\tthis.x++;\n\t\tvar ax = this.x - this.ax0;\n\t\tif( ax > (this.acols-1) ) {\n\t\t\tthis.x = this.ax0;\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tarea = this._int_getArea( oldx, oldy, oldx, oldy );\n\t\tthis._int_addChange( area );\n\t\t//this._int_addChangeAll();\n\n\t}\n\n\twritec( chr ) {\n\n\t\tif( chr == \"\\n\" ) {\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tthis.__int_write_direct_ch( chr );\n\t\tthis._int_flush();\n\t}\n\n\n\tsetFilter( f ) {\n\t\tthis.sys.post( \"gfilter\", { d: f }  );\n\t}\n\n\t_int_control( chr, data ) {\n\n\t\tif( chr == 16 ) {\n\t\t\tthis.colors.txtColor = data;\n\t\t}\n\t\telse if( chr == 17 ) {\n\t\t\tthis.colors.txtBgColor = data;\n\t\t}\n\t\telse if( chr == 18 ) {\n\t\t\tthis.sys.post( \"border\", { d: data }  );\n\t\t}\n\t\telse if( chr == 24 ) {  //CANCEL -> (we map it to) Clear Screen\n\t\t\tthis.clear();\n\t\t}\n\t\telse if( chr == 12 ) {  //FORMFEED -> (we map it to) RESET SCREEN\n\t\t\tthis.reset();\n\t\t}\n\t\telse if( chr == 25 ) {  //End of Medium -> (we map it to) Hide\n\t\t\t//this.hide();   TODO\n\t\t}\n\t\telse if( chr == 64 ) {\n\t\t\tthis.reverse = false;\n\t\t}\n\t\telse if( chr == 65 ) {\n\t\t\tthis.reverse = true;\n\t\t}\n\t\telse {\n\t\t\tthis.__int_write_direct_ch( \"?\" );\n\t\t}\n\t}\n\n\n\tsetPos( x, y ) {\n\n\t\tthis._int_setPos( x,y );\n\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorMode( mode ) {\n\t\tthis.cursorMode = mode;\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorPos( x, y ) {\n\t\tif( x<0 || y<0 ) { throw \"pos(\"+x+\",\"+y+\") < 0\" ; }\n\n\t\tif( x>=this.acols || y>= this.arows ) { throw \"pos(\"+x+\",\"+y+\") > max\" ; }\n\n\t\tif( ! ( x === undefined ) ) { this.x = x + this.ax0; }\n\t\tif( ! ( y === undefined ) ) { this.y = y + this.ay0; }\n\n\n\t\tthis._int_flush();\n\t}\n\n\tgetCursorPos() {\n\t\t\treturn [this.x - this.ax0, this.y - this.ay0 ];\n\t}\n\n\tcontrol( chr, data ) {\n\n\t\tthis._int_control( chr, data );\n\t\tthis._int_flush();\n\n\t}\n\n\n\t_int_setPos( x, y ) {\n\n\t\tif(x >= 0) {\n\t\t\t\tthis.x = x + this.ax0;\n\t\t\t\tif( (this.x - this.ax0) >= this.acols ) { this.x = this.acols-1;}\n\t\t}\n\t\tif(y >= 0) {\n\t\t\t\tthis.y = y + this.ay0;\n\t\t\t\tif( (this.y - this.ay0)>= this.arows ) { this.y = this.arows-1;}\n\t\t}\n\n\t\t\n\t\t\n\t}\n\n\tcenter( str, inhibitNewLine ) {\n\n\t\t\tif( str.length > this.cols ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar l = str.length;\n\t\t\tvar l2 = l/2;\n\n\t\t\tvar wh = [ this.acols, this.arows ];\n\n\t\t\tvar x = Math.floor( (wh[0] / 2)-l2 );\n\t\t\tthis._int_setPos( x, -1 );\n\t\t\tthis._int_write( str );\n\n\t\t\tif( !inhibitNewLine ) {\n\n\t\t\t\tvar stat = this.__int_nl();\n\t\t\t\tif( stat.scroll ) {\n\t\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\t\t\t\n\t\t\tvar area = this._int_getArea( this.ax0, this.y, this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_scrollDown() {\n\n\t\tvar ax0 = this.ax0;\n\t\tvar ay0 = this.ay0;\n\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\t\t\tfor( var ay=0; ay<this.arows-1; ay++) {\n\n\t\t\t\tvar y = ay + ay0;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x ];\n\t\t\t\tvar cellyp1 = this.cellel[ y+1 ][ x ];\n\n\t\t\t\tcell.txt = cellyp1.txt;\n\t\t\t\tcell.fg = cellyp1.fg;\n\t\t\t\tcell.bg = cellyp1.bg;\n\t\t\t}\n\t\t}\n\n\t\t//fill last row\n\t\tvar y2 = ay0 + (this.arows-1);\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\n\t\t\tvar cell = this.cellel[ y2 ][ x ];\n\t\t\tcell.txt = \" \";\n\t\t\tif( !this.reverse  ) {\n\t\t\t\tcell.fg = this.colors.txtColor;\n\t\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t\t\tcell.bg = this.colors.txtColor;\n\t\t\t}\n\t\t}\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/playfields.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n\nclass Playfields {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\n\t\tthis.current = 0;\n\t\tthis.enabledFlag = false;\n\t\tthis.list = null;\n  \t}\n\n  \tenable( flag )  {\n  \t\tthis.enabledFlag = flag;\n  \t}\n\n  \tset( list )  {\n  \t\tthis.list = list;\n  \t}\n\n  \tenabled() {\n  \t\treturn this.enabledFlag;\n  \t}\n\n  \tsetEnable( pid, ix, flag ) {\n\t\tthis.sys.post( \"pfenable\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tflag: flag\n\t\t\t}  );\t  \t\t\n  \t}\n\n\n\tselect( pid, ix ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfselect\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix\n\t\t\t}  );\t\t\n\n\t\tthis.current = ix;\n\t}\n\n\n\tscrollpos( pid, ix, x, y ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfscrollpos\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t}  );\t\t\n\n\t}\n\t\n\n\tviewdefine( pid, ix, x, y, w, h ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfviewsize\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\tw: w,\n\t\t\t\th: h\n\t\t\t}  );\t\t\n\n\t}\n\n\tinit( pid, pfIx, bcwC, brhC ) {\n\n\t\t/* If current we also need to update our \n\t\t\tworker text area buffers when done */\n\n\t\tthis.sys.post( \"pfinit\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: pfIx,\n\t\t\t\tbcwC: bcwC, brhC: brhC,\n\t\t\t\tfgColor: 1, bgColor: 0\n\t\t\t}  );\n\t}\n\n\told_init( pid, pfIx, xo, yo, cwC, rhC, bcwC, brhC ) {\n\n\n\t\t/* If current we also need to update our \n\t\t\tworker text area buffers when done */\n\n\t\tthis.sys.post( \"pfinit\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: pfIx,\n\t\t\t\tisCurrentIx: this.current == pfIx,\n\t\t\t\txo: xo, yo: yo,\n\t\t\t\tcC: cwC, rC: rhC,\n\t\t\t\tbcwC: bcwC, brhC: brhC,\n\t\t\t\tfgColor: 1, bgColor: 0\n\t\t\t}  );\n\t}\n\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/bitmap.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n\nclass BitMap {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n    this.lineColor = 1;\n    this.changes = {};\n    this.changes.flag = false;\n    this.changes.pixels = [];\n\n\t\tthis.origin( 0,0,1,1);\n  }\n\n\n\torigin( ox0, oy0, odx, ody ) {\n\t\tthis.ox0 = ox0;\n\t\tthis.oy0 = oy0;\n\t\tthis.odx = odx;\n\t\tthis.ody = ody;\n\n\t\tvar dir = [\"m\",undefined,\"p\"];\n\t\tvar xdir = \"x\" + dir[ odx + 1 ];\n\t\tvar ydir = \"y\" + dir[ ody + 1 ];\n\t\tvar direction = xdir + ydir;\n\n\t\tthis[\"_int_convertxy\"] = this.getConvertFunc( direction );\n\n\t}\n\n\treInit( w, h ) {\n\t\tthis.width = w;\n    this.height = h;\n\t}\n\n  attach( w, h ) {\n\t\tthis.reInit( w, h );\n\t}\n\n  isActive() {\n    return this.width > 0;\n  }\n\n  getDimensions() {\n\t\t\treturn [this.width, this.height ];\n\t}\n\n  triggerFlush() {\n\n\t\tif( !this.changes.flag ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sys.post( \"gfxupdate\",\n\t\t\t{\n\t\t\t\tpixels: this.changes.pixels\n\t\t\t}\n\t\t);\n\n\t\tthis.changes.pixels = [];\n\t\tthis.changes.flag = false;\n\n  }\n\n  _int_flush() {\n\n    if( this.changes.flag ) {\n\n      this.sys.post( \"gfxupdate\",\n        {\n          pixels: this.changes.pixels\n        }\n      );\n\n\t\t\tthis.changes.pixels = [];\n\t\t\tthis.changes.flag = false;\n    }\n\n  }\n\n\tsetLineColor( c ) {\n    this.lineColor = c;\n    this.sys.post( \"nativeout\",{\n      action: \"gcolor\",\n      params: { c: c }\n    });\n  }\n\n\n\tsetFillColor( c ) {\n    this.fillColor = c;\n    this.sys.post( \"nativeout\",{\n      action: \"fcolor\",\n      params: { c: c }\n    });\n  }\n\n\tgetConvertFunc( direction ) {\n\t\tvar __this = this;\n\t\tif( direction == \"xpyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + __this.ox0), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xpym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t}\n\n/*\n\t_int_convertxy_xpyp( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor(y + this.oy0)];\n\t}\n\n\t_int_convertxy_xpym( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y )];\n\t}\n\n\t_int_convertxy_xmyp( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( y + this.oy0)];\n\t}\n\n\t_int_convertxy_xmym( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( this.oy0 - y )];\n\t}\n*/\n\n  plot( x, y ) {\n\t\tvar xy2 = this._int_convertxy( x, y );\n\n    var pixel = { x: xy2[0], y: xy2[1], c:this.lineColor };\n\n    this.changes.pixels.push( pixel );\n    this.changes.flag = true;\n\n  }\n\n\tline( x0,y0, x1, y1 ) {\n\n\t\tvar xy0 = this._int_convertxy( x0, y0 );\n\t\tvar xy1 = this._int_convertxy( x1, y1 );\n\n    this.sys.post( \"nativeout\",{\n      action: \"line\",\n      params: { x0:xy0[0], y0:xy0[1], x1:xy1[0], y1:xy1[1] }\n    });\n  }\n\n  fillRect( x,y, w, h ) {\n\n\t\tvar xy = this._int_convertxy( x, y );\n\n\n    this.sys.post( \"nativeout\",{\n      action: \"fillRect\",\n      params: { x:xy[0], y:xy[1], w:w, h }\n    });\n  }\n\n\tdestroy() {\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/audio.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n\nclass Audio {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.userInput = false;\n  }\n\n\tflagUserInput() {\n\t\tthis.userInput = true;\n\t}\n\n  playBeep( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playBeep\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tplaySound( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playSound\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tvolume( volume ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"setVolume\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: volume\n\t\t}\n\t\t);\n\t}\n\n\treset() {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t\t{\n\t\t\t\t\t\tmethod: \"reset\",\n\t\t\t\t\t\tparCount: 0\n\t\t\t}\n\t\t\t);\n\n\t}\n\n\tattackDecayRelease( channel, attackT, decayT, releaseT ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetAttackDecayRelease\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: attackT,\n\t\t\t\t\tp3: decayT,\n\t\t\t\t\tp4: releaseT\n\t\t}\n\t\t);\n\t}\n\n\tchannelVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelVolume\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\tchannelFrequency( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelFrequency\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\n\tchannelSustainVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetSustainLevel\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\taddEffect( channel,  type , value, time ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"addEffect\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: type,\n\t\t\t\t\tp3: value,\n\t\t\t\t\tp4: time\n\t\t}\n\t\t);\n  }\n\n  clearEffect( channel ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"clearEffect\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: channel\n\t\t}\n\t\t);\n\n  }\n\n\tplayEffect( channel, freq ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"playEffect\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: freq\n\t\t}\n\t\t);\n\n\t}\n\n}\n\n//--EOC \n\n// ## workerbootstrap_static.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/workerbootstrap_static.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/workerbootstrap_static.js\n\nsys.log(\"Starting\");\nstart_sys();\n\n//--EOC \n\n"],"names":["sys","appName","unique","console","post","type","message","postMessage","log","args","Array","prototype","slice","call","arguments","args2","i","length","push","JSON","stringify","logerr","load","rt","path","device","processId","loaddata","label","save","data","delete","dir","setcfg","cfg","this","listfs","poststatus","procId","status","setfs","fs","setDisplayMode","m","blinkMode","html","executeFunction","htmlnode","get","wait_for_result","export","code","destination","signalHideMenu","flag","hide","init_sys","BasicArray","constructor","name","indices","defaultValue","buffer","getIndexCount","_check","detail","set","val","ptr","last","undefined","ErrorHandler","newError","clazz","context","lineNr","throwError","fromSimpleExternalError","s","lineNr0","parts","split","err","extCode0","extCode1","fromSerializedError","isSerializedError","substr","e","startsWith","isError","Object","toString","clss","Editor","output","out","keyMode","addRunTime","runTime","keyHandlerForCLE","keyLabel","shiftKey","ScrollDownByCurrentLine","backspace","ctrlKey","cursorMove","jumpTo","clear","insert","write","setCursorMode","key","command","getCurrentLine","writeln","executeInteractiveLine","interactiveKeyHandler","BasicRuntime","editor","debugFlag","listSpeed","bitmap","bout","playfields","pfields","input","audio","setHandler","setInterActive","menuEnable","program","runFlag","isWaitingFlag","waitingTime","waitForMessageFlag","waitForMessageVariable","executeLineFlag","goPlayExampleFlag","inputFlag","inputCommand","listFlag","immersiveFlag","statusChanged","gosubReturn","nullTime","Date","getTime","turboMode","cmdCountPerCycleDefault","cmdCountPerCycleTurbo","cmdCountPerCycle","commands","BasicCommands","extendedcommands","ExtendedCommands","erh","vars","functions","loadedData","default","loadedLabel","kbBuffer","yPos","SHORTLINE","LONGLINESTART","LONGLINEEND","forContext","outputCallBacksAll","lineOverFlow","method","scroll","clearScreen","outputCallBacksClScr","synchClock","exitMode","code2colMap","km","symbolTable","up","down","left","right","black","white","red","cyan","purple","green","blue","yellow","orange","brown","pink","grey1","grey2","grey3","backmap","mapInfo","entries","symbolTableBM","flagStatusChange","clearInputCommand","flagInputCommand","setWaiting","time","clearWaiting","getScopeVars","getFullVarList","scopes","getFullScopes","varList","si","fullscope","scope","names","getOwnPropertyNames","value","descr","ii","endsWith","cpuNeeded","getStatus","runPointer","vlen","getVars","pgmLen","varLen","displayMode","startWaitForMessage","start","autoStartAfterLoad","path0","getProgramAsText","deleteFile","variable","keyInterrupt","_type","_data","interrupt","_ix","interruptFlag0","interruptFlag1","line","useLabel","handlers","interrupt0","interrupt0ParamIsLabel","interrupt1","interrupt1ParamIsLabel","newScope","runPointer2","variables","setVar","toUpperCase","pgm","len","found","labels","receiveMessage","_message","reInit","textW","textH","bitmapW","bitmapH","mode","enable","pfEnabled","cells","printError","reason","pgmData","ok","bootPGM","control","runPGM","stop","insertData","isRunning","list","title","files","fname","enterListMode","currentFs","str","deviceNumberLen","stopAfterMessage","HandleStopped","printReady","runStop","listStop","cxy","getCursorPos","string","getLineFrom","inputStartInputPosX","handleLineInput","x","xy","setCursorPos","toggleMenu","startingProgram","flush","importPGMHandler","content","filename","textLinesToBas","fileName","setProgram","exitProgram","closeWindow","windowId","listPointer","printLine","listFlagBakInteractive","getInterActive","setExitMode","v","nullClock","setHours","setSeconds","setMinutes","setMilliseconds","setTurbo","on","appendProgram","exists","j","sort","a","b","getProgram","getProgramState","setProgramState","pgmState","_setByteBits","bits","byte","_getByteBits","masks","results","upperFirst","supressLine","explicitline","line1","onLineStr","printInfo","printHelp","reverseOn","print","colorReset","colors","setDefault","fg","bg","border","resetConsole","getDimensions","reset","setPos","getMillis","getJiffyTime","millis","Math","floor","hours","minutes","hard","muteReady","writel","clrPGM","compressPGMText","pgmTxt","p","Parser","init","kws","getKeyWordCodes","txt2","kw","replaceAll","toLowerCase","String","fromCharCode","getProgramAsTextNoPETSCII","text","l","prepareLineForExportNoPETSCII","trim","getProgramSize","controlKW","prepareLineForExport","txt0","txt","dst","c","charCodeAt","symdef","charAt","src","str1","str2","rv","indexOf","replace","rebuildNoPETSCIILineString","raw","noPetsciiLine","parseLine","toLower","cc","prevCharIsQuote","nextCharIsQuote","dst2","ResolveStringSymbolToCode","prepareLineForImport","num","parseInt","getProgramLines","padZeros2","evalExpressionPart","parseFloat","PI","varIntName","arr","ai","evalExpression","values","params","par","ecommands","cmds","nFunName","functionName","stc","fName","parValue","restore","functRecord","expr","op","pow","negate","binaryNegate","exitInputState","cycle","cmdCount","lineNumber","isActive","triggerFlush","changeCount","countdown","listCodeLine","bf","runCommands","traceVars","tvi","thisVar","thisValue","oldValue","traceOldValues","traceList","af","executedCount","retreiveRuntimeLine","pi","procIf","cstate","STATE_CLI","STATE_WAITING","STATE_INPUT","STATE_RUNNING","doReturn","oldPointers","pop","doInterruptReturn","closeScope","gosub","line0","retLine","retCmd","goto","startAsGoto","isListing","isInput","isReady","getDataBlocks","readData","dataPointer","result","getDataLength","setData","label0","typeParts","parseSimpleDataI_CSV","toArr","data2","parseSimpleDataS_CSV","parseSimpleDataS_LINES","printChar","rawLine","rebuildLineString","nr","removePadding","renumbering","addSmartPadding","shortenKeywords","newString","tokens","getTokens","nopadTokens","foundGoto","foundGotoParIndex","newLine","lineIsData","lineIsRem","lineIsSub","renumberProgram","gap","newLineNr","lineNumbers","newLineNr2","ceil","lRec","PETSCIIreplace","keywordCompress","compressProgram","normalizeProgram","restoreDataPtr","normalizeData","dataRec","bak1","bak2","normalize","k","doForInit","from","to","step","varName","cmdPointer","cmdArrayLen","linePointersLen","ctx","ctxv","doForNext","nextVarName","retreiveLine","parseLineNumber","commandToString","cmd","statementName","var","limit","TERMINATE_W_JUMP","end","cnt","cn","onCommand","onExpr","onLineNrs","jump","nextVar","ix","arrRec","arrayNames","pardefs","mycommands","enabled","varType0","varType","arrayAssignment","expression","getArray","getTraceList","setTraceVar","resetTraceVar","old","oldProgram","new","removePgmLine","linenr","pgm2","pl","padSpaces6","no","padSpaces8","insertPgmLine","insertPgmLineLocal","myProgram","lines","exception","parseErrorLine","startConsoleDataInput","inputVars","inputVarsPointer","isInputCommand","qMark","isNaN","basicCmds","runtime","func","statementList","getStatements","stats","stats2","getFunctions","getAllCategories","categoryIndexes","getCategories","categoryIndexes2","CommandHelp","getCategoriesNormalize","getCategoriesIntermediate","_stat_info_help","_stat_help","pars","catRecord","lst","catLists","hlpctx","lbl","attr","attribs","padLen","pad","description","_if_cls","_stat_info_cls","_stat_cls","_stat_info_reset","_stat_reset","_stat_info_menu","_stat_menu","_stat_info_reverse","_stat_reverse","reverse","_stat_info_beep","_stat_beep","playBeep","_stat_info_sound","_stat_sound","playSound","_stat_info_setadr","_stat_setadr","attackDecayRelease","_stat_info_volume","_stat_volume","volume","_stat_info_chfreq","_stat_chfreq","channelFrequency","_stat_info_chvolume","_stat_chvolume","channelVolume","_stat_info_chsvolume","_stat_chsvolume","channelSustainVolume","_stat_info_addfx","_stat_addfx","addEffect","_stat_info_clearfx","_stat_clearfx","clearEffect","_stat_info_playfx","_stat_playfx","freq","playEffect","_stat_info_textarea","_stat_textarea","cols","round","rows","wh","xo","yo","divx","divy","textArea","_stat_info_gcolor","_stat_gcolor","col","setLineColor","_stat_info_fcolor","_stat_fcolor","setFillColor","_stat_info_origin","_stat_origin","origin","_stat_info_line","_stat_line","_stat_info_box","_stat_box","fillRect","_stat_info_plot","_stat_plot","plot","_if_center","isNumber","isFinite","normalizeIfNumber","_stat_info_center","_stat_center","con","exparts","exparts2","center","nl","_stat_info_gtext","_stat_gtext","gtext","_stat_info_immediate","_stat_immediate","setPokeFlush","_stat_info_pokeccl","_stat_pokeccl","pokeccl","_stat_info_pokec","_stat_pokec","pokec","_stat_info_pokecl","_stat_pokecl","pokecl","_stat_info_pokebcl","_stat_pokebcl","_int_checkPlayfieldNo","_stat_info_pfinit","_stat_pfinit","_stat_info_playfield","_stat_playfield","select","_stat_info_pfscroll","_stat_pfscroll","scrollpos","_stat_info_pfview","_stat_pfview","viewdefine","_stat_info_pfenable","_stat_pfenable","setEnable","_stat_info_locate","_stat_locate","row","_stat_info_hide","_stat_hide","_if_html","_stat_info_html","_stat_html","handleIx","htmlHandle","htmlValue","htmlAppend","_stat_info_htmlnode","_stat_htmlnode","node","_stat_info_htmlbg","_stat_htmlbg","url","_stat_info_color","_stat_color","bgcol","_stat_info_display","_stat_display","modes","screenModes","_stat_info_gfilter","_stat_gfilter","filter","setFilter","_stat_info_border","_stat_border","bcol","_stat_info_export","_stat_export","_stat_info_copy","_stat_copy","_stat_info_txtcopy","_stat_txtcopy","_fun_info_peekcl","_fun_peekcl","peekcl","_fun_info_peekc","_fun_peekc","peekc","_fun_info_ucbase","_fun_ucbase","baseLabel","_fun_info_uc_DLR_","_fun_uc_DLR_","fromCodePoint","_fun_info_dc_DLR_","_fun_dc_DLR_","_fun_info_html_DLR_","_fun_html_DLR_","_fun_info_width","_fun_width","_fun_info_height","_fun_height","_fun_info_cols","_fun_cols","_fun_info_columns","_fun_columns","_fun_info_rows","_fun_rows","pgmman","addRuntime","keyLabelCodes","randnrs","random","randIndex","randStep","_stat_info_new","_stat_new","_stat_info_list","_stat_list","_if_get","_if_getkey","_if_read","_if_input","_if_list","_if_run","_stat_info_read","_stat_read","p0","_stat_info_get","_stat_get","getKey","_stat_info_getkey","_stat_getkey","_stat_info_input","_stat_input","_stat_info_restore","_stat_restore","_stat_info_waitms","_stat_waitms","_stat_info_load","_stat_load","aSync","_stat_info_setdata","_stat_setdata","_stat_info_datablocks","_stat_datablocks","_stat_info_loaddata","_stat_loaddata","_stat_info_dir","_stat_dir","_stat_info_fs","_stat_fs","_stat_info_renumber","_stat_renumber","_stat_info_vars","_stat_vars","_stat_info_tracevar","_stat_tracevar","_stat_info_clrtracevar","_stat_clrtracevar","_stat_info_boot","_stat_boot","_stat_info_save","_stat_save","_stat_info_delete","_stat_delete","_stat_info_run","_stat_run","_if_print","_stat_info_print","_stat_print","_stat_info_clr","_stat_clr","_fun_info_datalen","_fun_datalen","_fun_info_chr_DLR_","_fun_chr_DLR_","_fun_info_str_DLR_","_fun_str_DLR_","number","base","numberStr","_fun_info_abs","_fun_abs","_fun_info_len","_fun_len","_fun_info_asc","_fun_asc","_fun_info_val","_fun_val","_fun_info_hex2dec","_fun_hex2dec","_fun_info_hex_DLR_","_fun_hex_DLR_","_fun_info_exp","_fun_exp","exp","intGetNextRand","intSeedRand","x0","year","day","d","seedModifier","_fun_info_pad_DLR_","_fun_pad_DLR_","ch","dest","toPad","_fun_info_rnd","_fun_rnd","_fun_info_sqr","_fun_sqr","sqrt","_fun_info_log","_fun_log","_fun_info_pos","_fun_pos","getLinePos","_fun_info_left_DLR_","_fun_left_DLR_","_fun_info_right_DLR_","_fun_right_DLR_","_fun_info_mid_DLR_","_fun_mid_DLR_","_fun_info_sin","_fun_sin","sin","_fun_info_tri","_fun_tri","abs","_fun_info_saw","_fun_saw","_fun_info_tan","_fun_tan","tan","_fun_info_atn","_fun_atn","atan","_fun_info_cos","_fun_cos","cos","_fun_info_spc","_fun_spc","_max","_fun_info_int","_fun_int","_fun_info_range","_fun_range","min","max","_fun_info_tab","_fun_tab","_fun_info_sgn","_fun_sgn","_fun_info_millis","_fun_millis","_fun_info_jiffies","_fun_jiffies","ecmds","CTRL_KW","SHORTCUT_KW","KEYWORDS","more","screenCodes2CTRLTable","tab","KWCODES","padArray","missing","clazz2","upperCaseNameTokens","token","tokens2","mergeCompTokens","token2","mergeBrokenUpTokens","splits","p1","p2","p3","whole","r","mergeTokenRange","record","tokens3","parseFunParList","even","endTokens","parseBoolExpression","shift","peekIfNextIsOpenBracket","parseSubExpression","tokensToString","endTokensToString","endTokenArray","et","endToken","isEndToken","endTokenArry","parseSimpleExpression","endLoop","returnValue","pair","endTokens0","first","eList","parseExpression","opData","dbg","dbg2","retExpr","newParts","part","unshift","subEndTokens","isUserDefinedFunctionCall","parameters","subExpression","groupParts","oldExpression","parts0","parts1","parts2","prevPart","subExpr","normalizeStatementName","parseAssignment","preTokens","nameToken","token0","parseArrayAssignment","parseControlStructure","controlToken","expr_fn","nums","onInterrupt","num0","onType","labelFlag","expr_from","expr_to","expr_step","explicit","nextcommand","expr1","block","parseLineCommands","bi","dataArray","parseStatementCall","endCommand","keyword","oken","logTokens","tokensStr","tok","Tokenizer","StringReader","tokenize","lineRest","errContext","lineRecord","toker","merge","noPadding","strIn","index","lineIndex","peek","peek2","unconsume","consume","EOF","reader","keywords","greedy","isOpChar","match","isCompChar","isEqChar","isNameChar","endFound","prev","seq","isNumChar","isPadChar","isCommandSepChar","isSepChar","isAnyChar","isBracket","isStrChar","inString","normalizeToken","tok0","readChars","read","type0","compareF","tokenType","parseRules","tokenFound","rule","categoryIndexesInt","funs","cat","f_attribs","catlabel","rname","processes","STATE_NULL","STATE_LASTSTATE","_this","idlerInterval","runInterval","waitTimeOut","lastState","state","avgIdlerTime","flags","pstate","update","wtime","changeState","newState","killRuntimeInterval","startWaitingTimeOut","killWaitingTimeOut","startRuntimeInterval","idlerFunction","m1","running","stat","m3","runningFunction","waitingFunction","startIdlerInterval","setInterval","cpu","iv","clearInterval","t","setTimeout","clearTimeout","getTicks","count","id","register","obj","newId","getRoot","keyPress","interactive","hc","handlerClazz","inputKeyHandler","cursorOn","y","hidden","dc","dcCmd","defaultFG","defaultBG","txtBgColor","txtColor","initialized","changes","all","pokeFlush","w","h","_int_initMode","_int_setCells","destroy","cellel","_int_addChangeAll","_int_addChange","area","clist","lc","nc","y1","y2","x1","x2","changesTargetArray","cell","_int_flushAll","_int_flush","_int_getArea","cx","cy","cursorMode","areasList","attach","codePointAt","rowArray","srcCells","acols","xi","ax0","ay0","ay","ax","arows","oldx","maxX","__int_scrollDown","__int_scrollLineLeftFrom","__int_nl","__int_write_direct_ch","_int_write","__int_scrollLinesDownFrom","yy","xx","cell1","cell2","__int_scrollLineRightFrom","_int_control","dcCmdCode","oldy","writec","chr","f","_int_setPos","inhibitNewLine","l2","cellyp1","lineColor","pixels","ox0","oy0","odx","ody","direction","getConvertFunc","width","height","action","fillColor","__this","xy2","_int_convertxy","pixel","y0","xy0","xy1","current","enabledFlag","pid","pfIx","bcwC","brhC","fgColor","bgColor","old_init","cwC","rhC","isCurrentIx","cC","rC","userInput","flagUserInput","channel","frequency","parCount","attackT","decayT","releaseT","p4","rootProcId","self","onmessage","messageObject","sub","QPath","windowWidth","windowHeight","blockList"],"sourceRoot":""}