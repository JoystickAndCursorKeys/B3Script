{"version":3,"file":"basicworker.js","mappings":"MAyBA,IAAIA,EAAM,CACRC,QAAS,UACTC,OAAQ,GAIVC,QAAUH,EAIV,WAEE,SAASI,EAAMC,EAAMC,GACnBC,YAAa,CAAEF,KAAMA,EAAMC,QAASA,GACtC,CAEAN,EAAII,KAAOA,EAEXJ,EAAIQ,IAAM,WAKN,IAHA,IAAIC,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WAClCC,EAAQ,GAEHC,EAAE,EAAGA,EAAEP,EAAKQ,OAASD,IAC5BD,EAAMG,KAAMC,KAAKC,UAAWX,EAAMO,KAEpCZ,EAAK,SAASW,EAElB,EAEAf,EAAIqB,OAAS,WAET,IAAIZ,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WACtCV,EAAK,SAASK,EAElB,EAEAT,EAAIsB,KAAO,SAAUC,EAAIC,EAAMC,GAE3BrB,EAAK,OAAQ,CAAEsB,UAAWH,EAAGG,UAAWF,KAAKA,EAAMC,OAAQA,GAE/D,EAEAzB,EAAI2B,SAAW,SAAUJ,EAAIC,EAAMnB,EAAMuB,GAErCxB,EAAK,WAAY,CAAEsB,UAAWH,EAAGG,UAAWF,KAAKA,EAAMnB,KAAMA,EAAMuB,MAAOA,GAE9E,EAEA5B,EAAI6B,KAAO,SAAUN,EAAIC,EAAMC,EAAQK,GAEnC1B,EAAK,OAAQ,CAAEsB,UAAWH,EAAGG,UAAWF,KAAKA,EAAMC,OAAQA,EAASK,KAAMA,GAE9E,EAEA9B,EAAI+B,OAAS,SAAUR,EAAIC,EAAMC,GAE7BrB,EAAK,SAAU,CAAEsB,UAAWH,EAAGG,UAAWF,KAAKA,EAAMC,OAAQA,GAEjE,EAEAzB,EAAIgC,IAAM,SAAUT,EAAIC,EAAMC,GAE1BrB,EAAK,MAAO,CAAEsB,UAAWH,EAAGG,UAAWF,KAAKA,EAAMC,OAAQA,GAE9D,EAGAzB,EAAIiC,OAAS,SAAUC,GACnBC,KAAKD,IAAMA,CACf,EAEAlC,EAAIoC,OAAS,SAAUb,GAEnBnB,EAAK,SAAU,CAAEsB,UAAWH,EAAGG,WAEnC,EAEA1B,EAAIqC,iBAAmB,SAAUC,GAE/BlC,EAAK,QAAS,CAAEkC,OAAQA,GAE1B,EAEAtC,EAAIuC,WAAa,SAAUD,EAAQE,GAE/BpC,EAAK,SAAU,CAAEkC,OAAQA,EAAQE,OAAQA,GAE7C,EAEAxC,EAAIyC,MAAQ,SAAUlB,EAAIC,GAEtBW,KAAKO,GAAKlB,EACVpB,EAAK,QAAS,CAAEoB,KAAMA,EAAME,UAAWH,EAAGG,WAE9C,EAEA1B,EAAI2C,eAAiB,SAAUpB,EAAIqB,GACjCxC,EAAM,cAAe,CAAEsB,UAAWH,EAAGG,UAAWkB,EAAEA,GACpD,EAEA5C,EAAI6C,UAAY,SAAUD,GACxBxC,EAAM,YAAa,CAAEwC,EAAEA,GACzB,EAEA5C,EAAI8C,KAAO,CAAC,EAEZ9C,EAAI8C,KAAKC,gBAAkB,WAEvB,IAAItC,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WACtCV,EAAM,YAAYK,EAEtB,EAEAT,EAAI8C,KAAKA,KAAO,WAEZ,IAAIrC,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WACtCV,EAAM,OAAOK,EAEjB,EAEAT,EAAI8C,KAAKE,SAAW,WAElB,IAAIvC,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WACtCV,EAAM,WAAWK,EAEnB,EAGAT,EAAI8C,KAAKG,IAAM,WAGb,OADA7C,EAAM,UAAWK,MACV,CAAEyC,iBAAiB,EAE5B,EAEAlD,EAAImD,OAAS,SAAUC,EAAMC,GAC3BjD,EAAM,SAAU,CAAEgD,KAAMA,EAAMC,YAAaA,GAC7C,EAEArD,EAAIsD,eAAiB,SAAUC,GAC7BnD,EAAM,iBAAkB,CAAEoD,KAAMD,GAClC,CAEF,CAqVAE,GASA,MAAOC,EAELC,YAAaC,EAAMC,EAASC,GAC1B3B,KAAKyB,KAAOA,EACZzB,KAAK0B,QAAUA,EACf1B,KAAK4B,OAAS,KACd5B,KAAK2B,aAAeA,CACtB,CAEAE,gBACE,OAAO7B,KAAK0B,QAAQ5C,MACtB,CAEAgD,OAAQJ,GACN,GAAIA,EAAQ5C,QAAUkB,KAAK0B,QAAQ5C,OACjC,KAAM,oDAAsDkB,KAAKyB,KAEnE,IAAK,IAAI5C,EAAE,EAAGA,EAAE6C,EAAQ5C,OAAQD,IAAK,CACnC,GAAK6C,EAAQ7C,GAAKmB,KAAK0B,QAAS7C,GAAK,CACnC,IAAIkD,EAAS,IAAO/B,KAAKyB,KAAO,IAAMC,EAAQ7C,GAAjC,oBAKb,MAJI6C,EAAQ5C,OAAS,IACnBiD,EAAS,IAAO/B,KAAKyB,KAAO,gBAAmBC,EAAQ7C,GAAK,kBAC5DkD,GAAU,wBAA0BlD,GAEhC,qCAAuCkD,CAC/C,CACK,GAAKL,EAAQ7C,GAAK,EACrB,KAAM,mDAAqDmB,KAAKyB,IAGpE,CACF,CAEAO,IAAKN,EAASO,GACZjC,KAAK8B,OAAQJ,GACM,MAAf1B,KAAK4B,SACP5B,KAAK4B,OAAS,IAIhB,IAFA,IAAIM,EAAMlC,KAAK4B,OACXO,EAAOT,EAAQ5C,OAAS,EACnBD,EAAE,EAAGA,GAAGsD,EAAMtD,IAEjBA,GAAKsD,EACPD,EAAKR,EAAS7C,IAAOoD,QAGOG,IAAvBF,EAAMR,EAAQ7C,MACjBqD,EAAKR,EAAS7C,IAAO,IAEvBqD,EAAMA,EAAKR,EAAS7C,IAG1B,CAEAiC,IAAKY,GAGH,GAFA1B,KAAK8B,OAAQJ,GAEM,MAAf1B,KAAK4B,OACP,OAAO5B,KAAK2B,aAId,IAFA,IAAIO,EAAMlC,KAAK4B,OACXO,EAAOT,EAAQ5C,OAAS,EACnBD,EAAE,EAAGA,GAAGsD,EAAMtD,IAAK,CAE1B,GAAIA,GAAKsD,EACP,OAAOD,EAAKR,EAAS7C,IAGrB,QAA4BuD,IAAvBF,EAAMR,EAAQ7C,IACjB,OAAOmB,KAAK2B,aAEdO,EAAMA,EAAKR,EAAS7C,GAExB,CACF,EAWF,MAAMwD,EAEJC,SAAUC,EAAOR,EAAQS,EAASC,GAChC,MAAO,CAAED,QAASA,EAASD,MAAOA,EAAOR,OAAQA,EAAQU,OAAQA,EACnE,CAEAC,WAAYH,EAAOR,EAAQS,EAASC,GAClC,MAAMzC,KAAKsC,SAAUC,EAAOR,EAAQS,EAASC,EAC/C,CAGAE,wBAAyBC,EAAGJ,EAASK,GAEnC,IAAIJ,EAASI,OACET,IAAXK,IACFA,GAAU,GAGZ,IAAIK,EAAQF,EAAEG,MAAM,KACpB,GAAqB,IAAhBD,EAAMhE,OAAX,CAIA,IAAIkE,EAAMhD,KAAKsC,SAAUQ,EAAM,GAAIA,EAAM,GAAIN,EAASC,GAKtD,OAHAO,EAAIC,SAAWH,EAAM,GACrBE,EAAIE,SAAWJ,EAAM,GAEdE,CAPP,CASF,CAEAG,oBAAqBP,EAAGJ,EAASK,GAE/B,IAAIJ,EAASI,EAIb,QAHeT,IAAXK,IACFA,GAAU,IAENzC,KAAKoD,kBAAmBR,GAC5B,OAAO5C,KAAKsC,SAAU,UAAW,KAAME,EAASC,GAElD,IAAIK,EAAQF,EAAES,OAAO,GAAGN,MAAM,KAC9B,OAAoB,GAAhBD,EAAMhE,OACCkB,KAAKsC,SAAUQ,EAAM,GAAI,KAAMN,EAASC,GAE5CzC,KAAKsC,SAAUQ,EAAM,GAAIA,EAAM,GAAIN,EAASC,EAErD,CAEAW,kBAAmBE,GACjB,MAAgB,iBAALA,GAGJA,EAAEC,WAAY,IACvB,CAEAC,QAASF,GACP,GAA4C,oBAAxCG,OAAOjF,UAAUkF,SAAShF,KAAM4E,GAA4B,CACpDA,EAAa,QAAvB,IACIK,EAAOL,EAAW,MAGtB,GAFUA,EAAY,YAENlB,IAATuB,EACL,OAAO,CAEX,CACA,OAAO,CACT,EAUF,MAAMC,EAEJpC,YAAa3D,GACXmC,KAAKnC,IAAMA,EACXmC,KAAK6D,OAAShG,EAAIiG,IAClB9D,KAAK+D,QAAU,QAGjB,CAGAC,WAAY5E,GACVY,KAAKiE,QAAU7E,CACjB,CAEA8E,iBAAkBZ,GAEd,GAAkB,SAAdA,EAAEa,UAAyBb,EAAEc,SAOV,SAAdd,EAAEa,UAAuBb,EAAEc,SAElCpE,KAAK6D,OAAOQ,0BAGS,aAAdf,EAAEa,UACW,UAAdb,EAAEa,SAEU,UAAdb,EAAEa,SACAnE,KAAK6D,OAAOjE,SAGdI,KAAK6D,OAAOS,YAIK,WAAdhB,EAAEa,UAA0Bb,EAAEiB,QAGhB,aAAdjB,EAAEa,UAA4Bb,EAAEiB,QAGlB,WAAdjB,EAAEa,UAAyBb,EAAEiB,SACpCvE,KAAK6D,OAAOW,WAAW,MACvBxE,KAAK6D,OAAOW,WAAW,MACvBxE,KAAK6D,OAAOW,WAAW,MACvBxE,KAAK6D,OAAOW,WAAW,OAEF,aAAdlB,EAAEa,UAA2Bb,EAAEiB,SACtCvE,KAAK6D,OAAOW,WAAW,QACvBxE,KAAK6D,OAAOW,WAAW,QACvBxE,KAAK6D,OAAOW,WAAW,QACvBxE,KAAK6D,OAAOW,WAAW,SAEF,aAAdlB,EAAEa,UAA4Bb,EAAEiB,QAGlB,cAAdjB,EAAEa,UAA6Bb,EAAEiB,QAGlB,cAAdjB,EAAEa,UAA4Bb,EAAEiB,QACxCvE,KAAK6D,OAAOY,OAAO,YAEG,aAAdnB,EAAEa,UAA2Bb,EAAEiB,QACvCvE,KAAK6D,OAAOY,OAAO,cAEE,QAAdnB,EAAEa,UAAuBb,EAAEiB,SAAYjB,EAAEc,SAG3B,QAAdd,EAAEa,UAAsBb,EAAEc,WAAad,EAAEiB,QAChDvE,KAAK6D,OAAOa,QAES,OAAdpB,EAAEa,UAAsBb,EAAEiB,QAGZ,QAAdjB,EAAEa,UAAsBb,EAAEiB,UAAYjB,EAAEc,SAC/CpE,KAAK6D,OAAOY,OAAO,QAEE,OAAdnB,EAAEa,UAAqBb,EAAEiB,QAChCvE,KAAK6D,OAAOY,OAAO,OAEE,OAAdnB,EAAEa,SACW,UAAhBnE,KAAK+D,QACP/D,KAAK6D,OAAOc,OAAS,YAGrB3E,KAAK6D,OAAOe,MAAQ,YAID,UAAdtB,EAAEa,UAEW,UAAhBnE,KAAK+D,QACP/D,KAAK+D,QAAU,YAGf/D,KAAK+D,QAAU,SAEjB/D,KAAK6D,OAAOgB,cAAe7E,KAAK+D,UAGnB,MAATT,EAAEwB,MACgB,UAAhB9E,KAAK+D,QACP/D,KAAK6D,OAAOc,OAAQrB,EAAEwB,KAGtB9E,KAAK6D,OAAOe,MAAOtB,EAAEwB,MAjCzB9E,KAAK6D,OAAOY,OAAO,YANnBzE,KAAK6D,OAAOY,OAAO,cATnBzE,KAAK6D,OAAOW,WAAW,SAHvBxE,KAAK6D,OAAOW,WAAW,QAfvBxE,KAAK6D,OAAOW,WAAW,QAHvBxE,KAAK6D,OAAOW,WAAW,UAxBmB,CAC1C,IAAIO,EAAUlH,EAAIiG,IAAIkB,iBACtBhF,KAAK6D,OAAOoB,QAAQ,IAEpBjF,KAAKiE,QAAQiB,uBAAwBH,EAEvC,CA4FJ,CAGAI,sBAAuB7B,GACrBtD,KAAKkE,iBAAkBZ,EACzB,EAUF,MAAM8B,EAEJ5D,YAAa3D,EAAKwH,GAEhBrF,KAAKsF,WAAY,EACjBtF,KAAKnC,IAAMA,EACXmC,KAAKqF,OAASA,EACdrF,KAAKqF,OAAOrB,WAAYhE,MACxBA,KAAKuF,UAAY,GAEjBvF,KAAK6D,OAAShG,EAAIiG,IAClB9D,KAAKwF,OAAS3H,EAAI4H,KAClBzF,KAAK0F,WAAa7H,EAAI8H,QACtB3F,KAAK4F,MAAQ/H,EAAI+H,MACjB5F,KAAK6F,MAAQhI,EAAIgI,MACjB7F,KAAK4F,MAAME,WAAY9F,MACvBA,KAAK4F,MAAMG,gBAAgB,GAC3B/F,KAAKW,KAAO9C,EAAI8C,KAChBX,KAAKgG,YAAa,EAElBhG,KAAKiG,QAAU,GACfjG,KAAKkG,SAAU,EACflG,KAAKmG,eAAgB,EACrBnG,KAAKoG,gBAAiB,EACtBpG,KAAKqG,YAAc,EACnBrG,KAAKsG,UAAY,EACjBtG,KAAKuG,sBAAuB,EAE5BvG,KAAKwG,oBAAqB,EAC1BxG,KAAKyG,uBAAyB,KAC9BzG,KAAK0G,iBAAkB,EACvB1G,KAAK2G,mBAAoB,EAEzB3G,KAAK4G,WAAY,EACjB5G,KAAK6G,cAAe,EACpB7G,KAAK8G,UAAW,EAChB9G,KAAK+G,eAAgB,EACrB/G,KAAKgH,eAAgB,EAErBhH,KAAKiH,YAAc,GACnBjH,KAAKkH,UAAW,IAAIC,MAAOC,UAE3BpH,KAAKqH,WAAY,EACjBrH,KAAKsH,wBAA0B,IAC/BtH,KAAKuH,sBAAwB,IAC7BvH,KAAKwH,iBAAmBxH,KAAKsH,wBAErBtH,KAAK6D,OACb7D,KAAKyH,SAAW,IAAIC,EAAe1H,MACnCA,KAAK2H,iBAAmB,IAAIC,EAAkB5H,KAAKyH,SAAUzH,MAE7DA,KAAK6H,IAAM,IAAIxF,EACfrC,KAAK8H,KAAO,CAAC,EACb9H,KAAK+H,UAAY,GACjB/H,KAAKL,KAAO,GACZK,KAAKgI,WAAa,CAAEC,QAAS,IAC7BjI,KAAKkI,YAAc,KAEnBlI,KAAKmI,SAAW,GAEhBnI,KAAKoI,MAAQ,EAEbpI,KAAKqI,UAAY,EACjBrI,KAAKsI,cAAgB,EACrBtI,KAAKuI,YAAc,EAEnBvI,KAAKwI,WAAa,CAAEP,QAAQ,IAE5BjI,KAAKyI,mBAAqB,CACtBC,aAAc,CAAEnG,MAAOvC,KAAM2I,OAAQ,kBACrCC,OAAQ,CAAErG,MAAOvC,KAAM2I,OAAQ,YAC/BE,YAAa,CAAEtG,MAAOvC,KAAM2I,OAAQ,kBAGxC3I,KAAK8I,qBAAuB,CACxBJ,kBAActG,EACdwG,OAAQ,CAAErG,MAAOvC,KAAM2I,OAAQ,YAC/BE,YAAa,CAAEtG,MAAOvC,KAAM2I,OAAQ,kBAIxC3I,KAAK+I,aACL/I,KAAKgJ,SAAW,OAEhBhJ,KAAKiJ,YAAc,GACnB,IAAIC,EAAKlJ,KAAKiJ,YAEdC,EAAG,KAAQ,EACXA,EAAG,GAAQ,EACXA,EAAG,IAAQ,EACXA,EAAG,KAAQ,EACXA,EAAG,KAAQ,EACXA,EAAG,IAAQ,EACXA,EAAG,IAAQ,EACXA,EAAG,KAAQ,EAEXA,EAAG,KAAQ,EACXA,EAAG,KAAQ,EACXA,EAAG,KAAQ,GACXA,EAAG,KAAQ,GACXA,EAAG,KAAQ,GACXA,EAAG,KAAQ,GACXA,EAAG,KAAQ,GACXA,EAAG,KAAQ,GAEXlJ,KAAKmJ,YAAc,CAAC,EAEpBnJ,KAAKmJ,YAAYC,GAAS,IAC1BpJ,KAAKmJ,YAAYE,KAAS,GAC1BrJ,KAAKmJ,YAAYG,KAAS,IAC1BtJ,KAAKmJ,YAAYI,MAAS,GAC1BvJ,KAAKmJ,YAAY,cAAiB,GAClCnJ,KAAKmJ,YAAY,eAAkB,IACnCnJ,KAAKmJ,YAAmB,MAAK,IAC7BnJ,KAAKmJ,YAAkB,KAAK,GAC5BnJ,KAAKmJ,YAAYK,MAAS,IAC1BxJ,KAAKmJ,YAAYM,MAAS,EAC1BzJ,KAAKmJ,YAAYO,IAAO,GACxB1J,KAAKmJ,YAAYQ,KAAQ,IACzB3J,KAAKmJ,YAAYS,OAAU,IAC3B5J,KAAKmJ,YAAYU,MAAS,GAC1B7J,KAAKmJ,YAAYW,KAAQ,GACzB9J,KAAKmJ,YAAYY,OAAU,IAC3B/J,KAAKmJ,YAAYa,OAAU,IAC3BhK,KAAKmJ,YAAYc,MAAS,IAC1BjK,KAAKmJ,YAAYe,KAAQ,IACzBlK,KAAKmJ,YAAYgB,MAAS,IAC1BnK,KAAKmJ,YAAYiB,MAAS,IAC1BpK,KAAKmJ,YAAY,eAAkB,IACnCnJ,KAAKmJ,YAAY,cAAiB,IAClCnJ,KAAKmJ,YAAYkB,MAAS,IAK1B,IAFA,IAAIC,EAAU,GACVC,EAAU9G,OAAO+G,QAAQxK,KAAKmJ,aACzBtK,EAAE,EAAGA,EAAE0L,EAAQzL,OAAQD,IAC9ByL,EAASC,EAAQ1L,GAAG,IAAM0L,EAAQ1L,GAAG,GAEvCmB,KAAKyK,cAAgBH,CAEvB,CAEAI,mBACE1K,KAAKgH,eAAgB,CACvB,CAEA2D,oBACE3K,KAAK6G,cAAe,CACtB,CAEA+D,mBACE5K,KAAK6G,cAAe,CACtB,CAEAgE,WAAYC,GACV9K,KAAKmG,eAAgB,EACrBnG,KAAKqG,YAAcyE,CACrB,CAEAC,eACE/K,KAAKmG,eAAgB,CACvB,CAGA6E,aAAc1E,GACZtG,KAAKsG,UAAYA,EACK,GAAlBtG,KAAKsG,YACPtG,KAAKuG,sBAAwB,GAG/BvG,KAAK6D,OAAOoH,aAA2B,GAAb3E,EAC5B,CAGA4E,aACwB,GAAlBlL,KAAKsG,YACPtG,KAAKuG,wBACDvG,KAAKuG,sBAAwB,MAC/BvG,KAAKmL,iBACLnL,KAAKuG,sBAAwB,GAGnC,CAEA6E,eACEpL,KAAK6D,OAAOwH,KACU,GAAlBrL,KAAKsG,YACPtG,KAAKmL,iBACLnL,KAAKuG,sBAAwB,EAEjC,CAEA4E,iBACEnL,KAAKoG,gBAAiB,EACtBpG,KAAKsL,eAAc,IAAInE,MAAOC,SAChC,CAEAmE,gBACEvL,KAAKoG,gBAAiB,EACtBpG,KAAKwL,cAAgB,IAAIrE,MAAOC,UAAcpH,KAAKsL,aACrD,CAGAG,aAAc7I,GACZ,OAAOA,EAAEkF,IACX,CAEA4D,iBAIE,IAHA,IAAIC,EAAS3L,KAAK4L,gBACdC,EAAU,GAELC,EAAK,EAAGA,EAAIH,EAAO7M,OAAQgN,IAMlC,IAJA,IAAIC,EAAYJ,EAAOG,GACnBhE,EAAO9H,KAAKyL,aAAcM,EAAUC,OACpCC,EAAQxI,OAAOyI,oBAAqBpE,GAE/BjJ,EAAE,EAAEA,EAAEoN,EAAMnN,OAAOD,IAAK,CAC/B,IAAI4C,EAAOwK,EAAMpN,GACbsN,EAAQrE,EAAMrG,GACdpC,EAAO0M,EAAU1M,KAGrB,GAFY,IAARA,EAAeA,EAAO,GACnBA,GAAQ,IACToC,EAAK8B,WAAY,WAQlB,CAED,IADA,IAAI6I,EAAQ,GACHC,EAAG,EAAGA,EAAGF,EAAMzK,QAAQ5C,OAAQuN,IAClCA,EAAG,IAAMD,GAAS,KACtBA,GAASD,EAAMzK,QAAU2K,GAG3BR,EAAQ9M,KAAM0C,EAAK4B,OAAO,GAAK,qBAAuB+I,EAAQ,IAClE,MAfQ3K,EAAK6K,SAAS,KACdT,EAAQ9M,KAAMM,EAAOoC,EAAO,OAAU0K,EAAQ,KAG9CN,EAAQ9M,KAAMM,EAAOoC,EAAO,MAAQ0K,EAY9C,CAGF,OAAON,CACT,CAEAD,gBAGE,IAFA,IAAID,EAAS,GACTtM,EAAO,GACFyM,EAAK,EAAIA,EAAK9L,KAAK2L,OAAO7M,OAAQgN,IAAO,CAChD,IAAIE,EAAQhM,KAAK2L,OAAOG,GAAIrK,KAExBqK,EAAK,IACK,IAARzM,IACFA,GAAQ,KAEVA,GAAQ2M,GAGVL,EAAO5M,KAAM,CAAEM,KAAMA,EAAM2M,MAAOhM,KAAK2L,OAAOG,IAChD,CAEA,OAAOH,CACT,CAEAY,YACE,OAAIvM,KAAKkG,QAAmB,EACnBlG,KAAK8G,SAAoB,GAC3B,EAET,CAEA0F,YAEE,IACI/J,EADApC,EAAS,GAIXA,EAFEL,KAAKkG,QAEE,YADTzD,EAASzC,KAAKiG,QAASjG,KAAKyM,YAAa,IACV,IAGtB,UAGPzM,KAAKkG,SAAWlG,KAAK4G,UACvBvG,EAAS,WAAaoC,EAAS,WAEvBzC,KAAKkG,SAAWlG,KAAK8G,WAC7BzG,EAAS,mBAGX,IAAIqM,EAAOjJ,OAAOyI,oBAAqBlM,KAAK2M,WAAY7N,OAKxD,OAFAkB,KAAKgH,eAAgB,EAEd,CACL3G,OAAQA,EACRuM,OAAQ5M,KAAKiG,QAAQnH,OACrB+N,OAAQH,EACRI,YAAa9M,KAAKnC,IAAIiP,YAE1B,CAEAjN,IAAKR,EAAMC,GACTU,KAAKnC,IAAIgC,IAAKG,KAAMX,EAAMC,GAC1BU,KAAK+M,oBAAqB,MAC5B,CAEA9M,SACED,KAAKnC,IAAIoC,OAAQD,MACjBA,KAAK+M,oBAAqB,SAC5B,CAEAzM,MAAOjB,GACLW,KAAKnC,IAAIyC,MAAON,KAAMX,GACtBW,KAAK+M,oBAAqB,OAC5B,CAEA5N,KAAME,EAAM2N,EAAO1N,GACjBU,KAAKnC,IAAIsB,KAAMa,KAAMX,EAAMC,GAC3BU,KAAK+M,oBAAqB,QAC1B/M,KAAKiN,mBAAqBD,CAE5B,CAEAxN,SAAUH,EAAMnB,EAAMuB,GACpBO,KAAKnC,IAAI2B,SAAUQ,KAAMX,EAAMnB,EAAMuB,GACrCO,KAAK+M,oBAAqB,WAE5B,CAEArN,KAAMwN,EAAO5N,GAEX,IAAIK,EAAOK,KAAKmN,mBACZ9N,EAAO6N,EACE,MAATA,IACF7N,EAAO,eAETW,KAAKnC,IAAI6B,KAAMM,KAAMX,EAAMC,EAAQK,GACnCK,KAAK+M,oBAAqB,OAC5B,CAEAK,WAAY/N,EAAMC,GAEhBU,KAAKnC,IAAI+B,OAAQI,KAAMX,EAAMC,GAC7BU,KAAK+M,oBAAqB,SAC5B,CAGAA,oBAAqBM,GACnBrN,KAAKwG,oBAAqB,EAC1BxG,KAAKyG,uBAAyB4G,CAChC,CAGAC,aAAcC,EAAOC,GACnBxN,KAAKyN,UAAW,EAAGF,EAAO,CAAC,EAC7B,CAEAE,UAAWC,EAAKH,EAAOC,GAIrB,KAAW,GAAPE,GAAY1N,KAAK2N,gBAIV,GAAPD,GAAY1N,KAAK4N,gBAArB,CAKA,IAAIC,EAAMC,EACV,GAAW,GAAPJ,EAAW,CAGb,QAAatL,KADbyL,EAAO7N,KAAK+N,SAASC,YAEnB,OAEFhO,KAAK2N,gBAAiB,EACtBG,EAAW9N,KAAK+N,SAASE,sBAC3B,KACK,CAGH,QAAa7L,KADbyL,EAAO7N,KAAK+N,SAASG,YAEnB,OAEFlO,KAAK4N,gBAAiB,EACtBE,EAAW9N,KAAK+N,SAASI,sBAC3B,CAGAnO,KAAKoO,SAAU,YAAcV,EAC3B,CAAEjB,WAAYzM,KAAKyM,WAAY4B,YAAarO,KAAKqO,cAEnD,IAAIC,EAAY7K,OAAO+G,QAASgD,GAChCxN,KAAKuO,OAAQ,QAAQC,cAAejB,EAAMiB,eAC1C,IAAK,IAAI3P,EAAE,EAAGA,EAAEyP,EAAUxP,OAAQD,IAChCmB,KAAKuO,OAAQD,EAAUzP,GAAG,GAAG2P,cAAeF,EAAUzP,GAAG,IAG3D,IAAI4P,EAAMzO,KAAKiG,QACXyI,EAAI1O,KAAKiG,QAAQnH,OACjB6P,GAAQ,EAEZ,GAAIb,GAGU1L,OADZyL,EAAO7N,KAAK4O,OAAOf,IAEjB,KAAM,iBAIV,IAAShP,EAAE,EAAGA,EAAE6P,EAAK7P,IAGnB,GAFQ4P,EAAI5P,GAEN,IAAMgP,EAAO,CACjB7N,KAAKyM,WAAa5N,EAClBmB,KAAKqO,YAAc,EACnBM,GAAQ,EACR,KACF,CAGF,IAAIA,EACF,KAAM,4BAzDR,CA4DF,CAEAE,eAAgBC,EAAUtB,GAKxB,GAHAxN,KAAK8H,KAAM9H,KAAKyG,wBAA2BqI,EAC3C9O,KAAKwG,oBAAqB,EAEtBsI,EAASvL,WAAY,gBACrBvD,KAAK6D,OAAOkL,OAAQvB,EAAMwB,MAAOxB,EAAMyB,OACvCjP,KAAKwF,OAAOuJ,OAAQvB,EAAM0B,QAAS1B,EAAM2B,SAEzCnP,KAAKnC,IAAIiP,YAAcU,EAAM4B,KAC7BpP,KAAK0F,WAAW2J,OAAQ7B,EAAM8B,WAC9BtP,KAAK0F,WAAW1D,IAAKwL,EAAM9H,iBAI1B,GAAIoJ,EAASvL,WAAY,mBAO1BvD,KAAK6D,OAAO7B,IAAKwL,EAAMwB,MAAOxB,EAAMyB,MAAOzB,EAAM+B,OACjDvP,KAAK0F,WAAW1D,IAAKwL,EAAM9H,iBAG1B,GAAIoJ,EAASvL,WAAY,iBAE1BvD,KAAK0F,WAAW1D,IAAKwL,EAAM9H,iBAG1B,GAAIoJ,EAASvL,WAAY,aAE1BvD,KAAK6D,OAAO7B,IAAKwL,EAAMwB,MAAOxB,EAAMyB,MAAOzB,EAAM+B,YAGhD,GAAgB,cAAZT,EAEa,GAAhB9O,KAAKkG,SACLlG,KAAKwP,WAAW,QAAQ,OAAOpN,EAAWoL,EAAMiC,aAGjD,GAAgB,kBAAZX,EAA+B,CAEtCjR,EAAIQ,IAAI,6CAA+CmP,EAAMkC,QAAQ5Q,OAAS,YAE9E,IAAI6Q,EAAK3P,KAAK4P,QAASpC,EAAMkC,QAASlC,EAAMnO,MAC5CxB,EAAIQ,IAAI,yBAEJsR,GAAM3P,KAAKiN,oBACbjN,KAAK6D,OAAOgM,QAAS,IACrB7P,KAAK8P,SACLjS,EAAIQ,IAAI,uBAGR2B,KAAK+P,MAET,MACK,GAAgB,sBAAZjB,EAEPjR,EAAIQ,IAAI,iDAAmDmP,EAAM7N,KAAKb,OAAS,YAE/EkB,KAAKgQ,WAAYxC,EAAM7N,KAAM6N,EAAMtP,KAAMsP,EAAM/N,YAG5C,GAAgB,kBAAZqP,EAEPjR,EAAIQ,IAAI,4CAA8CmP,EAAMiC,QAE5DzP,KAAKwP,WAAW,YAAY,OAAOpN,EAAWoL,EAAMiC,QACpDzP,KAAK+P,YAEF,GAAgB,oBAAZjB,EAEPjR,EAAIQ,IAAI,6CAGL,GAAgB,gBAAZyQ,EAEPjR,EAAIQ,IAAI,0CAA4CmP,EAAMiC,QAE1DzP,KAAKwP,WAAW,UAAU,OAAOpN,EAAWoL,EAAMiC,QAClDzP,KAAK+P,YAEF,GAAgB,kBAAZjB,EAEPjR,EAAIQ,IAAI,sCAEH2B,KAAKiQ,iBAGP,GAAgB,cAAZnB,EAEPjR,EAAIQ,IAAI,wCAA0CmP,EAAMiC,QAExDzP,KAAKwP,WAAW,QAAQ,OAAOpN,EAAWoL,EAAMiC,QAChDzP,KAAK+P,YAEF,GAAgB,iBAAZjB,EAA8B,CAErCjR,EAAIQ,IAAI,qCAIR,IAFA,IAAI6R,EAAO,CAAC,GAAG,kBAAqB1C,EAAM2C,MAAQ,QAAW3C,EAAMjN,GAAI,IAE9D1B,EAAE,EAAGA,EAAE2O,EAAM4C,MAAMtR,OAAQD,IAChCqR,EAAKnR,KAAMyO,EAAM4C,MAAMvR,GAAGwR,OAG9BH,EAAKnR,KAAMyO,EAAM4C,MAAMtR,OAAS,UAEhCkB,KAAKsQ,cAAeJ,EAEtB,MACK,GAAgB,aAAZpB,EAEPjR,EAAIQ,IAAI,uCAAyCmP,EAAMiC,QAEvDzP,KAAKwP,WAAW,OAAO,OAAOpN,EAAWoL,EAAMiC,QAC/CzP,KAAK+P,YAEF,GAAgB,oBAAZjB,EAAiC,CASxC,IAPAjR,EAAIQ,IAAI,wCAEJ6R,EAAO,CAAC,GAAI,wBAA2B1C,EAAM+C,UAAY,IAAM,GAAI,WAAY,IAK1E1R,EAAE,EAAGA,EAAE2O,EAAMjN,GAAGzB,OAAQD,IAAK,CAElC,IAAI0B,EAAKiN,EAAMjN,GAAG1B,GACd2R,EAAM,IAAOjQ,EAAGkB,KAAO,IACvBgP,GAAmBlQ,EAAGjB,OAAS,IAAIR,OACvC0R,EAAMA,EAAM,qBAAqBnN,OAAQ,EAAG,GAAGmN,EAAI1R,OAAO2R,GAAqBlQ,EAAGjB,OAGlF4Q,EAAKnR,KAAK,QAAUyR,EACxB,CAEAN,EAAKnR,KAAM,IACXmR,EAAKnR,KAAMyO,EAAMjN,GAAGzB,OAAS,6BAE7BkB,KAAKsQ,cAAeJ,EAEtB,KACqB,mBAAZpB,IAEF9O,KAAKiQ,YASY,MAAhBzC,EAAMnN,SAERL,KAAKwP,WAAW,eAAe,OAAOpN,EAAW,gCACjDpC,KAAK+P,QAXa,MAAhBvC,EAAMnN,QAGRL,KAAKwP,WAAW,eAAe,OAAOpN,EAAW,iCAanDpC,KAAK0Q,mBACP1Q,KAAK0Q,kBAAmB,EACxB1Q,KAAKkG,SAAU,EACflG,KAAK2Q,eAAe,IAIjB3Q,KAAKiQ,aAAgC,GAAjBjQ,KAAK8G,UAC5B9G,KAAK4Q,YAGT,CAEAb,OACM/P,KAAKkG,SACPlG,KAAK6Q,UAEH7Q,KAAK8G,UACP9G,KAAK8Q,UAET,CAEA3L,sBAAuB7B,GAErB,GAAoB,GAAhBtD,KAAKkG,QACP,GAAkB,SAAd5C,EAAEa,SAAsB,CAE1B,IAAI4M,EAAM/Q,KAAK6D,OAAOmN,eAElBC,EAASjR,KAAK6D,OAAOqN,YAAalR,KAAKmR,oBAAqBJ,EAAI,IACpE/Q,KAAK6D,OAAOoB,QAAQ,IAEpBjF,KAAKoR,gBAAiBH,GAAQ,EAEhC,MACK,GAAkB,aAAd3N,EAAEa,UACW,UAAdb,EAAEa,SAAwB,CAChC,IAAIkN,EAAIrR,KAAK6D,OAAOmN,eAAe,GAEjB,UAAd1N,EAAEa,SACAnE,KAAK6D,OAAOjE,SAGVyR,EAAIrR,KAAKmR,oBACTnR,KAAK6D,OAAOS,YAGdtE,KAAK6D,OAAOjE,QAIpB,MACK,GAAkB,aAAd0D,EAAEa,UAA4Bb,EAAEiB,QAMpC,GAAkB,cAAdjB,EAAEa,UAA6Bb,EAAEiB,QAGrC,GAAkB,QAAdjB,EAAEa,UAAuBb,EAAEiB,QAKZ,cAAdjB,EAAEa,UAA4Bb,EAAEiB,QACxCvE,KAAK6D,OAAOY,OAAO,YAEE,OAAdnB,EAAEa,SACTnE,KAAK6D,OAAOY,OAAO,gBAEG,aAAdnB,EAAEa,UAA2Bb,EAAEiB,SACvCvE,KAAK6D,OAAOY,OAAO,eACf6M,EAAKtR,KAAK6D,OAAOmN,gBACd,GAAIhR,KAAKmR,qBACdnR,KAAK6D,OAAO0N,aAAcvR,KAAKmR,oBAAqBG,EAAG,KAI5C,MAAThO,EAAEwB,KACJ9E,KAAK6D,OAAOe,MAAOtB,EAAEwB,SApBqB,CAC5C,IAAIwM,EAAKtR,KAAK6D,OAAOmN,eAErBhR,KAAK6D,OAAO0N,aAAcvR,KAAKmR,oBAAqBG,EAAG,GACzD,MANEtR,KAAK6D,OAAOW,WAAW,cANdxE,KAAK6D,OAAOmN,eACd,GAAKhR,KAAKmR,qBACfnR,KAAK6D,OAAOW,WAAW,aA+B3BxE,KAAKqF,OAAOF,sBAAuB7B,EAEvC,CAEAkO,aACExR,KAAKgG,YAAchG,KAAKgG,WAEpBhG,KAAKgG,WACPhG,KAAKnC,IAAIsD,gBAAgB,GAGzBnB,KAAKnC,IAAIsD,gBAAgB,EAE7B,CAEAwP,cAAec,GAEbzR,KAAK+K,eACL/K,KAAK4F,MAAMG,gBAAgB,GAC3B/F,KAAK4F,MAAM8L,SACND,GAAmBzR,KAAKgG,YAC3BhG,KAAKnC,IAAIsD,gBAAgB,GAG3BnB,KAAK0K,kBACP,CAEAiH,iBAAkBC,EAASC,GACzB,IAAIpD,EAAMzO,KAAK8R,eAAgBF,EAAQ7O,MAAM,OAAQ0L,IACrDzO,KAAK+R,SAAWF,EAEhB7R,KAAKiG,QAAUwI,EACfzO,KAAKnC,IAAIQ,IAAK,oBAAsBwT,EAAU,SAAWD,EAAQ9S,OAAS,UAC5E,CAEA8Q,QAASgC,EAASC,GAChB,IACE,IAAIpD,EAAMzO,KAAK8R,eAAgBF,EAAQ7O,MAAM,OAAQ0L,IAOrD,OANAzO,KAAK+R,SAAWF,EAEhB7R,KAAKiG,QAAUwI,EACfzO,KAAKgS,WAAYvD,GAEjBzO,KAAKnC,IAAIQ,IAAK,oBAAsBwT,EAAU,SAAWD,EAAQ9S,OAAS,YACnE,CAYT,CAVA,MAAQwE,GAQN,OALImL,EAAMzO,KAAK8R,eAAgB,IAAKrD,IACpCzO,KAAKiG,QAAUwI,EACfzO,KAAK2Q,eAAe,GACpB3Q,KAAKwP,WAAW,kBAAkB,EAAOlM,EAAEb,OAAQa,EAAEvB,QACrD/B,KAAK4Q,cACE,CAET,CACF,CAcAqB,cACEjS,KAAKkS,YAAalS,KAAKmS,SACzB,CAGA7B,cAAeJ,GACblQ,KAAK8G,UAAW,EAChB9G,KAAKkQ,KAAOA,EACZlQ,KAAKoS,YAAc,EACnBpS,KAAKqS,UAAU,IACfrS,KAAKsS,uBAAyBtS,KAAK4F,MAAM2M,iBACzCvS,KAAK4F,MAAMG,gBAAgB,GAC3B/F,KAAK0K,kBACP,CAEA8H,YAAaC,GACXzS,KAAKgJ,SAAWyJ,CAClB,CAEA1J,aAGE,IAAI2J,EAAY,IAAIvL,KACpBuL,EAAUC,SAAS,GACnBD,EAAUE,WAAW,GACrBF,EAAUG,WAAW,GACrBH,EAAUI,gBAAgB,GAE1B9S,KAAKkH,SAAWwL,CAElB,CAEAK,SAAUC,GACR,GAAIA,EAGF,OAFAhT,KAAKwH,iBAAmBxH,KAAKuH,2BAC7BvH,KAAKqH,WAAY,GAGnBrH,KAAKwH,iBAAmBxH,KAAKsH,wBAC7BtH,KAAKqH,WAAY,CACnB,CAEA2K,WAAYvD,GACVzO,KAAKiG,QAAUwI,EACfzO,KAAKkG,SAAU,EACflG,KAAK2Q,eAAe,GAEpB3Q,KAAK4G,WAAY,EACjB5G,KAAK8G,UAAW,EAEhB9G,KAAK0K,kBAEP,CAEAuI,cAAexE,GAEb,IAAI,IAAI5P,EAAE,EAAGA,EAAE4P,EAAI3P,OAAQD,IAAK,CAG9B,IAFA,IAAIqU,GAAU,EAENC,EAAE,EAAGA,EAAEnT,KAAKiG,QAAQnH,OAAQqU,IAC9BnT,KAAKiG,QAAQkN,GAAG,IAAM1E,EAAI5P,GAAG,KAC/BqU,EAASC,GAITD,GAAQ,EACVlT,KAAKiG,QAASiN,GAAWzE,EAAK5P,GAG9BmB,KAAKiG,QAAQlH,KAAM0P,EAAK5P,GAE5B,CAMAmB,KAAKiG,QAAQmN,MAJD,SAAkBC,EAAGC,GAC/B,OAAOD,EAAE,GAAKC,EAAE,EAClB,IAIAtT,KAAKkG,SAAU,EACflG,KAAK2Q,eAAe,GAEpB3Q,KAAK4G,WAAY,EACjB5G,KAAK8G,UAAW,CAElB,CAEAyM,aACE,OAAOvT,KAAKiG,OACd,CAEAuN,kBACE,MAAO,CACLtN,QAASlG,KAAKkG,QACdU,UAAW5G,KAAK4G,UAChBkB,KAAM9H,KAAK8H,KACXC,UAAW/H,KAAK+H,UAChBS,WAAYxI,KAAKwI,WACjBiE,WAAYzM,KAAKyM,WACjB4B,YAAarO,KAAKqO,YAEtB,CAEAoF,gBAAiBC,GACb1T,KAAKkG,QAAUwN,EAASxN,QACxBlG,KAAK2Q,eAAe,GACpB3Q,KAAK4G,UAAY8M,EAAS9M,UAC1B5G,KAAK8H,KAAO4L,EAAS5L,KACrB9H,KAAK+H,UAAY2L,EAAS3L,UAC1B/H,KAAKwI,WAAakL,EAASlL,WAC3BxI,KAAKyM,WAAaiH,EAASjH,WAC3BzM,KAAKqO,YAAcqF,EAASrF,WAChC,CAEAsF,aAAcC,GAIb,IAFA,IAAIC,EAAO,EAEFhV,EAAE,EAAGA,EAAE,EAAGA,IACdA,EAAE,IACHgV,IAAe,GAEbD,EAAK/U,KACPgV,GAAc,KAGlB,OAAOA,CACR,CAEAC,aAAcD,GAQb,IAPC,IAAIE,EAAQ,CACV,EAAW,EAAW,EAAW,EACjC,GAAW,GAAW,GAAW,KAGhCC,EAAU,EAAE,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAExDnV,EAAE,EAAGA,EAAE,EAAGA,IAEjBmV,EAASnV,IAAOgV,EAAOE,EAAMlV,IAAM,EAIrC,OAAOmV,CACR,CAEAC,WAAYrR,GACV,OAAIA,GACGA,EAAE9D,OAAS,EACL8D,EAAES,OAAO,EAAE,GAAGmL,cAAgB5L,EAAES,OAAQ,GAG9CT,CACT,CAEA4M,WAAY5M,EAAGsR,EAAaC,EAAcpS,GAExC,IAAIqS,EAAS,IAAMpU,KAAKiU,WAAYrR,GAAM,SAAW5C,KAAKqU,YAEtDF,IACAC,EAAW,IAAMpU,KAAKiU,WAAYrR,GAAM,aAAeuR,GAEvDD,IACAE,EAAW,IAAMpU,KAAKiU,WAAYrR,GAAM,UAG5C5C,KAAK6D,OAAOoB,QAAUmP,GAClBrS,GACF/B,KAAK6D,OAAOoB,QAAU,MAAQlD,EAGlC,CAEAuS,UAAW1R,GAET5C,KAAKnC,IAAIQ,KAAQuE,EAAI5C,KAAKqU,aAAa7F,cAEzC,CAEA+F,YACEvU,KAAK2H,iBAA6B,WAAE,GACtC,CAEA0K,UAAWzP,GACT5C,KAAK6D,OAAOoB,QAAQrC,GACpB5C,KAAKwU,WAAY,CACnB,CAGAC,MAAO7R,GACL5C,KAAK6D,OAAOoB,QAAQrC,GACpB5C,KAAKwU,WAAY,CACnB,CAIAE,WAAYC,GACV3U,KAAK6D,OAAO+Q,WAAYD,EAAOE,GAAIF,EAAOG,IAC1C9U,KAAK6D,OAAOgM,QAAS,GAAI8E,EAAOI,QAChC/U,KAAK6D,OAAO6Q,YACd,CAEAM,eACWhV,KAAK6D,OAAOoR,gBAIrBjV,KAAK6D,OAAOqR,OAEd,CAEArM,cACE7I,KAAK6D,OAAOa,QACZ1E,KAAK6D,OAAOsR,OAAO,EAAE,EACvB,CAEAC,YAEE,OADW,IAAIjO,MAAOC,UAAYpH,KAAKkH,QAEzC,CAEAmO,eACE,IAAIC,GAAO,IAAInO,MAAOC,UAAYpH,KAAKkH,SAGvC,OAFaqO,KAAKC,MAAMF,GAAU,IAAO,KAEzB,MAClB,CAEAlO,UACE,IAAIkO,GAAO,IAAInO,MAAOC,UAAYpH,KAAKkH,SACvCoO,GAAkB,MAElB,IAAIG,EAAQF,KAAKC,MAAMF,EAAS,MAChCA,GAA2B,KAARG,EACnB,IAAIC,EAAUH,KAAKC,MAAMF,EAAS,KAIlC,OAHAA,GAA6B,IAAVI,EAGZ,CAACD,EAAMC,EAFAH,KAAKC,MAAMF,EAAS,KAGpC,CAEAJ,MAAOS,EAAMC,GACX5V,KAAK6D,OAAOgF,cACZ7I,KAAK6D,OAAOgS,OAAO,UAEnB7V,KAAK4G,WAAY,EACjB5G,KAAKkG,SAAU,EACflG,KAAK8G,UAAW,EAEhB9G,KAAK8V,SACL9V,KAAK+S,UAAU,EACjB,CAEAgD,gBAAiBC,GAEf,IAAIC,EAAI,IAAIC,EAAQlW,KAAKyH,SAAUzH,KAAK2H,kBACxCsO,EAAEE,OAIF,IAHA,IAAIC,EAAMH,EAAEI,kBACRC,EAAON,EAEFnX,EAAE,EAAGA,EAAEuX,EAAItX,OAAQD,IAAK,CAC/B,IAAI0X,EAAKH,EAAIvX,GACR,MAAC0X,IACFD,EAAOA,EAAKE,WAAYD,EAAGE,cAAgBC,OAAOC,aAAa9X,IAErE,CAEA,OAAOyX,CACT,CAGAM,4BACE,IAAIC,EAAO,GACX,IAAK,MAAMC,KAAK9W,KAAKiG,QAEL,IAAR4Q,IACFA,GAAQ,MAEVA,GAAS7W,KAAK+W,8BAA+BD,EAAE,GAAGE,QAAQ,GAE9D,OAAOH,CACT,CAEAI,iBACE,OAAOjX,KAAKiG,QAAQnH,MACtB,CAEAqO,mBACE,IAAI0J,EAAO,GACX,IAAK,MAAMC,KAAK9W,KAAKiG,QAEL,IAAR4Q,IACFA,GAAQ,MAGU,WAAhBC,EAAE,GAAG,GAAG5Y,MAA0C,OAArB4Y,EAAE,GAAG,GAAGI,YACrCL,GAAQ,MAEZA,GAAQC,EAAE,GAAGE,OAEjB,OAAOH,CACT,CAEAM,qBAAsBC,GACpB,IAAIC,EACJA,EAAMD,EAAKJ,OAGX,IAFA,IAAIM,EAAM,GAEDzY,EAAE,EAAGA,EAAEwY,EAAIvY,OAAQD,IAAK,CAC/B,IAAI0Y,EAAIF,EAAIG,WAAY3Y,GACxB,GAAI0Y,EAAE,IAAS,IAAHA,GAASA,GAAG,IAAM,CAC5B,IAAIE,EAASzX,KAAKyK,cAAe8M,GAE7BD,QADelV,IAAXqV,EACG,IAAMA,EAAS,IAGf,IAAIF,EAAE,GAGnB,MAEED,GAAOD,EAAIK,OAAQ7Y,EAEvB,CACA,OAAOyY,EAAIb,aACb,CAEAD,WAAYmB,EAAKC,EAAMC,GAGrB,IADA,IAAIC,EAAKH,EACFG,EAAGC,QAASH,IAAU,GAC3BE,EAAKA,EAAGE,QAASJ,EAAMC,GAEzB,OAAOC,CACT,CAGAG,2BAA4BC,GAG1B,IAAIjC,EAAI,IAAIC,EAAQlW,KAAKyH,SAAUzH,KAAK2H,kBACxCsO,EAAEE,OACF,IAAIgC,EAAgBnY,KAAK+W,8BAA+BmB,GAAK,GAE7D,OADUjC,EAAEmC,UAAWD,EAEzB,CAGApB,8BAA+BK,EAAMiB,GACnC,IAAIhB,EACJA,EAAMD,EAAKJ,OAIX,IAHA,IAAIM,EAAM,GACNnV,EAAM,GAEDtD,EAAE,EAAGA,EAAEwY,EAAIvY,OAAQD,IAAK,CAC/B,IAAI0Y,EAAIF,EAAIG,WAAY3Y,GACpByZ,EAAKjB,EAAIK,OAAQ7Y,GACrB,GAAI0Y,EAAE,IAAS,IAAHA,GAASA,GAAG,GAAK,CAE3B,IAAIgB,GAAkB,EAAOC,GAAgB,EACxC3Z,EAAE,EAAGwY,EAAIvY,QAED,KADDuY,EAAIK,OAAQ7Y,EAAE,KAEtB2Z,GAAkB,GAGV,KAARrW,IACAoW,GAAkB,GAGlBA,IAAoBC,GACpBlB,EAAMA,EAAIjU,OAAQ,EAAGiU,EAAIxY,OAAO,GAChCwY,GAAO,QAAQC,EAAE,OAEZgB,GAAmBC,GACxBlB,EAAMA,EAAIjU,OAAQ,EAAGiU,EAAIxY,OAAO,GAChCwY,GAAO,QAAQC,EAAE,IACjB1Y,MAEM0Z,GAAmBC,GACzBlB,GAAO,UAAWC,EAAE,IACpB1Y,KAIAyY,GAAO,UAAWC,EAAE,KAE1B,MAEED,GAAOD,EAAIK,OAAQ7Y,GAErBsD,EAAOmW,CACT,CAEA,IAAIG,EAAMzY,KAAKwW,WAAYc,EAAK,OAAS,KAEzC,OAAIe,EAAmBI,EAAKhC,cACrBgC,CACT,CAEAC,0BAA2BrH,GAEzB,OAAGrR,KAAKmJ,YAAYkI,GACXrR,KAAKmJ,YAAYkI,GAGnBA,CACT,CAEAsH,qBAAsBvB,GACpB,IAAIC,EACJA,EAAMD,EAAKJ,OAGF,IAFT,IAAIM,EAAM,GAENzY,EAAE,EAAUA,EAAEwY,EAAIvY,QAAS,CAC7B,IAAIyY,EAAIF,EAAIG,WAAY3Y,GACxB,GAAS,KAAL0Y,EAAW,CACb1Y,IAEA,IADA,IAAI+Z,EAAM,GACH/Z,EAAIwY,EAAIvY,QAAS,CAEpB,GAAS,MADTyY,EAAIF,EAAIG,WAAY3Y,IACL,CACbA,IACA,KACF,CACA+Z,GAAOlC,OAAOC,aAAcY,GAExBvX,KAAKsF,YACPtH,QAAQK,IAAI,sBAAwBqY,OAAOC,aAAcY,IACzDvZ,QAAQK,IAAI,2BAA6BkZ,IAE3C1Y,GACJ,CAEImB,KAAKsF,WACPtH,QAAQK,IAAI,iBAAmBua,GAGjCA,EAAM5Y,KAAK0Y,0BAA0BE,EAAInC,eAErCzW,KAAKsF,WACPtH,QAAQK,IAAI,0BAA4Bua,GAG1CtB,GAAOZ,OAAOC,aAAckC,SAAUD,EAAK,IAC7C,MACc,MAALrB,GAAkB,MAALA,GACpBD,GAAO,IACPzY,MAGAyY,GAAOD,EAAIK,OAAQ7Y,GACnBA,IAEJ,CAMA,OAJImB,KAAKsF,WACPtH,QAAQK,IAAI,OAASiZ,GAGhBA,CACT,CAEAwB,kBAEE,OAAO9Y,KAAKiG,OACd,CAEA8S,UAAW1H,GAET,IADA,IAAIzO,EAAIyO,EAAI,GACJxS,EAAE+D,EAAE9D,OAAQD,EAAE,EAAGA,IACvB+D,EAAE,IAAIA,EAER,OAAOA,CACT,CAEAoW,mBAAoB/C,GAClB,IAAIhU,EAAI,EAER,GAAY,OAARgU,EAAE/X,KAEF+D,EADY,KAAVgU,EAAEtW,KACE,GAEC,GAAGsW,EAAEtW,MAAMoY,QAAQ,MAAQ,EAC5BkB,WAAWhD,EAAEtW,MAGbkZ,SAAS5C,EAAEtW,WAGhB,GAAY,OAARsW,EAAE/X,KACT+D,EAAMgU,EAAEtW,UAEL,GAAY,OAARsW,EAAE/X,KACN+X,EAAEtW,KAAK4D,WAAW,QACnBtB,EAAMjC,KAAKoV,YACRa,EAAEtW,KAAK2M,SAAS,OACjBrK,EAAMjC,KAAKoH,UACXnF,EAAM,GACJjC,KAAK+Y,UAAU9W,EAAI,IACnBjC,KAAK+Y,UAAU9W,EAAI,IACnBjC,KAAK+Y,UAAU9W,EAAI,MAGtBgU,EAAEtW,KAAK4D,WAAW,OACnBtB,EAAMjC,KAAKwL,aAEK,eAAVyK,EAAEtW,MAEI,IADZsC,EAAMjC,KAAKyM,cAETxK,EAAM4W,SAAU7Y,KAAKiG,QAAShE,GAAM,KAItCA,EADgB,MAAVgU,EAAEtW,KACF4V,KAAK2D,GAGLlZ,KAAK8H,KAAMmO,EAAEtW,MAEVyC,MAAPH,IACFA,EAAM,EACFjC,KAAK2L,OAAO,GAAG7D,KAAMmO,EAAEtW,QACzBsC,EAAMjC,KAAK2L,OAAO,GAAG7D,KAAMmO,EAAEtW,aAI9B,GAAY,SAARsW,EAAE/X,KAAgB,CACzB,IAAIib,EAAa,UAAYlD,EAAEtW,KAC3ByZ,EAAMpZ,KAAK8H,KAAMqR,GAErB,QAAY/W,IAARgX,IACEpZ,KAAK2L,OAAO,GAAG7D,KAAMqR,KACvBC,EAAMpZ,KAAK2L,OAAO,GAAG7D,KAAMqR,SAEjB/W,IAARgX,GACF,KAAM,yBAA0BD,EAAW,mBAI/C,GAAIC,EAAIvX,iBAAmBoU,EAAEvU,QAAQ5C,OACjC,KAAM,qDAIV,IADA,IAAI4C,EAAU,GACL2X,EAAG,EAAGA,EAAGpD,EAAEvU,QAAQ5C,OAAQua,IAClC3X,EAAQ2X,GAAMrZ,KAAKsZ,eAAgBrD,EAAEvU,QAAS2X,SAIpCjX,KADZH,EAAMmX,EAAItY,IAAKY,MAEbO,EAAM,EAGV,MACK,GAAY,QAARgU,EAAE/X,KACT+D,EAAMjC,KAAKsZ,eAAgBrD,QAExB,GAAY,WAARA,EAAE/X,KAAkB,CAG3B,IADA,IAAIqb,EAAS,GACJpG,EAAE,EAAGA,EAAE8C,EAAEuD,OAAO1a,OAAQqU,IAAK,CACpC,IAAIsG,EAAMzZ,KAAKsZ,eAAgBrD,EAAEuD,OAAOrG,IACxCoG,EAAOxa,KAAM,CAACoN,MAAOsN,GACvB,CACA,IACE,IAAIhS,EAAWzH,KAAKyH,SAChBiS,EAAY1Z,KAAK2H,iBACjBgS,EAAO3Z,KAAKyH,SAEZmS,EAAW,QAAU3D,EAAE4D,aAAapD,cAAcuB,QAAQ,IAAI,SAE9D8B,EAAMrS,EAAUmS,GACpB,QAAYxX,IAAR0X,EAAoB,CAItB,QAAY1X,KAFZ0X,EAAMJ,EAAWE,IASf,MALAE,EAAMJ,EAAWE,GAEjB5Z,KAAKwP,WAAW,qBAAuByG,EAAE4D,cACzC7b,QAAQK,IAAI,4BAA8Bub,GAEpC,qBAAuB3D,EAAE4D,aAI/BF,EAAOD,CAEX,CAEAzX,EAAM0X,EAAMC,GAAYL,EAK1B,CAFA,MAAQjW,GACN,MAAMA,CACR,CACF,MACK,GAAY,aAAR2S,EAAE/X,KAET,IACE,IAAI6b,EAAQ9D,EAAE4D,aACVG,EAAWha,KAAKsZ,eAAgBrD,EAAEuD,OAAO,IACzCS,EAAU,KAEd,QAAgC7X,IAA5BpC,KAAK+H,UAAWgS,GAClB,KAAM,oBAER,IAAIG,EAAcla,KAAK+H,UAAWgS,QAEM3X,IAAjCpC,KAAK8H,KAAMoS,EAAYT,OAC5BQ,EAASja,KAAK8H,KAAMoS,EAAYT,MAGlCzZ,KAAK8H,KAAMoS,EAAYT,KAAQO,EAC/B/X,EAAOjC,KAAKsZ,eAAgBY,EAAYC,MAEzB,MAAXF,EACFja,KAAK8H,KAAMmS,EAAQxY,MAASwY,EAG5Bja,KAAK8H,KAAMoS,EAAYT,KAAQ,CAMnC,CAFA,MAAQnW,GACN,MAAMA,CACR,CAGF,OAAOrB,CACT,CAEAqX,eAAgBa,GAEd,GAAY,MAARA,EACF,OAAO,KAGT,GAAyB,GAArBA,EAAKrX,MAAMhE,OACb,OAAO,KAKT,IAFA,IAAImD,EAAMjC,KAAKgZ,mBAAoBmB,EAAKrX,MAAO,IAEtCjE,EAAE,EAAGA,EAAEsb,EAAKrX,MAAMhE,OAAQD,IAAK,CACtC,IAAIoX,EAAIkE,EAAKrX,MAAOjE,GACpB,GAAY,KAARoX,EAAEmE,GACJnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE7B,GAAY,KAARA,EAAEmE,GACTnY,EAAMsT,KAAK8E,IAAKpY,EAAKjC,KAAKgZ,mBAAoB/C,SAE3C,GAAY,KAARA,EAAEmE,GACTnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE7B,GAAY,KAARA,EAAEmE,GACTnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE7B,GAAY,KAARA,EAAEmE,GAAY,CACrB,GAAoC,GAAhCpa,KAAKgZ,mBAAoB/C,GAC3B,KAAM,oBAERhU,GAAOjC,KAAKgZ,mBAAoB/C,EAClC,MACK,GAAY,KAARA,EAAEmE,GACTnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE7B,GAAY,KAARA,EAAEmE,GACTnY,GAAQ,GAAKjC,KAAKgZ,mBAAoB/C,QAEnC,GAAY,MAARA,EAAEmE,GACPnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE/B,GAAY,OAARA,EAAEmE,GACPnY,GAAOjC,KAAKgZ,mBAAoB/C,QAE/B,GAAY,KAARA,EAAEmE,GAEPnY,EADEA,EAAOjC,KAAKgZ,mBAAoB/C,IAC3B,EAED,OAGL,GAAY,KAARA,EAAEmE,GAEPnY,EADEA,EAAOjC,KAAKgZ,mBAAoB/C,IAC3B,EAED,OAGL,GAAY,KAARA,EAAEmE,GAEPnY,EADEA,GAAQjC,KAAKgZ,mBAAoB/C,IAC5B,EAED,OAGL,GAAY,MAARA,EAAEmE,GAEPnY,EADEA,GAAQjC,KAAKgZ,mBAAoB/C,IAC5B,EAED,OAGL,GAAY,MAARA,EAAEmE,GAEPnY,EADEA,GAAQjC,KAAKgZ,mBAAoB/C,IAC5B,EAED,MAGL,IAAY,MAARA,EAAEmE,GAST,KAAM,6BAA6BnE,EAAEmE,GAAG,IAPtCnY,EADEA,GAAQjC,KAAKgZ,mBAAoB/C,IAC5B,EAED,CAMV,CACF,CAEA,OAAIkE,EAAKG,QACCrY,EAENkY,EAAKI,aACI,GAAPtY,GACM,EAEH,EAEFA,CACT,CAEAuY,iBACYxa,KAAK6D,OAAf,IACIoS,EAAIjW,KAAKiG,QAEbjG,KAAK4G,WAAY,EAGjB,IACI+S,EADI3Z,KAAKiG,QAASjG,KAAKyM,YACd,GAEbzM,KAAK4F,MAAMG,gBAAgB,GAE3B/F,KAAKqO,cAEDrO,KAAKqO,aAAgBsL,EAAK7a,SAE5BkB,KAAKqO,YAAc,EACnBrO,KAAKyM,aAEDzM,KAAKyM,YAAewJ,EAAEnX,SAExBkB,KAAKkG,SAAU,EAEflG,KAAK2Q,eAAe,GAEpB3Q,KAAKqS,UAAU,IACfrS,KAAK4Q,cAOX,CAEA6J,QAYUza,KAAK6D,OATb,IAWI6W,EAAW1a,KAAKwH,iBAChBmT,GAAc,EAClB,IASE,GAPI3a,KAAKwF,OAAOoV,YACd5a,KAAKwF,OAAOqV,eAEV7a,KAAK6D,OAAO+W,YAAc5a,KAAK6D,OAAOiX,cAAgB,GACxD9a,KAAK6D,OAAOgX,gBAGT7a,KAAKkG,SACJlG,KAAK4G,WACL5G,KAAK8G,UAGT,GAAI9G,KAAK8G,SAAW,CAEjB,IADA,IAAIiU,EAAY/a,KAAKuF,UACdvF,KAAKoS,YAAcpS,KAAKkQ,KAAKpR,QAAUic,KAAc,GACxD/a,KAAKgb,aAAchb,KAAKkQ,KAAMlQ,KAAKoS,cACnCpS,KAAKoS,cAEHpS,KAAKoS,aAAepS,KAAKkQ,KAAKpR,SAClCkB,KAAK8Q,WACL9Q,KAAK0K,mBAGV,MAEG,CAEA1K,KAAKsF,WAAWtH,QAAQK,IAAI,6CAI/B,IAFA,IAAI4X,EAAIjW,KAAKiG,SAKPjG,KAAKwG,oBAHE,CAQRxG,KAAKsF,WAAWtH,QAAQK,IAAI,iCAC/B,IAAIyY,EAAIb,EAAGjW,KAAKyM,YAChBkO,EAAa7D,EAAE,GAKf,IAAImE,EAAKjb,KAAKqO,YACXrO,KAAKsF,WAAWtH,QAAQK,IAAI,sBAAwB2B,KAAKyM,WAAY,uBAAyBzM,KAAKqO,aACnGrO,KAAKsF,WAAWtH,QAAQK,IAAI,eAAiBqc,GAChD,IAAI5C,EAAK9X,KAAKkb,YAAapE,EAAE,GAAI4D,GAEjC,QAA0BtY,IAAnBpC,KAAKmb,UACR,IAAK,IAAIC,EAAI,EAAGA,EAAIpb,KAAKmb,UAAUrc,OAAQsc,IAAO,CAChD,IAAIC,EAAUrb,KAAKmb,UAAWC,GAC1BE,EAAYtb,KAAK8H,KAAMuT,GACvBE,EAAWvb,KAAKwb,eAAgBH,QAEdjZ,IAAdkZ,GACFC,GAAYD,IACdtb,KAAKyb,UAAU1c,KACb,OAAS4b,EAAa,KAAOU,EAAU,IAAMC,GAG/Ctb,KAAKwb,eAAgBH,GAAYC,EAIvC,CAIJ,IAAII,EAAK5D,EAAI,GAnFI,IAqFbA,EAAG,KACL9X,KAAKqO,YAAcqN,GAGrB,IAAIC,EAAgB7D,EAAG,GAQvB,GANG9X,KAAKsF,WAAWtH,QAAQK,IAAI,SAAW4c,EAAI,SAAWS,GACtD1b,KAAKsF,WAAWtH,QAAQK,IAAI,oBAAsBsd,GAClD3b,KAAKsF,WAAWtH,QAAQK,IAAI,SAAWyZ,GAE1C4C,GAAsBiB,EAElB7D,EAAG,IAAI,EAAI,CACV9X,KAAKsF,WAAWtH,QAAQK,IAAI,gBAC/B2B,KAAKkG,SAAU,EACf,IAAI5C,EAAI,KACJwU,EAAGhZ,QAAU,IACfwE,EAAIwU,EAAG,IAET9X,KAAKqS,UAAU,IACfrS,KAAK4Q,aACL5Q,KAAK2Q,eAAe,GA7GV,GA8GNmH,EAAG,KAEL9X,KAAKuO,OAAO,OAAQoM,GACpB3c,QAAQK,IAAI,UAAWiF,EAAG,SAAUtD,KAAK4b,uBACzC5d,QAAQK,IAAI,kBAAmB2B,KAAK8H,MACpC9J,QAAQK,IAAI,iBAAkB2B,KAAK+H,YAElC/H,KAAKsF,WAAWtH,QAAQK,IAAI,oBAE/B,KACF,CACK,GAvHS,IAuHLyZ,EAAG,IAKV,GAJA9X,KAAKyM,aACLzM,KAAKqO,YAAc,EAChBrO,KAAKsF,WAAWtH,QAAQK,IAAI,0BAA4B2B,KAAKyM,WAAY,uBAAyBzM,KAAKqO,aAEtGrO,KAAKyM,YAAewJ,EAAEnX,OAAS,CAC9BkB,KAAKsF,WAAWtH,QAAQK,IAAK,eAEhC2B,KAAKuO,OAAO,OAAQoM,GAEf3a,KAAKwG,mBAMRxG,KAAK0Q,kBAAmB,GALxB1Q,KAAKkG,SAAU,EACflG,KAAK2Q,eAAe,GACpB3Q,KAAK4Q,cAKP,KACF,OAEG,GA1IY,IA0IRkH,EAAG,GAEP9X,KAAKsF,WAAWtH,QAAQK,IAAI,kCAAoC2B,KAAKyM,WAAY,uBAAyBzM,KAAKqO,iBAG/G,IA9IS,IA8ILyJ,EAAG,GAAsB,CAEhC9X,KAAKqO,YAAcqN,EAChB1b,KAAKsF,WAAWtH,QAAQK,IAAI,sBAAwB2B,KAAKyM,WAAa,IAAMzM,KAAKqO,aACpF,KAEF,CACK,GApJc,IAoJVyJ,EAAG,GAA2B,CAErC9X,KAAKqO,YAAcqN,EAChB1b,KAAKsF,WAAWtH,QAAQK,IAAI,8BAAgC2B,KAAKyM,WAAa,IAAMzM,KAAKqO,aAC5F,KAEF,CACK,GA1JM,IA0JFyJ,EAAG,GAAmB,CAE7B9X,KAAKqO,YAAcqN,EAChB1b,KAAKsF,WAAWtH,QAAQK,IAAI,sBAAwB2B,KAAKyM,WAAa,IAAMzM,KAAKqO,aACpF,KAEF,EAEA,GAAIqM,GAAU,EAAI,CACb1a,KAAKsF,WAAWtH,QAAQK,IAAI,qBAAuBqc,GACtD,KACF,CAEF,CAEG1a,KAAKsF,WAAWtH,QAAQK,IAAI,sBAAwB2B,KAAKyM,WAAY,uBAAyBzM,KAAKqO,YAExG,CAqDF,CAlDA,MAAO/K,GAQL,GALAzF,EAAIQ,IAAI,iBAAkBiF,GAE1BtD,KAAKuO,OAAO,OAAQoM,GAGhB3a,KAAK6H,IAAIrE,QAASF,GAAM,CAC1B,IAAIN,EAAMM,EAEVtD,KAAKuO,OAAO,MAAOvL,EAAIT,OACvBvC,KAAKuO,OAAO,YAAavL,EAAIjB,QAE7B/B,KAAKwP,WAAYxM,EAAIT,WAAOH,OAAWA,EAAWY,EAAIjB,OACxD,MACS/B,KAAK6H,IAAIzE,kBAAmBE,IAC/BN,EAAMhD,KAAK6H,IAAI1E,oBAAqBG,GAExCtD,KAAKuO,OAAO,MAAOvL,EAAIT,OACvBvC,KAAKuO,OAAO,YAAavL,EAAIjB,QAE7B/B,KAAKwP,WAAYxM,EAAIT,WAAOH,OAAWA,EAAWY,EAAIjB,UAGlDiB,EAAMhD,KAAK6H,IAAIlF,wBAAyBW,OAAGlB,OAAWA,GAEtDY,GAEAhD,KAAKuO,OAAO,MAAOvL,EAAIT,OACvBvC,KAAKuO,OAAO,YAAavL,EAAIjB,QAC7B/B,KAAKwP,WAAYxM,EAAIT,WAAOH,OAAWA,EAAWY,EAAIjB,UAItD/B,KAAKuO,OAAO,MAAO,cACnBvO,KAAKuO,OAAO,YAAa,cACzBvO,KAAKwP,WAAY,kBAAcpN,OAAWA,EAAWkB,KAK3DtD,KAAK4Q,aACL5Q,KAAKkG,SAAU,EACflG,KAAK2Q,eAAe,GAEpB9S,EAAIQ,IAAI,UAAWiF,EAAG,SAAUtD,KAAK4b,uBACrC/d,EAAIQ,IAAI,kBAAmB2B,KAAK8H,MAChCjK,EAAIQ,IAAI,iBAAkB2B,KAAK+H,UAEjC,CAEA,IAAI8T,EAAK7b,KAAK8b,OAEVC,EAASF,EAAGG,UAOhB,OALIhc,KAAKmG,cAAmB4V,EAASF,EAAGI,cAC/Bjc,KAAKoG,gBAAoB2V,EAASF,EAAGK,eAAkBre,EAAIQ,IAAI,aAC/D2B,KAAK4G,UAAemV,EAASF,EAAGM,YAChCnc,KAAKkG,QAAUlG,KAAK8G,WAAaiV,EAASF,EAAGO,eAE/C,CAAEpc,KAAKgH,cAAe+U,EAAQ/b,KAAKqG,YAC5C,CAEAgW,WAEE,IAAIC,EAActc,KAAKiH,YAAYsV,MACnC,QAAoBna,IAAhBka,EACF,KAAM,wBAGRtc,KAAKqO,YAAciO,EAAa,GAChCtc,KAAKyM,WAAa6P,EAAa,EAGjC,CAGAE,oBAEyB,cAAnBxc,KAAKgM,MAAMvK,KACbzB,KAAK2N,gBAAiB,EAGtB3N,KAAK4N,gBAAiB,EAGxB5N,KAAKyM,WAAazM,KAAKgM,MAAMrM,KAAK8M,WAClCzM,KAAKqO,YAAcrO,KAAKgM,MAAMrM,KAAK0O,YAEnCrO,KAAKyc,YAEP,CAKAC,MAAOC,EAAOtO,GAGFrO,KAAKiG,QAAf,IACIyI,EAAI1O,KAAKiG,QAAQnH,OACjB8d,EAAU,KACVC,EAAS,KAEThP,EAAO8O,EACX,GAAoC,kBAAxBA,GAAOlG,eAELrU,OADZyL,EAAO7N,KAAK4O,OAAO+N,IAEjB,KAAM,iBAIV3c,KAAKqO,YAAcA,EAEbrO,KAAKqO,YAAc,EAAKrO,KAAKiG,QAASjG,KAAKyM,YAAa,GAAG3N,QAC/D+d,EAAS7c,KAAKqO,YAAc,EAC5BuO,EAAU5c,KAAKyM,YAGVzM,KAAKyM,WAAW,EAAKiC,GACxBmO,EAAO,EACPD,EAAU5c,KAAKyM,WAAW,IAG1BoQ,EAAO,KACPD,EAAU5c,KAAKyM,YAInBzM,KAAKiH,YAAYlI,KAAM,CAAE6d,EAASC,IAClC7c,KAAK8c,KAAMjP,EACb,CAEAiP,KAAMH,GAGJ,IAGI9O,EAHAY,EAAMzO,KAAKiG,QACXyI,EAAI1O,KAAKiG,QAAQnH,OACjB6P,GAAQ,EAIZ,GADAd,EAAO8O,EAC6B,kBAAxBA,GAAOlG,eAELrU,OADZyL,EAAO7N,KAAK4O,OAAO+N,IAEjB,KAAM,iBAIV,IAAK,IAAI9d,EAAE,EAAGA,EAAE6P,EAAK7P,IACX4P,EAAI5P,GAEN,IAAMgP,IACV7N,KAAKyM,WAAa5N,EAClBmB,KAAKqO,YAAc,EACnBM,GAAQ,GAIZ,IAAIA,EACF,KAAM,qBAGJ3O,KAAKkG,UACPlG,KAAK+c,aAAc,EACnB/c,KAAK8P,SAET,CAEAgB,WACM9Q,KAAK8G,WACH9G,KAAKkG,SACPlG,KAAK8G,UAAW,EAChB9G,KAAK4F,MAAMG,eAAgB/F,KAAKsS,0BAGxBtS,KAAK6D,OACb7D,KAAK8G,UAAW,EAChB9G,KAAK2Q,eAAe,GACpB3Q,KAAKqS,UAAW,IAChBrS,KAAK4Q,cAGX,CAGAC,UACM7Q,KAAKkG,UACClG,KAAK6D,OACb7D,KAAKkG,SAAU,EACflG,KAAK+N,SAASC,gBAAa5L,EAC3BpC,KAAK+N,SAASG,gBAAa9L,EAE3BpC,KAAK2Q,eAAe,GAEpB3S,QAAQK,IAAK,YAAc2B,KAAKiG,QAASjG,KAAKyM,YAAa,IAE3DzM,KAAKuO,OAAQ,OAAQvO,KAAKiG,QAASjG,KAAKyM,YAAa,IACrDzM,KAAKuO,OAAO,MAAO,SAEnBvO,KAAKqS,UAAU,IACfrS,KAAKqS,UAAW,YAAcrS,KAAKiG,QAASjG,KAAKyM,YAAa,IAC9DzM,KAAK4Q,aAET,CAEAX,YACE,OAAOjQ,KAAKkG,OACd,CAEA8W,YACE,OAAOhd,KAAK8G,QACd,CAEAmW,UACE,OAAOjd,KAAK4G,SACd,CAEAsW,UACE,OAAQld,KAAKkG,UAAYlG,KAAK8G,WAAc9G,KAAK0G,eACnD,CAGAyW,gBAIE,IAHA,IAAIjN,EAAO,GAEP3F,EAAU9G,OAAO+G,QAASxK,KAAKgI,YAC1BnJ,EAAE,EAAGA,EAAE0L,EAAQzL,OAAQD,IAC1B0L,EAAQ1L,GAAG,GAAGC,OAAS,GACzBoR,EAAKnR,KAAMwL,EAAQ1L,GAAG,GAAK,KAAO0L,EAAQ1L,GAAG,GAAGC,QAKpD,OAAOoR,CAET,CAEAkN,WAEE,KAAIpd,KAAKqd,aAAerd,KAAKL,KAAKb,QAAlC,CAIA,IAAIwe,EAAStd,KAAKL,KAAMK,KAAKqd,aAG7B,OAFArd,KAAKqd,cAEEC,CALP,CAMF,CAGAC,gBAEE,OAAOvd,KAAKL,KAAKb,MAEnB,CAEA0e,QAASC,GACP,IAAIhe,EAAQge,EACNhe,IACJA,EAAQ,WAGVO,KAAKL,KAAOK,KAAKgI,WAAYvI,GAC7BO,KAAKqd,YAAc,CAErB,CAEArN,WAAYrQ,EAAMzB,EAAMuf,GAGtB,IAAIhe,EAAQge,EACNhe,IACJA,EAAQ,WAEVO,KAAKkI,YAAczI,EACnBO,KAAKqd,YAAc,EAEnB,IAAIjE,EAAM,GACVpZ,KAAKgI,WAAWvI,GAAU2Z,EAE1B,IAAIsE,EAAYxf,EAAK6E,MAAM,KAI3B/C,KAAK,kBAHU0d,EAAU,GAAGlP,cAGQ,IAFnBkP,EAAU,GAAGlP,eAEyB7O,EAAMyZ,GAE7DpZ,KAAKL,KAAOyZ,CACd,CAGAuE,qBAAsBhe,EAAMie,GAC1B,IAAIC,EAAQle,EAAK6W,WAAW,IAAI,IAAIA,WAAW,KAAK,IAAIA,WAAW,KAAK,IAAIA,WAAW,KAAK,IAC5FqH,EAAQA,EAAM9a,MAAM,KACpB,IAAK,IAAIlE,EAAE,EAAGA,EAAEgf,EAAM/e,OAAQD,IAC5B+e,EAAM7e,KAAM8e,EAAOhf,GAGvB,CAGAif,qBAAsBne,EAAMie,GAC1B,IAAIC,EAAQle,EAAK6W,WAAW,IAAI,IAAIA,WAAW,KAAK,IAAIA,WAAW,KAAK,IAAIA,WAAW,KAAK,IAC5FqH,EAAQA,EAAM9a,MAAM,KACpB,IAAK,IAAIlE,EAAE,EAAGA,EAAEgf,EAAM/e,OAAQD,IAC5B+e,EAAM7e,KAAM8e,EAAOhf,GAGvB,CAEAkf,uBAAwBpe,EAAMie,GAC5B,IAAIC,EACJA,EAAQle,EAAKoD,MAAM,MACnB,IAAK,IAAIlE,EAAE,EAAGA,EAAEgf,EAAM/e,OAAQD,IAC5B+e,EAAM7e,KAAM8e,EAAOhf,GAGvB,CAEAmf,UAAWzG,GACTvX,KAAK6D,OAAOe,MAAO2S,EACrB,CAEAyD,aAAciD,QACI7b,IAAZ6b,EAKJje,KAAKqS,UAAW4L,GAJZje,KAAKqS,UAAW,MAMtB,CAEA6L,kBAAmBC,EAAIjG,EACnBkG,EACAC,EACAC,EACAC,GAGF,IAAItI,EAAI,IAAIC,EAAQlW,KAAKyH,SAAUzH,KAAK2H,kBACxCsO,EAAEE,OAEF,IAyCIqI,EAzCAC,EAASxI,EAAEyI,UAAWxG,GAAK,GAAO,GAEtC,QAAwB9V,IAAhBic,EAA6B,CAInC,IAAIM,EAAc,GAClB,IAAK9f,EAAI,EAAGA,EAAE4f,EAAO3f,OAAQD,IACL,OAAlB4f,EAAO5f,GAAGX,MACZygB,EAAY5f,KAAM0f,EAAQ5f,IAI9B,IAAI+f,GAAY,EACZC,GAAqB,EAEzB,IAAKhgB,EAAI,EAAGA,EAAE8f,EAAY7f,OAAQD,IAgBhC,GAdMA,EAAE,IACuB,OAAvB8f,EAAY9f,GAAGX,MACU,QAAzBygB,EAAY9f,EAAE,GAAGX,MAA2C,QAAzBygB,EAAY9f,EAAE,GAAGc,MACtDif,GAAY,EACZC,EAAoBhgB,GAEU,OAAvB8f,EAAY9f,GAAGX,MACO,QAAzBygB,EAAY9f,EAAE,GAAGX,MACU,QAAzBygB,EAAY9f,EAAE,GAAGc,MAA2C,SAAzBgf,EAAY9f,EAAE,GAAGc,OAC1Dif,GAAY,EACZC,EAAoBhgB,IAIC,OAAvB8f,EAAY9f,GAAGX,MAAiB0gB,GAAc/f,GAAKggB,EAAoB,CACzE,IAAIC,EAAUT,EAAa,OAASM,EAAY9f,GAAGc,MACpCyC,MAAX0c,IAAyBA,EAAU,OACvCH,EAAY9f,GAAGc,KAAMmf,EACrBF,GAAY,CACd,CAEJ,CACAH,EAAO,GAAG9e,KAAOwe,EAGjBK,EAAYL,EACRC,IACFI,EAAYL,EAAK,KAEnB,IAAK,IAAItf,EAAI,EAAIA,EAAG4f,EAAO3f,OAAQD,IAC7Buf,GACqB,OAAlBK,EAAO5f,GAAGX,OAKZqgB,EACoB,QAAlBE,EAAO5f,GAAGX,MAAoC,SAAlBugB,EAAO5f,GAAGc,OACxC8e,EAAO5f,GAAGc,KAAO,KAIG,QAAlB8e,EAAO5f,GAAGX,MAAoC,KAAlBugB,EAAO5f,GAAGc,OACxC8e,EAAO5f,GAAGc,KAAO,SAIA,OAAlB8e,EAAO5f,GAAGX,KACZsgB,GAAa,IAAOC,EAAO5f,GAAGc,KAAO,IAEZ,QAAlB8e,EAAO5f,GAAGX,MAAqC,GAAnBogB,EACnCE,GAAaC,EAAO5f,GAAGc,KAAO,IAEL,OAAlB8e,EAAO5f,GAAGX,MAAoC,GAAnBogB,GACL,GAAzBG,EAAO5f,GAAGc,KAAKb,OACf0f,GAAa,IAAMC,EAAO5f,GAAGc,KAOjC6e,GAAaC,EAAO5f,GAAGc,MAO3B,OAFUsW,EAAEmC,UAAWoG,EAGzB,CAEAO,WAAYlR,GAEV,OADA7P,QAAQK,IAAKwP,GACS,GAAlBA,EAAK,GAAG/O,aACuBsD,IAAzByL,EAAK,GAAG,GAAGqJ,WACyB,QAAtCrJ,EAAK,GAAG,GAAGqJ,UAAU1I,aAM/B,CAEAwQ,UAAWnR,GAET,OADA7P,QAAQK,IAAKwP,GACS,GAAlBA,EAAK,GAAG/O,aACuBsD,IAAzByL,EAAK,GAAG,GAAGqJ,WACyB,OAAtCrJ,EAAK,GAAG,GAAGqJ,UAAU1I,aAM/B,CAEAyQ,UAAWpR,GAET,OADA7P,QAAQK,IAAKwP,GACS,GAAlBA,EAAK,GAAG/O,aACuBsD,IAAzByL,EAAK,GAAG,GAAGqJ,WACyB,OAAtCrJ,EAAK,GAAG,GAAGqJ,UAAU1I,aAM/B,CAEA0Q,gBAAiBlS,EAAOmS,GAiFpB,IA/EF,IAAIlJ,EAAIjW,KAAKiG,QAETmZ,EAAYpS,EACZqR,EAAc,CAAC,EACfgB,EAAc,GA2EPxgB,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAAK,CAC3B,IAKMygB,EALFzR,EAAOoI,EAAGpX,GACJmB,KAAKif,UAAWpR,MAIpByR,EAAa,IADH/J,KAAKgK,KAAMH,EAAY,MAEpBA,EAAa,MAC5BE,GAAY,KAEdF,EAAYE,GAEdjB,EAAY,OAASxQ,EAAK,IAAMuR,EAChCC,EAAYtgB,KAAMqgB,GAClBA,GAAaD,CAEjB,CAIF,IAAStgB,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAAK,CAC3BugB,EAAYC,EAAaxgB,GACrBgP,EAAOoI,EAAGpX,GAAd,IACI2gB,EAAOxf,KAAKke,kBAAmBkB,EAAWvR,EAAK,IAAI,EAAMwQ,GAAa,GAE1ExQ,EAAK,GAAKuR,EACVvR,EAAK,GAAK2R,EAAK/X,SACfoG,EAAK,GAAK2R,EAAKtH,IAAIlB,MAGvB,CACF,CAEAyI,eAAgBC,GAGd,IAFA,IAAIzJ,EAAIjW,KAAKiG,QAEJpH,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAAK,CAC3B,IAAIgP,EAAOoI,EAAGpX,GAEV2gB,EAAOxf,KAAKiY,2BAA4BpK,EAAK,IAEjDA,EAAK,GAAK2R,EAAK/X,SACfoG,EAAK,GAAK2R,EAAKtH,GAEnB,CACF,CAEAyH,gBAAiBD,GAGf,IAFA,IAAIzJ,EAAIjW,KAAKiG,QAEJpH,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAAK,CAC3B,IAAIgP,EAAOoI,EAAGpX,GAEX2gB,EAAOxf,KAAKke,kBAAmBrQ,EAAK,GAAIA,EAAK,IAAI,OAAMzL,GAAW,EAAOsd,GAE5E7R,EAAK,GAAK2R,EAAK/X,SACfoG,EAAK,GAAK2R,EAAKtH,GAEnB,CACF,CAEA0H,mBAGE,IAFA,IAAI3J,EAAIjW,KAAKiG,QAEJpH,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAAK,CAC3B,IAAIgP,EAAOoI,EAAGpX,GAEV2gB,EAAOxf,KAAKke,kBAAmBrQ,EAAK,GAAIA,EAAK,IAAI,OAAMzL,GAAW,GAEtEyL,EAAK,GAAK2R,EAAK/X,SACfoG,EAAK,GAAK2R,EAAKtH,GAEnB,CACF,CAEApC,SACE9V,KAAK8H,KAAO,CAAC,EACb9H,KAAK+H,UAAY,GACjB/H,KAAK6f,gBACP,CAEAA,iBACE7f,KAAKqd,YAAc,EACnBrd,KAAKL,KAAOK,KAAKgI,WAAsB,OACzC,CAEA8X,cAAeC,GACb,IAAIpgB,EAAOogB,EAAQpgB,KAanB,MAXoB,OAAhBogB,EAAQ7hB,KACyB,kBAAvByB,GAAM8W,gBAChB9W,EAAOkZ,SAAUlZ,IAIgB,kBAAvBA,GAAM8W,gBAChB9W,EAAO,GAAKA,GAITA,CACT,CAEAmQ,SAKE,GAHA9P,KAAK0G,iBAAkB,EACvB1G,KAAK0Q,kBAAmB,EAEpB1Q,KAAK+c,YAAc,CACnB/c,KAAK+c,aAAc,EAEnB,IAAIiD,EAAOhgB,KAAKyM,WACZwT,EAAOjgB,KAAKqO,YAQhB,OANArO,KAAK8P,SAEL9P,KAAKyM,WAAauT,OAClBhgB,KAAKqO,YAAc4R,EAIvB,CAEAjgB,KAAK4F,MAAMG,gBAAgB,GAC3B/F,KAAK4F,MAAM8L,QAEH1R,KAAK6D,OAAb,IACIoS,EAAIjW,KAAKiG,QAEbjG,KAAKgI,WAAsB,QAAI,GAC/BhI,KAAK6f,iBAEL7f,KAAKiH,YAAc,GACnBjH,KAAK2L,OAAS,GACd3L,KAAKoO,SAAU,SAAU,CAAC,GAC1BpO,KAAK+H,UAAY,GACjB/H,KAAK+N,SAAW,CAAC,EACjB/N,KAAK4O,OAAS,CAAC,EACf5O,KAAKyb,UAAY,GACjBzb,KAAKwb,eAAiB,CAAC,EAIvB,IAFA,IAAI0E,EAAYlgB,KAAK8f,cAEZjhB,EAAE,EAAGA,EAAEoX,EAAEnX,OAAQD,IAKtB,IAHA,IAAIgP,EAAOoI,EAAGpX,GACV4I,EAAWoG,EAAK,GAEXsF,EAAE,EAAGA,EAAE1L,EAAS3I,OAAQqU,IAAK,CAEpC,IAAIpO,EAAU0C,EAAS0L,GAEvB,GAAqB,WAAjBpO,EAAQ7G,MAA2C,QAArB6G,EAAQmS,UACxC,IAAK,IAAIiJ,EAAE,EAAGA,EAAEpb,EAAQyU,OAAO1a,OAAQqhB,IACrCngB,KAAKgI,WAAsB,QAAEjJ,KAAMmhB,EAAWnb,EAAQyU,OAAO2G,UAG5D,GAAqB,WAAjBpb,EAAQ7G,MAA2C,MAArB6G,EAAQmS,UACpB,cAArBnS,EAAQyU,OAAO,IACjBxZ,KAAK+N,SAASG,WAAanJ,EAAQyU,OAAO,GAC1CxZ,KAAK+N,SAASI,uBAAyBpJ,EAAQtF,OAEnB,cAArBsF,EAAQyU,OAAO,KACtBxZ,KAAK+N,SAASC,WAAajJ,EAAQyU,OAAO,GAC1CxZ,KAAK+N,SAASE,uBAAyBlJ,EAAQtF,YAG9C,GAAqB,WAAjBsF,EAAQ7G,MAA2C,OAArB6G,EAAQmS,UAAoB,CACjE,IAAIzX,EAAQsF,EAAQtF,MACpBO,KAAK4O,OAAQnP,GAAUoZ,SAAShL,EAAK,GACvC,CACF,CAGA7N,KAAKsF,WACPtH,QAAQK,IAAI,aAAa2B,KAAKL,MAI5BK,KAAKiG,QAAQnH,OAAS,GACxBkB,KAAKkG,SAAU,EACflG,KAAK4G,WAAY,EACjB5G,KAAKqG,YAAc,EACnBrG,KAAKmG,eAAgB,EACrBnG,KAAKoG,gBAAiB,EACtBpG,KAAKyM,WAAa,EAClBzM,KAAKqO,YAAc,EACnBrO,KAAKwG,oBAAqB,EAC1BxG,KAAK2N,gBAAiB,EACtB3N,KAAK4N,gBAAiB,EACtB5N,KAAKgL,aAAc,KAInBhL,KAAKkG,SAAU,EACflG,KAAK4G,WAAY,EACjB5G,KAAKqG,YAAc,EACnBrG,KAAKmG,eAAgB,EACrBnG,KAAKoG,gBAAiB,EACtBpG,KAAKyM,WAAa,EAClBzM,KAAKqO,YAAc,EACnBrO,KAAKwG,oBAAqB,EAC1BxG,KAAK2N,gBAAiB,EACtB3N,KAAK4N,gBAAiB,EACtB5N,KAAKgL,aAAc,GACnBhL,KAAK4F,MAAMG,gBAAgB,IAG7B/F,KAAK0K,kBACP,CAEAiC,UACE,OAAO3M,KAAK8H,IACd,CAKAsY,UAAWC,EAAMC,EAAIC,EAAMC,EAASC,EAAYC,EAAaC,GAE3D,IAAIC,EAAM5gB,KAAKwI,gBAEcpG,IAAzBpC,KAAK8H,KAAM0Y,KACbxgB,KAAK8H,KAAM0Y,GAAY,GAEzBxgB,KAAK8H,KAAM0Y,GAAYxgB,KAAKsZ,eAAgB+G,GAE5CO,EAAI3Y,QAAQlJ,KAAMyhB,GAClBI,EAAIJ,GAAW,CAAC,EAEhB,IAAIK,EAAOD,EAAIJ,GAaf,GAZAK,EAAKP,GAAKtgB,KAAKsZ,eAAgBgH,GAG3BO,EAAKN,KADG,MAARA,EACY,EAGFvgB,KAAKsZ,eAAgBiH,GAGnCM,EAAKpc,OACH,CAAEoJ,KAAM7N,KAAKyM,WACXgU,WAAYA,EAAW,GACvBI,EAAKpc,OAAOgc,YAAcC,EAAe,CAE3C,IAAwB,GAApB1gB,KAAKyM,WACP,KAAM,yCAGN,GAAMzM,KAAKyM,WAAa,GAAMkU,EAC5B,KAAM,uDAERE,EAAKpc,OAAOoJ,OACZgT,EAAKpc,OAAOgc,WAAa,CAE7B,CAEF,CAEAK,UAAWC,GACT,IAAIH,EAAM5gB,KAAKwI,WACf,GAA0B,GAAtBoY,EAAI3Y,QAAQnJ,OACd,KAAM,2BAER,IAAI0hB,EAAUI,EAAI3Y,QAAQ2Y,EAAI3Y,QAAQnJ,OAAO,GACzB,MAAhBiiB,IACFP,EAAUO,GAGZ,IAAIF,EAAOD,EAAIJ,GAGf,GADAxgB,KAAK8H,KAAM0Y,IAAaK,EAAKN,KACzBM,EAAKN,KAAO,GACd,GAAGvgB,KAAK8H,KAAM0Y,IAAWK,EAAKP,GAE5B,OAAOO,EAAKpc,WAGX,IAAiB,GAAboc,EAAKN,KACZ,OAAOM,EAAKpc,OAGZ,GAAGzE,KAAK8H,KAAM0Y,IAAWK,EAAKP,GAC5B,OAAOO,EAAKpc,MAEhB,CAGA,OADAmc,EAAI3Y,QAAQsU,OACJ,CACV,CAEAlI,YAEE,IAAIxG,EAAO7N,KAAKghB,eAChB,OAAa,GAATnT,GAAsB,IAARA,EAAqB,GAEhC,OAASA,CAElB,CAEA+N,sBACE,OAAI5b,KAAKyM,YAAc,EACVzM,KAAKiG,QAAQjG,KAAKyM,YACjB,IAEN,CACV,CAGAuU,eACE,OAAIhhB,KAAKkG,QACAlG,KAAK4b,2BAGoBxZ,IAA5BpC,KAAsB,iBAChB,GAEmB,GAAzBA,KAAKihB,gBAAgC,GAClCjhB,KAAKihB,eAGhB,CAGAC,gBAAiBC,GACf,MAAgB,WAAZA,EAAIjjB,KACCijB,EAAIjK,UAAU1I,cAEF,QAAZ2S,EAAIjjB,KACJijB,EAAIC,cAEQ,cAAZD,EAAIjjB,KACJ,YAAcijB,EAAIE,IAEpB,MACT,CAEAnG,YAAavB,EAAM2H,GAYjB,IAAI7Z,EAAWzH,KAAKyH,SAChBiS,EAAY1Z,KAAK2H,iBAQjB4Z,EAAmB,GAKnBC,EAAM7H,EAAK7a,OACXD,EAAEmB,KAAKqO,YACPoT,EAAI,EASR,IAPcrf,MAATkf,IAIHA,EAAQ,MAGHziB,EAAE2iB,GAAOC,EAAIH,GAAQ,CAG1B,IAAIH,EAAIxH,EAAK9a,GAETiY,EAAE9W,KAAKiG,QAAQjG,KAAKyM,YAOxB,GANIqK,GACmB,MAAlB+B,SAAS/B,EAAE,KACZ9Y,QAAQK,IAAI,QAIA,WAAZ8iB,EAAIjjB,KAAqB,CAC3B,IAAIwjB,EAAKP,EAAIjK,UACb,GAAU,QAANwK,EAEF,OADA1hB,KAAK8c,KAAMqE,EAAI3H,OAAO,IACf,CAAC+H,EAAiB1iB,EAAE,EAAE4iB,EAAI,GAE9B,GAAU,OAANC,EACP,MAAO,EAtCW,EAsCQ7iB,EAAE,EAAE4iB,EAAI,GAE/B,GAAU,QAANC,EAEP,OADA1hB,KAAKsU,UAAU,SACR,EA1CW,EA0CQzV,EAAE,EAAE4iB,EAAI,GAE/B,GAAU,SAANC,EAEP,OADA1hB,KAAK0c,MAAOyE,EAAI3H,OAAO,GAAI3a,GACpB,CAAC0iB,EAAiB1iB,EAAE,EAAE4iB,EAAI,GAE9B,GAAU,MAANC,EAAa,CACpB,IAAIC,EAAYR,EAAI3H,OAAQ,GAE5B,GAAiB,cAAbmI,GAA2C,cAAbA,EAA4B,CAC5D,IAAIC,EAAST,EAAI3H,OAAQ,GACrBqI,EAAYV,EAAI3H,OAAQ,GAExBrN,EAAQnM,KAAKsZ,eAAgBsI,GACjC,GAAKzV,EAAM,GAAI,GAAMA,EAAM,EAAG0V,EAAU/iB,OAAS,CAC/C,GAAiB,QAAb6iB,EAEF,OADA3hB,KAAK8c,KAAM+E,EAAY1V,EAAM,IACtB,CAACoV,EAAiB1iB,EAAE,EAAE4iB,EAAI,GAE9B,GAAiB,SAAbE,EAEP,OADA3hB,KAAK0c,MAAOmF,EAAY1V,EAAM,GAAMtN,GAC7B,CAAC0iB,EAAiB1iB,EAAE,EAAE4iB,EAAI,EAErC,CACF,CAGF,KACK,IAAU,UAANC,EAWP,OATI1hB,KAAK2N,gBAAkB3N,KAAK4N,eAE9B5N,KAAKwc,oBAILxc,KAAKqc,WAGA,CAACkF,EAAiB1iB,EAAE,EAAE4iB,EAAI,GAE9B,GAAU,MAANC,GAMP,GAHe,GAEA1hB,KAAKsZ,eAAgB6H,EAAI3H,OAAO,IAK5C,MAAO,CA5FI,GA4FW3a,EAAE,EAAE4iB,EAAI,QAG9B,GAAU,QAANC,OAGJ,IAAU,OAANA,EACP,MAAO,CAnGO,GAmGQ7iB,EAAE,EAAE4iB,EAAI,GAE3B,GAAU,OAANC,EACP,MAAO,CAtGO,GAsGQ7iB,EAAE,EAAE4iB,EAAI,GAE3B,GAAU,YAANC,EACP1hB,KAAKogB,UAAWe,EAAI3H,OAAO,GAAI2H,EAAI3H,OAAO,GAAI2H,EAAI3H,OAAO,GAAI2H,EAAI9T,SAAUxO,EAAG8a,EAAK7a,aAEhF,GAAU,YAAN4iB,EAAmB,CAE1B,IAAII,EAAO9hB,KAAK8gB,UAAWK,EAAIY,SAE/B,IAAgB,IAAVD,EAAgB,CAEpB,IAAkB,GAAdA,EAAKjU,KAAa,CAClB,GAAI7N,KAAKyM,YAAcqV,EAAKjU,KAAO,CACjChP,EAAIijB,EAAKrB,WACTgB,IACA,QACF,CAKA,OAHEzhB,KAAKyM,WAAaqV,EAAKjU,KACvB7N,KAAKqO,YAAcyT,EAAKrB,WAEnB,CAACc,EAAiB1iB,EAAE,EAAE4iB,EAAI,EACrC,CAEE5iB,EAAIijB,EAAKrB,WACTgB,IACA,QAEJ,CACF,MACK,GAAU,OAANC,EACP,CAAW1hB,KAAK8H,KAEhB,IAFA,IAESka,EAAG,EAAGA,EAAGb,EAAI3H,OAAO1a,OAAQkjB,IAAM,CAGzC,IADA,IAAItgB,EAAU,GACL2X,EAAG,EAAEA,EAAG8H,EAAI3H,OAAOwI,GAAIljB,OAAOua,IACrC3X,EAAQ2X,GAAMrZ,KAAKsZ,eAAgB6H,EAAI3H,OAAOwI,GAAI3I,IAGpD,IAAI4I,EAAS,IAAI1gB,EAAY4f,EAAIe,WAAWF,GAAKtgB,EAAS,GAEtDyX,EAAa,UAAYgI,EAAIe,WAAWF,GAE5C,QAAoC5f,IAA5BpC,KAAK8H,KAAMqR,GAEjB,OADAnZ,KAAKwP,WAAY,iBACV,CAtJC,EAsJY3Q,EAAE,EAAE4iB,EAAI,GAE9BzhB,KAAK8H,KAAMqR,GAAe8I,CAC5B,CAlBoB,KAqBjB,IAAU,OAANP,EAQP,OADA1hB,KAAKwP,WAAY,uBAAyBkS,EAAK,KACxC,CApKK,EAoKQ7iB,EAAE,EAAE4iB,EAAI,GAP5BzhB,KAAK+H,UAAWoZ,EAAI3H,OAAO,IAAO,CAChCC,IAAK0H,EAAI3H,OAAO,GAChBW,KAAMgH,EAAI3H,OAAO,GAMrB,GACF,MACK,GAAgB,QAAZ2H,EAAIjjB,KAAkB,CAC7B,IAAIqb,EAAS,GACT4I,EAAU,GACVC,EAAa3a,EACbqS,EAAMsI,EAAY,SAAWjB,EAAIC,cAAc3K,eAEnD,QAAYrU,IAAR0X,EAMF,QAAY1X,KAFZ0X,GAFAsI,EAAa1I,GAEK,SAAWyH,EAAIC,cAAc3K,sBAI7C,GAA0B,GAAtB2L,EAAWC,SACsB,OAAnClB,EAAIC,cAAc3K,cAEd,OADAzW,KAAKwP,WAAY,wBACV,CAxLH,EAwLgB3Q,EAAE,EAAE4iB,EAAI,GAMtC,QAAgBrf,IADLggB,EAAY,OAASjB,EAAIC,cAAc3K,eAE9C0L,EAAUC,EAAY,OAASjB,EAAIC,cAAc3K,sBAGnD,IAAK,IAAItD,EAAE,EAAGA,EAAEgO,EAAI3H,OAAO1a,OAAQqU,IACjCgP,EAAQhP,GAtML,EA0MP,IAASA,EAAE,EAAGA,EAAEgO,EAAI3H,OAAO1a,OAAQqU,IACjC,GA3MK,GA2MDgP,EAAQhP,GAAa,CAEvB,IAAI8C,EAAIjW,KAAKsZ,eAAgB6H,EAAI3H,OAAOrG,IAE/B,MAAL8C,GACFsD,EAAOxa,KAAM,CAAEb,KAAM,QAASiO,MAAO8J,GAEzC,MACK,GAnNS,GAmNLkM,EAAQhP,GAAY,CAC3B,IAAIqN,EAAUW,EAAI3H,OAAOrG,GAAGrQ,MAAM,GAAGnD,KACjC2iB,EAAWnB,EAAI3H,OAAOrG,GAAGrQ,MAAM,GAAG5E,KAEtC,GAAgB,SAAZokB,EAAsB,CAExB,IAAIC,EAAU,MACV/B,EAAQzI,QAAQ,MAAQ,IAC1BwK,EAAU,OAGZhJ,EAAOxa,KAAM,CAAEb,KAAM,MAAOiO,MAAOqU,EAAS+B,QAASD,EAAW,IAAMC,GAGxE,MAEMA,EAAU,MACV/B,EAAQzI,QAAQ,MAAQ,IAC1BwK,EAAU,OAGZhJ,EAAOxa,KAAM,CAAEb,KAAM,MAAOiO,MAAOqU,EAAS+B,QAASA,GAIzD,MAGEhJ,EAAOxa,KAAMoiB,EAAI3H,OAAOrG,IAI5B,IAEE,QAAY/Q,IAAR0X,EAEF,OADA9Z,KAAKwP,WAAW,UACT,CApPG,EAoPU3Q,EAAE,EAAE4iB,EAAI,GAQ1B,GAJAzhB,KAAK6G,cAAgB,EAErBub,EAAY,SAAWjB,EAAIC,cAAc3K,eAAgB8C,GAErDvZ,KAAK4G,UACP,MAAO,CAxPC,GAwPc/H,EAAE,EAAE4iB,EAAI,GAE3B,GAAKzhB,KAAKmG,cACb,MAAO,CA1PM,GA0PctH,EAAE,EAAE4iB,EAAI,GAEhC,GAAKzhB,KAAKoG,eACb,MAAO,CA5PF,GA4PcvH,EAAE,EAAE4iB,EAAI,EAsBnC,CAhBA,MAAQne,GAGN,GAFAtF,QAAQK,IAAIiF,GAERtD,KAAK6H,IAAIzE,kBAAmBE,GAAM,CACpC,IAAIN,EAAMhD,KAAK6H,IAAI1E,oBAAqBG,GACxCtD,KAAKwP,WAAYxM,EAAIT,OAAO,GAAO,EAAOS,EAAIjB,OAChD,MACS/B,KAAK6H,IAAIrE,QAASF,IACrBN,EAAMM,EACVtD,KAAKwP,WAAYxM,EAAIT,OAAO,GAAO,EAAOS,EAAIjB,SAG9C/B,KAAKwP,WAAW,cAAgBlM,GAGlC,MAAO,CAxRK,EAwRQzE,EAAE,EAAE4iB,EAC1B,CACF,MACK,GAAgB,cAAZN,EAAIjjB,KACX,GAAIijB,EAAIqB,gBAAkB,CAExB,GADIrJ,EAAa,UAAYgI,EAAIE,SACDjf,IAA5BpC,KAAK8H,KAAMqR,GAGb,OAFAnZ,KAAKwP,WAAW,iBAAgB,GAAO,EAAO,iBAEvC,CAjSG,EAiSU3Q,EAAE,EAAE4iB,GAG1B,IAAIrI,EAAMpZ,KAAK8H,KAAMqR,GACrB,GAAIgI,EAAIzf,QAAQ5C,QAAUsa,EAAIvX,gBAE5B,OADA7B,KAAKwP,WAAW,iBAAgB,GAAO,EAAO,oBACvC,CAvSG,EAuSU3Q,EAAE,EAAE4iB,GAI1B,IADI/f,EAAU,GACL2X,EAAG,EAAEA,EAAG8H,EAAIzf,QAAQ5C,OAAOua,IAClC3X,EAAQ2X,GAAMrZ,KAAKsZ,eAAgB6H,EAAIzf,QAAQ2X,IAGjD,GAAI8H,EAAIE,IAAI/U,SAAS,KACjB8M,EAAIpX,IAAKN,EAAS6T,KAAKC,MAAOxV,KAAKsZ,eAAgB6H,EAAIsB,mBAEtD,GAAMtB,EAAIE,IAAI/U,SAAS,KASxB8M,EAAIpX,IAAKN,EAAS1B,KAAKsZ,eAAgB6H,EAAIsB,iBATZ,CAE/B,GAAmB,iBADXziB,KAAKsZ,eAAgB6H,EAAIsB,YAG/B,OADAziB,KAAKwP,WAAW,qBAAiBpN,OAAWA,EAAW,sBAChD,CAtTD,EAsTcvD,EAAE,EAAE4iB,GAE1BrI,EAAIpX,IAAKN,EAAS1B,KAAKsZ,eAAgB6H,EAAIsB,YAC/C,CAKF,KACK,CACH,QAA6BrgB,IAAzBpC,KAAK8H,KAAMqZ,EAAIE,KAAsB,CACvC,GAAGF,EAAIE,IAAI9d,WAAW,MAEpB,OADAvD,KAAKwP,WAAW,UACT,CAnUC,EAmUY3Q,EAAE,EAAE4iB,EAAI,GAE9BzhB,KAAK8H,KAAMqZ,EAAIE,KAAQ,CACzB,CACA,GAAGF,EAAIE,IAAI/U,SAAS,KAClBtM,KAAK8H,KAAMqZ,EAAIE,KAAQ9L,KAAKC,MAAOxV,KAAKsZ,eAAgB6H,EAAIsB,kBAEzD,GAAMtB,EAAIE,IAAI/U,SAAS,KAS1BtM,KAAK8H,KAAMqZ,EAAIE,KAAQrhB,KAAKsZ,eAAgB6H,EAAIsB,gBATf,CAE/B,GAAmB,iBADXziB,KAAKsZ,eAAgB6H,EAAIsB,YAG/B,OADAziB,KAAKwP,WAAW,qBAAiBpN,OAAWA,EAAW,sBAChD,CA9UD,EA8UcvD,EAAE,EAAE4iB,GAE1BzhB,KAAK8H,KAAMqZ,EAAIE,KAAQrhB,KAAKsZ,eAAgB6H,EAAIsB,WACpD,CAIF,CAGF5jB,IACA4iB,GACF,CAEA,OAAI5iB,GAAI8a,EAAK7a,OACJ,CA3VW,GA2VID,EAAE4iB,GAGnB,CA7VgB,GA6VE5iB,EAAE4iB,EAE7B,CAEArT,SAAU3M,EAAM9B,GACd,IAAIqM,EAAQ,CAAEvK,KAAMA,EAAMqG,KAAM,CAAC,EAAGnI,KAAMA,GAC1CK,KAAK2L,OAAO5M,KAAMiN,GAClBhM,KAAK8H,KAAOkE,EAAMlE,KAClB9H,KAAKgM,MAAQA,CACf,CAEAyQ,aACEzc,KAAK2L,OAAO4Q,MACZvc,KAAK8H,KAAO9H,KAAK2L,OAAQ3L,KAAK2L,OAAO7M,OAAS,GAAIgJ,IACpD,CAGA4a,SAAUrP,GACT,OAAOrT,KAAK8H,KAAO,UAAYuL,EAChC,CAEA9E,OAAQ8E,EAAGC,GACTtT,KAAK8H,KAAMuL,GAAMC,CACnB,CAEAqP,eACE,YAAuBvgB,IAAnBpC,KAAKyb,UACA,GAGFzb,KAAKyb,SACd,CAEAmH,YAAanQ,QACYrQ,IAAnBpC,KAAKmb,YACLnb,KAAKmb,UAAY,IAErBnb,KAAKmb,UAAUpc,KAAM0T,EAAEjE,cAEzB,CAEAqU,cAAepQ,GACbzS,KAAKmb,eAAY/Y,CACnB,CAGA0gB,MACE9iB,KAAKiG,QAAUjG,KAAK+iB,UACtB,CAEAC,MACEhjB,KAAK+iB,WAAa/iB,KAAKiG,QACvBjG,KAAKiG,QAAU,EACjB,CAEAgd,cAAeC,GAIb,IAFA,IAAIC,EAAO,GAEFtkB,EAAE,EAAGA,EAAEmB,KAAKiG,QAAQnH,OAAQD,IAAK,CACxC,IAAIukB,EAAGpjB,KAAKiG,QAAQpH,GAChBukB,EAAG,IAAMF,GACXC,EAAKpkB,KAAKqkB,EAEd,CACApjB,KAAKiG,QAAUkd,CAEjB,CAGAE,WAAYC,GAEV,IADA,IAAI1gB,EAAI0gB,EAAK,GACLzkB,EAAE+D,EAAE9D,OAAQD,EAAE,EAAGA,IACvB+D,GAAG,IAEL,OAAOA,CACT,CAEA2gB,WAAYD,GAEV,IADA,IAAI1gB,EAAI0gB,EAAK,GACLzkB,EAAE+D,EAAE9D,OAAQD,EAAE,EAAGA,IACvB+D,GAAG,IAEL,OAAOA,CACT,CAGA4gB,cAAeN,EAAQzb,EAAUsG,EAAUmK,GAEzClY,KAAKyjB,mBAAoBP,EAAQzb,EAAUsG,EAAUmK,EAAKlY,KAAKiG,QACjE,CAEAwd,mBAAoBP,EAAQzb,EAAUsG,EAAUmK,EAAKwL,GAEnD,IAAK,IAAI7kB,EAAE,EAAGA,EAAE6kB,EAAU5kB,OAAQD,IAEhC,GADO6kB,EAAU7kB,GACV,IAAMqkB,EAEX,YADAQ,EAAU7kB,GAAK,CAACqkB,EAAQzb,EAAUyQ,EAAIlB,SAK1C0M,EAAU3kB,KAAM,CAACmkB,EAAQzb,EAAUyQ,EAAIlB,OAAQjJ,IAM/C2V,EAAUtQ,MAJE,SAAkBC,EAAGC,GAC/B,OAAOD,EAAE,GAAKC,EAAE,EAClB,GAIF,CAEAxB,eAAgB6R,GAEd,IAAID,EAAY,GACZE,OAAYxhB,EAEZpC,KAAKsF,WACPtH,QAAQK,IAAK,kBAEf,IAAK,IAAIQ,EAAI,EAAGA,EAAE8kB,EAAM7kB,OAAQD,IAAM,CAEpC,IAAIgP,EAAO7N,KAAK2Y,qBAAsBgL,EAAO9kB,IACzCoX,EAAI,IAAIC,EAAQlW,KAAKyH,SAAUzH,KAAK2H,kBACxCsO,EAAEE,OAEF,IAAIW,EAAI,KAER,IACIA,EAAIb,EAAEmC,UAAWvK,EAcrB,CAZA,MAAQvK,QACYlB,IAAdwhB,IACAA,EAAYtgB,GAGhB,IACEwT,EAAIb,EAAE4N,eAAgBhW,EAKxB,CAHA,MAAQvK,GACJtD,KAAKwP,WAAY,uBAAuB3Q,EAAE,KAAK,GAC/Cb,QAAQK,IAAI,iBAAkBwP,EAClC,CACF,CAEA,GAAS,MAALiJ,EAAJ,CAGA,IAAqB,GAAjBA,EAAE6D,WAUJ,KAAM,8DATN,KAAI7D,EAAErP,SAAS3I,OAAS,GAKtB,KAAM,8BAAgCgY,EAAE6D,WAJxC3a,KAAKyjB,mBAAoB3M,EAAE6D,WAAY7D,EAAErP,SAAUqP,EAAE/I,SAAU+I,EAAEoB,IAAMwL,GAWvE1jB,KAAKsF,YACPtH,QAAQK,IAAI,WAAWqlB,GACvB1lB,QAAQK,IAAI,SAAUyY,GAhBxB,CAkBF,CACA,MAAO,CAAErI,IAAKiV,EAAWE,UAAWA,EACtC,CAEAhT,aACE5Q,KAAKqS,UAAU,SACjB,CAGAyR,sBAAuBhc,GAEjB9H,KAAKsF,WACPtH,QAAQK,IAAI,aAAayJ,GAE3B9H,KAAK4G,WAAY,EACjB5G,KAAK+jB,UAAYjc,EACjB9H,KAAK4F,MAAMG,gBAAgB,GAC3B/F,KAAKgkB,iBAAmB,EACxBhkB,KAAK6D,OAAOe,MAAO,MACnB5E,KAAKmR,oBAAsBnR,KAAK6D,OAAOmN,eAAe,GAEtDhR,KAAK0K,kBAEP,CAEAxF,uBAAwBsL,GACtBxQ,KAAKoR,gBAAiBZ,GAAK,EAC7B,CAEAY,gBAAiBZ,EAAKyT,GAMpB,GAJIjkB,KAAKsF,WACPtH,QAAQK,IAAI,iDAAmD4lB,EAAiB,kBAG9EA,EAAiB,CAIjB,IAFA,IAAIre,EAAM4K,EACN0T,EAAQte,EAAMmS,QAAQ,KACnBmM,GAAS,GAEdA,GADAte,EAAQA,EAAMvC,OAAO6gB,EAAM,IACbnM,QAAQ,KAcxB,GAXI/X,KAAKsF,YACPtH,QAAQK,IAAI,4DACZL,QAAQK,IAAK,oBAAsB2B,KAAKgkB,kBACxChmB,QAAQK,IAAK,aAAe2B,KAAK+jB,WAEjC/lB,QAAQK,IAAK,gBAAiBuH,GAC9B5H,QAAQK,IAAK,uBAAwB2B,KAAK+jB,UAAW/jB,KAAKgkB,oBAIhDhkB,KAAK+jB,UAAW/jB,KAAKgkB,kBACvBjM,QAAQ,MAAO,EACrB/X,KAAKuO,OAAQvO,KAAK+jB,UAAW/jB,KAAKgkB,kBAAoBpe,EAAMoR,YAE3D,CACH,IAAI4B,EAAMK,WAAYrT,EAAMoR,QAE5B,GAAImN,MAAOvL,GAGT,OAFA5Y,KAAKqS,UAAU,yBACfrS,KAAKge,UAAW,MAGlBhe,KAAKuO,OAAQvO,KAAK+jB,UAAW/jB,KAAKgkB,kBAAoBpL,EACxD,CAcA,OAZA5Y,KAAKgkB,mBACDhkB,KAAKgkB,kBAAoBhkB,KAAK+jB,UAAUjlB,OAE1CkB,KAAKwa,iBAGLxa,KAAKge,UAAW,YAGdhe,KAAKsF,WACPtH,QAAQK,IAAI,4CAGlB,CAEA2B,KAAK0G,iBAAkB,EAEnB1G,KAAKsF,WACPtH,QAAQK,IAAKmS,GAEf,IAAIyF,EAAI,IAAIC,EAAQlW,KAAKyH,SAAUzH,KAAK2H,kBACxCsO,EAAEE,OACF,IACE,IAAIW,EAAIb,EAAEmC,UAAW5H,EAavB,CAXA,MAAOlN,GAELtD,KAAKihB,iBAAmB,EACpBjhB,KAAK6H,IAAIrE,QAASF,IACpBtD,KAAKihB,gBAAkB3d,EAAEb,OACzBzC,KAAKwP,WAAYlM,EAAEf,OAAO,OAAMH,EAAWkB,EAAEvB,SAG7C/B,KAAKwP,WAAY,UAAU,GAE7BxP,KAAK4Q,YACP,CACA,GAAS,MAALkG,EAMF,OALI9W,KAAKsF,WACPtH,QAAQK,IAAI,iDAGd2B,KAAK0G,iBAAkB,GAIzB,IAAqB,GAAjBoQ,EAAE6D,WACA7D,EAAErP,SAAS3I,OAAS,EACtBkB,KAAKwjB,cAAe1M,EAAE6D,WAAY7D,EAAErP,SAAUqP,EAAE/I,SAAU+I,EAAEoB,KAG5DlY,KAAKijB,cAAenM,EAAE6D,gBAGrB,CACH3a,KAAKyM,YAAc,EACnBzM,KAAKqO,YAAc,EAEnB,IACErO,KAAKkb,YAAapE,EAAErP,SAqBtB,CAnBA,MAAOnE,GAIL,GAFAtD,KAAKihB,iBAAmB,EAEpBjhB,KAAK6H,IAAIzE,kBAAmBE,GAAM,CACpC,IAAIN,EAAMhD,KAAK6H,IAAI1E,oBAAqBG,GACxCtD,KAAKihB,gBAAkBje,EAAIP,OAC3BzC,KAAKwP,WAAYxM,EAAIT,WAAOH,OAAWA,EAAWY,EAAIjB,OACxD,MACS/B,KAAK6H,IAAIrE,QAASF,IACrBN,EAAMM,EACVtD,KAAKwP,WAAYxM,EAAIT,OACrBvC,KAAKihB,gBAAkBje,EAAIP,QAG3BzC,KAAKwP,WAAW,cAAgBlM,GAGlCtD,KAAKkG,SAAU,CACjB,CAEMlG,KAAKkG,SAAalG,KAAK8G,UAAa9G,KAAKwG,oBAC7CxG,KAAK4Q,YAGT,CAEA5Q,KAAK0G,iBAAkB,EAEnB1G,KAAKsF,YACPtH,QAAQK,IAAI,WAAW2B,KAAKiG,SAC5BjI,QAAQK,IAAI,SAAUyY,GAEtB9Y,QAAQK,IAAI,4CAEhB,EAWF,MAAMuJ,EAEJpG,YAAa4iB,EAAWC,GACtBrkB,KAAK6D,OAASwgB,EAAQxgB,OACtB7D,KAAKwF,OAAS6e,EAAQ7e,OACtBxF,KAAK0F,WAAa2e,EAAQ3e,WAC1B1F,KAAK6F,MAAQwe,EAAQxe,MACrB7F,KAAKW,KAAO0jB,EAAQ1jB,KACpBX,KAAK4F,MAAQye,EAAQze,MACrB5F,KAAKqkB,QAAUA,EACfrkB,KAAKnC,IAAMwmB,EAAQxmB,IACnBmC,KAAK2Z,KAAO,CAAC,EACb3Z,KAAKskB,KAAO,CAAC,EACbtkB,KAAKukB,cAAgB,KACrBvkB,KAAK6H,IAAM,IAAIxF,EACfrC,KAAKokB,UAAYA,CAEnB,CAEAI,cAAetM,GAOb,IAJA,IAAIuM,EAAQhhB,OAAOyI,oBAAqBtE,EAAiBpJ,WAErDkmB,EAAS,GAEJ7lB,EAAE,EAAEA,EAAE4lB,EAAM3lB,OAAOD,IAC1B,GAAI4lB,EAAM5lB,GAAG0E,WAAW,UAAW,CACjC,GAAIkhB,EAAM5lB,GAAG0E,WAAW,eAAkB,SAE1C,IAAI9B,EAAOgjB,EAAM5lB,GAEXqZ,IACFzW,EAAOA,EAAK4B,OAAO,GAAImL,eAG3BkW,EAAO3lB,KAAM0C,EACf,CAGF,OAAOijB,CACT,CAEAC,aAAczM,GAKZ,IAJA,IAAIuM,EAAQhhB,OAAOyI,oBAAqBtE,EAAiBpJ,WAErDkmB,EAAS,GAEJ7lB,EAAE,EAAEA,EAAE4lB,EAAM3lB,OAAOD,IAC1B,GAAI4lB,EAAM5lB,GAAG0E,WAAW,SAAU,CAChC,GAAIkhB,EAAM5lB,GAAG0E,WAAW,cAAiB,SAEzC,IAAI9B,EAAOgjB,EAAM5lB,GAEXqZ,IACFzW,EAAOA,EAAK4B,OAAO,GAAImL,cAAcwJ,QAAQ,QAAQ,MAGzD0M,EAAO3lB,KAAM0C,EACf,CAGF,OAAOijB,CACT,CAGAE,mBACE,IAAIC,EAAkB7kB,KAAKokB,UAAUU,gBACjCC,EAAmB/kB,KAAK8kB,cAAeD,GAE3C,OAAO,IAAIG,GAAcC,uBAAwBF,EACnD,CAEAD,cAAeD,GAEb,OAAO,IAAIG,GAAcE,0BAA2BL,EAAiB7kB,KAEvE,CAOAmlB,kBAAoB,MAAO,uDAAyD,CAEpFC,WAAYC,GAEZrlB,KAAK6D,OAAOoB,QAAQ,IACpB,IAAIqgB,EAAYtlB,KAAK4kB,mBACjBW,EAAMD,EAAU,GAChBE,EAAWF,EAAU,GACrBG,EAAS,IAMb,GAJmB,GAAfJ,EAAKvmB,SACP2mB,EAASJ,EAAK,GAAGlZ,OAGL,KAAVsZ,EAAiB,CACnBzlB,KAAK6D,OAAOoB,QAAQ,kCACpBjF,KAAK6D,OAAOoB,QAAQ,qBACpBjF,KAAK6D,OAAOoB,QAAQ,kCACpB,IAAK,IAAIpG,EAAE,EAAGA,EAAE0mB,EAAIzmB,OAAQD,IAC1BmB,KAAK6D,OAAOoB,QAASpG,EAAI,IAAM0mB,EAAI1mB,GAAG2P,cAE1C,KACK,CAEH,IAAIkX,EAAMH,EAAKE,GAQf,SANWrjB,KADXmjB,EAAMC,EAAUE,KAEd1lB,KAAK6H,IAAInF,WAAY,sBAEvB1C,KAAK6D,OAAOoB,QAAQ,kCACpBjF,KAAK6D,OAAOoB,QAAQ,uBAA0BygB,EAAIlX,cAAgB,KAClExO,KAAK6D,OAAOoB,QAAQ,kCACXpG,EAAE,EAAGA,EAAE0mB,EAAIzmB,OAAQD,IAAK,CAE/B,IAAI8mB,EAAOJ,EAAI1mB,GAAG+mB,QACdC,EAAS,GAAGN,EAAI1mB,GAAG4C,KAAK3C,OACxBgnB,EAAM,kBAAkBziB,OAAO,EAAEwiB,GASrC,GANIF,EAAKI,YACL/lB,KAAK6D,OAAOoB,QAAS,IAAMsgB,EAAI1mB,GAAG4C,KAAQqkB,EAAM,MAAQH,EAAKI,aAG7D/lB,KAAK6D,OAAOoB,QAAS,IAAMsgB,EAAI1mB,GAAG4C,MAElCkkB,EAAK/f,MAAQ,CACf,IAAI+d,EAAQgC,EAAK/f,MAAM7C,MAAM,MAE7B/C,KAAK6D,OAAOoB,QAAS,0BAA4B0e,EAAM,IACvD,IAAK,IAAI7M,EAAE,EAAGA,EAAE6M,EAAM7kB,OAAQgY,IAAK,CAC/B,IAAIjJ,EAAO8V,EAAO7M,GAElB9W,KAAK6D,OAAOoB,QAAS,0BAA4B4I,EACnD,CACA7N,KAAK6D,OAAOoB,QAAS,GACvB,CAEA,GAAI0gB,EAAK9hB,OAAS,CAIhB,IAHI8f,EAAQgC,EAAK9hB,OAAOd,MAAM,MAE9B/C,KAAK6D,OAAOoB,QAAS,2BAA6B0e,EAAM,IAC/C7M,EAAE,EAAGA,EAAE6M,EAAM7kB,OAAQgY,IACtBjJ,EAAO8V,EAAO7M,GAElB9W,KAAK6D,OAAOoB,QAAS,0BAA4B4I,GAEnD7N,KAAK6D,OAAOoB,QAAS,GACzB,CACF,CACF,CACFjF,KAAK6D,OAAOoB,QAAQ,GAEpB,CAEA+gB,UAEE,MAAO,CADoB,EAE7B,CAEAC,iBAAmB,MAAO,+CAAiD,CAE3EC,UAAWb,GACT,IAAInQ,GAAQ,EAEZ,GAAImQ,EAAKvmB,OAAS,EAChB,KAAM,aAER,GAAmB,GAAfumB,EAAKvmB,QAAeumB,EAAK,GAAGviB,MAAMhE,OAAS,EAC7C,KAAM,aAER,GAAmB,GAAfumB,EAAKvmB,QAAuC,GAAxBumB,EAAK,GAAGviB,MAAMhE,OAAc,CAClD,GAA2C,SAAvCumB,EAAK,GAAGviB,MAAM,GAAGnD,KAAK6O,cAIxB,KAAM,aAHJ0G,GAAQ,CAKd,CAEIA,EACFlV,KAAK6D,OAAOgM,QAAS,IAGrB7P,KAAK6D,OAAOgM,QAAS,GAEzB,CAEAsW,mBAAqB,MAAO,iFAAmF,CAC/GC,YAAaf,GAEX,GAAmB,GAAfA,EAAKvmB,OAIP,OAHAkB,KAAK6D,OAAOqR,QACZlV,KAAK6F,MAAMqP,aACXlV,KAAKqkB,QAAQxB,gBAIf,IAAIzT,EAAOiW,EAAK,GAAGlZ,MAEP,GAARiD,GAAqB,GAARA,GAAqB,GAARA,GAKlB,GAARA,GACFpP,KAAK6D,OAAOqR,QAEF,GAAR9F,GAIFpP,KAAK6D,OAAOqR,QAHZlV,KAAK6F,MAAMqP,SARXlV,KAAK6H,IAAInF,WAAY,OAAQ,yBAejC,CAGA2jB,kBAAoB,MAAO,qCAAuC,CAClEC,WAAYjB,GAES,GAAfA,EAAKvmB,QACPkB,KAAKqkB,QAAQ7S,YAIjB,CAEA+U,qBAAuB,MAAO,8CAAgD,CAE9EC,cAAenB,GAEb,GAAmB,GAAfA,EAAKvmB,OAAT,CAKA,IAAI2nB,EAAUpB,EAAK,GAAGlZ,MAClBsa,EAAS,GAAKA,EAAS,GAI3BzmB,KAAK6D,OAAOgM,QAAS,GAAK4W,EAP1B,MAFEzmB,KAAK6D,OAAOgM,QAAS,GAUzB,CAEA6W,kBAAoB,MAAO,yDAA2D,CACtFC,WAAYtB,GAGS,GAAfA,EAAKvmB,OAMU,GAAfumB,EAAKvmB,OAKTkB,KAAK6F,MAAM+gB,SAAUvB,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJzDnM,KAAK6H,IAAInF,WAAY,kBAAmB,gCANxC1C,KAAK6F,MAAM+gB,SAAU,EAAG,IAAK,IAYjC,CAIAC,mBAAqB,MAAO,+DAAiE,CAC7FC,YAAazB,GAEQ,GAAfA,EAAKvmB,OAMU,GAAfumB,EAAKvmB,OAKTkB,KAAK6F,MAAMkhB,UAAW1B,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJ1DnM,KAAK6H,IAAInF,WAAY,kBAAmB,gCANxC1C,KAAK6F,MAAMkhB,UAAW,EAAG,IAAK,IAYlC,CAGAC,oBAAsB,MAAO,kFAAoF,CACjHC,aAAc5B,GAGO,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAMqhB,mBACR7B,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OARTnM,KAAK6H,IAAInF,WAAY,kBAAmB,8CAW5C,CAEAykB,oBAAsB,MAAO,wCAA0C,CACvEC,aAAc/B,GAEO,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAMwhB,OAAQhC,EAAK,GAAGlZ,OAJzBnM,KAAK6H,IAAInF,WAAY,kBAAmB,kBAM5C,CAEA4kB,oBAAsB,MAAO,+DAAiE,CAC9FC,aAAclC,GAEO,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAM2hB,iBAAkBnC,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJlDnM,KAAK6H,IAAInF,WAAY,kBAAmB,8BAM5C,CAEA+kB,sBAAwB,MAAO,2DAA6D,CAC5FC,eAAgBrC,GAEK,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAM8hB,cAAetC,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJ/CnM,KAAK6H,IAAInF,WAAY,kBAAmB,2BAM5C,CAEAklB,uBAAyB,MAAO,6DAA+D,CAC/FC,gBAAiBxC,GAEI,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAMiiB,qBAAsBzC,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJtDnM,KAAK6H,IAAInF,WAAY,kBAAmB,2BAM5C,CAEAqlB,mBAAqB,MAAO,6EAA+E,CAC3GC,YAAa3C,GAEQ,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAMoiB,UACP5C,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OARVnM,KAAK6H,IAAInF,WAAY,kBAAmB,6CAW5C,CAEAwlB,qBAAuB,MAAO,sCAAwC,CACtEC,cAAe9C,GAEM,GAAfA,EAAKvmB,OAKTkB,KAAK6F,MAAMuiB,YAAa/C,EAAK,GAAGlZ,OAJ9BnM,KAAK6H,IAAInF,WAAY,kBAAmB,mBAM5C,CAEA2lB,oBAAsB,MAAO,mEAAqE,CAClGC,aAAcjD,GAEZ,GAAIA,EAAKvmB,OAAS,GAAKumB,EAAKvmB,OAAQ,EAClCkB,KAAK6H,IAAInF,WAAY,kBAAmB,0CAD1C,CAKA,IAAI6lB,EAAO,EACPlD,EAAKvmB,OAAQ,IACfypB,EAAOlD,EAAK,GAAGlZ,OAGjBnM,KAAK6F,MAAM2iB,WAAYnD,EAAK,GAAGlZ,MAAOoc,EAPtC,CASF,CAGAE,sBAAwB,MAAO,iFAAmF,CAClHC,eAAgBrD,GAId,GAAmB,GAAfA,EAAKvmB,QAA8B,GAAfumB,EAAKvmB,OAA7B,CAKA,IAAI6pB,EAAOpT,KAAKqT,MAAOvD,EAAK,GAAGlZ,OAC3B0c,EAAOtT,KAAKqT,MAAOvD,EAAK,GAAGlZ,OAE3B2c,EAAK9oB,KAAK6D,OAAOoR,gBAIrB,GADA8T,GAAM,EAAGC,GAAM,EACI,GAAf3D,EAAKvmB,OACP,IAAIiqB,EAAKxT,KAAKqT,MAAOvD,EAAK,GAAGlZ,OACzB6c,EAAKzT,KAAKqT,MAAOvD,EAAK,GAAGlZ,OAG/B,GAAIwc,EAAO,GAAKE,EAAO,GAAMF,GAAQG,EAAG,IAAMD,GAAQC,EAAG,GAAK,CAE1D,IAAIG,EAAOH,EAAG,GAAKH,EACfO,EAAOJ,EAAG,GAAKD,EAWnB,OATIE,EAAK,GAAKA,EAAKE,GACjBjpB,KAAK6H,IAAInF,WAAY,YAAa,aAEhCsmB,EAAK,GAAKA,EAAKE,GACjBlpB,KAAK6H,IAAInF,WAAY,YAAa,kBAGpC1C,KAAK6D,OAAOslB,SAAWR,EAAME,EAAME,EAAIC,EAG3C,CA7BA,MAFEhpB,KAAK6H,IAAInF,WAAY,kBAAmB,4CAiC5C,CAEA0mB,oBAAsB,MAAO,qDAAuD,CACpFC,aAAchE,GAIZ,GAAmB,GAAfA,EAAKvmB,OAKT,GAAmB,GAAfumB,EAAKvmB,YAAT,CACI,IAAIwqB,EAAM/T,KAAKqT,MAAOvD,EAAK,GAAGlZ,OAC1Bmd,EAAM,GAAKA,EAAM,IACjBtpB,KAAKwF,OAAO+jB,aAAeD,EAGnC,MAVEtpB,KAAK6H,IAAInF,WAAY,kBAAmB,iBAY5C,CAEA8mB,oBAAsB,MAAO,sDAAwD,CACrFC,aAAcpE,GAIZ,GAAmB,GAAfA,EAAKvmB,OAKT,GAAmB,GAAfumB,EAAKvmB,YAAT,CACI,IAAIwqB,EAAM/T,KAAKqT,MAAOvD,EAAK,GAAGlZ,OAC1Bmd,EAAM,GAAKA,EAAM,IACjBtpB,KAAKwF,OAAOkkB,aAAeJ,EAGnC,MAVEtpB,KAAK6H,IAAInF,WAAY,kBAAmB,iBAY5C,CAEAinB,oBAAsB,MAAO,iEAAmE,CAChGC,aAAcvE,GACO,GAAfA,EAAKvmB,OAKJkB,KAAKwF,OAAOoV,WAKI,GAAjByK,EAAK,GAAGlZ,QAAgC,GAAlBkZ,EAAK,GAAGlZ,MAKb,GAAjBkZ,EAAK,GAAGlZ,QAAgC,GAAlBkZ,EAAK,GAAGlZ,MAKlCnM,KAAKwF,OAAOqkB,OACVxE,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OARRnM,KAAK6H,IAAInF,WAAY,YAAa,sBALlC1C,KAAK6H,IAAInF,WAAY,YAAa,sBALlC1C,KAAK6H,IAAInF,WAAY,uBAAwB,qCAL7C1C,KAAK6H,IAAInF,WAAY,kBAAmB,iCAAmC2iB,EAAKvmB,OA0BpF,CAEAgrB,kBAAoB,MAAO,0CAA4C,CACvEC,WAAY1E,GACS,GAAfA,EAAKvmB,QAA8B,GAAfumB,EAAKvmB,OAKxBkB,KAAKwF,OAAOoV,WAKE,GAAfyK,EAAKvmB,OAUTkB,KAAKwF,OAAOqI,KACVwX,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OAZRnM,KAAKwF,OAAOqI,UACVzL,OAAWA,EACXijB,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OATVnM,KAAK6H,IAAInF,WAAY,uBAAwB,qCAL7C1C,KAAK6H,IAAInF,WAAY,kBAAmB,yCAA2C2iB,EAAKvmB,OA0B5F,CAEAkrB,iBAAmB,MAAO,kDAAoD,CAC9EC,UAAW5E,GACU,GAAfA,EAAKvmB,OAKJkB,KAAKwF,OAAOoV,WAKjB5a,KAAKwF,OAAO0kB,SACV7E,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,OARRnM,KAAK6H,IAAInF,WAAY,uBAAwB,qCAL7C1C,KAAK6H,IAAInF,WAAY,kBAAmB,6BAA+B2iB,EAAKvmB,OAgBhF,CAEAqrB,kBAAoB,MAAO,2CAA6C,CACxEC,WAAY/E,GACS,GAAfA,EAAKvmB,OAKJkB,KAAKwF,OAAOoV,WAKjB5a,KAAKwF,OAAO6kB,KAAMhF,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJvCnM,KAAK6H,IAAInF,WAAY,uBAAwB,qCAL7C1C,KAAK6H,IAAInF,WAAY,kBAAmB,yBAA2B2iB,EAAKvmB,OAU5E,CAGFwrB,aAEI,MAAO,CADoB,EAE/B,CAEAC,SAASpe,GACP,MAAwB,iBAAVA,GAAsBqe,SAASre,EAC/C,CAEAse,kBAAmBpZ,GACjB,OAAIrR,KAAKuqB,SAAUlZ,IACZA,GAAK,EACD,IAAMA,EAGV,GAAKA,CACd,CAGEqZ,oBAAsB,MAAO,uEAAyE,CACtGC,aAActF,GAEZ,IAAIhB,EAAUrkB,KAAKqkB,QACfuG,EAAK5qB,KAAK6D,OAEd,GAAmB,GAAfwhB,EAAKvmB,OAIJ,GAAmB,GAAfumB,EAAKvmB,QACgB,GAAxBumB,EAAK,GAAGviB,MAAMhE,OAQpB,IAFA,IACIqN,EADA2S,GAAU,EAELjgB,EAAE,EAAGA,EAAEwmB,EAAKvmB,OAAQD,IAAK,CAEhCigB,GAAU,EACNjgB,EAAGwmB,EAAKvmB,OAAO,IACjBggB,GAAU,GAGRjgB,EAAE,GACJ+rB,EAAIhmB,MAAO,aASb,IANA,IAAIimB,EAAUxF,EAAKxmB,GACfisB,EACF,CAAEhoB,MAAO,GACPyX,aAAcsQ,EAAQtQ,aACtBD,OAAQuQ,EAAQvQ,QAEXnH,EAAE,EAAGA,EAAE0X,EAAQ/nB,MAAMhE,OAAQqU,IACP,SAAzB0X,EAAQ/nB,MAAMqQ,GAAGjV,MACM,KAAvB2sB,EAAQ/nB,MAAMqQ,GAAGiH,IAAajH,GAAI0X,EAAQ/nB,MAAMhE,OAAO,GACnDD,GAAKwmB,EAAKvmB,OAAO,EAEvBggB,GAAU,EAGVgM,EAAShoB,MAAM/D,KAAM8rB,EAAQ/nB,MAAMqQ,IAIvChH,EAAQkY,EAAQ/K,eAAgBwR,GAEvB,GAALjsB,EAEF+rB,EAAIG,OAAQ/qB,KAAKyqB,kBAAmBte,IAAS,GAG7Cye,EAAIG,OAAQ,GAAK5e,GAAQ,GAEvB2S,IAAY8L,EAAIvf,KAAMgZ,EAAQxZ,WAAY,GAEhD,MA/CI+f,EAAIvf,UALNuf,EAAIvf,IAsDR,CAGA2f,mBAAqB,MAAO,wDAA0D,CACtFC,YAAa5F,GAIQ,GAAfA,EAAKvmB,OAKTkB,KAAK6D,OAAOqnB,MAAO7F,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJvDnM,KAAK6H,IAAInF,WAAY,aAAc,yCAA2C2iB,EAAKvmB,OAKvF,CAMAqsB,qBAAuB,MAAO,yFAA2F,CACzHC,cAAe/F,GAIb,GAAIA,EAAKvmB,OAAS,EAChBkB,KAAK6H,IAAInF,WAAY,aAAc,uCAAyC2iB,EAAKvmB,YADnF,CAKA,IAAI+V,OAAKzS,EACL0S,OAAK1S,EAELijB,EAAKvmB,QAAU,IAAM+V,EAAKwQ,EAAK,GAAGlZ,OAClCkZ,EAAKvmB,QAAU,IAAMgW,EAAKuQ,EAAK,GAAGlZ,OACtCnM,KAAK6D,OAAOwnB,QAAShG,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAO0I,EAAIC,EAPtE,CAQF,CAEAwW,mBAAqB,MAAO,qEAAuE,CACnGC,YAAalG,GAIQ,GAAfA,EAAKvmB,OAKTkB,KAAK6D,OAAO2nB,MAAOnG,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJvDnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,OAK5E,CAEA2sB,oBAAsB,MAAO,8EAAgF,CAC7GC,aAAcrG,GAEZ,IACIvQ,OAAK1S,EAEU,GAAfijB,EAAKvmB,QAA+B,GAAfumB,EAAKvmB,QAKX,GAAfumB,EAAKvmB,SACPgW,EAAKuQ,EAAK,GAAGlZ,OAGfnM,KAAK6D,OAAO8nB,OAAQtG,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAO2I,IAR/D9U,KAAK6H,IAAInF,WAAY,aAAc,mCAAqC2iB,EAAKvmB,OASjF,CAEA8sB,qBAAuB,MAAO,6EAA+E,CAC7GC,cAAexG,GAIM,GAAfA,EAAKvmB,OAKTkB,KAAK6D,OAAO8nB,OAAQtG,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,WAAO/J,EAAWijB,EAAK,GAAGlZ,OAJnEnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,OAK5E,CAGAgtB,sBAAuBxI,GAEX,GAANA,GACM,GAANA,GACM,GAANA,GACM,GAANA,GACM,GAANA,GACM,GAANA,GAEFtjB,KAAK6H,IAAInF,WAAY,aAAc,+BAGvC,CAIDqpB,oBACK,MAAQ,yEACV,CAEFC,aAAc3G,GAEPrlB,KAAK0F,WAAW2c,UAKF,GAAfgD,EAAKvmB,QAKTkB,KAAK8rB,sBAAuBzG,EAAK,GAAGlZ,OAEpCnM,KAAK0F,WAAWyQ,KACZnW,KAAKqkB,QAAQ9kB,UACb8lB,EAAK,GAAGlZ,MACR,EAAE,EACFkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MACvBkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAG3BnM,KAAKqkB,QAAQtX,oBAAqB,WAdhC/M,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,QALxEkB,KAAK6H,IAAInF,WAAY,uBAAwB,wCAoBjD,CAEAupB,uBAAyB,MAAO,kDAAoD,CACpFC,gBAAiB7G,GAEVrlB,KAAK0F,WAAW2c,UAKF,GAAfgD,EAAKvmB,QAKTkB,KAAK8rB,sBAAuBzG,EAAK,GAAGlZ,OAEpCnM,KAAK0F,WAAWymB,OACNnsB,KAAKqkB,QAAQ9kB,UACb8lB,EAAK,GAAGlZ,OAClBnM,KAAKqkB,QAAQtX,oBAAqB,aAThC/M,KAAK6H,IAAInF,WAAY,aAAc,6BAA+B2iB,EAAKvmB,QALvEkB,KAAK6H,IAAInF,WAAY,uBAAwB,wCAejD,CAEA0pB,sBACI,MAAQ,mEACV,CAEFC,eAAgBhH,GAETrlB,KAAK0F,WAAW2c,UAKF,GAAfgD,EAAKvmB,QAKTkB,KAAK8rB,sBAAuBzG,EAAK,GAAGlZ,OAEpCnM,KAAK0F,WAAW4mB,UACZtsB,KAAKqkB,QAAQ9kB,UACb8lB,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,QATzBnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,QALxEkB,KAAK6H,IAAInF,WAAY,uBAAwB,wCAiBjD,CAEA6pB,oBACI,MAAQ,4EACV,CAEFC,aAAcnH,GAEPrlB,KAAK0F,WAAW2c,UAKF,GAAfgD,EAAKvmB,QAKTkB,KAAK8rB,sBAAuBzG,EAAK,GAAGlZ,OAEpCnM,KAAK0F,WAAW+mB,WACZzsB,KAAKqkB,QAAQ9kB,UACb8lB,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MACvBkZ,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,QAVzBnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,QALxEkB,KAAK6H,IAAInF,WAAY,uBAAwB,wCAkBjD,CAMAgqB,sBACI,MAAQ,oEACV,CAEFC,eAAgBtH,GAETrlB,KAAK0F,WAAW2c,UAKF,GAAfgD,EAAKvmB,QAKTkB,KAAK8rB,sBAAuBzG,EAAK,GAAGlZ,OAEpCnM,KAAK0F,WAAWknB,UACZ5sB,KAAKqkB,QAAQ9kB,UACb8lB,EAAK,GAAGlZ,MACRkZ,EAAK,GAAGlZ,QATVnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,QALxEkB,KAAK6H,IAAInF,WAAY,uBAAwB,wCAiBjD,CAEAmqB,oBAAsB,MAAO,uCAAyC,CACtEC,aAAczH,GAEZ,IAAI0H,OAAM3qB,EAAWknB,OAAMlnB,EAEvBijB,EAAKvmB,OAAS,EAChBkB,KAAK6H,IAAInF,WAAY,sBAAuB,uBAAyB2iB,EAAKvmB,QAIzD,GAAfumB,EAAKvmB,SAILumB,EAAKvmB,QAAU,IACjBiuB,EAAM1H,EAAK,GAAGlZ,OAGZkZ,EAAKvmB,QAAU,IACjBwqB,EAAMjE,EAAK,GAAGlZ,OAGhBnM,KAAK6D,OAAO0N,aAAc+X,EAAKyD,GACjC,CAEAC,kBAAoB,MAAO,2BAA6B,CACxDC,WAAY5H,GACVrlB,KAAK6D,OAAOgM,QAAS,GACvB,CAGAqd,WAEI,MAAO,CADoB,EAE/B,CAEAC,kBAAoB,MAAO,0BAA4B,CACvDC,WAAY/H,GAGV,GAFWrlB,KAAKW,KAEG,GAAf0kB,EAAKvmB,OAAT,CAIA,IACIqN,EAEAkhB,GAAY,EACZC,EAAa,KACbC,EAAY,GACZC,GAAa,EAEE,GAAfnI,EAAKvmB,SAEPuuB,EAAW,GAGb,IAAK,IAAIxuB,EAAE,EAAGA,EAAEwmB,EAAKvmB,QAAUD,EAAE,EAAGA,IAAK,CAQvC,IANA,IAAIgsB,EAAUxF,EAAKxmB,GACfisB,EACF,CAAEhoB,MAAO,GACPyX,aAAcsQ,EAAQtQ,aACtBD,OAAQuQ,EAAQvQ,QAEXnH,EAAE,EAAGA,EAAE0X,EAAQ/nB,MAAMhE,OAAQqU,IACP,SAAzB0X,EAAQ/nB,MAAMqQ,GAAGjV,MACM,KAAvB2sB,EAAQ/nB,MAAMqQ,GAAGiH,IAAajH,GAAI0X,EAAQ/nB,MAAMhE,OAAO,GACnDD,GAAKwmB,EAAKvmB,OAAO,EACnB0uB,GAAa,EAGjB1C,EAAShoB,MAAM/D,KAAM8rB,EAAQ/nB,MAAMqQ,IAGvChH,EAAQnM,KAAKqkB,QAAQ/K,eAAgBwR,GAEjCjsB,GAAKwuB,EACPC,EAAcnhB,EAGdohB,EAAYphB,CAEhB,CAEAnM,KAAKW,KAAKA,KACN,CACE2sB,WAAYA,EACZC,UAAWA,EACXC,WAAYA,GA/ClB,CAkDF,CAEAC,sBAAwB,MAAO,0BAA4B,CAC3DC,eAAgBrI,GAId,GAAmB,GAAfA,EAAKvmB,OAAT,CAIA,IAAI6uB,EAAOtI,EAAK,GAEhBrlB,KAAKW,KAAKE,SAAU8sB,EAJpB,CAMF,CAGAC,oBAAsB,MAAO,0BAA4B,CACzDC,aAAcxI,GAIZ,GAAmB,GAAfA,EAAKvmB,OAAT,CAIA,IAAIgvB,EAAMzI,EAAK,GAAGlZ,MAElBnM,KAAKW,KAAKC,gBAAiB,6BAA8BktB,EAJzD,CAMF,CAEAC,mBAAqB,MAAO,kFAAoF,CAChHC,YAAa3I,GAIX,GAAmB,GAAfA,EAAKvmB,OAIT,GAAmB,GAAfumB,EAAKvmB,OAAT,CAMA,IAAImvB,EAAQ5I,EAAK,GAAGlZ,MAKpB,GAJImd,EAAMjE,EAAK,GAAGlZ,MAClBnM,KAAK6D,OAAOgM,QAAS,GAAIyZ,GACzBtpB,KAAK6D,OAAOgM,QAAS,GAAIoe,GAEN,GAAf5I,EAAKvmB,YAAT,CACI,IAAIiW,EAASsQ,EAAK,GAAGlZ,MACrBnM,KAAK6D,OAAOgM,QAAS,GAAIkF,EAE7B,CAXA,KAJA,CACI,IAAIuU,EAAMjE,EAAK,GAAGlZ,MAClBnM,KAAK6D,OAAOgM,QAAS,GAAIyZ,EAE7B,CAaF,CAEA4E,qBAAuB,MAAO,0DAA4D,CAC1FC,cAAe9I,GAEb,IACI+I,EAAQpuB,KAAKnC,IAAIwwB,YAErB,GAAmB,GAAfhJ,EAAKvmB,OAAT,CAgBIumB,EAAKvmB,OAAS,GACdkB,KAAK6H,IAAInF,WAAY,qBAAsB,+BAG/C,IAAI0M,EAAOiW,EAAK,GAAGlZ,WACC/J,IAAhBgsB,EAAMhf,IACRpP,KAAK6H,IAAInF,WAAY,eAAgB,wBAEvC1C,KAAKnC,IAAI2C,eAAgBR,KAAKqkB,QAASjV,GACvCpP,KAAKnC,IAAI6C,WAAYV,KAAKqkB,QAAQpU,aAClCjQ,KAAKqkB,QAAQ3Z,mBACb1K,KAAKqkB,QAAQtX,oBAAqB,cAblC,KAdA,CAKI,IAHA,IAAImD,EAAO,GAGFrR,EAAE,EAAIA,EAAEuvB,EAAMtvB,OAASD,IAC1BuvB,EAAOvvB,IACTqR,EAAKnR,KAAMF,EAAI,OAASuvB,EAAMvvB,IAKlCmB,KAAKqkB,QAAQ/T,cAAeJ,EAEhC,CAgBF,CAGAoe,qBAAuB,MAAO,8DAAgE,CAC9FC,cAAelJ,GAIM,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,qBAAsB,+BAG/C,IAAI8rB,EAASnJ,EAAK,GAAGlZ,MAErBnM,KAAK6D,OAAO4qB,UAAWD,EAEzB,CAEAE,oBAAsB,MAAO,+CAAiD,CAC9EC,aAActJ,GAIZ,GAAmB,GAAfA,EAAKvmB,OAAT,CAIIumB,EAAKvmB,OAAS,GACdkB,KAAK6H,IAAInF,WAAY,sBAAuB,+BAGhD,IAAIksB,EAAOvJ,EAAK,GAAGlZ,MACnBnM,KAAK6D,OAAOgM,QAAS,GAAI+e,EAPzB,CASF,CAEAC,oBAAsB,MAAO,qCAAuC,CACpEC,aAAczJ,GACRA,EAAKvmB,OAAS,GACdkB,KAAK6H,IAAInF,WAAY,sBAAuB,8BAGhD,IAAIzB,EAAOjB,KAAKqkB,QAAQlX,mBACxBnN,KAAKnC,IAAImD,OAAQC,EAAM,OACzB,CAEA8tB,kBAAoB,MAAO,mCAAqC,CAChEC,WAAY3J,GACNA,EAAKvmB,OAAS,GACdkB,KAAK6H,IAAInF,WAAY,sBAAuB,4BAGhD,IAAIzB,EAAOjB,KAAKqkB,QAAQlX,mBACxBnN,KAAKnC,IAAImD,OAAQC,EAAM,aACvBjB,KAAKqkB,QAAQhS,UAAU,UAAYrS,KAAKqkB,QAAQpN,iBAAmB,kCACrE,CAGAgY,qBAAuB,MAAO,mDAAqD,CACnFC,cAAe7J,GACM,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,kBAAmB,2BAG5C1C,KAAKnC,IAAImD,OAAQqkB,EAAK,GAAGlZ,MAAQ,GAAI,YAEvC,CAIAgjB,mBAAqB,MAAO,6EAA+E,CAC3GC,YAAa/J,GAEX,IACIjW,EAAO,EAEX,GAAmB,GAAfiW,EAAKvmB,QAA+B,GAAfumB,EAAKvmB,OAQ9B,OAHmB,GAAfumB,EAAKvmB,SACPsQ,EAAOiW,EAAK,GAAGlZ,OAEVnM,KAAK6D,OAAOwrB,OAAQhK,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAAOiD,GAPvDpP,KAAK6H,IAAInF,WAAY,aAAc,mCAAqC2iB,EAAKvmB,OAQjF,CAGAwwB,kBAAoB,MAAO,+DAAiE,CAC5FC,WAAYlK,GAIV,GAAmB,GAAfA,EAAKvmB,OAKT,OAAOkB,KAAK6D,OAAO2rB,MAAOnK,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJ/CnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,OAK5E,CAGA2wB,mBAAqB,MAAO,0DAA4D,CACxFC,YAAarK,GAEQ,GAAfA,EAAKvmB,QACPkB,KAAK6H,IAAInF,WAAY,aAAc,gCAGrC,IAAIitB,EAAYtK,EAAK,GAAGlZ,MAExB,MAA+B,OAA3BwjB,EAAUlZ,cACLoC,SAAU,OAAQ,IAES,UAA3B8W,EAAUlZ,cACVoC,SAAU,OAAQ,IAES,UAA3B8W,EAAUlZ,cACVoC,SAAU,OAAQ,IAES,UAA3B8W,EAAUlZ,cACVoC,SAAU,QAAS,IAErB,CACT,CAEA+W,oBAAsB,MAAO,mDAAqD,CAClFC,aAAcxK,GAEZ,OAAIA,EAAK,GAAGlZ,MACkB,iBAAjBkZ,EAAK,GAAGlZ,MACRuK,OAAOoZ,cAAejX,SAAUwM,EAAK,GAAGlZ,MAAO,KAEnDuK,OAAOoZ,cAAezK,EAAK,GAAGlZ,OAEhC,GACT,CAEA4jB,oBAAsB,MAAO,uEAAyE,CACtGC,aAAc3K,GAMZ,OAFM3O,OAAOoZ,cAAe,IAAOpZ,OAAOoZ,cAAezK,EAAK,GAAGlZ,OAASuK,OAAOoZ,cAAezK,EAAK,GAAGlZ,MAG1G,CAEA8jB,sBAAwB,MAAO,2BAA6B,CAC5DC,eAAgB7K,GAGhB,CAGA8K,kBAAoB,MAAO,4CAA8C,CACzEC,WAAY/K,GAOV,OALmB,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,sBAAuB,6BAGvC1C,KAAKwF,OAAOyP,gBACX,EACZ,CAEAob,mBAAqB,MAAO,6CAA+C,CAC3EC,YAAajL,GAOX,OALmB,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,sBAAuB,6BAGvC1C,KAAKwF,OAAOyP,gBACX,EACZ,CAEAsb,iBAAoB,MAAO,2CAA6C,CACxEC,UAAWnL,GAOT,OALmB,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,sBAAuB,4BAGvC1C,KAAK6D,OAAOoR,gBACX,EACZ,CAEAwb,oBAAsB,MAAO,2CAA6C,CAC1EC,aAAcrL,GAOZ,OALmB,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,sBAAuB,+BAGvC1C,KAAK6D,OAAOoR,gBACX,EACZ,CAEA0b,iBAAmB,MAAO,yCAA2C,CACrEC,UAAWvL,GAOT,OALmB,GAAfA,EAAKvmB,QACLkB,KAAK6H,IAAInF,WAAY,sBAAuB,4BAGvC1C,KAAK6D,OAAOoR,gBACX,EACZ,EAyBF,IAAI4b,EAAS,IAdb,MAEErvB,cACExB,KAAKZ,GAAK,EACZ,CAEA0xB,WAAa,SAAUlQ,GAErB5gB,KAAKZ,GAAGL,KAAM6hB,EAEhB,GAaF,MAAMlZ,EAEJlG,YAAa6iB,GACXrkB,KAAK6D,OAASwgB,EAAQxgB,OACtB7D,KAAKwF,OAAS6e,EAAQ7e,OACtBxF,KAAK4F,MAAQye,EAAQze,MACrB5F,KAAKqkB,QAAUA,EACfrkB,KAAKnC,IAAMwmB,EAAQxmB,IACnBmC,KAAK2Z,KAAO,CAAC,EACb3Z,KAAKskB,KAAO,CAAC,EACbtkB,KAAKukB,cAAgB,KACrBvkB,KAAK6H,IAAM,IAAIxF,EACfrC,KAAK+wB,cAAgB,CAAC,EAEtB/wB,KAAKgxB,QAAU,GACf,IAAI,IAAInyB,EAAE,EAAGA,EAAE,IAAMA,IACnBmB,KAAKgxB,QAAQjyB,KAAMwW,KAAK0b,UAE1BjxB,KAAKkxB,UAAY,EACjBlxB,KAAKmxB,SAAW,CAElB,CAEA3M,cAAetM,GAOb,IAJA,IAAIuM,EAAQhhB,OAAOyI,oBAAqBxE,EAAclJ,WAElDkmB,EAAS,GAEJ7lB,EAAE,EAAEA,EAAE4lB,EAAM3lB,OAAOD,IAC1B,GAAI4lB,EAAM5lB,GAAG0E,WAAW,UAAW,CACjC,GAAIkhB,EAAM5lB,GAAG0E,WAAW,eAAkB,SAE1C,IAAI9B,EAAOgjB,EAAM5lB,GAEXqZ,IACFzW,EAAOA,EAAK4B,OAAO,GAAImL,eAG3BkW,EAAO3lB,KAAM0C,EACf,CAGF,OAAOijB,CACT,CAEAC,aAAczM,GAKZ,IAJA,IAAIuM,EAAQhhB,OAAOyI,oBAAqBxE,EAAclJ,WAElDkmB,EAAS,GAEJ7lB,EAAE,EAAEA,EAAE4lB,EAAM3lB,OAAOD,IAC1B,GAAI4lB,EAAM5lB,GAAG0E,WAAW,SAAU,CAChC,GAAIkhB,EAAM5lB,GAAG0E,WAAW,cAAiB,SAEzC,IAAI9B,EAAOgjB,EAAM5lB,GAEXqZ,IACFzW,EAAOA,EAAK4B,OAAO,GAAImL,cAAcwJ,QAAQ,QAAQ,MAGzD0M,EAAO3lB,KAAM0C,EACf,CAGF,OAAOijB,CACT,CAEAI,gBAEE,OAAO,IAAIE,GAAcE,0BAA2B,CAAC,CAAC,EAAE,CAAC,GAAIllB,KAE/D,CAKAoxB,iBAAmB,MAAO,iDAAmD,CAC7EC,UAAWhM,GAETrlB,KAAKqkB,QAAQrB,KACf,CAEAsO,kBAAoB,MAAO,gCAAkC,CAC7DC,WAAYlM,GAEV,IAAIrY,EAAQ,EACRwU,EAAQ,OACR1e,EAAQ,GAIK,GAAbuiB,EAAKvmB,SACPgE,EAAQuiB,EAAK,GAAGviB,OAGE,GAAhBA,EAAMhE,QAAgC,OAAjBgE,EAAM,GAAG5E,MAAiB4E,EAAM,GAAGnD,MAAO,GACjEqN,EAAQlK,EAAM,GAAGnD,KACjB6hB,EAAM1e,EAAM,GAAGnD,MAEQ,GAAhBmD,EAAMhE,QAAgC,OAAjBgE,EAAM,GAAG5E,MAAiB4E,EAAM,GAAGnD,KAAM,EAErE6hB,GAAO1e,EAAM,GAAGnD,KAEO,GAAhBmD,EAAMhE,QACS,OAAjBgE,EAAM,GAAG5E,MACQ,OAAjB4E,EAAM,GAAG5E,MACM,KAAf4E,EAAM,GAAGsX,IAEdpN,EAAQlK,EAAM,GAAGnD,KACjB6hB,EAAM1e,EAAM,GAAGnD,MAGQ,GAAhBmD,EAAMhE,QACS,OAAjBgE,EAAM,GAAG5E,MACQ,SAAjB4E,EAAM,GAAG5E,MACM,KAAf4E,EAAM,GAAGsX,KAEdpN,EAAQlK,EAAM,GAAGnD,MAGnB,IAAI0kB,EAAUrkB,KAAKqkB,QACfnU,EAAO,GACX,IAAK,MAAM4G,KAAKuN,EAAQpe,QACtB,CAEE,IAAIxD,EAASoW,SAAS/B,EAAE,KACX,MAARA,EAAE,IAAerU,GAASuK,GAASvK,GAAS+e,KAC3B,WAAhB1K,EAAE,GAAG,GAAG5Y,MAA0C,OAArB4Y,EAAE,GAAG,GAAGI,WACrChH,EAAKnR,KAAM,IAEfmR,EAAKnR,KAAM+X,EAAE,IAEjB,CAEA9W,KAAKqkB,QAAQ/T,cAAeJ,EAChC,CAGAshB,UAEI,MAAO,CADa,EAExB,CAEAC,aAEI,MAAO,CADa,EAExB,CAEAC,WAEI,MAAO,CADa,EAExB,CAEAC,YAEI,MAAO,CADoB,oBAE/B,CAEAC,WAEI,MAAO,CADoB,EAE/B,CAEAC,UAEI,MAAO,CADoB,EAE/B,CAEAC,kBAAoB,MAAO,gDAAkD,CAC7EC,WAAY1M,GACV,IAAI2M,EAAK3M,EAAM,GACA,OAAX2M,EAAG9zB,MACL8B,KAAK6H,IAAInF,WAAY,YAAa,eAGpC,IAAI/C,EAAOK,KAAKqkB,QAAQjH,gBACXhb,IAATzC,GAAuBK,KAAK6H,IAAInF,WAAY,eAE9B,OAAdsvB,EAAGzP,SAAmD,kBAAvB5iB,GAAM8W,eAIlB,OAAdub,EAAGzP,SAAmD,kBAAvB5iB,GAAM8W,cAHxCzW,KAAKqkB,QAAQ9V,OACXyjB,EAAG7lB,MAAQxM,GAMI,OAAdqyB,EAAGzP,SAAmD,kBAAvB5iB,GAAM8W,eAExC9W,EAAOkZ,SAAWlZ,GAEdwkB,MAAOxkB,IACTK,KAAK6H,IAAInF,WAAY,mBAEvB1C,KAAKqkB,QAAQ9V,OACXyjB,EAAG7lB,MAAOxM,IAEK,OAAdqyB,EAAGzP,SAAmD,kBAAvB5iB,GAAM8W,eACxCzW,KAAKqkB,QAAQ9V,OACXyjB,EAAG7lB,MAAQ,GAAKxM,EAG1B,CAEAsyB,iBAAmB,MAAO,0CAA4C,CACtEC,UAAW7M,GACT,IAAI2M,EAAK3M,EAAM,GAEA,OAAX2M,EAAG9zB,MACL8B,KAAK6H,IAAInF,WAAY,YAAa,eAGpC,IAAIyd,EAAIngB,KAAK4F,MAAMusB,SACV,MAALhS,EAAcngB,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAO,IAEjC,MAATgU,EAAErb,IACJ9E,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAOgU,EAAErb,KAGhC9E,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAO,OAIlCnM,KAAKqkB,QAAQzZ,kBACf,CAEAwnB,oBAAsB,MAAO,0CAA4C,CACzEC,aAAchN,GACZ,IAAI2M,EAAK3M,EAAM,GAEA,OAAX2M,EAAG9zB,MACL8B,KAAK6H,IAAInF,WAAY,YAAa,eAGpC,IAAIyd,EAAIngB,KAAK4F,MAAMusB,SACV,MAALhS,EAAcngB,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAO,IAEjC,MAATgU,EAAErb,IACJ9E,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAOgU,EAAErb,KAGhC9E,KAAKqkB,QAAQ9V,OAAOyjB,EAAG7lB,MAAOgU,EAAEhc,UAIpCnE,KAAKqkB,QAAQzZ,kBACf,CAEA0nB,mBAAqB,MAAO,mDAAqD,CACjFC,YAAalN,GAKX,IAHA,IAAIvd,EAAO,GACP8iB,EAAM5qB,KAAK6D,OAENhF,EAAE,EAAGA,EAAEwmB,EAAKvmB,OAAQD,IAC3B,GAAS,GAALA,EAAS,CACX,IAAI4a,EAAM4L,EAAK,GAES,GAApB5L,EAAI3W,MAAMhE,OACa,OAArB2a,EAAI3W,MAAM,GAAG5E,OACf0sB,EAAIhmB,MAAO6U,EAAI3W,MAAM,GAAGnD,MACC,OAArB8Z,EAAI3W,MAAM,GAAG5E,MAAoC,KAAnBub,EAAI3W,MAAM,GAAGsX,IAC7CtS,EAAK/I,KAAM0a,EAAI3W,MAAM,GAAGnD,OAID,GAApB8Z,EAAI3W,MAAMhE,QACjBgJ,EAAK/I,KAAM0a,EAAI3W,MAAM,GAAGnD,KAG5B,MAEE9B,EAAIQ,IAAK,QAAQQ,EAAE,IAAKwmB,EAAKxmB,IACA,OAAzBwmB,EAAKxmB,GAAGiE,MAAM,GAAG5E,MAEnB8B,KAAK6H,IAAInF,WAAY,YAAa,aAAe7D,GAEnDiJ,EAAK/I,KAAMsmB,EAAKxmB,GAAGiE,MAAM,GAAGnD,MAIhCK,KAAKqkB,QAAQP,sBAAuBhc,EAEtC,CAEA0qB,qBAAuB,MAAO,4CAA8C,CAC5EC,cAAepN,GACbrlB,KAAKqkB,QAAQxE,gBACf,CAEA6S,oBAAsB,MAAO,4CAA8C,CAC3EC,aAActN,GACZrlB,KAAKqkB,QAAQxZ,WAAYwa,EAAK,GAAGlZ,MACnC,CAEAymB,oBAAsB,MAAO,wCAA0C,CACvEC,aAAcxN,GAEZrlB,KAAKqkB,QAAQlZ,gBACf,CAIA2nB,kBAAoB,MAAO,6CAA+C,CAC1EC,WAAY1N,GACV,IAAIhB,EAAUrkB,KAAKqkB,QAGnBA,EAAQhS,UAAU,IAEC,GAAfgT,EAAKvmB,OACPulB,EAAQhS,UAAU,aAGlBgS,EAAQhS,UAAU,kBAAqBgT,EAAK,GAAGlZ,MAAQ,KAGtC,GAAfkZ,EAAKvmB,OACIulB,EAAQllB,KAAM,KAAK,GAAQ,GAGnB,GAAfkmB,EAAKvmB,OACEulB,EAAQllB,KAAMkmB,EAAK,GAAGlZ,OAAO,GAAQ,GAExB,GAAfkZ,EAAKvmB,QACHulB,EAAQllB,KAAMkmB,EAAK,GAAGlZ,OAAO,EAAOkZ,EAAK,GAAGlZ,OAGzDnM,KAAKgzB,OAAQ,CAEf,CAEAC,qBAAuB,MAAO,yCAA2C,CACzEC,cAAe7N,GAEb,IAAIhB,EAAUrkB,KAAKqkB,QACf5kB,EAAQ,KAER4lB,EAAKvmB,OAAS,GAChBkB,KAAK6H,IAAInF,WAAY,aAAc,wCAGlB,GAAf2iB,EAAKvmB,SACPW,EAAQ4lB,EAAK,GAAGlZ,OAGPkY,EAAQ7G,QAAS/d,EAE9B,CAEA0zB,wBAA0B,MAAO,yCAA2C,CAC5EC,iBAAkB/N,GAEhB,IAAIhB,EAAUrkB,KAAKqkB,QAGA,GAAfgB,EAAKvmB,QACPkB,KAAK6H,IAAInF,WAAY,aAAc,iCAGrC,IAAIwN,EAAOmU,EAAQlH,gBACnBkH,EAAQ/T,cAAeJ,EAEzB,CAEAmjB,sBAAwB,MAAO,iEAAmE,CAClGC,eAAgBjO,GAEd,IAAIhB,EAAUrkB,KAAKqkB,QAEf5kB,EAAQ,KACRvB,EAAO,QACXmmB,EAAQhS,UAAU,IAEC,GAAfgT,EAAKvmB,QAA8B,GAAfumB,EAAKvmB,QAA8B,GAAfumB,EAAKvmB,QAC/CkB,KAAK6H,IAAInF,WAAY,aAAc,4DAGjC2iB,EAAKvmB,QAAU,IACjBZ,EAAOmnB,EAAK,GAAGlZ,OAGbjO,EAAK6Z,QAAQ,KAAO,GACtB/X,KAAK6H,IAAInF,WAAY,6BAA8B,kDAGlC,GAAf2iB,EAAKvmB,SACPW,EAAQ4lB,EAAK,GAAGlZ,OAGTkY,EAAQ7kB,SAAU6lB,EAAK,GAAGlZ,MAAOjO,EAAMuB,GAEhDO,KAAKgzB,OAAQ,CAEf,CAGAO,iBAAmB,MAAO,sEAAwE,CAClGC,UAAWnO,GACT,IAAIhB,EAAUrkB,KAAKqkB,QAGnBA,EAAQhS,UAAU,IAEC,GAAfgT,EAAKvmB,OAKU,GAAfumB,EAAKvmB,OAIe,GAAfumB,EAAKvmB,QAKdkB,KAAK6H,IAAInF,WAAY,YAAa,mCAElC1C,KAAKgzB,OAAQ,GANX3O,EAAQxkB,IAAKwlB,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,OAJpCkY,EAAQxkB,IAAKwlB,EAAK,GAAGlZ,OAAQ,GAL7BkY,EAAQxkB,IAAK,GAiBjB,CAEA4zB,gBAAkB,MAAO,yDAA2D,CACpFC,SAAUrO,GACR,IAAIhB,EAAUrkB,KAAKqkB,QAEA,GAAfgB,EAAKvmB,OACPulB,EAAQpkB,SAEc,GAAfolB,EAAKvmB,QACZulB,EAAQ/jB,MAAO+kB,EAAK,GAAGlZ,OAIzBnM,KAAKgzB,OAAQ,CAEf,CAGAW,sBAAwB,MAAO,sCAAwC,CACvEC,eAAgBvO,GAEArlB,KAAKqkB,QACXnF,gBAAiB,GAAG,GAE9B,CAEA2U,kBAAoB,MAAO,0CAA4C,CACvEC,WAAYzO,GAGV,IAEIxZ,EAFU7L,KAAKqkB,QAEG3Y,iBACtB1L,KAAKqkB,QAAQ/T,cAAezE,EAE9B,CAGAkoB,sBAAwB,MAAO,kDAAoD,CACnFC,eAAgB3O,GAEd,IAAIhB,EAAUrkB,KAAKqkB,QAEnB,GAAmB,GAAfgB,EAAKvmB,OAOU,GAAfumB,EAAKvmB,QACPulB,EAAQzB,YAAayC,EAAK,GAAGlZ,WAR/B,CACE,IAAIsP,EAAY4I,EAAQ1B,eACxB3iB,KAAKqkB,QAAQ/T,cAAemL,EAG9B,CAOF,CAEAwY,yBAA2B,MAAO,gCAAkC,CACpEC,kBAAmB7O,GAEjB,IAAIhB,EAAUrkB,KAAKqkB,QAEA,GAAfgB,EAAKvmB,QACSulB,EAAQxB,eAE5B,CAGAsR,kBAAoB,MAAO,2CAA6C,CACxEC,WAAY/O,GACV,IAAIhB,EAAUrkB,KAAKqkB,QAGnBA,EAAQhS,UAAU,IAEC,GAAfgT,EAAKvmB,OACPulB,EAAQhS,UAAU,aAGlBgS,EAAQhS,UAAU,iBAAmBgT,EAAK,GAAGlZ,OAG5B,GAAfkZ,EAAKvmB,OACIulB,EAAQllB,KAAM,KAAK,GAAO,GAG5BklB,EAAQllB,KAAMkmB,EAAK,GAAGlZ,OAAO,GAAO,GAE/CnM,KAAKgzB,OAAQ,CAEf,CAEAqB,kBAAoB,MAAO,6CAA+C,CAC1EC,WAAYjP,GACV,IAAIhB,EAAUrkB,KAAKqkB,QAEA,GAAfgB,EAAKvmB,OACLulB,EAAQ3kB,KAAM,MAEO,GAAf2lB,EAAKvmB,OACbulB,EAAQ3kB,KAAM2lB,EAAK,GAAGlZ,OAAQ,GAER,GAAfkZ,EAAKvmB,QACZulB,EAAQ3kB,KAAM2lB,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAEzC,CAEAooB,oBAAsB,MAAO,kCAAoC,CACjEC,aAAcnP,GACZ,IAAIhB,EAAUrkB,KAAKqkB,QAEA,GAAfgB,EAAKvmB,QAA8B,GAAfumB,EAAKvmB,OACzBkB,KAAK6H,IAAInF,WAAY,YAAa,2BAEb,GAAf2iB,EAAKvmB,OACbulB,EAAQjX,WAAYiY,EAAK,GAAGlZ,OAAQ,GAEd,GAAfkZ,EAAKvmB,QACZulB,EAAQjX,WAAYiY,EAAK,GAAGlZ,MAAOkZ,EAAK,GAAGlZ,MAE/C,CAKAsoB,iBAAmB,MAAO,iCAAmC,CAC7DC,UAAWrP,GACKrlB,KAAKqkB,QAEXvU,QACV,CAGA6kB,YAEI,MAAO,CADoB,EAE/B,CAEApK,SAASpe,GACP,MAAwB,iBAAVA,GAAsBqe,SAASre,EAC/C,CAEAse,kBAAmBpZ,GACjB,OAAIrR,KAAKuqB,SAAUlZ,IACZA,GAAK,EACD,IAAMA,EAGV,GAAKA,CACd,CAGAujB,uBAAyB,MAAO,8FAAgG,CAChIC,gBAAiBxP,GAII,GAAfA,EAAKvmB,OAKTkB,KAAKqkB,QAAQrZ,aAAcqa,EAAK,GAAGlZ,OAJjCnM,KAAK6H,IAAInF,WAAY,aAAc,8BAAgC2iB,EAAKvmB,OAK5E,CAGAg2B,mBAAqB,MAAO,gEAAkE,CAC9FC,YAAa1P,GAEX,IAAIhB,EAAUrkB,KAAKqkB,QACfuG,EAAK5qB,KAAK6D,OAEd,GAAmB,GAAfwhB,EAAKvmB,OAKJ,GAAmB,GAAfumB,EAAKvmB,QACgB,GAAxBumB,EAAK,GAAGviB,MAAMhE,OAQpB,IAFA,IACIqN,EADA2S,GAAU,EAELjgB,EAAE,EAAGA,EAAEwmB,EAAKvmB,OAAQD,IAAK,CAEhCigB,GAAU,EACNjgB,EAAGwmB,EAAKvmB,OAAO,IACjBggB,GAAU,GAGRjgB,EAAE,GACJ+rB,EAAIhmB,MAAO,aASb,IANA,IAAIimB,EAAUxF,EAAKxmB,GACfisB,EACF,CAAEhoB,MAAO,GACPyX,aAAcsQ,EAAQtQ,aACtBD,OAAQuQ,EAAQvQ,QAEXnH,EAAE,EAAGA,EAAE0X,EAAQ/nB,MAAMhE,OAAQqU,IACP,SAAzB0X,EAAQ/nB,MAAMqQ,GAAGjV,MACM,KAAvB2sB,EAAQ/nB,MAAMqQ,GAAGiH,IAAajH,GAAI0X,EAAQ/nB,MAAMhE,OAAO,GACnDD,GAAKwmB,EAAKvmB,OAAO,EAEvBggB,GAAU,EAGVgM,EAAShoB,MAAM/D,KAAM8rB,EAAQ/nB,MAAMqQ,IAYvC,GARAhH,EAAQkY,EAAQ/K,eAAgBwR,GAEvB,GAALjsB,EACF+rB,EAAIhmB,MAAO5E,KAAKyqB,kBAAmBte,IAGnCye,EAAIhmB,MAAO,GAAKuH,GAEd2S,EAEF,YADA9e,KAAKqkB,QAAQjZ,eAGfpL,KAAKqkB,QAAQnZ,YAEf,MAlDIlL,KAAKqkB,QAAQjZ,oBALfpL,KAAKqkB,QAAQjZ,cAyDjB,CAEA4pB,iBAAmB,MAAO,6BAA+B,CACzDC,UAAW5P,GACT,OAAOrlB,KAAKqkB,QAAQvO,QACtB,CAIAof,oBAAsB,MAAO,iDAAmD,CAChFC,aAAc9P,GAEZ,OADcrlB,KAAKqkB,QACJ9G,eACjB,CAEA6X,qBAAuB,MAAO,4CAA8C,CAC5EC,cAAehQ,GACb,OAAO3O,OAAOC,aAAc0O,EAAK,GAAGlZ,MACtC,CAEAmpB,qBAAuB,MAAO,8DAAgE,CAC9FC,cAAelQ,IAETA,EAAKvmB,OAAQ,GAAKumB,EAAKvmB,OAAQ,IACjCkB,KAAK6H,IAAInF,WAAY,YAAa,oCAGpC,IAAI8yB,EAASnQ,EAAK,GAAGlZ,MACjBspB,EAAO,GACPze,GAAO,EAEPqO,EAAKvmB,QAAQ,IACf22B,EAAOpQ,EAAK,GAAGlZ,OAGA,GAAbkZ,EAAKvmB,SACPkY,EAASqO,EAAK,GAAGlZ,MAAQ,GAG3B,IAAIupB,EAAYF,EAAO9xB,SAAS+xB,GAEhC,OAAID,GAAS,IAAMxe,EACV,IAAO0e,EAGTA,CACT,CAEAC,gBAAkB,MAAO,qBAAuB,CAChDC,SAAUvQ,GACR,OAAIA,EAAK,GAAGlZ,MAAQ,GACVkZ,EAAK,GAAGlZ,MAEXkZ,EAAK,GAAGlZ,KACjB,CAEA0pB,gBAAkB,MAAO,2BAA6B,CACtDC,SAAUzQ,GACR,OAAOA,EAAK,GAAGlZ,MAAMrN,MACvB,CAEAi3B,gBAAkB,MAAO,mCAAqC,CAC9DC,SAAU3Q,GACR,MAA4C,kBAAhCA,EAAK,GAAGlZ,OAAOqC,eAEpB6W,EAAK,GAAGlZ,MAAMrN,OAAS,EACjBumB,EAAK,GAAGlZ,MAAMqL,WAAW,GAG/B,CACT,CAEAye,gBAAkB,MAAO,oCAAsC,CAC/DC,SAAU7Q,GACR,IAAIoQ,EAAO,GAEM,GAAbpQ,EAAKvmB,SACP22B,EAAOpQ,EAAK,GAAGlZ,QAGdspB,EAAO,GAAKA,EAAO,KACpBz1B,KAAK6H,IAAInF,WAAY,OAAQ,qCAG/B,IAAIT,EAAM4W,SAAUwM,EAAK,GAAGlZ,MAAOspB,GAMnC,OAJItR,MAAOliB,IACTjC,KAAK6H,IAAInF,WAAY,wBAAyB,mBAAqB2iB,EAAK,GAAGlZ,MAAO,aAAespB,GAG5FxzB,CACT,CAEAk0B,oBAAsB,MAAO,gDAAkD,CAC/EC,aAAc/Q,GAGO,GAAfA,EAAKvmB,QACPkB,KAAK6H,IAAInF,WAAY,YAAa,iCAGpC,IAAIT,EAAM4W,SAAUwM,EAAK,GAAGlZ,MANjB,IAYX,OAJIgY,MAAOliB,IACTjC,KAAK6H,IAAInF,WAAY,wBAAyB,mBAAqB2iB,EAAK,GAAGlZ,MAA7B,gBAGzClK,CACT,CAGAo0B,qBAAuB,MAAO,gDAAkD,CAChFC,cAAejR,GASb,OANmB,GAAfA,EAAKvmB,QACPkB,KAAK6H,IAAInF,WAAY,YAAa,+BAGH,EAAhB2iB,EAAK,GAAGlZ,OAAWzI,SAAS,GAGhD,CAKC6yB,gBAAkB,MAAO,eAAiB,CAC1CC,SAAUnR,GACR,OAAO9P,KAAKkhB,IAAKpR,EAAK,GAAGlZ,MAC3B,CAEAuqB,iBAEE,OADA12B,KAAKkxB,WAAalxB,KAAKkxB,UAAYlxB,KAAKmxB,UAAYnxB,KAAKgxB,QAAQlyB,OAC1DkB,KAAKgxB,QAAShxB,KAAKkxB,UAC5B,CAEAyF,YAAaC,GAEX,GAAIA,EAAK,EAAG,CACV,IAAIvlB,GAAKulB,EACLnB,EAAOlgB,KAAKC,MAAW,GAAJnE,GACvBrR,KAAKkxB,UAAWuE,EAAOz1B,KAAKgxB,QAAQlyB,OACpCkB,KAAKmxB,SAAW,EAAGsE,EAAO,EAG1Bz1B,KAAKgxB,QAAU,GACf,IAAI,IAAInyB,EAAE,EAAGA,EAAE,IAAMA,IACnBmB,KAAKgxB,QAAQjyB,KAAMwW,KAAK0b,SAE5B,KACK,CAEH,MAGM4F,EAAOC,QAEPC,EAAI,IAAI5vB,KACd,IAAI6vB,EAAezhB,KAAKqT,MAAMmO,EAAE3vB,UAAYyvB,GAS5C,IAPAxlB,GAAKA,EACDokB,EAAOlgB,KAAKC,MAAsB,GAAfwhB,GACvBh3B,KAAKkxB,UAAWuE,EAAOz1B,KAAKgxB,QAAQlyB,OACpCkB,KAAKmxB,SAAW,EAAGsE,EAAO,EAG1Bz1B,KAAKgxB,QAAU,GACPnyB,EAAE,EAAGA,EAAE,IAAMA,IACnBmB,KAAKgxB,QAAQjyB,KAAMwW,KAAK0b,SAE5B,CAEF,CAGAgG,qBAAuB,MAAO,oEAAsE,CACpGC,cAAe7R,IAETA,EAAKvmB,OAAS,GAAKumB,EAAKvmB,OAAQ,IAClCkB,KAAK6H,IAAInF,WAAY,SAAU,kCAGjC,IAAI8N,EAAM6U,EAAK,GAAGlZ,MACdgrB,EAAK9R,EAAK,GAAGlZ,MACbuC,EAAM2W,EAAK,GAAGlZ,MACd7C,GAAO,EAEQ,GAAf+b,EAAKvmB,SAILwK,EADW,KAFbA,EAAM+b,EAAK,GAAGlZ,QAYhB,IAJA,IAAIirB,EAAO,GAGPC,EAAQ3oB,EADC8B,EAAI1R,OAERD,EAAI,EAAGA,EAAEw4B,EAAQx4B,IACxBu4B,GAAQD,EAUV,OAPI7tB,EACF8tB,GAAc5mB,EAGd4mB,EAAO5mB,EAAM4mB,EAGRA,CACT,CAGAE,gBAAkB,MAAO,iFAAmF,CAC5GC,SAAUlS,GAMR,GAJIA,EAAKvmB,OAAQ,GACfkB,KAAK6H,IAAInF,WAAY,SAAU,2BAGd,GAAf2iB,EAAKvmB,OAAa,CAEpB,GAAqB,GAAjBumB,EAAK,GAAGlZ,MACV,OAAOoJ,KAAK0b,SAEdjxB,KAAK22B,YAAatR,EAAK,GAAGlZ,MAC5B,CAEA,OAAOnM,KAAK02B,gBACd,CAEAc,gBAAkB,MAAO,kBAAoB,CAC7CC,SAAUpS,GACR,OAAO9P,KAAKmiB,KAAMrS,EAAK,GAAGlZ,MAC5B,CAEAwrB,gBAAkB,MAAO,eAAiB,CAC1CC,SAAUvS,GACR,OAAO9P,KAAKlX,IAAKgnB,EAAK,GAAGlZ,MAC3B,CAEA0rB,gBAAkB,MAAO,gBAAkB,CAC3CC,SAAUzS,GACR,OAAOrlB,KAAKqkB,QAAQ0T,YACtB,CAEAC,sBAAwB,MAAO,gCAAkC,CACjEC,eAAgB5S,GAEZ,IAAIziB,EAAIyiB,EAAK,GAAGlZ,MAEhB,GAAkB,iBAANvJ,EACV,KAAM,iBAER,OAAOA,EAAES,OAAO,EAAEgiB,EAAK,GAAGlZ,MAC9B,CAEA+rB,uBAAyB,MAAO,iCAAmC,CACnEC,gBAAiB9S,GAEb,IAAIziB,EAAIyiB,EAAK,GAAGlZ,MAEhB,GAAkB,iBAANvJ,EACV,KAAM,iBAER,OAAOA,EAAES,OAAQT,EAAE9D,OAASumB,EAAK,GAAGlZ,MACxC,CAEAisB,qBAAuB,MAAO,oBAAsB,CACpDC,cAAehT,GAEX,IAAIziB,EAAIyiB,EAAK,GAAGlZ,MAEhB,GAAkB,iBAANvJ,EACV,KAAM,iBAER,OAAmB,GAAfyiB,EAAKvmB,OACA8D,EAAES,OAAQgiB,EAAK,GAAGlZ,MAAM,EAAGkZ,EAAK,GAAGlZ,OAEpB,GAAfkZ,EAAKvmB,OACL8D,EAAES,OAAQgiB,EAAK,GAAGlZ,MAAM,QAD5B,CAGT,CAEAmsB,gBAAkB,MAAO,YAAc,CACvCC,SAAUlT,GACR,OAAO9P,KAAKijB,IAAKnT,EAAK,GAAGlZ,MAC3B,CAEAssB,gBAAkB,MAAO,gBAAkB,CAC3CC,SAAUrT,GACR,IAAI5S,EAAI8C,KAAKojB,IAAKtT,EAAK,GAAGlZ,OAAS,EAEnC,OAAIsG,GAAG,GACM,EAAFA,EAEFA,GAAG,EACD,EAAa,GAATA,EAAE,SADZ,CAGP,CAEAmmB,gBAAkB,MAAO,iBAAmB,CAC5CC,SAAUxT,GAGR,OAFQ9P,KAAKojB,IAAKtT,EAAK,GAAGlZ,OAAS,CAIrC,CAEA2sB,gBAAkB,MAAO,cAAgB,CACzCC,SAAU1T,GACR,OAAO9P,KAAKyjB,IAAK3T,EAAK,GAAGlZ,MAC3B,CAEA8sB,gBAAkB,MAAO,oBAAsB,CAC/CC,SAAU7T,GACR,OAAO9P,KAAK4jB,KAAM9T,EAAK,GAAGlZ,MAC5B,CAEAitB,gBAAkB,MAAO,cAAgB,CACzCC,SAAUhU,GACR,OAAO9P,KAAK+jB,IAAKjU,EAAK,GAAGlZ,MAC3B,CAEAotB,gBAAkB,MAAO,2CAA6C,CACtEC,SAAUnU,GAER,IADA,IAAIvhB,EAAI,GACCjF,EAAE,EAAGA,EAAEwmB,EAAK,GAAGlZ,MAAOtN,IAC7BiF,GAAK,IAEP,OAAOA,CACT,CAEA21B,KAAKpoB,EAAE5Q,GACL,OAAI4Q,EAAE5Q,EAAc4Q,EACb5Q,CACT,CAIAi5B,gBAAkB,MAAO,yBAA2B,CACpDC,SAAUtU,GACR,OAAO9P,KAAKC,MAAO6P,EAAK,GAAGlZ,MAC7B,CAEAytB,kBAAoB,MAAO,qCAAuC,CAClEC,WAAYxU,GAENA,EAAKvmB,OAAQ,GACfkB,KAAK6H,IAAInF,WAAY,YAAa,yBAEpC,IAAI+P,EAAI4S,EAAK,GAAGlZ,MACZ2tB,EAAMzU,EAAK,GAAGlZ,MACd4tB,EAAM1U,EAAK,GAAGlZ,MAElB,OAAIsG,EAAEqnB,EAAeA,EACjBrnB,EAAEsnB,EAAeA,EACdtnB,CACT,CAGAunB,gBAAkB,MAAO,mDAAqD,CAC9EC,SAAU5U,GACMrlB,KAAKqkB,QAEfgB,EAAKvmB,OAAQ,GACfkB,KAAK6H,IAAInF,WAAY,SAAU,uBAEjC,IAAIuT,EAAIoP,EAAK,GAAGlZ,OACZ8J,EAAE,GAAKA,EAAI,MACbjW,KAAK6H,IAAInF,WAAY,mBAAoB,sCAG3C,IAAK,IAAI7D,EAAE,EAAGA,EAAEwmB,EAAK,GAAGlZ,MAAQtN,IAC5BmB,KAAK6D,OAAOe,MAAO,KAGvB,MAAO,EACT,CAEAs1B,gBAAkB,MAAO,qBAAuB,CAChDC,SAAU9U,GACR,IAAIhU,EAAIgU,EAAK,GAAGlZ,MAEhB,OAAIkF,EAAE,GAAc,EACXA,EAAE,EAAa,EACjB,CACT,CAEA+oB,mBAAqB,MAAO,mCAAqC,CACjEC,YAAahV,GACX,OAAOrlB,KAAKqkB,QAAQjP,WACtB,CAEAklB,oBAAsB,MAAO,gCAAkC,CAC/DC,aAAclV,GACZ,OAAOrlB,KAAKqkB,QAAQhP,cACtB,EAUF,MAAMa,EAEJ1U,YAAamY,EAAM6gB,GACjBx6B,KAAKyH,SAAWkS,EAChB3Z,KAAK2H,iBAAmB6yB,EACxBx6B,KAAK6H,IAAM,IAAIxF,EACfrC,KAAKsF,WAAY,CACnB,CAEA6Q,OAECnW,KAAKy6B,QAAU,CAAC,KAAK,OAAO,OAAO,MAAO,MAAO,KAAO,QAAS,SAAU,MAAO,KAAM,OAAQ,OAAQ,OAAQ,MAAO,QAAS,MAAO,MAAO,MAAO,OAAQ,MAAO,KAAM,KAAM,MAAO,aAAc,cACpMz6B,KAAK06B,YAAc,CAAC,KAEpB16B,KAAK26B,SAAW36B,KAAKyH,SAAS+c,gBAG9B,IADA,IAAIoW,EAAO56B,KAAK2H,iBAAiB6c,gBACxB3lB,EAAE,EAAGA,EAAE+7B,EAAK97B,OAAQD,IAC3BmB,KAAK26B,SAAS57B,KAAM67B,EAAM/7B,IAI5B,IADA+7B,EAAO56B,KAAKyH,SAASkd,eACZ9lB,EAAE,EAAGA,EAAE+7B,EAAK97B,OAAQD,IAC3BmB,KAAK26B,SAAS57B,KAAM67B,EAAM/7B,IAI5B,IADA+7B,EAAO56B,KAAK2H,iBAAiBgd,eACpB9lB,EAAE,EAAGA,EAAE+7B,EAAK97B,OAAQD,IAC3BmB,KAAK26B,SAAS57B,KAAM67B,EAAM/7B,IAG3B,IAASA,EAAE,EAAGA,EAAEmB,KAAKy6B,QAAQ37B,OAAQD,IACnCmB,KAAK26B,SAAS57B,KAAMiB,KAAKy6B,QAAS57B,IAGpC,IAASA,EAAE,EAAGA,EAAEmB,KAAK06B,YAAY57B,OAAQD,IACvCmB,KAAK26B,SAAS57B,KAAMiB,KAAK06B,YAAa77B,IAIpCmB,KAAKsF,WAActH,QAAQK,IAAI,YAAc2B,KAAK26B,UAEtD36B,KAAK66B,sBAAwB,GAC7B,IAAIC,EAAM96B,KAAK66B,sBAEfC,EAAI,KAAU,IACdA,EAAI,KAAU,GACjB,CAEAzkB,kBAGE,OADArW,KAAK0C,WAAY,KAAM,wCAAyC,qBACzD1C,KAAK+6B,OACd,CAEAC,SAAU5hB,EAAK+E,GAEb,IADA,IAAI8c,EAAU9c,EAAK/E,EAAIta,OAChBm8B,EAAU,GACf7hB,EAAIra,KAAM,MACVk8B,GAEJ,CAEAv4B,WAAYke,EAAK7e,EAAQQ,GAEvB,IAAI24B,EAAS34B,OACEH,IAAX84B,IACFA,EAAS,UAGPta,GACF5iB,QAAQK,IAAI,cAAgBkE,EAAQ,YAAcqe,EAAIjG,WAAY,IAAM5Y,GAGtE6e,GACwBxe,MAAlBwe,EAAIjG,YACV3a,KAAK6H,IAAInF,WAAYw4B,EAAQn5B,EAAQ6e,EAAKA,EAAIjG,YAIlD3a,KAAK6H,IAAInF,WAAYw4B,EAAQn5B,OAAQK,GAAY,EAEnD,CAEA+4B,oBAAqB1c,GAErB,IAAM,IAAI5f,EAAE,EACTA,EAAE4f,EAAO3f,OACTD,IACH,CACC,IAAIu8B,EAAQ3c,EAAO5f,GAEfu8B,GACe,QAAdA,EAAMl9B,OACTk9B,EAAMz7B,KAAOy7B,EAAMz7B,KAAK6O,cAI3B,CAEA,OAAOiQ,CACR,CAEAL,cAAeK,GAGd,IAFA,IAAI4c,EAAU,GAEJx8B,EAAE,EACTA,EAAE4f,EAAO3f,OACTD,IACH,CACC,IAAIu8B,EAAQ3c,EAAO5f,GAEfu8B,GACe,OAAdA,EAAMl9B,MACTm9B,EAAQt8B,KAAMq8B,EAIjB,CAEA,OAAOC,CACR,CAECC,gBAAiB7c,GAMjB,IALA,IAAI4c,EAAU,GAKJx8B,EAAE,EACTA,EAAE4f,EAAO3f,OACTD,IACH,CACC,IAAIu8B,EAAQ3c,EAAO5f,GAEnB,GAAIA,EAAE,EAAI,CACL,IAAI08B,EAAS9c,EAAO5f,EAAE,GACN,QAAdu8B,EAAMl9B,MAAgC,MAAdk9B,EAAMl9B,MACX,QAAfq9B,EAAOr9B,MAAiC,MAAfq9B,EAAOr9B,OACzCq9B,EAAOr9B,KAAO,aACTk9B,EAAMz7B,KAAO47B,EAAO57B,KAAOy7B,EAAMz7B,KACjCy7B,EAAMl9B,KAAO,OACK,MAAdk9B,EAAMz7B,KACRy7B,EAAMz7B,KAAO,KAEQ,MAAdy7B,EAAMz7B,KACby7B,EAAMz7B,KAAO,KAEQ,MAAdy7B,EAAMz7B,OACby7B,EAAMz7B,KAAO,MAItB,EAEuB,QAAdy7B,EAAMl9B,MAAiC,MAAdk9B,EAAMz7B,MACnB,QAAdy7B,EAAMl9B,MAAiC,OAAdk9B,EAAMz7B,MACjB,QAAdy7B,EAAMl9B,MAAiC,OAAdk9B,EAAMz7B,QAC/By7B,EAAMl9B,KAAO,MAGrB,CAEE,IAAUW,EAAE,EACXA,EAAE4f,EAAO3f,OACTD,IAEqB,cAAhB4f,EAAO5f,GAAGX,MACZm9B,EAAQt8B,KAAM0f,EAAO5f,IAI3B,OAAOw8B,CACR,CAICG,oBAAqB/c,GAEnB,IAAIgd,EAAS,GAIbA,EAAO18B,KAAM,CAAE28B,GAAI,OAAQC,GAAI,KAAMC,GAAI,IAAKC,MAAO,YACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,KAAMC,GAAI,IAAKC,MAAO,SAMlDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,KAAMC,GAAI,IAAKC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,KAAMC,GAAI,IAAKC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,MAAOC,GAAI,MAAOC,MAAO,YACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,MAAOC,GAAI,OAAQC,MAAO,aACtDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,MAAOC,GAAI,KAAMC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,MAAO,SACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,MAAOC,GAAI,KAAMC,MAAO,UAErDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,OAAQC,GAAI,KAAMC,MAAO,WACtDJ,EAAO18B,KAAM,CAAE28B,GAAI,SAAUC,GAAI,IAAKC,GAAI,KAAMC,MAAO,YACvDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,MAAOC,GAAI,KAAMC,MAAO,UACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,OAAQC,GAAI,IAAKC,GAAI,KAAMC,MAAO,UACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,MAAOC,GAAI,IAAKC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,MAAOC,GAAI,IAAKC,MAAO,YACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,MAAOC,GAAI,IAAKC,MAAO,YACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,KAAMC,GAAI,MAAOC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,QAASC,GAAI,IAAKC,MAAO,YACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,OAAQC,GAAI,MAAOC,GAAI,KAAMC,MAAO,YACvDJ,EAAO18B,KAAM,CAAE28B,GAAI,SAAUC,GAAI,KAAMC,GAAI,KAAMC,MAAO,aACxDJ,EAAO18B,KAAM,CAAE28B,GAAI,SAAUC,GAAI,QAASC,GAAI,KAAMC,MAAO,gBAC3DJ,EAAO18B,KAAM,CAAE28B,GAAI,SAAUC,GAAI,QAASC,GAAI,KAAMC,MAAO,gBAC3DJ,EAAO18B,KAAM,CAAE28B,GAAI,SAAUC,GAAI,KAAMC,GAAI,KAAMC,MAAO,aACxDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,IAAKC,GAAI,KAAMC,MAAO,SACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMC,MAAO,QACnDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,MAAOC,GAAI,KAAMC,MAAO,SACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,IAAKC,GAAI,OAAQC,GAAI,KAAMC,MAAO,UACrDJ,EAAO18B,KAAM,CAAE28B,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,MAAO,WACpDJ,EAAO18B,KAAM,CAAE28B,GAAI,MAAOC,GAAI,KAAMC,GAAI,MAAOC,MAAO,aAKtD,IAFA,IAAIR,EAAU,GAELx8B,EAAE,EAAGA,EAAE4f,EAAO3f,OAAQD,IAC7Bw8B,EAAQt8B,KAAM0f,EAAQ5f,IAGxB,IAASA,EAAE,EAAGA,EAAE48B,EAAO38B,OAAQD,IAAK,CAClC,IAAIi9B,EAAEL,EAAO58B,GACbw8B,EAAUr7B,KAAK+7B,gBAAiBV,EAASS,EAC3C,CAGA,OADI97B,KAAKsF,WAAetH,QAAQK,IAAKg9B,GAC9BA,CACT,CAGAU,gBAAiBtd,EAAQud,GAMzB,IALA,IAAIX,EAAU,GACRY,EAAU,GAINp9B,EAAE,EACTA,EAAE4f,EAAO3f,OACTD,IAECw8B,EAAQx8B,GAAK4f,EAAO5f,GAGtB,IAAUA,EAAE,EACXA,EAAEw8B,EAAQv8B,OACVD,IAEC,GAAiB,MAAbm9B,EAAOJ,GAEiB,QAArBP,EAAQx8B,EAAE,GAAGX,MAAuC,OAArBm9B,EAAQx8B,EAAE,GAAGX,MACvB,QAArBm9B,EAAQx8B,EAAE,GAAGX,MAAuC,OAArBm9B,EAAQx8B,EAAE,GAAGX,MAEzCm9B,EAAQx8B,EAAE,GAAGc,MAAQq8B,EAAON,IAC5BL,EAAQx8B,EAAE,GAAGc,MAAQq8B,EAAOL,KAC1BN,EAAQx8B,EAAE,GAAGc,KAAOq8B,EAAOH,MAC3BR,EAAQx8B,EAAE,GAAGX,KAAO,gBAI3B,CACH,GAAGW,EAAE,EACH,SAGuB,QAArBw8B,EAAQx8B,EAAE,GAAGX,MAAuC,OAArBm9B,EAAQx8B,EAAE,GAAGX,MACtB,QAArBm9B,EAAQx8B,EAAE,GAAGX,MAAuC,OAArBm9B,EAAQx8B,EAAE,GAAGX,MACvB,QAArBm9B,EAAQx8B,EAAE,GAAGX,MAAuC,OAArBm9B,EAAQx8B,EAAE,GAAGX,MAExCm9B,EAAQx8B,EAAE,GAAGc,MAAQq8B,EAAON,IAC7BL,EAAQx8B,EAAE,GAAGc,MAAQq8B,EAAOL,IAC5BN,EAAQx8B,EAAE,GAAGc,MAAQq8B,EAAOJ,KAC1BP,EAAQx8B,EAAE,GAAGc,KAAOq8B,EAAOH,MAC3BR,EAAQx8B,EAAE,GAAGX,KAAO,WACpBm9B,EAAQx8B,EAAE,GAAGX,KAAO,WAGhC,CAGF,IAAIiV,EAAE,EACN,IAAUtU,EAAE,EACXA,EAAEw8B,EAAQv8B,OACVD,IAEwB,YAAnBw8B,EAAQx8B,GAAGX,OACX+9B,EAAQ9oB,GAAKkoB,EAAQx8B,GACrBsU,KAIR,OAAO8oB,CACR,CAEAC,gBAAiB15B,GAEhB,IAAIic,EAASjc,EAAQic,OACjBjF,EAAS,GACT2iB,GAAO,EAEPC,EAAY,GAMhB,IALAA,EAAUr9B,KAAM,CAAEb,KAAM,MAAOyB,KAAM,WACrCy8B,EAAUr9B,KAAM,CAAEb,KAAM,UAAWyB,KAAM,MAEzCy8B,EAAUr9B,SAEI,CAEb,IAAIq8B,EAED,GAAI3c,EAAO3f,OAAS,GACE,WAAhB2f,EAAO,GAAGvgB,MAAmC,KAAhBugB,EAAO,GAAG9e,KACzC,MAIP,GAAIw8B,EAAO,CACN,IAAIhiB,EAAOna,KAAKq8B,oBAAqB75B,EAAS45B,GAC9CjiB,EAAKjc,KAAO,OAChBsb,EAAOza,KAAMob,EACd,KAIiB,QAFhBihB,EAAQ3c,EAAO6d,SAELp+B,MAIT8B,KAAK0C,WAAYF,EAAS,6BAA+B44B,EAAMz7B,KAAO,KAGxEw8B,GAAQA,CACT,CAEA,OAAO3iB,CACR,CAEA+iB,wBAAyB/5B,GAExB,IAAIic,EAASjc,EAAQic,OAErB,OAAIA,EAAO3f,OAAS,GACG,WAAlB2f,EAAO,GAAGvgB,MAAuC,KAAlBugB,EAAO,GAAG9e,IAK/C,CAEA68B,mBAAoBh6B,GAEnB,IAAI44B,EAAQ54B,EAAQic,OAAO6d,QAEP,WAAdlB,EAAMl9B,MAAmC,KAAdk9B,EAAMz7B,MACtCK,KAAK0C,WAAYF,EAAS,oDAAuD44B,EAAMz7B,KAAO,KAG/F,IAAIy8B,EAAY,GAChBA,EAAUr9B,KAAM,CAAEb,KAAM,UAAWyB,KAAM,MAEzC,IAAIwa,EAAOna,KAAKq8B,oBAAqB75B,EAAS45B,GAI9C,OAHA55B,EAAQic,OAAO6d,QAEfniB,EAAKjc,KAAO,OACLic,CACR,CAGCsiB,eAAgBrB,GACd,IAAI5qB,EAAM,GAUV,MARiB,UAAd4qB,EAAMz7B,KACC6Q,EAAM,IAAM4qB,EAAMl9B,KAAO,IAI3BsS,EAAM,IAAM4qB,EAAMz7B,KAAO,GAInC,CAEA+8B,kBAAmBC,GAGjB,IAFA,IAAInsB,EAAM,GAEDosB,EAAG,EAAGA,EAAGD,EAAc79B,OAAQ89B,IAAM,CAC5C,IAAIC,EAAWF,EAAcC,GAElB,IAAPpsB,IAAaA,GAAM,KACvBA,GAAOxQ,KAAKy8B,eAAgBI,EAC9B,CACA,OAAOrsB,CACT,CAEAssB,WAAY1B,EAAO2B,GAEjB,IAAK,IAAIH,EAAG,EAAGA,EAAGG,EAAaj+B,OAAQ89B,IAAM,CAC3C,IAAIC,EAAWE,EAAaH,GAE5B,GAAIxB,EAAMl9B,MAAQ2+B,EAAS3+B,MAAQk9B,EAAMz7B,MAAQk9B,EAASl9B,KACxD,OAAO,EAEJ,GAAIy7B,EAAMl9B,MAAQ2+B,EAAS3+B,MAAyB,UAAjB2+B,EAASl9B,KAC/C,OAAO,CAEX,CACA,OAAO,CACT,CAGAq9B,sBAAuBx6B,EAAS45B,GAE9B,IAAIa,EACFxe,EAASjc,EAAQic,OAEnB,GAAqB,GAAjBA,EAAO3f,OAAX,CAIF,IAAIs8B,EAAO8B,OAAY96B,EAarB,IAZFg5B,EAAQ3c,EAAO6d,UAGdt8B,KAAK0C,WAAYF,EAAS,4BAGzBy6B,EAAUj9B,KAAK88B,WAAY1B,EAAOgB,KAEhCp8B,KAAK0C,WAAYF,EAAS,2BAIV,MAAd44B,EAAMl9B,MAA8B,KAAdk9B,EAAMz7B,KAAc,CAC9C,IAAIw9B,EAAOn9B,KAAKg9B,sBAAuBx6B,EAAS45B,GAE5C,OADAe,EAAK,GAAGx9B,MAAQw9B,EAAK,GAAGx9B,KACjBw9B,CACb,CAqBA,MAnBkB,OAAd/B,EAAMl9B,KACJg/B,EAAa,CAAEh/B,KAAM,MAAOyB,KAAMy7B,EAAMz7B,MAEvB,OAAdy7B,EAAMl9B,OACbg/B,EAAa,CAAEh/B,KAAM,MAAOyB,KAAMy7B,EAAMz7B,QAIxCy7B,EAAQ3c,EAAO6d,YAEbW,EAAUj9B,KAAK88B,WAAY1B,EAAOgB,MAEhCa,EAAmC,GAAzBz6B,EAAQic,OAAO3f,QAEtBm+B,GACHj9B,KAAK0C,WAAYF,EAAS,yCAIzB,CAAC06B,EAAa9B,EAxCnB,CAyCH,CAGCiB,oBAAqB75B,EAAS46B,GAK5B,IAHA,IAAIhB,EAAY,GACZ3d,EAASjc,EAAQic,OAEZ5f,EAAE,EAAGA,EAAIu+B,EAAWt+B,OAAQD,IACnCu9B,EAAUr9B,KAAMq+B,EAAYv+B,IAG9Bu9B,EAAUr9B,KAAM,CAAEb,KAAM,MAAOyB,KAAM,OACrCy8B,EAAUr9B,KAAM,CAAEb,KAAM,MAAOyB,KAAM,QAKrC,IAHA,IAAI09B,GAAQ,EACRC,EAAQ,GACRljB,EAAK,OACK,CAEZ,IAAID,EAAOna,KAAKu9B,gBAAiB/6B,EAAS45B,GAC1C,GAAIiB,GAA0B,GAAjB5e,EAAO3f,OAClB,OAAOqb,EAETkjB,GAAQ,EAER,IAAIG,EAAS,KAiBb,GAhBU,MAANpjB,IACAojB,EAASpjB,EAAGza,MASZwa,EAAKC,GAAKojB,EACVrjB,EAAKjc,KAAO,OACZic,EAAKsjB,IAAM,IACXH,EAAMv+B,KAAOob,KAGbsE,EAAO3f,OAAS,GACI,OAAlB2f,EAAO,GAAGvgB,MAKhB,MAJQkc,EAAKqE,EAAO6d,OAKtB,CAEA,GAAoB,GAAhBgB,EAAMx+B,OAEN,OADAw+B,EAAM,GAAGI,KAAO,QACTJ,EAAM,GAIjB,IAAIK,EAAU,CACZrjB,QAAQ,EACRC,cAAc,EACdrc,KAAM,OACN4E,MAAO,GACPsX,GAAI,MAGN,IAAKvb,EAAE,EAAGA,EAAEy+B,EAAMx+B,OAAQD,IACxB8+B,EAAQ76B,MAAM/D,KAAMu+B,EAAOz+B,IAG7B,OAAO8+B,CAET,CAEDJ,gBAAiB/6B,EAAS45B,GAEzB,IAAI3d,EAASjc,EAAQic,OACnB,GAAqB,GAAjBA,EAAO3f,OACT,OAAO,KAmBX,IAhBA,IAwLM8+B,EAxLFnb,EAAa,CACd3f,MAAO,GACFwX,QAAQ,EACRC,cAAc,GAIlB4hB,GAAO,EACP/hB,EAAK,KACLtX,EAAQ2f,EAAW3f,MACjBu6B,GAAQ,EACR/iB,GAAS,EAETC,GAAe,IAGP,CACb,IAAI6gB,EAAOyC,EAGX,KAFAzC,EAAQ3c,EAAO6d,SAGd,MAIE,GADct8B,KAAK88B,WAAY1B,EAAOgB,GACxB,CAEZ3d,EAAOqf,QAAS1C,GAChB,KACF,CAEH,GAAIe,EAAO,CAEV,GAAkB,OAAdf,EAAMl9B,KACT2/B,EAAO,CAAE3/B,KAAM,MAAOyB,KAAMy7B,EAAMz7B,KAAMya,GAAIA,GACnCE,IACFujB,EAAKl+B,MAAQk+B,EAAKl+B,MAEzBmD,EAAM/D,KAAM8+B,GACPR,GAAQ,EACR/iB,GAAS,OAEV,GAAkB,OAAd8gB,EAAMl9B,KACd2/B,EAAO,CAAE3/B,KAAM,MAAOyB,KAAMy7B,EAAMz7B,KAAMya,GAAIA,GAC5CtX,EAAM/D,KAAM8+B,GACHvjB,GACFta,KAAK0C,WAAYF,EAAS,6BAA8B,iBAE1D66B,GAAQ,OAET,GAAgB,WAAZjC,EAAMl9B,MAA+B,KAAZk9B,EAAMz7B,KAAW,CACjD8e,EAAOqf,QAAS1C,GAEV,IAAI2C,EAAe,GACnBA,EAAah/B,KAAM,CAAEb,KAAM,UAAWyB,KAAM,MAElD,IAAIwa,EAAOna,KAAKw8B,mBAAoBh6B,EAASu7B,GACvC5jB,EAAKC,GAAKA,EACVD,EAAKG,OAASA,EACdH,EAAKI,aAAeA,EAC1BzX,EAAM/D,KAAOob,GACPkjB,GAAQ,EACR/iB,GAAS,CACjB,MACK,GAAgB,QAAZ8gB,EAAMl9B,KAAe,CAE5B,IAAIuD,EAAO25B,EAAMz7B,KAEPq+B,EAAqC,MAARv8B,EAEvC,GAH4BzB,KAAKu8B,wBAAyB/5B,GAG9B,CAE3B44B,EAAQ3c,EAAO6d,QACf,IAAI2B,EAAaj+B,KAAKk8B,gBAAiB15B,GAWhC,GAVAic,EAAO6d,QAEPuB,EAAO,CAAE3/B,KAAM,UAAWsb,OAAQykB,EAAY7jB,GAAIA,EAAIP,aAAcpY,IAE9B,GAAlCzB,KAAK26B,SAAS5iB,QAAStW,KAEzBo8B,EAAO,CAAE3/B,KAAM,QAASyB,KAAM8B,EAAM2Y,GAAIA,EAAI1Y,QAASu8B,IAI7C,MAAN7jB,GAAcE,EAAS,CACzB,IAAI4jB,EAAgB,CACdp7B,MAAO,CAAC+6B,GACRvjB,QAAQ,EACRC,cAAc,EACdrc,KAAM,QAEZ4E,EAAM/D,KAAOm/B,EACf,MAEEp7B,EAAM/D,KAAO8+B,EAGvB,MACeG,GAGPv8B,GADA25B,EAAQ3c,EAAO6d,SACF38B,KAEby7B,EAAQ3c,EAAO6d,QACX2B,EAAaj+B,KAAKk8B,gBAAiB15B,GACvCic,EAAO6d,QAEPuB,EAAO,CAAE3/B,KAAM,YAAasb,OAAQykB,EAAY7jB,GAAIA,EAAIP,aAAcpY,GAE5D,MAAN2Y,GAAcE,GACZ4jB,EAAgB,CACdp7B,MAAO,CAAC+6B,GACRvjB,QAAQ,EACRC,cAAc,EACdrc,KAAM,QAEZ4E,EAAM/D,KAAOm/B,IAGbp7B,EAAM/D,KAAO8+B,KAMtBA,EAAO,CAAE3/B,KAAM,MAAOyB,KAAMy7B,EAAMz7B,KAAMya,GAAIA,GAC3B,MAANA,GAAcE,GACZ4jB,EAAgB,CACdp7B,MAAO,CAAC+6B,GACRvjB,QAAQ,EACRC,cAAc,EACdrc,KAAM,QAEZ4E,EAAM/D,KAAOm/B,IAGbp7B,EAAM/D,KAAO8+B,IAIjBvjB,GAAS,EACT+iB,GAAQ,CAChB,KACS,IAAgB,MAAZjC,EAAMl9B,MAA0B,KAAZk9B,EAAMz7B,KAAY,CAC7C2a,GAAWA,EACX,QACF,CACK,GAAgB,OAAZ8gB,EAAMl9B,MAA2B,OAAZk9B,EAAMz7B,MAAe09B,EAAQ,CACzD9iB,GAAiBA,EACjBkI,EAAWlI,aAAeA,EACtBva,KAAKsF,WACPtH,QAAQK,IAAI,OAEd,QACF,CAEH2B,KAAK0C,WAAYF,EAAS,2DAAqE44B,EAAMz7B,KACtG,CACIya,EAAK,IACV,KAGmB,MAAdghB,EAAMl9B,MAA8B,QAAdk9B,EAAMl9B,MAAgC,MAAdk9B,EAAMl9B,MAA8B,OAAdk9B,EAAMl9B,KAC7Ekc,EAAKghB,EAAMz7B,KAGXK,KAAK0C,WAAYF,EAAS,kCACrBxC,KAAK08B,kBAAkBN,GACvB,WAAahB,EAAMz7B,KAAO,KAGjCw8B,GAAQA,CAET,CAOA,GALY,MAAN/hB,IACFyjB,EAAO,CAAE3/B,KAAM,QAASyB,KAAM,KAAMya,GAAIA,GACxCtX,EAAM/D,KAAO8+B,IAGO,MAApBpb,EAAW3f,MACd,OAAO,KAIN86B,EAAW59B,KAAKm+B,WAAY1b,EAAW3f,MAAO,KAC9C86B,EAAW59B,KAAKm+B,WAAYP,EAAU,KACtCA,EAAW59B,KAAKm+B,WAAYP,EAAU,KACtCA,EAAW59B,KAAKm+B,WAAYP,EAAU,KAGtC,IAAIQ,EAAgB3b,EAOtB,MANe,CACP3f,MAJN86B,EAAW59B,KAAKm+B,WAAYP,EAAU,KAKhCtjB,OAAQ8jB,EAAc9jB,OACtBC,aAAc6jB,EAAc7jB,aAIrC,CAGC4jB,WAAYE,EAASjkB,GAInB,IAFA,IAAIkkB,EAAO,GAAIC,EAAO,GAEb1/B,EAAE,EAAGA,EAAEw/B,EAAOv/B,OAAQD,IAC7By/B,EAAOv/B,KAAMs/B,EAAQx/B,IAGvB,IAASA,EAAE,EAAGA,EAAEy/B,EAAOx/B,OAAQD,IAAM,CAEnC,IAAIg/B,EAAOS,EAAQz/B,GACnB,GAAIA,EAAE,GAAKg/B,EAAKzjB,IAAMA,EAAK,CACzB,IAAIokB,EAAWF,EAAQz/B,EAAE,GAErB4/B,EAAU,CACZnkB,QAAQ,EACRC,cAAc,EACdrc,KAAM,OACN4E,MAAO,GACPsX,GAAIokB,EAASpkB,IAGfqkB,EAAQ37B,MAAO,GAAM07B,EACrBC,EAAQ37B,MAAO,GAAIsX,GAAK,KACxBqkB,EAAQ37B,MAAO,GAAM+6B,EAErBS,EAAOz/B,EAAE,GAAK,KACdy/B,EAAQz/B,GAAM4/B,CAEhB,CACF,CAGA,IAAS5/B,EAAE,EAAGA,EAAEy/B,EAAOx/B,OAAQD,IAGjB,OADRg/B,EAAOS,EAAQz/B,KAEjB0/B,EAAOx/B,KAAM8+B,GAIjB,OAAOU,CACT,CAEAG,uBAAwBrtB,GACtB,MAAQ,KAALA,EACM,QAEFA,CACT,CAEAstB,gBAAiBn8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWC,GAGtDt8B,EAAQic,OAEnB1Z,EAAQ7G,KAAO,aACf6G,EAAQsc,IAAMwd,EACd95B,EAAQyd,iBAAkB,EAE1B,IAAI4Z,EAAY,GAChBA,EAAUr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,WAExCoF,EAAQ0d,WAAaziB,KAAKq8B,oBAAqB75B,EAAS45B,GACxD30B,EAAS1I,KAAMgG,EACjB,CAEAg6B,qBAAsBv8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWC,GAEtE,IAAI1D,EAAQ0D,EACVrgB,EAASjc,EAAQic,OAEnB1Z,EAAQ7G,KAAO,aACf6G,EAAQsc,IAAMwd,EACd95B,EAAQyd,iBAAkB,EAG1B,IAAI9gB,EAAU1B,KAAKk8B,gBAAiB15B,GACpCuC,EAAQrD,QAAUA,EAElB+c,EAAO6d,QACHt8B,KAAKsF,WACPtH,QAAQK,IAAI,gBAAgBogB,QAIhBrc,KADdg5B,EAAQ3c,EAAO6d,WAEblB,EAAQ,CAAEl9B,KAAM,eAGA,MAAdk9B,EAAMl9B,MACR8B,KAAK0C,WAAYF,EAAS,cAG5B,IAAI45B,EAAY,GAChBA,EAAUr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,WAExCoF,EAAQ0d,WAAaziB,KAAKq8B,oBAAqB75B,EAAS45B,GACxD30B,EAAS1I,KAAMgG,EAEjB,CAEAi6B,sBAAwBx8B,EAASo8B,EAAWn3B,EAAU1C,EAASgJ,EAAU8wB,EAAWC,GAElF,IAAI1D,EAAQ0D,EACVrgB,EAASjc,EAAQic,OAIjB1Z,EAAQ7G,KAAO,UACf,IAAI+gC,EAAeJ,EAMnB,GALA95B,EAAQmS,UAAY2nB,EAAUpoB,cACZ,cAAd2kB,EAAMl9B,MACRugB,EAAOqf,QAAS1C,GAGE,OAAhB6D,EAGgB,SADlB7D,EAAQ3c,EAAO6d,SACLp+B,MACR8B,KAAK0C,WAAYF,EAAS,wBAE5Bq8B,EAAYzD,EAAMz7B,UAGJyC,KADdg5B,EAAQ3c,EAAO6d,WAEblB,EAAQ,CAAEl9B,KAAM,eAQA,MAAdk9B,EAAMl9B,KAER8B,KAAK2+B,gBAAiBn8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,GAEnD,WAAdA,EAAMl9B,MAAiC,KAAZk9B,EAAMz7B,KAExCK,KAAK++B,qBAAsBv8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,GAI7Ep7B,KAAK0C,WAAYF,EAAS,iCAAmC44B,EAAMz7B,KAAO,UAIzE,GAAoB,OAAhBs/B,EAAuB,CAE9B,IAAI5B,GAAQ,EAIZ,IAHAt4B,EAAQyU,OAAS,GACjBzU,EAAQmd,WAAa,KAEP,CAGZ,GADAkZ,EAAQ3c,EAAO6d,SACXe,EAAQ,CACV,QAAcj7B,IAAVg5B,EACF,MAEF,GAAsB,OAAdA,EAAMl9B,MAA+B,KAAdk9B,EAAMz7B,KAAe,CAClD8e,EAAOqf,QAAS1C,GAChB,KACF,CACAA,EAAQ3c,EAAO6d,OACjB,CAEkB,QAAdlB,EAAMl9B,MACR8B,KAAK0C,WAAYF,EAAS,wBAG5Bq8B,EAAYzD,EAAMz7B,UAGJyC,KADdg5B,EAAQ3c,EAAO6d,WAEblB,EAAQ,CAAEl9B,KAAM,eAGA,WAAZk9B,EAAMl9B,MAA+B,KAAZk9B,EAAMz7B,MACnCK,KAAK0C,WAAYF,EAAS,iBAG5B,IAAId,EAAU1B,KAAKk8B,gBAAiB15B,QAGtBJ,KADdg5B,EAAQ3c,EAAO6d,WAEblB,EAAQ,CAAEl9B,KAAM,eAGA,WAAZk9B,EAAMl9B,MAA+B,KAAZk9B,EAAMz7B,MACnCK,KAAK0C,WAAYF,EAAS,iBAG5BuC,EAAQyU,OAAOza,KAAM2C,GACrBqD,EAAQmd,WAAWnjB,KAAM8/B,GAEzBxB,GAAQ,CACV,CAEA51B,EAAS1I,KAAMgG,EACjB,MACK,GAAoB,OAAhBk6B,EAAuB,CAGT,SADrB7D,EAAQ3c,EAAO6d,SACFp+B,MAAgC,MAAdk9B,EAAMz7B,MACnCK,KAAK0C,WAAYF,EAAS,kBAIV,SADlB44B,EAAQ3c,EAAO6d,SACLp+B,MACR8B,KAAK0C,WAAYF,EAAS,gCAE5B,IAAIuX,EAAQqhB,EAAMz7B,KAGG,YADrBy7B,EAAQ3c,EAAO6d,SACFp+B,MAAmC,KAAdk9B,EAAMz7B,MACtCK,KAAK0C,WAAYF,EAAS,kDAIP,SADrB44B,EAAQ3c,EAAO6d,SACFp+B,MACX8B,KAAK0C,WAAYF,EAAS,kDAE5B,IAAIge,EAAU4a,EAAMz7B,KAGC,YADrBy7B,EAAQ3c,EAAO6d,SACFp+B,MAAmC,KAAdk9B,EAAMz7B,MACtCK,KAAK0C,WAAYF,EAAS,mDAIP,OADrB44B,EAAQ3c,EAAO6d,SACFp+B,MAA8B,KAAdk9B,EAAMz7B,MACjCK,KAAK0C,WAAYF,EAAS,qDAI5B45B,EAAY,GACZ,IAAI8C,EAAUl/B,KAAKq8B,oBAAqB75B,EAAS45B,GAE7Cp8B,KAAKsF,WACPtH,QAAQK,IAAI,UAAY6gC,GAG1Bn6B,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAKO,EACpBhV,EAAQyU,OAAO,GAAKgH,EACpBzb,EAAQyU,OAAO,GAAK0lB,EACpBz3B,EAAS1I,KAAMgG,EAEjB,MACK,GAAoB,QAAhBk6B,GAA0C,SAAhBA,EAAyB,CAC1D,IAAIrmB,GAAO,EAQX,QAJcxW,KAFdg5B,EAAQ3c,EAAO6d,UAGbt8B,KAAK0C,WAAYF,EAAS,yCAA0C,qBAGpD,OAAd44B,EAAMl9B,KAAe,CAGL,QAAdk9B,EAAMl9B,MACN8B,KAAK0C,WAAYF,EAAS,yCAA0C,qBAGxE,IAAI/C,EAAQ27B,EAAMz7B,KAalB,YAVcyC,KADdg5B,EAAQ3c,EAAO6d,UAEK,UAAdlB,EAAMl9B,MACR8B,KAAK0C,WAAYF,EAAS,8CAA+C44B,EAAMz7B,KAAK,KAIxFoF,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAK/Z,EACpBsF,EAAQtF,OAAQ,OAChBgI,EAAS1I,KAAMgG,EAGjB,CACA6T,EAAMC,SAASuiB,EAAMz7B,WAEPyC,KADdg5B,EAAQ3c,EAAO6d,UAEK,UAAdlB,EAAMl9B,MACR8B,KAAK0C,WAAYF,EAAS,8CAA+C44B,EAAMz7B,KAAK,KAIxFoF,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAKZ,EACpB7T,EAAQtF,OAAQ,EAChBgI,EAAS1I,KAAMgG,EAEjB,MACK,GAAoB,MAAhBk6B,EAAuB,CAC9B,IAAIE,EAAO,GACPC,GAAc,GAElBhD,EAAY,IACFr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,SACtCy8B,EAAUr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,UAGtC,IAAIiiB,EAAS,KAEK,SAHlBwZ,EAAQ3c,EAAO6d,SAGLp+B,MAAiC,cAAdk9B,EAAMz7B,MAAsC,cAAdy7B,EAAMz7B,MAQ/D8e,EAAOqf,QAAS1C,GAChBxZ,EAAS5hB,KAAKq8B,oBAAqB75B,EAAS45B,KAR5CgD,GAAc,EACdxd,EAAS,CACP1jB,KAAM,UACNyB,KAAMy7B,EAAMz7B,OASE,SADlBy7B,EAAQ3c,EAAO6d,SACLp+B,MACR8B,KAAK0C,WAAYF,EAAS,yBAGvB48B,EAMkB,QAAdhE,EAAMz7B,MACXK,KAAK0C,WAAYF,EAAS,6BANP,QAAd44B,EAAMz7B,MAAgC,SAAdy7B,EAAMz7B,MACnCK,KAAK0C,WAAYF,EAAS,yBAS9B,IAMI68B,EANAC,EAASlE,EAAMz7B,KAIf4/B,GAAY,EAoBhB,GAnBI9/B,EAAQ,GAGM,QANlB27B,EAAQ3c,EAAO6d,SAMLp+B,MAEY,QAAdk9B,EAAMl9B,MACN8B,KAAK0C,WAAYF,EAAS,yCAA0C,qBAGxE+8B,GAAY,EACZ9/B,EAAQ27B,EAAMz7B,MAIhB0/B,EAAQxmB,SAASuiB,EAAMz7B,MAGzBw/B,EAAKpgC,KAAMsgC,GAEND,EA8BHr6B,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAKoI,EAAOjiB,KAAK8W,cAE5B1R,EAAQyU,OAAO,GADd+lB,EACmB9/B,EAGA4/B,EAExBt6B,EAAQtF,MAAQ8/B,EAEhB93B,EAAS1I,KAAMgG,OAxCE,CACjB,KAGe3C,OADbg5B,EAAQ3c,EAAO6d,UAEG,UAAdlB,EAAMl9B,MACQ,UAAdk9B,EAAMl9B,MACW,OAAdk9B,EAAMl9B,MAA+B,KAAdk9B,EAAMz7B,MAClCK,KAAK0C,WAAYF,EAAS,oCAIV,QADlB44B,EAAQ3c,EAAO6d,SACLp+B,MACR8B,KAAK0C,WAAYF,EAAS,6BAE5B28B,EAAKpgC,KAAO8Z,SAASuiB,EAAMz7B,OAGzBw/B,EAAKrgC,OAAS,GAChBkB,KAAK0C,WAAYF,EAAS,sDAG5BuC,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAK8lB,EAAO7oB,cAC3B1R,EAAQyU,OAAO,GAAKoI,EACpB7c,EAAQyU,OAAO,GAAK2lB,EACpB13B,EAAS1I,KAAMgG,EACjB,CAiBF,MACK,GAAoB,UAAhBk6B,EACHrmB,GAAO,EAEX7T,EAAQyU,OAAO,GACf/R,EAAS1I,KAAMgG,QAGZ,GAAoB,OAAhBk6B,EACHrmB,GAAO,EAEX7T,EAAQyU,OAAO,GACf/R,EAAS1I,KAAMgG,QAGZ,GAAoB,QAAhBk6B,EACHrmB,GAAO,EAEX7T,EAAQyU,OAAO,GACf/R,EAAS1I,KAAMgG,QAGZ,GAAoB,OAAhBk6B,EAAuB,CAE9B,IAAcO,EAAWC,EAASC,EAC9BtD,EAAY,GAkChB,GA/BkB,SADlBhB,EAAQ3c,EAAO6d,SACLp+B,MACR8B,KAAK0C,WAAYF,EACX,6CAA+C44B,EAAMl9B,KAAK,IAAIk9B,EAAMz7B,MAG5E0N,EAAW+tB,EAAMz7B,KAGI,OADrBy7B,EAAQ3c,EAAO6d,SACFp+B,MAA8B,KAAdk9B,EAAMz7B,MACjCK,KAAK0C,WAAYF,EACX,qCAAuC44B,EAAMl9B,KAAK,IAAIk9B,EAAMz7B,OAGpEy8B,EAAY,IACFr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,OAEtC6/B,EAAYx/B,KAAKq8B,oBAAqB75B,EAAS45B,GAG1B,SADrBhB,EAAQ3c,EAAO6d,SACFp+B,MAAgC,MAAdk9B,EAAMz7B,MACnCK,KAAK0C,WAAYF,EAAS,sCAAwC44B,EAAMl9B,KAAK,IAAIk9B,EAAMz7B,OAGzFy8B,EAAY,IACFr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,MACxCy8B,EAAUr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,SAEtC8/B,EAAUz/B,KAAKq8B,oBAAqB75B,EAAS45B,GAC7CsD,EAAY,CAAE58B,MAAO,CAAE,CAAEnD,KAAM,IAAKya,GAAI,KAAMlc,KAAM,cAGnCkE,KADjBg5B,EAAQ3c,EAAO6d,SAEb,GAAkB,QAAdlB,EAAMl9B,MAAgC,QAAdk9B,EAAMz7B,MAE9By8B,EAAY,IACFr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,MACxC+/B,EAAY1/B,KAAKq8B,oBAAqB75B,EAAS45B,QAGjD,GAAqB,UAAdhB,EAAMl9B,MAAkC,KAAdk9B,EAAMz7B,KACrC,KAAM,0BAA4By7B,EAAMz7B,KAAM,IAKpDoF,EAAQmS,UAAY,WACpBnS,EAAQyU,OAAO,GACfzU,EAAQyU,OAAO,GAAKgmB,EACpBz6B,EAAQyU,OAAO,GAAKimB,EACpB16B,EAAQyU,OAAO,GAAKkmB,EACpB36B,EAAQsI,SAAWA,EACnB5F,EAAS1I,KAAMgG,GACX/E,KAAKsF,WACPtH,QAAQK,IAAI,WAAY0G,EAG5B,MACK,GAAoB,QAAhBk6B,EAAwB,CAK/B,IAHA,IAAI5xB,EAEAsyB,GAAW,GAGTvE,EAAQ3c,EAAO6d,UAID,UAAdlB,EAAMl9B,MANE,CAUZ,GAAkB,QAAdk9B,EAAMl9B,KACR,KAAM,gCAAiCk9B,EAAMz7B,KAAM,IAGrD,IAAIigC,EAAc,CAChB1oB,UAAW,WACX6K,QAASqZ,EAAMz7B,KACfgb,WAAY5V,EAAQ4V,WACpBzc,KAAM6G,EAAQ7G,MAOhB,GAJAuJ,EAAS1I,KAAM6gC,GACfD,GAAW,IAEPvE,EAAQ3c,EAAO6d,SAEjB,MAEF,GAAkB,UAAdlB,EAAMl9B,KACR,MAEF,GAAqB,OAAdk9B,EAAMl9B,MAA+B,KAAdk9B,EAAMz7B,KAClC,KAAM,0BAA4By7B,EAAMz7B,KAAO,GAEnD,CAEMggC,IACJ56B,EAAQmS,UAAY,WACpBnS,EAAQgd,QAAU,KAClBta,EAAS1I,KAAMgG,GAGnB,MACK,GAAoB,MAAhBk6B,EAAsB,EAG7B7C,EAAY,IACFr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,SACtCy8B,EAAUr9B,KAAM,CAAEb,KAAM,OAAQyB,KAAM,SACtC,IAAIkgC,EAAQ7/B,KAAKq8B,oBAAqB75B,EAAS45B,GAK/C,GAJAr3B,EAAQyU,OAAQ,CAAEqmB,GAIA,SAFlBzE,EAAQ3c,EAAO6d,SAELp+B,MAAgC,QAAdk9B,EAAMz7B,KAAgB,CAChD,IAAIgF,EAAS,CACbA,KAAc,OACdA,KAAc,QACd8Z,EAAOqf,QAASn5B,EAClB,MACM8Z,EAAO3f,OAAS,GACI,OAAlB2f,EAAO,GAAGvgB,OACRyG,EAAS,CACbA,KAAc,OACdA,KAAc,QACd8Z,EAAOqf,QAASn5B,IAMtB,IACIm7B,EADS9/B,KAAK+/B,kBAAmBv9B,GAClBiF,SAEfzH,KAAKsF,WACPtH,QAAQK,IAAKyhC,GAGfr4B,EAAS1I,KAAMgG,GAEf,IAAK,IAAIi7B,EAAG,EAAGA,EAAGF,EAAMhhC,OAAQkhC,IAC9Bv4B,EAAS1I,KAAM+gC,EAAME,GAGzB,MACK,GAAoB,QAAhBf,EAAwB,CAE/B,IAAIgB,EAAY,GAOhB,KAJA7D,EAAY,IACFr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,MACxCy8B,EAAUr9B,KAAM,CAAEb,KAAM,MAAOyB,KAAM,QAEtB,CACX,IAAIw9B,EAAOn9B,KAAKg9B,sBAAuBx6B,EAAS45B,GAKhD,QAAch6B,KAHVy9B,EAAQ1C,EAAK,IAIf,KAAM,sBAMR,GAHA8C,EAAUlhC,KAAM8gC,QAGFz9B,KADdg5B,EAAQ+B,EAAK,IAEX,MAEF,GAAkB,UAAd/B,EAAMl9B,MAAkC,KAAdk9B,EAAMz7B,KAClC,MAEqB,OAAdy7B,EAAMl9B,MAA8B,KAAbk9B,EAAMz7B,MAIpCK,KAAK0C,WAAYF,EAAS,4BAA8B44B,EAAMl9B,KAAK,IAAIk9B,EAAMz7B,KAEnF,CAEAoF,EAAQyU,OAAOymB,EACfx4B,EAAS1I,KAAMgG,EAEjB,MACK,GAAoB,OAAhBk6B,EAAuB,CAI9B,GAFIx/B,EAAQ,GAEC,OADb27B,EAAQ3c,EAAO6d,SACO,KAAM,qBAE5B,GAAkB,QAAdlB,EAAMl9B,KACR,KAAM,2BAA4Bk9B,EAAMz7B,KAAM,IAMhD,GAHAF,EAAQ27B,EAAMz7B,KAAK6O,cAGN,OADb4sB,EAAQ3c,EAAO6d,SACO,KAAM,kCAE5Bv3B,EAAQtF,MAAQA,EAChBgI,EAAS1I,KAAMgG,EAEjB,MACK,GAAoB,OAAhBk6B,EAAwB,CAE/B,KAGiB,OADb7D,EAAQ3c,EAAO6d,WAInB70B,EAAS1I,KAAMgG,EAEjB,MAEE/E,KAAK0C,WAAYF,EAASuC,EAAQmS,UAAY,mBAGpD,CAEAgpB,mBAAqB19B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWC,GAErE,IAAI1D,EAAQ0D,EACVrgB,EAASjc,EAAQic,OAYnB,IAVA1Z,EAAQqc,cAAgBphB,KAAK0+B,uBAAwBG,GACrD95B,EAAQ7G,KAAO,OAGG,cAAdk9B,EAAMl9B,MACRugB,EAAOqf,QAAS1C,GAGlBr2B,EAAQyU,OAAS,KAEF,CAEb,IAAI2mB,GAAa,EACb/D,EAAY,GAChBA,EAAUr9B,KAAM,CAAEb,KAAM,MAAOyB,KAAM,WACrCy8B,EAAUr9B,KAAM,CAAEb,KAAM,SAAUyB,KAAM,WAExC,IAAI8iB,EAAaziB,KAAKq8B,oBAAqB75B,EAAS45B,GAKpD,GAJIp8B,KAAKsF,WACPtH,QAAQK,IAAKokB,GAGG,MAAdA,EAIF,GAHA1d,EAAQyU,OAAOza,KAAM0jB,GAGRrgB,OADbg5B,EAAQ3c,EAAO6d,SAKb,QAHcl6B,IAAVg5B,IACF+E,GAAa,GAEG,UAAd/E,EAAMl9B,KACRiiC,GAAa,MAEV,IAAkB,OAAd/E,EAAMl9B,KACb,SAGA8B,KAAK0C,WAAYF,EAAS,6CAA+C44B,EAAMz7B,KAAM,IACvF,MAGAwgC,GAAa,OAKfA,GAAa,EAGf,GAAIA,EAAc,CAChB14B,EAAS1I,KAAMgG,GACf,KACF,CACF,CACF,CAEDg7B,kBAAmBv9B,EAASo8B,GAO3B,IALA,IAAIngB,EAASjc,EAAQic,OACjBhX,EAAW,GACTsG,EAAW,CAAC,IAGJ,CAEb,IACIqtB,EADAr2B,EAAU,CAAC,EAERq7B,GAAU,EACVvwB,GAAU,EAKjB,GAHA9K,EAAQ4V,WAAanY,EAAQmY,gBAGfvY,KADdg5B,EAAQ3c,EAAO6d,SAEd,MAED,GAAkB,UAAdlB,EAAMl9B,KAAV,CAKkB,QAAdk9B,EAAMl9B,OACS,SAAdk9B,EAAMl9B,KACJ8B,KAAK0C,WAAYF,EAAS,+CAAiD69B,KAAK1gC,KAAM,KAGtFK,KAAK0C,WAAYF,EAAS,oDAAwD44B,EAAMr5B,SAI/F,IAAI88B,EAAYzD,EAAMz7B,KAGlBK,KAAKy6B,QAAQ1iB,QAASqjB,EAAMz7B,OAAU,IACxCkQ,GAAU,IAGL7P,KAAK26B,SAAS5iB,QAASqjB,EAAMz7B,OAAU,GAAmB,OAAdy7B,EAAMz7B,MAIhDK,KAAK06B,YAAY3iB,QAASqjB,EAAMz7B,OAAU,KAHjDygC,GAAU,QASEh+B,KADbg5B,EAAQ3c,EAAO6d,WAEflB,EAAQ,CAAEl9B,KAAM,eAGR2R,EAEJ7P,KAAKg/B,sBAAuBx8B,EAASo8B,EAAWn3B,EAAU1C,EAASgJ,EAAU8wB,EAAWzD,GAGtE,MAAdA,EAAMl9B,KAEd8B,KAAK2+B,gBAAiBn8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,GAE/C,WAAdA,EAAMl9B,MAAiC,KAAZk9B,EAAMz7B,MAAcygC,GAM/CA,IACHpiC,QAAQK,IAAI,SAASmE,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,GACvEp7B,KAAK0C,WAAYF,EAAS,oBAAsBq8B,IAElD7+B,KAAKkgC,mBAAoB19B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,IARjFp7B,KAAK++B,qBAAsBv8B,EAASo8B,EAAWn3B,EAAU1C,EAAS85B,EAAWzD,EA3C9E,CAuDD,CAOE,MALa,CACT3zB,SAAUA,EACVsG,SAAUA,EAIjB,CAECuyB,UAAW7hB,GACT,GAAKze,KAAKsF,UAAV,CAGA,IADA,IAAIi7B,EAAY,GACP1hC,EAAE,EAAGA,EAAE4f,EAAO3f,OAAQD,IAGZ,IAAb0hC,IACFA,GAAa,MAEfA,IALIC,EAAM/hB,EAAO5f,IACAX,KAAO,IAAMsiC,EAAI7gC,KAUpC,IAHA3B,QAAQK,IAAKkiC,GAGJ1hC,EAAE,EAAGA,EAAE4f,EAAO3f,OAAQD,IAAK,CAChC,IAAI2hC,EAAM/hB,EAAO5f,GACjBb,QAAQK,IAAI,UAAUmiC,EAC1B,CAlBiC,CAoBnC,CAKA3c,eAAgBhW,GAEd,IAKwBpL,GAAQ,EAO5Bgc,EAHM,IAAIgiB,EAAW,IAAIC,EAAe7yB,GAAQ7N,KAAK26B,UAGtCgG,WAkBnB,GAjBI3gC,KAAKsF,WACPtH,QAAQK,IAAI,0BAEd2B,KAAKsgC,UAAW7hB,GAGhBA,EAASze,KAAKm7B,oBAAqB1c,GACnCA,EAASze,KAAKoe,cAAeK,GAC7BA,EAASze,KAAKs7B,gBAAiB7c,GAC/BA,EAASze,KAAKw7B,oBAAqB/c,GAG/Bze,KAAKsF,WACPtH,QAAQK,IAAI,sBAEd2B,KAAKsgC,UAAW7hB,GAEK,GAAjBA,EAAO3f,OACZ,OAAO,KAGR,GAAsB,OAAlB2f,EAAO,GAAGvgB,KAAgB,CACLugB,EAAO,GAAG9e,KAC/B8C,EAASgc,EAAO,GAAG9e,KACnB,IAAIihC,EAAW/yB,EAAKxK,OAAQZ,EAAO3D,QACnC,OAAOkB,KAAKoY,UAAW3V,EAAS,eAAiBm+B,EACnD,CAEE,KAAM,sDAGV,CAEAxoB,UAAWvK,GAET,IAKIgzB,EAAY9+B,EALZ++B,EAAa,CACfnmB,YAAa,EACblT,SAAU,IAGYhF,GAAQ,EAChC,IACEo+B,EAAW,YACX9+B,EAAO,OACT,IAAIg/B,EAAQ,IAAIN,EAAW,IAAIC,EAAe7yB,GAAQ7N,KAAK26B,UAEzD54B,EAAO,iBACP,IAAI0c,EAASsiB,EAAMJ,WAkBnB,GAjBI3gC,KAAKsF,WACPtH,QAAQK,IAAI,0BAEd2B,KAAKsgC,UAAW7hB,GAEhB1c,EAAO,WACP0c,EAASze,KAAKm7B,oBAAqB1c,GACnCA,EAASze,KAAKoe,cAAeK,GAC7BA,EAASze,KAAKs7B,gBAAiB7c,GAC/BA,EAASze,KAAKw7B,oBAAqB/c,GAG/Bze,KAAKsF,WACPtH,QAAQK,IAAI,sBAEd2B,KAAKsgC,UAAW7hB,GAEK,GAAjBA,EAAO3f,OACZ,OAAO,KAGc,OAAlB2f,EAAO,GAAGvgB,OACb4iC,EAAWnmB,WAAa8D,EAAO,GAAG9e,KAC/B8C,EAASgc,EAAO,GAAG9e,KACnB8e,EAAO6d,SAGX,IAAI95B,EAAU,CACVic,OAAQA,EACR9D,WAAYmmB,EAAWnmB,YAGzBkmB,EAAa,SACb9+B,EAAO,mBACP,IAAIub,EAAStd,KAAK+/B,kBAAmBv9B,GACjCiF,EAAW6V,EAAO7V,SAItB,OAHAq5B,EAAWr5B,SAAWA,EACtBq5B,EAAW5oB,IAAMrK,EACjBizB,EAAW/yB,SAAWuP,EAAOvP,SACtB+yB,CAaT,CAXA,MAAQx9B,GAEN,GAAItD,KAAK6H,IAAIrE,QAASF,GAMpB,MALiB,GAAbA,EAAEb,SACW,GAAXA,IACFa,EAAEb,OAASA,GAGTa,EAERtD,KAAK0C,WAAY,KAAMm+B,EAAa,WAAYv9B,EAAG,WAAavB,EAClE,CACF,CAEA2c,UAAW7Q,EAAMmzB,EAAOC,GAEtB,IACE,IACIxiB,EADQ,IAAIgiB,EAAW,IAAIC,EAAe7yB,GAAQ7N,KAAK26B,UACxCgG,WAInB,OAHIM,IAAaxiB,EAASze,KAAKoe,cAAeK,IAC1CuiB,IAASviB,EAASze,KAAKs7B,gBAAiB7c,IAC5Cze,KAAKsgC,UAAW7hB,GACTA,CAKT,CAHA,MAAQnb,GACNtF,QAAQK,IAAKiF,GACbtD,KAAK0C,WAAW,KAAK,kBAAkB,WACzC,CACF,EAUF,MAAMg+B,EAELl/B,YAAa0/B,GACXlhC,KAAK4B,OAASs/B,EACdlhC,KAAKmhC,MAAQ,EACbnhC,KAAKohC,UAAY,EACjBphC,KAAK6N,KAAO,CAGd,CAEAwzB,OACC,OAAOrhC,KAAK4B,OAAOyB,OAAQrD,KAAKmhC,MAAM,EACvC,CACAG,QACC,OAAOthC,KAAK4B,OAAOyB,OAAQrD,KAAKmhC,MAAM,EACvC,CAGAI,UAAWlwB,GACVrR,KAAKmhC,OAAS9vB,CACf,CAEAmwB,UAEC,IAAIjqB,EAAIvX,KAAK4B,OAAOyB,OAAQrD,KAAKmhC,MAAM,GACvCnhC,KAAKmhC,QACI,MAAL5pB,IACHvX,KAAK6N,OACL7N,KAAKohC,UAAY,EAGnB,CAEAK,MACC,IAAI/yB,EAAM1O,KAAK4B,OAAO9C,OACtB,QAAIkB,KAAKmhC,MAAQzyB,EAIlB,EAID,MAAM+xB,EAELj/B,YAAakgC,EAAQC,GACnB3hC,KAAKye,OAAS,GACdze,KAAK0hC,OAASA,EACd1hC,KAAK2hC,SAAWA,EAChB3hC,KAAK4hC,QAAS,CAChB,CAEAC,SAAUjhB,GAIT,MAAO,CAFoD,MAAlDA,EAAIrJ,EAAEuqB,MAAM,mCAEV,EAEZ,CAEAC,WAAYnhB,GAGX,MAAO,CADa,KAATA,EAAIrJ,GAAqB,KAATqJ,EAAIrJ,EACpB,EACZ,CAEAyqB,SAAUphB,GACR,MAAa,KAATA,EAAIrJ,EACA,EAAC,EAAK,GAEP,EAAC,EAAM,EAChB,CAGA0qB,WAAYrhB,GAGX,GAAIA,EAAIshB,SACP,MAAO,EAAC,EAAM,GAEf,IAAIpqB,EAAsC,MAAjC8I,EAAIrJ,EAAEuqB,MAAM,kBAkBrB,GAhBY,KAARlhB,EAAIrJ,IACNO,GAAK,EACW,MAAZ8I,EAAIuhB,MAC4C,MAAjCvhB,EAAIuhB,KAAKL,MAAM,iBAEhClhB,EAAIshB,UAAW,EACfpqB,GAAK,IAME,KAAP8I,EAAIrJ,IACPqJ,EAAIshB,UAAW,GAGZliC,KAAK4hC,OACR,GAAI5hC,KAAK2hC,SAAS5pB,QAAS6I,EAAIwhB,IAAI5zB,gBAAkB,EACpDoS,EAAIshB,UAAW,OAEX,QAAmB9/B,IAAZwe,EAAIwhB,IAGf,IAFA,IAESvjC,EAAE,EAAGA,EAAEmB,KAAK2hC,SAAS7iC,OAAQD,IAAK,CAC1C,IAAI0X,EAAKvW,KAAK2hC,SAAS9iC,GACvB,GAAI+hB,EAAIwhB,IAAI5zB,cAAcuJ,QAASxB,GAAO,EAGzC,MAAO,CAACuB,EAAIvB,EAAGzX,OAEjB,CAIF,MAAO,CAACgZ,EAAG,EACZ,CAEAuqB,UAAWzhB,GACV,MAAO,CAA6B,MAA3BA,EAAIrJ,EAAEuqB,MAAM,WAAqB,EAC3C,CAEAQ,UAAW1hB,GACT,MAAa,KAATA,EAAIrJ,GAAqB,MAATqJ,EAAIrJ,GAAsB,MAATqJ,EAAIrJ,GAAsB,MAATqJ,EAAIrJ,EAClD,EAAC,EAAK,GAGP,EAAC,EAAM,EAChB,CAEAgrB,iBAAkB3hB,GAChB,MAAa,KAATA,EAAIrJ,EACA,EAAC,EAAK,GAEP,EAAC,EAAM,EAChB,CAGAirB,UAAW5hB,GACT,MAAa,KAATA,EAAIrJ,EACA,EAAC,EAAK,GAEP,EAAC,EAAM,EAChB,CAEAkrB,UAAW7hB,GACT,MAAO,EAAC,EAAK,EACf,CAEA8hB,UAAW9hB,GACV,MAAa,KAATA,EAAIrJ,GAAqB,KAATqJ,EAAIrJ,GAAqB,KAATqJ,EAAIrJ,GAAqB,KAATqJ,EAAIrJ,EAChD,EAAC,EAAK,GAEP,EAAC,EAAM,EACf,CAGAorB,UAAW/hB,GAEV,OAAIA,EAAIshB,SACA,EAAC,EAAM,GAGE,GAAbthB,EAAIugB,MACI,KAAPvgB,EAAIrJ,GACPqJ,EAAIgiB,UAAW,EACR,EAAC,EAAK,IAEP,EAAC,EAAM,GAENhiB,EAAIgiB,UACPhiB,EAAIugB,MAAQ,GAAY,KAAPvgB,EAAIrJ,IACzBqJ,EAAIshB,UAAW,GAET,EAAC,EAAK,IAGP,EAAC,EAAM,EAEf,CAEAW,eAAgBC,GACf,IAAItC,EAAMsC,EAOV,OALAtC,EAAItiC,KAAO4kC,EAAK5kC,KAEA,OAAZsiC,EAAItiC,OACNsiC,EAAI7gC,KAAOmjC,EAAKnjC,KAAK0D,OAAO,EAAEy/B,EAAKnjC,KAAKb,OAAO,IAE1C0hC,CACR,CAEAuC,UAAWC,EAAMC,EAAOC,EAAUC,GAIjC,IAHA,IAAI3C,EAAM,CAAEtiC,KAAM+kC,EAAOtjC,KAAO,IAC5BihB,EAAM,CAAEugB,MAAM,EAAGgB,KAAM,KAAMC,IAAK,KAE/BY,EAAKvB,OAAO,CAElB,IAAIlqB,EAAIyrB,EAAK3B,OAEbzgB,EAAIwhB,KAAO7qB,EACXqJ,EAAIrJ,EAAIA,EAER,IAAIO,EAAK9X,KAAKkjC,GAAatiB,GAC3B,GAAI9I,EAAG,GAAK,EAAI,CACdkrB,EAAKzB,UAAWzpB,EAAG,GAAG,GACtB8I,EAAIwhB,IAAMxhB,EAAIwhB,IAAI/+B,OAAO,EAAEud,EAAIwhB,IAAItjC,OAAOgZ,EAAG,IAC7C0oB,EAAI7gC,KAAOihB,EAAIwhB,IACf,KACF,CAEA,IAAKtqB,EAAG,GACP,OAAO9X,KAAK6iC,eAAgBrC,GAQ7B,GANAA,EAAI7gC,MAAQ4X,EACZyrB,EAAKxB,UAEL5gB,EAAIugB,QACJvgB,EAAIuhB,KAAO5qB,EAEM,OAAb4rB,EACH,KAEF,CAEA,OAAOnjC,KAAK6iC,eAAgBrC,EAC7B,CAGAG,WACC,IAAIqC,EAAOhjC,KAAK0hC,OAGZjjB,EAAS,GAET2kB,EAAa,GAiBjB,IAZAA,EAAWrkC,KAAK,CAAC,MAAS,YAAe,QACzCqkC,EAAWrkC,KAAK,CAAC,MAAS,YAAe,QACzCqkC,EAAWrkC,KAAK,CAAC,MAAS,YAAe,QACzCqkC,EAAWrkC,KAAK,CAAC,OAAU,aAAe,QAC1CqkC,EAAWrkC,KAAK,CAAC,KAAS,WAAgB,QAC1CqkC,EAAWrkC,KAAK,CAAC,OAAU,aAAgB,QAC3CqkC,EAAWrkC,KAAK,CAAC,KAAS,WAAgB,QAC1CqkC,EAAWrkC,KAAK,CAAC,UAAW,YAAgB,QAC5CqkC,EAAWrkC,KAAK,CAAC,MAAS,YAAgB,QAC1CqkC,EAAWrkC,KAAK,CAAC,SAAW,mBAAuB,QACnDqkC,EAAWrkC,KAAK,CAAC,QAAU,YAAgB,SAEnCikC,EAAKvB,OAAQ,CAIpB,IAHA,IAAIlqB,EAAIyrB,EAAK3B,OACTgC,GAAa,EAERxkC,EAAE,EAAGA,EAAEukC,EAAWtkC,OAAQD,IAAK,CACvC,IAAIykC,EAAOF,EAAYvkC,GAEnB+hB,EAAM,CAAEugB,MAAO,EAAG5pB,EAAEA,GAExB,GADSvX,KAAKsjC,EAvBH,IAuBkB1iB,GACtB,GAAK,CACV,IAAI4f,EAAMxgC,KAAK+iC,UAAWC,EAAMM,EA1BvB,GA0BqCA,EAzBrC,GAyBmDA,EAxB7C,IA0BC,QAAZ9C,EAAItiC,OACPsiC,EAAI7gC,KAAO6gC,EAAI7gC,KAAK6O,eAGL,SAAZgyB,EAAItiC,OACPsiC,EAAIz+B,OAAS,IAAMy+B,EAAI7gC,KAAO,iBAAmB6gC,EAAI7gC,KAAK6X,WAAW,GAAK,KAG3EiH,EAAO1f,KAAMyhC,GACb6C,GAAa,EACb,KACF,CAID,CACA,IAAIA,EACH,KAAM,wCAA0C9rB,EAAI,OAASyrB,EAAKn1B,KAAO,IAAMm1B,EAAK5B,SAEtF,CACA,OAAO3iB,CACR,EA0TD,MAAMuG,EAELxjB,cAAe,CAGdyjB,uBAAyBse,GAKvB,MAJsB,CACpB9/B,OAAOyI,oBAAqBq3B,EAAmB,IAC/CA,EAAmB,GAGvB,CAEAre,0BAA4BL,EAAiBtiB,GAG3C,IAAIkiB,EAAQliB,EAAMiiB,eAAe,GAC7Bgf,EAAOjhC,EAAMoiB,cAAc,GAE3B8e,EAAM5e,EAAiB,GACvBW,EAAWX,EAAiB,QAEPziB,IAArBqhC,EAAe,UAAoBA,EAAe,QAAI,EAAGje,EAAoB,QAAI,IAErF,IAAK,IAAI3mB,EAAE,EAAEA,EAAE4lB,EAAM3lB,OAAOD,IAAK,CAa/B,IAAI6kC,EAAY,CAAC,GAPbC,OADmBvhC,IAAhBG,EAHHuJ,GADA83B,EAAQnf,EAAM5lB,IACHmZ,QAAQ,SAAS,gBAIjBzV,EAAOuJ,KAIT,WAIAiM,QAAQ,KAAM,IAEV4rB,EAAS5gC,MAAM,KAAMjE,OAEpC4kC,EAAU3d,YAAe4d,EAAS5gC,MAAM,KAAM,GAC9C2gC,EAAU99B,MAAU+9B,EAAS5gC,MAAM,KAAM,GACzC2gC,EAAU7/B,OAAU8/B,EAAS5gC,MAAM,KAAM,GAEzC4gC,EAASA,EAAS5gC,MAAM,KAAK,IAG/B6gC,EAAQA,EAAM5rB,QAAQ,SAAS,IAAIxJ,mBAEXpM,IAApBqhC,EAAKE,KAA6BF,EAAKE,GAAa,EAAGne,EAAUme,GAAa,IAClFF,EAAKE,KACLne,EAAUme,GAAW5kC,KAAM,CAAC0C,KAAMmiC,EAAOhe,QAAS8d,GACpD,CAEA,IAAS7kC,EAAE,EAAEA,EAAE2kC,EAAK1kC,OAAOD,IAAK,CAC9B,IAAI+kC,EACA93B,EAEA63B,EAGAD,EAAY,CAAC,GAFsBC,OAAhBvhC,IAAhBG,EAHHuJ,GADA83B,EAAQJ,EAAK3kC,IACFmZ,QAAQ,QAAQ,eAGmBzV,EAAOuJ,KACvC,WAGLiM,QAAQ,KAAM,IAER4rB,EAAS5gC,MAAM,KAAMjE,OAEpC4kC,EAAU3d,YAAe4d,EAAS5gC,MAAM,KAAM,GAC9C2gC,EAAU99B,MAAU+9B,EAAS5gC,MAAM,KAAM,GACzC2gC,EAAU7/B,OAAU8/B,EAAS5gC,MAAM,KAAM,GAEzC4gC,EAASA,EAAS5gC,MAAM,KAAK,IAGjC6gC,EAAQA,EAAM5rB,QAAQ,QAAQ,IAAIA,QAAQ,QAAQ,KAAKxJ,cAAgB,UAE/CpM,IAApBqhC,EAAKE,KAA6BF,EAAKE,GAAa,EAAGne,EAAUme,GAAa,IAClFF,EAAKE,KACLne,EAAUme,GAAW5kC,KAAM,CAAC0C,KAAMmiC,EAAOhe,QAAS8d,GACpD,CAIA,MAAO,CAACD,EAAIje,EACd,EA09CF3nB,EAAIQ,IAAI,YAhgUNR,EAAIQ,IAAI,iBAERR,EAAIgmC,UAAY,IA2uQlB,MAECriC,YAAa3D,GAEZ,MAAMimC,EAAe,KAEf9nB,EAAc,KACdI,EAAgB,KAEhBH,EAAgB,KAChBC,EAAiB,KAEvBlc,KAAK8jC,WAAgBA,EACrB9jC,KAAK+jC,gBARmB,KASxB/jC,KAAKgc,UAAkBA,EACvBhc,KAAKoc,cAAkBA,EACvBpc,KAAKmc,YARgB,KASrBnc,KAAKic,cAAkBA,EACvBjc,KAAKkc,eAAmBA,EAExBlc,KAAKnC,IAAMA,EACXmC,KAAK6jC,UAAY,GAEjB,IAAIG,EAAQhkC,KACL6jC,EAAYG,EAAMH,UAEzB7jC,KAAKikC,cAAgB,KACrBjkC,KAAKkkC,YAAc,KACnBlkC,KAAKmkC,YAAc,KAEnB,IAAIC,EAAYN,EACZO,EAAQP,EAEZ9jC,KAAKskC,aAAe,GAEpB,IA4BIC,EAAOC,EAAQC,EAAQC,EAAOzuB,EA5B9B0uB,EAAc,SAAUC,EAAUjlC,GA3BjB,MA6BhBilC,EACHZ,EAAMa,sBAEED,GAAY3oB,GACpB+nB,EAAMa,sBACNb,EAAMc,oBAAqBnlC,IAEnBilC,GAAY1oB,GACpB8nB,EAAMa,sBACNb,EAAMe,qBAENf,EAAMnmC,IAAIqC,iBAAkB,IAEpB0kC,GAAY5oB,GACpBgoB,EAAMa,sBACNb,EAAMe,sBAEEH,GAAYxoB,IACpB4nB,EAAMe,qBACNf,EAAMgB,qBAAsBrlC,IAG7BykC,EAAYC,EACZA,EAAQO,CACT,EAIA5kC,KAAKilC,cAAgB,WACpB,IAAIC,GAAK,IAAI/9B,MAAOC,UAEpB,GAAIi9B,GAASjoB,GAAkBioB,GAASpoB,GAAiBooB,GAASnoB,EAAlE,CAMA,IAAIipB,GAFJlvB,EAAI4tB,EAAU,IAEEt3B,YAChB,GAAI44B,EAAQ,GAAK,CAChB,IAAIC,EAAOnvB,EAAEzJ,YAIb,OAHAw3B,EAAMnmC,IAAIuC,WAAY,EAAGglC,QAEzBT,EAAavoB,EAAe+oB,EAE7B,CAEAZ,EAAQtuB,EAAEwE,QAEVgqB,EAASF,EAAO,GAChBC,EAASD,EAAO,GAChBG,EAAQH,EAAO,GAEXE,IACCW,EAAOnvB,EAAEzJ,YACbw3B,EAAMnmC,IAAIuC,WAAY,EAAGglC,IAGtBZ,GAAUH,GACbM,EAAaH,EAAQE,GAGtB,IACIW,GADK,IAAIl+B,MAAOC,UACR89B,EAEZlB,EAAMM,cAAsC,GAArBN,EAAMM,aAAqBe,GAAM,GA/BxD,CAgCD,EAEArlC,KAAKslC,gBAAkB,WAElBjB,GAASjoB,IAKbmoB,EAAQtuB,EAAEwE,QAEV+pB,EAASD,EAAO,GAChBG,EAAQH,EAAO,GAEXC,GAAUH,GACbM,EAAaH,EAAQE,GAGvB,EAEA1kC,KAAKulC,gBAAkB,WAEtBvB,EAAME,YAAc,KACpBjuB,EAAElL,eACF45B,EAAaP,EAAW,GAEpBC,GAASjoB,GACZ4nB,EAAMsB,iBAER,EAEAtlC,KAAKwlC,MAAQ,SAAUC,GAEtBzB,EAAME,YAAc,KACpBjuB,EAAE1K,gBAEFo5B,EAAaP,EAAW,GAEpBC,GAASjoB,GACZ4nB,EAAMsB,iBAER,EAEAX,EAAa3oB,EACf,CAEC0pB,qBAC2B,MAAtB1lC,KAAKikC,gBAENjkC,KAAKikC,cAAgB0B,YAAa3lC,KAAKilC,cAAe,KAE1D,CAEAD,qBAAsBY,GACrB,GAAwB,MAApB5lC,KAAKkkC,YAAsB,CAG5B,IAAI2B,EAAKtwB,KAAKC,MAAO,IAAO,IAAIowB,GAGhC5lC,KAAKkkC,YAAcyB,YAAa3lC,KAAKslC,gBAAiBO,EACzD,CACD,CAEAhB,sBACyB,MAApB7kC,KAAKkkC,cAEN4B,cAAe9lC,KAAKkkC,aACpBlkC,KAAKkkC,YAAc,KAEvB,CAEAY,oBAAqBiB,GACI,MAApB/lC,KAAKmkC,cAENnkC,KAAKmkC,YAAc6B,WAAYhmC,KAAKulC,gBAAiBQ,EAAGA,GAE5D,CAEAhB,qBACyB,MAApB/kC,KAAKmkC,cAEN8B,aAAcjmC,KAAKmkC,aACnBnkC,KAAKmkC,YAAc,KAEvB,CAEA+B,WACC,OAAOlmC,KAAKmmC,KACb,CAEArlC,IAAK2kC,GACJ,OAAOzlC,KAAK6jC,UAAW4B,EACxB,CAEAW,SAAUC,GAET,IAAIC,EAAQtmC,KAAK6jC,UAAU/kC,OAW3B,OATAkB,KAAK6jC,UAAU9kC,KAAMsnC,GAIrBA,EAAI9mC,UAAY+mC,EAChBD,EAAIvqB,OAAS9b,KAEbA,KAAK0lC,qBAEEY,CACR,CAGAC,UAEC,OAAOvmC,KAAK6jC,UAAW,EACxB,GAp8QgChmC,GAC/BA,EAAI+H,MAAQ,IA6pQd,MAEEpE,YAAa3D,GACXmC,KAAKwmC,SAAW,GAChBxmC,KAAKymC,aAAc,EACnBzmC,KAAKnC,IAAMA,CACb,CAEAiI,WAAY4gC,GACV1mC,KAAK2mC,aAAeD,CACtB,CAEA3gC,eAAgB3E,GAEdpB,KAAKymC,YAAcrlC,EACnBpB,KAAKnC,IAAI6C,UAAWU,EAEtB,CAGAmR,iBAEE,OAAOvS,KAAKymC,WAEd,CAGA/0B,QACE1R,KAAKwmC,SAAW,EAClB,CAEAI,gBAAiBtjC,GAEf,IAAIojC,EAAK1mC,KAAK2mC,aAEI,UAAdrjC,EAAEa,UAKNuiC,EAAiB,aAAG,WAAYpjC,GAE3BtD,KAAKymC,YAINC,EAA0B,sBAAGpjC,GAH7BtD,KAAKwmC,SAASznC,KAAMuE,IAPpBojC,EAAS,MAYf,CAEAvU,SAEE,OADUnyB,KAAKwmC,SAASlK,SAIjB,IACT,GArtQuBz+B,GACvBA,EAAIiG,IAAM,IA4iRZ,MAECtC,YAAa3D,GACZmC,KAAKnC,IAAMA,EACXmC,KAAK6mC,UAAW,EAChB7mC,KAAK2oB,KAAO,GACZ3oB,KAAK6oB,KAAO,GACZ7oB,KAAKqR,EAAI,EACTrR,KAAK8mC,EAAI,EACT9mC,KAAK+mC,QAAS,EAEd/mC,KAAKgnC,IAAK,EACVhnC,KAAKinC,OAAQ,EAEbjnC,KAAK2U,OAAQ,CAAC,EACd3U,KAAKymB,SAAU,EAEfzmB,KAAKknC,UAAY,EACjBlnC,KAAKmnC,UAAY,EAEjBnnC,KAAK2U,OAAOyyB,WAAYpnC,KAAKmnC,UAC7BnnC,KAAK2U,OAAO0yB,SAAWrnC,KAAKknC,UAE5BlnC,KAAKsnC,aAAc,EAEnBtnC,KAAKunC,QAAU,CAAEC,KAAK,EAAOt3B,KAAM,IACnClQ,KAAKynC,WAAY,CAGlB,CAEA7sB,WACI,OAAO5a,KAAKsnC,cAAgBtnC,KAAK+mC,MACnC,CAEFh4B,OAAQ24B,EAAGC,GACV3nC,KAAK4nC,cAAeF,EAAGC,EACxB,CAEA3lC,IAAK0lC,EAAGC,EAAGp4B,GACVvP,KAAK4nC,cAAeF,EAAGC,GACvB3nC,KAAK6nC,cAAet4B,EAErB,CAEAu4B,UACC9nC,KAAK+nC,YAAS3lC,EAEdpC,KAAKunC,QAAU,CAAEC,KAAK,EAAOt3B,KAAM,IACnClQ,KAAKsnC,aAAc,CACpB,CAIAU,oBAEChoC,KAAKunC,QAAQC,KAAM,EACnBxnC,KAAKunC,QAAQr3B,KAAO,EAEpB,CAID4K,cACE,OAAI9a,KAAKunC,QAAQC,IAAe,MACzBxnC,KAAKunC,QAAQr3B,KAAKpR,MAC1B,CAGDmpC,eAAgBC,GAEf,GAAKloC,KAAKunC,QAAQC,IACbxnC,KAAKunC,QAAQr3B,KAAKpR,OAAS,IAC7BkB,KAAKunC,QAAQr3B,KAAO,QAFvB,CAOA,IAAIi4B,EAAQnoC,KAAKunC,QAAQr3B,KACzB,GAAIi4B,EAAMrpC,OAAS,EAAI,CACtB,IAAIspC,EAAKD,EAAOA,EAAMrpC,OAAQ,GAC1BupC,EAAKH,EACT,GAAIE,EAAGE,IAAMF,EAAGG,IAAMF,EAAGC,IAAMD,EAAGE,IAAMH,EAAGE,IAAMD,EAAGC,IAC/CD,EAAGG,IAAMJ,EAAGK,GAAI,EAAI,CACbL,EAAGK,GAGZ,IAHA,IAEIC,EAAqBN,EAAG74B,MAAM,GACzB1Q,EAAE,EAAGA,EAAEqpC,EAAK34B,MAAM,GAAGzQ,OAAQD,IAAK,CAC1C,IAAI8pC,EAAOT,EAAK34B,MAAM,GAAG1Q,GACzB6pC,EAAmB3pC,KAAM4pC,EAC1B,CAEA,YADAP,EAAGK,GAAKJ,EAAGI,GAEb,CAEF,CAEAzoC,KAAKunC,QAAQr3B,KAAKnR,KAAMmpC,EArBxB,CAuBA,CAGDU,gBACC5oC,KAAKunC,QAAQC,KAAM,EACnBxnC,KAAKunC,QAAQr3B,KAAO,GAEpBlQ,KAAK6oC,YACN,CAGAC,aAAcN,EAAIF,EAAIG,EAAIF,GAI1B,IAFA,IAAIh5B,EAAQ,GAEHu3B,EAAEwB,EAAIxB,GAAGyB,EAAIzB,IAAK,CAEzB,IADA,IAAI/Z,EAAM,GACD1b,EAAEm3B,EAAIn3B,GAAGo3B,EAAIp3B,IACrB0b,EAAIhuB,KAAMiB,KAAK+nC,OAAQjB,GAAIz1B,IAE5B9B,EAAMxQ,KAAMguB,EACb,CAWA,MARA,CACExd,MAAOA,EACPi5B,GAAIA,EACJF,GAAIA,EACJG,GAAIA,EACJF,GAAIA,EAKP,CAGCM,aAEK7oC,KAAKunC,QAAQC,KAChBxnC,KAAKnC,IAAII,KAAM,iBACb,CACE4W,GAAI7U,KAAK2U,OAAO0yB,SACjBvyB,GAAI9U,KAAK2U,OAAOyyB,WAChB2B,GAAI/oC,KAAKqR,EACT23B,GAAIhpC,KAAK8mC,EACTv3B,MAAOvP,KAAK+nC,OACZkB,WAAYjpC,KAAKipC,aAGpBjpC,KAAKunC,QAAQC,KAAM,GAIXxnC,KAAKunC,QAAQr3B,KAAKpR,OAAS,GAEnCkB,KAAKnC,IAAII,KAAM,aACd,CACC4W,GAAI7U,KAAK2U,OAAO0yB,SAChBvyB,GAAI9U,KAAK2U,OAAOyyB,WAChB2B,GAAI/oC,KAAKqR,EACT23B,GAAIhpC,KAAK8mC,EACToC,UAAYlpC,KAAKunC,QAAQr3B,KACzB+4B,WAAYjpC,KAAKipC,aAEnBjpC,KAAKunC,QAAQr3B,KAAO,IAGpBlQ,KAAKnC,IAAII,KAAM,aACd,CACC4W,GAAI7U,KAAK2U,OAAO0yB,SAChBvyB,GAAI9U,KAAK2U,OAAOyyB,WAChB2B,GAAI/oC,KAAKqR,EACT23B,GAAIhpC,KAAK8mC,EACToC,UAAY,GACZD,WAAYjpC,KAAKipC,YAKrB,CAEDE,OAAQzB,EAAGC,GACV3nC,KAAK4nC,cAAeF,EAAGC,EACxB,CAEA18B,aAAc7J,GACZpB,KAAKynC,UAAYrmC,CACnB,CAGAouB,MAAOne,EAAGy1B,GAGL,OADO9mC,KAAK+nC,OAAOjB,GAAGz1B,GACVgG,IAAI+xB,YAAY,EAEjC,CAEA/Z,OAAQhe,EAAGy1B,EAAGrmC,GAEb,IAAIkoC,EAAO3oC,KAAK+nC,OAAOjB,GAAGz1B,GAE1B,OAAQ,GAAJ5Q,EACIkoC,EAAK9zB,GAEA,GAAJpU,EACDkoC,EAAK7zB,GAGL6zB,EAAK9zB,GAAM,GAAG8zB,EAAK7zB,EAE5B,CAEA0W,MAAOna,EAAGy1B,EAAIvvB,GAEZ,IACYvX,KAAK+nC,OAAOjB,GAAGz1B,GACrBgG,IAAMX,OAAOoZ,cAAevY,GAEjC,IAAI2wB,EAAOloC,KAAK8oC,aAAcz3B,EAAGy1B,EAAGz1B,EAAGy1B,GACvC9mC,KAAKioC,eAAgBC,GAEjBloC,KAAKynC,WACRznC,KAAK6oC,YAKP,CAFA,MAAOvlC,GACN,KAAM,2BAA6B+N,EAAI,IAAMy1B,EAAI,GAClD,CAEF,CAEAnb,OAAQta,EAAGy1B,EAAIjyB,EAAIC,GAEjB,IACC,IAAI6zB,EAAO3oC,KAAK+nC,OAAOjB,GAAGz1B,QACbjP,IAAPyS,IACL8zB,EAAK9zB,GAAKA,QAEEzS,IAAP0S,IACL6zB,EAAK7zB,GAAKA,GAEX,IAAIozB,EAAOloC,KAAK8oC,aAAcz3B,EAAGy1B,EAAGz1B,EAAGy1B,GACvC9mC,KAAKioC,eAAgBC,GAEjBloC,KAAKynC,WACRznC,KAAK6oC,YAMP,CAFA,MAAOvlC,GACN,KAAM,2BAA6B+N,EAAI,IAAMy1B,EAAI,GAClD,CACF,CAGAzb,QAASha,EAAGy1B,EAAIvvB,EAAG1C,EAAIC,GAEtB,IACE,IAAI6zB,EAAO3oC,KAAK+nC,OAAOjB,GAAGz1B,GAE1Bs3B,EAAKtxB,IAAMX,OAAOoZ,cAAevY,QACpBnV,IAAPyS,IACL8zB,EAAK9zB,GAAKA,QAEEzS,IAAP0S,IACL6zB,EAAK7zB,GAAKA,GAGX,IAAIozB,EAAOloC,KAAK8oC,aAAcz3B,EAAGy1B,EAAGz1B,EAAGy1B,GACvC9mC,KAAKioC,eAAgBC,GAEjBloC,KAAKynC,WACRznC,KAAK6oC,YAMR,CAFA,MAAOvlC,GACL,KAAM,2BAA6B+N,EAAI,IAAMy1B,EAAI,GACnD,CACD,CAGAjsB,eAEC7a,KAAK6oC,YACN,CAGAjB,cAAeF,EAAGC,GAEb3nC,KAAKsnC,aACPtnC,KAAK8nC,UAEG9nC,KAAKnC,IAEfmC,KAAKqR,EAAI,EACTrR,KAAK8mC,EAAI,EAET9mC,KAAK6oB,KAAO8e,EACZ3nC,KAAK2oB,KAAO+e,EAEZ1nC,KAAKmpB,SAAUnpB,KAAK2oB,KAAM3oB,KAAK6oB,MAAO,GAAI,GAC1C7oB,KAAK2U,OAAOyyB,WAAYpnC,KAAKmnC,UAC7BnnC,KAAK2U,OAAO0yB,SAAWrnC,KAAKknC,UAE5BlnC,KAAK+nC,OAAS,GACd,IAAK,IAAIjB,EAAE,EAAGA,EAAE9mC,KAAK6oB,KAAMie,IAAK,CAE/B,IADA,IAAIuC,EAAW,GACNh4B,EAAE,EAAGA,EAAErR,KAAK2oB,KAAMtX,IAAK,CAC9B,IAAIs3B,EAAO,CACVtxB,IAAK,IACLxC,GAAI7U,KAAK2U,OAAO0yB,SAChBvyB,GAAI9U,KAAK2U,OAAOyyB,YAEjBiC,EAAStqC,KAAM4pC,EAChB,CACA3oC,KAAK+nC,OAAOhpC,KAAMsqC,EACpB,CAEArpC,KAAKunC,QAAU,CAAEC,KAAK,EAAMt3B,KAAM,IAGlClQ,KAAK4oC,gBAEL5oC,KAAKnC,IAAIQ,IAAI,qBAEb2B,KAAKsnC,aAAc,EACnBtnC,KAAKynC,WAAY,CAGlB,CAEAI,cAAeyB,GAEdtpC,KAAK+nC,OAAS,GACd,IAAK,IAAIjB,EAAE,EAAGA,EAAE9mC,KAAK6oB,KAAMie,IAAK,CAE9B,IADA,IAAIuC,EAAW,GACNh4B,EAAE,EAAGA,EAAErR,KAAK2oB,KAAMtX,IAAK,CAC/B,IAAIs3B,EAAO,CACVtxB,IAAKiyB,EAAUxC,GAAKz1B,GAAIgG,IACxBxC,GAAKy0B,EAAUxC,GAAKz1B,GAAIwD,GACxBC,GAAKw0B,EAAUxC,GAAKz1B,GAAIyD,IAEzBu0B,EAAStqC,KAAM4pC,EAChB,CACA3oC,KAAK+nC,OAAOhpC,KAAMsqC,EACnB,CAEDrpC,KAAKunC,QAAU,CAAEC,KAAK,EAAOt3B,KAAM,GACpC,CAGA+E,gBACE,MAAO,CAACjV,KAAK2oB,KAAM3oB,KAAK6oB,KAC1B,CAEA7jB,iBAGC,IAFA,IAAI8hC,EAAI9mC,KAAK8mC,EACTt2B,EAAM,GACD3R,EAAI,EAAGA,EAAGmB,KAAKupC,MAAO1qC,IAAK,CACnC,IAAI2qC,EAAK3qC,EAAImB,KAAKypC,IAClBj5B,GAAOxQ,KAAK+nC,OAAQjB,GAAK0C,GAAKnyB,GAC/B,CACA,OAAO7G,CACR,CAEAU,YAAa0lB,EAAIkQ,GAKhB,IAHA,IAAIt2B,EAAM,GACNi4B,EAAKzoC,KAAKupC,MAAQvpC,KAAKypC,IAAM,EAExB5qC,EAAI+3B,EAAI/3B,EAAG4pC,EAAI5pC,IACvB2R,GAAOxQ,KAAK+nC,OAAQ/nC,KAAK0pC,IAAM5C,GAAKjoC,GAAIwY,IAEzC,OAAO7G,CACR,CAKAoE,WAAYC,EAAIC,GACf9U,KAAKmnC,UAAYryB,EACjB9U,KAAKknC,UAAYryB,CAElB,CAGAH,aAEC1U,KAAK2U,OAAOyyB,WAAYpnC,KAAKmnC,UAC7BnnC,KAAK2U,OAAO0yB,SAAWrnC,KAAKknC,UAM5B,IAHA,IAAIryB,EAAK7U,KAAKknC,UACVpyB,EAAK9U,KAAKmnC,UAELwC,EAAG,EAAGA,EAAG3pC,KAAK6oB,KAAM8gB,IAI5B,IADA,IAAI7C,EAAI6C,EACCC,EAAG,EAAGA,EAAG5pC,KAAK2oB,KAAMihB,IAAM,CAElC,IAAIv4B,EAAIu4B,EAEJjB,EAAO3oC,KAAK+nC,OAAQjB,GAAKz1B,GAE7Bs3B,EAAK9zB,GAAKA,EACV8zB,EAAK7zB,GAAKA,CACX,CAID9U,KAAKunC,QAAU,CAAEC,KAAK,EAAMt3B,KAAM,IAElClQ,KAAK4oC,eACN,CAEA1zB,QACClV,KAAKmpB,SAAUnpB,KAAK2oB,KAAM3oB,KAAK6oB,MAAO,GAAI,GAE1C7oB,KAAK2U,OAAOyyB,WAAYpnC,KAAKmnC,UAC7BnnC,KAAK2U,OAAO0yB,SAAWrnC,KAAKknC,UAE5BlnC,KAAKynC,WAAY,EACjBznC,KAAK0E,OAEN,CAEAykB,SAAUue,EAAGC,EAAG5e,EAAIC,GACnB,IAAIC,EAAOjpB,KAAK2oB,KAAO+e,EACnBxe,EAAOlpB,KAAK6oB,KAAO8e,EAGrB3nC,KAAKypC,IADH1gB,EAAK,EACIxT,KAAKC,MAAMyT,EAAO,GAGnBF,EAIV/oB,KAAK0pC,IADH1gB,EAAK,EACIzT,KAAKC,MAAM0T,EAAO,GAGnBF,EAGZhpB,KAAKupC,MAAQ7B,EACb1nC,KAAK6pC,MAAQlC,EACb3nC,KAAKqR,EAAIrR,KAAKypC,IACdzpC,KAAK8mC,EAAI9mC,KAAK0pC,GACf,CAEAhlC,QAGC,IAAK,IAAIilC,EAAG,EAAGA,EAAG3pC,KAAK6pC,MAAOF,IAI7B,IADA,IAAI7C,EAAI9mC,KAAK0pC,IAAMC,EACVC,EAAG,EAAGA,EAAG5pC,KAAKupC,MAAOK,IAAM,CAEnC,IAAIv4B,EAAIrR,KAAKypC,IAAMG,EAEfjB,EAAO,CACVtxB,IAAK,IACLxC,GAAI7U,KAAK2U,OAAO0yB,SAChBvyB,GAAI9U,KAAK2U,OAAOyyB,YAEjBpnC,KAAK+nC,OAAQjB,GAAKz1B,GAAKs3B,CACxB,CAID3oC,KAAKunC,QAAU,CAAEC,KAAK,EAAMt3B,KAAM,IAElClQ,KAAKqR,EAAIrR,KAAKypC,IACdzpC,KAAK8mC,EAAI9mC,KAAK0pC,IAEd1pC,KAAK4oC,eACN,CAGAnkC,OAAQvD,GAKP,GAJmB,QAAfA,IACHlB,KAAK8mC,EAAI9mC,KAAK0pC,IACd1pC,KAAKqR,EAAIrR,KAAKypC,KAEI,OAAfvoC,EACHlB,KAAK8mC,EAAI9mC,KAAK0pC,IAAM1pC,KAAK6pC,MAAQ,EACjC7pC,KAAKqR,EAAIrR,KAAKypC,IAAMzpC,KAAKupC,MAAQ,OAE7B,GAAmB,cAAfroC,EACRlB,KAAKqR,EAAIrR,KAAKypC,SAEV,GAAmB,YAAfvoC,EACRlB,KAAKqR,EAAIrR,KAAKypC,IAAMzpC,KAAKupC,MAAQ,OAE7B,GAAmB,YAAfroC,EAA4B,CAGpC,IAAIqW,EAAI,KACJuyB,EAAO9pC,KAAKqR,EAChBrR,KAAKqR,EAAMrR,KAAKypC,IAAMzpC,KAAKupC,MAAO,EAGlC,IAFA,IAAIxP,EAAQ/5B,KAAKypC,IAAMzpC,KAAKupC,MAAO,EAE5BvpC,KAAKqR,GAAKrR,KAAKypC,KAAM,CAEzB,GAAS,MADTlyB,EAAIvX,KAAK+nC,OAAQ/nC,KAAK8mC,GAAK9mC,KAAKqR,GAAIgG,KACrB,CACdrX,KAAKqR,IACDrR,KAAKqR,EAAI0oB,IACZ/5B,KAAKqR,EAAI0oB,GAEV,KACD,CACA/5B,KAAKqR,GACR,CAEA,IAAI04B,EAAO/pC,KAAKqR,EAIhB,IAFArR,KAAKqR,EAAIy4B,EACLvyB,EAAI,KACDvX,KAAKqR,EAAKrR,KAAKypC,IAAMzpC,KAAKupC,MAAO,GAAW,KAALhyB,GAC3CvX,KAAKqR,IACLkG,EAAIvX,KAAK+nC,OAAQ/nC,KAAK8mC,GAAK9mC,KAAKqR,GAAIgG,IAKnCrX,KAAKqR,EAAI04B,IACZ/pC,KAAKqR,EAAI04B,EAEX,MACK,GAAmB,gBAAf7oC,EAKR,IAJIqW,EAAI,KACRvX,KAAKqR,EAAMrR,KAAKypC,IAAMzpC,KAAKupC,MAAO,EAC9BxP,EAAQ/5B,KAAKypC,IAAMzpC,KAAKupC,MAAO,EAE5BvpC,KAAKqR,GAAKrR,KAAKypC,KAAM,CAEzB,GAAS,MADTlyB,EAAIvX,KAAK+nC,OAAQ/nC,KAAK8mC,GAAK9mC,KAAKqR,GAAIgG,KACrB,CACdrX,KAAKqR,IACDrR,KAAKqR,EAAI0oB,IACZ/5B,KAAKqR,EAAI0oB,GAEV,KACD,CACA/5B,KAAKqR,GACR,MAEI,GAAmB,cAAfnQ,EAER,IADIqW,EAAI,KACDvX,KAAKqR,EAAGrR,KAAKypC,KAAY,KAALlyB,GACxBvX,KAAKqR,IACLkG,EAAIvX,KAAK+nC,OAAQ/nC,KAAK8mC,GAAK9mC,KAAKqR,GAAIgG,IAIxCrX,KAAK6oC,YACN,CAEArkC,WAAY3E,GACA,MAAPA,EACCG,KAAK8mC,EAAE9mC,KAAK0pC,KACf1pC,KAAK8mC,IAGS,QAAPjnC,IACJG,KAAK8mC,EAAK9mC,KAAK0pC,IAAM1pC,KAAK6pC,MAAO,EACpC7pC,KAAK8mC,IAEG9mC,KAAK8mC,GAAM9mC,KAAK0pC,IAAM1pC,KAAK6pC,MAAO,IAC1C7pC,KAAKgqC,mBACLhqC,KAAKgoC,sBAGI,QAAPnoC,EACCG,KAAKqR,EAAErR,KAAKypC,KACfzpC,KAAKqR,IAGS,SAAPxR,GACJG,KAAKqR,EAAKrR,KAAKypC,IAAMzpC,KAAKupC,MAAO,GACpCvpC,KAAKqR,IAGPrR,KAAK6oC,YACN,CAEAvkC,YACKtE,KAAKqR,GAAKrR,KAAKypC,KACjBzpC,KAAKqR,IAGPrR,KAAKiqC,yBAA0BjqC,KAAKqR,EAAGrR,KAAK8mC,GAE5C,IAAIoB,EAAOloC,KAAK8oC,aAAc9oC,KAAKqR,EAAGrR,KAAK8mC,EAAG9mC,KAAK2oB,KAAK,EAAG3oB,KAAK8mC,GAChE9mC,KAAKioC,eAAgBC,GACrBloC,KAAK6oC,YACN,CAEAjpC,SAECI,KAAKiqC,yBAA0BjqC,KAAKqR,EAAGrR,KAAK8mC,GAE5C,IAAIoB,EAAOloC,KAAK8oC,aAAc9oC,KAAKqR,EAAGrR,KAAK8mC,EAAG9mC,KAAK2oB,KAAK,EAAG3oB,KAAK8mC,GAChE9mC,KAAKioC,eAAgBC,GACrBloC,KAAK6oC,YACN,CAEAx9B,KAME,GAJArL,KAAKqR,EAAIrR,KAAKypC,IACdzpC,KAAK8mC,IACI9mC,KAAK8mC,EAAI9mC,KAAK0pC,KAEb1pC,KAAK6pC,MAMd,OAJA7pC,KAAKgqC,mBACLhqC,KAAK8mC,EAAI9mC,KAAK0pC,KAAO1pC,KAAK6pC,MAAO,QAEjC7pC,KAAK4oC,gBAIN5oC,KAAK6oC,YAEP,CAEAqB,WAIE,OAHAlqC,KAAKqR,EAAIrR,KAAKypC,IACdzpC,KAAK8mC,IACI9mC,KAAK8mC,EAAI9mC,KAAK0pC,KACb1pC,KAAK6pC,OACd7pC,KAAKgqC,mBACLhqC,KAAK8mC,EAAI9mC,KAAK0pC,KAAO1pC,KAAK6pC,MAAO,GAC1B,CAAEjhC,QAAQ,IAEX,CAAEA,QAAQ,EAEnB,CAEA3D,QAASuL,GAEP,IAAK,IAAI3R,EAAE,EAAGA,EAAE2R,EAAI1R,OAAQD,IAAK,CAChC,IAAI0Y,EAAI/G,EAAInN,OAAOxE,EAAE,GACrBmB,KAAKmqC,sBAAuB5yB,EAC7B,CACWvX,KAAKkqC,WACPthC,QACP5I,KAAKgoC,oBAEPhoC,KAAK6oC,YACP,CAEAuB,WAAY55B,EAAK7L,GAChB,IAAK,MAAM4S,KAAK/G,EACfxQ,KAAKmqC,sBAAuB5yB,EAAG5S,EAEjC,CAEAC,MAAO4L,GACLxQ,KAAKoqC,WAAY55B,GAEjBxQ,KAAK6oC,YACP,CAGAlkC,OAAQ6L,GACNxQ,KAAKoqC,WAAY55B,GAAK,GAEtBxQ,KAAK6oC,YACP,CAKAwB,0BAA2BvD,GAEzB,IAAK,IAAIwD,EAAGtqC,KAAK6oB,KAAK,EAAGyhB,EAAGxD,EAAGwD,IAC9B,IAAK,IAAIC,EAAG,EAAGA,EAAGvqC,KAAK2oB,KAAM4hB,IAAO,CAEnC,IAAIC,EAAQxqC,KAAK+nC,OAAQuC,EAAG,GAAMC,GAC9BE,EAAQzqC,KAAK+nC,OAAQuC,GAASC,GAElCE,EAAM51B,GAAK21B,EAAM31B,GACjB41B,EAAM31B,GAAK01B,EAAM11B,GACjB21B,EAAMpzB,IAAMmzB,EAAMnzB,GAEnB,CAGD,IAASkzB,EAAG,EAAGA,EAAGvqC,KAAK2oB,KAAM4hB,KAExBC,EAAQxqC,KAAK+nC,OAAQuC,GAAOC,IAE1BlzB,IAAM,IAIbrX,KAAKgoC,mBAEP,CAGA3jC,0BAEMrE,KAAO,EAAKA,KAAK6oB,KAAK,IAC1B7oB,KAAKqqC,0BAA2BrqC,KAAK8mC,GACrC9mC,KAAK6oC,aAEP,CAEA6B,0BAA2B9T,EAAIkQ,GAE9B,IACI0B,EAAKxoC,KAAKypC,IAAMzpC,KAAKupC,MAAQ,EAEjC,GAAI3S,GAAM4R,EAIV,IAAK,IAAI3pC,EAAE2pC,EAAI3pC,EAAE+3B,EAAI/3B,IAAK,CACzB,IAAI2rC,EAAQxqC,KAAK+nC,OAAQjB,GAAMjoC,EAAE,GAC7B4rC,EAAQzqC,KAAK+nC,OAAQjB,GAAMjoC,GAE/B4rC,EAAM51B,GAAK21B,EAAM31B,GACjB41B,EAAM31B,GAAK01B,EAAM11B,GACjB21B,EAAMpzB,IAAMmzB,EAAMnzB,GACnB,CACD,CAEA4yB,yBAA0BrT,EAAIkQ,GAE7B,IACI0B,EAAKxoC,KAAKypC,IAAMzpC,KAAKupC,MAAQ,EAEjC,GAAI3S,GAAM4R,EAIV,IAAK,IAAI3pC,EAAE+3B,EAAI/3B,EAAE2pC,EAAI3pC,IAAK,CACzB,IAAI2rC,EAAQxqC,KAAK+nC,OAAQjB,GAAMjoC,EAAG,GAC9B4rC,EAAQzqC,KAAK+nC,OAAQjB,GAAMjoC,GAE/B4rC,EAAM51B,GAAK21B,EAAM31B,GACjB41B,EAAM31B,GAAK01B,EAAM11B,GACjB21B,EAAMpzB,IAAMmzB,EAAMnzB,GACnB,CAGD,CAEA8yB,sBAAuBhT,EAAIxyB,GAE1B,IAAI1D,EAAOk2B,EAAGiS,YAAY,GAE1B,GAAIppC,KAAKgnC,IAAMhnC,KAAKinC,MAMnB,OAJAjnC,KAAKgnC,IAAK,EACVhnC,KAAKinC,OAAQ,OACbjnC,KAAK2qC,aAAc3qC,KAAK4qC,UAAW3pC,GAKpC,GAAIjB,KAAKgnC,KAAOhnC,KAAKinC,MAGpB,OAFAjnC,KAAKinC,OAAQ,OACbjnC,KAAK4qC,UAAY3pC,GAIlB,GAAY,IAARA,EAIH,OAFAjB,KAAKgnC,IAAK,OACVhnC,KAAKinC,OAAQ,GAId,IAAI0B,EAAO3oC,KAAK+nC,OAAQ/nC,KAAK8mC,GAAK9mC,KAAKqR,GAEvC,GAAY,MAARs3B,EAAJ,CAKA,IAAIT,EAEAvjC,IACH3E,KAAK0qC,0BAA2B1qC,KAAKqR,EAAGrR,KAAK8mC,GAE7CoB,EAAOloC,KAAK8oC,aAAc9oC,KAAKqR,EAAGrR,KAAK8mC,EAAG9mC,KAAKypC,IAAMzpC,KAAKupC,MAAM,EAAGvpC,KAAK8mC,GACxE9mC,KAAKioC,eAAgBC,IAItBS,EAAKtxB,IAAM8f,EAENn3B,KAAKymB,SAKTkiB,EAAK7zB,GAAK9U,KAAK2U,OAAO0yB,SACtBsB,EAAK9zB,GAAK7U,KAAK2U,OAAOyyB,aALtBuB,EAAK9zB,GAAK7U,KAAK2U,OAAO0yB,SACtBsB,EAAK7zB,GAAK9U,KAAK2U,OAAOyyB,YAOvB,IAAI0C,EAAO9pC,KAAKqR,EACZw5B,EAAO7qC,KAAK8mC,EAIhB,GAFA9mC,KAAKqR,IACIrR,KAAKqR,EAAIrR,KAAKypC,IACbzpC,KAAKupC,MAAM,IACpBvpC,KAAKqR,EAAIrR,KAAKypC,IACHzpC,KAAKkqC,WACPthC,QAER,YADA5I,KAAKgoC,oBAKPE,EAAOloC,KAAK8oC,aAAcgB,EAAMe,EAAMf,EAAMe,GAC5C7qC,KAAKioC,eAAgBC,EAtCrB,MAFClqC,QAAQK,IAAK,WAAa2B,KAAKqR,EAAI,IAAMrR,KAAK8mC,EAAG,YA2CnD,CAEAgE,OAAQC,GAEI,MAAPA,GAQJ/qC,KAAKmqC,sBAAuBY,GAC5B/qC,KAAK6oC,cARO7oC,KAAKkqC,WACPthC,QACP5I,KAAKgoC,mBAOT,CAGAvZ,UAAWuc,GACVhrC,KAAKnC,IAAII,KAAM,UAAW,CAAE84B,EAAGiU,GAChC,CAEAL,aAAcI,EAAKprC,GAEP,IAAPorC,EACH/qC,KAAK2U,OAAO0yB,SAAW1nC,EAER,IAAPorC,EACR/qC,KAAK2U,OAAOyyB,WAAaznC,EAEV,IAAPorC,EACR/qC,KAAKnC,IAAII,KAAM,SAAU,CAAE84B,EAAGp3B,IAEf,IAAPorC,EACR/qC,KAAK0E,QAEU,IAAPqmC,EACR/qC,KAAKkV,QAEU,IAAP61B,IAGO,IAAPA,EACR/qC,KAAKymB,SAAU,EAEA,IAAPskB,EACR/qC,KAAKymB,SAAU,EAGfzmB,KAAKmqC,sBAAuB,KAE9B,CAGAh1B,OAAQ9D,EAAGy1B,GAEV9mC,KAAKirC,YAAa55B,EAAEy1B,GAEpB9mC,KAAK6oC,YACN,CAEAhkC,cAAeuK,GACdpP,KAAKipC,WAAa75B,EAClBpP,KAAK6oC,YACN,CAEAt3B,aAAcF,EAAGy1B,GAChB,GAAIz1B,EAAE,GAAKy1B,EAAE,EAAM,KAAM,OAAOz1B,EAAE,IAAIy1B,EAAE,QAExC,GAAIz1B,GAAGrR,KAAKupC,OAASzC,GAAI9mC,KAAK6pC,MAAU,KAAM,OAAOx4B,EAAE,IAAIy1B,EAAE,eAE/C1kC,IAANiP,IAAsBrR,KAAKqR,EAAIA,EAAIrR,KAAKypC,UAClCrnC,IAAN0kC,IAAsB9mC,KAAK8mC,EAAIA,EAAI9mC,KAAK0pC,KAGhD1pC,KAAK6oC,YACN,CAEA73B,eACE,MAAO,CAAChR,KAAKqR,EAAIrR,KAAKypC,IAAKzpC,KAAK8mC,EAAI9mC,KAAK0pC,IAC3C,CAEA75B,QAASk7B,EAAKprC,GAEbK,KAAK2qC,aAAcI,EAAKprC,GACxBK,KAAK6oC,YAEN,CAGAoC,YAAa55B,EAAGy1B,GAEZz1B,GAAK,IACNrR,KAAKqR,EAAIA,EAAIrR,KAAKypC,IACbzpC,KAAKqR,EAAIrR,KAAKypC,KAAQzpC,KAAKupC,QAAUvpC,KAAKqR,EAAIrR,KAAKupC,MAAM,IAE7DzC,GAAK,IACN9mC,KAAK8mC,EAAIA,EAAI9mC,KAAK0pC,IACb1pC,KAAK8mC,EAAI9mC,KAAK0pC,KAAO1pC,KAAK6pC,QAAU7pC,KAAK8mC,EAAI9mC,KAAK6pC,MAAM,GAKhE,CAEA9e,OAAQva,EAAK06B,GAEX,KAAI16B,EAAI1R,OAASkB,KAAK2oB,MAAtB,CAIA,IACIwiB,EADI36B,EAAI1R,OACD,EAEPgqB,EAAK,CAAE9oB,KAAKupC,MAAOvpC,KAAK6pC,OAExBx4B,EAAIkE,KAAKC,MAAQsT,EAAG,GAAK,EAAGqiB,GAIhC,GAHAnrC,KAAKirC,YAAa55B,GAAI,GACtBrR,KAAKoqC,WAAY55B,IAEZ06B,GAEOlrC,KAAKkqC,WACPthC,OAEP,YADA5I,KAAKgoC,oBAMR,IAAIE,EAAOloC,KAAK8oC,aAAc9oC,KAAKypC,IAAKzpC,KAAK8mC,EAAG9mC,KAAKupC,MAAM,EAAGvpC,KAAK8mC,GACnE9mC,KAAKioC,eAAgBC,GACrBloC,KAAK6oC,YAvBL,CAyBF,CAEAmB,mBAKC,IAHA,IAAIP,EAAMzpC,KAAKypC,IACXC,EAAM1pC,KAAK0pC,IAENE,EAAG,EAAGA,EAAG5pC,KAAKupC,MAAOK,IAG7B,IADA,IAAIv4B,EAAIu4B,EAAKH,EACJE,EAAG,EAAGA,EAAG3pC,KAAK6pC,MAAM,EAAGF,IAAM,CAErC,IAAI7C,EAAI6C,EAAKD,EAETf,EAAO3oC,KAAK+nC,OAAQjB,GAAKz1B,GACzB+5B,EAAUprC,KAAK+nC,OAAQjB,EAAE,GAAKz1B,GAElCs3B,EAAKtxB,IAAM+zB,EAAQ/zB,IACnBsxB,EAAK9zB,GAAKu2B,EAAQv2B,GAClB8zB,EAAK7zB,GAAKs2B,EAAQt2B,EACnB,CAID,IAAIyzB,EAAKmB,GAAO1pC,KAAK6pC,MAAM,GAC3B,IAASD,EAAG,EAAGA,EAAG5pC,KAAKupC,MAAOK,IAEzBv4B,EAAIu4B,EAAKH,GAETd,EAAO3oC,KAAK+nC,OAAQQ,GAAMl3B,IACzBgG,IAAM,IACNrX,KAAKymB,SAKTkiB,EAAK9zB,GAAK7U,KAAK2U,OAAOyyB,WACtBuB,EAAK7zB,GAAK9U,KAAK2U,OAAO0yB,WALtBsB,EAAK9zB,GAAK7U,KAAK2U,OAAO0yB,SACtBsB,EAAK7zB,GAAK9U,KAAK2U,OAAOyyB,WAQzB,GAlhTyBvpC,GACxBA,EAAI4H,KAAO,IAgqTb,MAECjE,YAAa3D,GACZmC,KAAKnC,IAAMA,EACTmC,KAAKqrC,UAAY,EACjBrrC,KAAKunC,QAAU,CAAC,EAChBvnC,KAAKunC,QAAQnmC,MAAO,EACpBpB,KAAKunC,QAAQ+D,OAAS,GAExBtrC,KAAK6pB,OAAQ,EAAE,EAAE,EAAE,EACnB,CAGDA,OAAQ0hB,EAAKC,EAAKC,EAAKC,GACtB1rC,KAAKurC,IAAMA,EACXvrC,KAAKwrC,IAAMA,EACXxrC,KAAKyrC,IAAMA,EACXzrC,KAAK0rC,IAAMA,EAEX,IAAI7rC,EAAM,CAAC,SAAIuC,EAAU,KAGrBupC,EAFO,IAAM9rC,EAAK4rC,EAAM,GACjB,IAAM5rC,EAAK6rC,EAAM,GAG5B1rC,KAAqB,eAAIA,KAAK4rC,eAAgBD,EAE/C,CAEA58B,OAAQ24B,EAAGC,GACV3nC,KAAK6rC,MAAQnE,EACX1nC,KAAK8rC,OAASnE,CACjB,CAECwB,OAAQzB,EAAGC,GACX3nC,KAAK+O,OAAQ24B,EAAGC,EACjB,CAEC/sB,WACE,OAAO5a,KAAK6rC,MAAQ,CACtB,CAEA52B,gBACC,MAAO,CAACjV,KAAK6rC,MAAO7rC,KAAK8rC,OAC3B,CAECjxB,eAEK7a,KAAKunC,QAAQnmC,OAIlBpB,KAAKnC,IAAII,KAAM,YACd,CACCqtC,OAAQtrC,KAAKunC,QAAQ+D,SAIvBtrC,KAAKunC,QAAQ+D,OAAS,GACtBtrC,KAAKunC,QAAQnmC,MAAO,EAEpB,CAEAynC,aAEM7oC,KAAKunC,QAAQnmC,OAEfpB,KAAKnC,IAAII,KAAM,YACb,CACEqtC,OAAQtrC,KAAKunC,QAAQ+D,SAI5BtrC,KAAKunC,QAAQ+D,OAAS,GACtBtrC,KAAKunC,QAAQnmC,MAAO,EAGrB,CAEDmoB,aAAchS,GACXvX,KAAKqrC,UAAY9zB,EACjBvX,KAAKnC,IAAII,KAAM,YAAY,CACzB8tC,OAAQ,SACRvyB,OAAQ,CAAEjC,EAAGA,IAEjB,CAGDmS,aAAcnS,GACXvX,KAAKgsC,UAAYz0B,EACjBvX,KAAKnC,IAAII,KAAM,YAAY,CACzB8tC,OAAQ,SACRvyB,OAAQ,CAAEjC,EAAGA,IAEjB,CAEDq0B,eAAgBD,GACf,IAAIM,EAASjsC,KACb,MAAiB,QAAb2rC,EACI,SAAUt6B,EAAEy1B,GAClB,MAAO,CAAEvxB,KAAKC,MAAMnE,EAAI46B,EAAOV,KAAMh2B,KAAKC,MAAMsxB,EAAImF,EAAOT,KAC5D,EAEqB,QAAbG,EACD,SAAUt6B,EAAEy1B,GAClB,MAAO,CAAEvxB,KAAKC,MAAMnE,EAAIrR,KAAKurC,KAAMh2B,KAAKC,MAAOxV,KAAKwrC,IAAM1E,GAC3D,EAEqB,QAAb6E,EACD,SAAUt6B,EAAEy1B,GAClB,MAAO,CAAEvxB,KAAKC,MAAOy2B,EAAOV,IAAMl6B,GAAKkE,KAAKC,MAAMsxB,EAAImF,EAAOT,KAC9D,EAEqB,QAAbG,EACD,SAAUt6B,EAAEy1B,GAClB,MAAO,CAAEvxB,KAAKC,MAAOy2B,EAAOV,IAAMl6B,GAAKkE,KAAKC,MAAOxV,KAAKwrC,IAAM1E,GAC/D,OAHI,CAKN,CAoBCzc,KAAMhZ,EAAGy1B,GACT,IAAIoF,EAAMlsC,KAAKmsC,eAAgB96B,EAAGy1B,GAE5BsF,EAAQ,CAAE/6B,EAAG66B,EAAI,GAAIpF,EAAGoF,EAAI,GAAI30B,EAAEvX,KAAKqrC,WAE3CrrC,KAAKunC,QAAQ+D,OAAOvsC,KAAMqtC,GAC1BpsC,KAAKunC,QAAQnmC,MAAO,CAEtB,CAEDyM,KAAM+oB,EAAGyV,EAAI7D,EAAIF,GAEhB,IAAIgE,EAAMtsC,KAAKmsC,eAAgBvV,EAAIyV,GAC/BE,EAAMvsC,KAAKmsC,eAAgB3D,EAAIF,GAEjCtoC,KAAKnC,IAAII,KAAM,YAAY,CACzB8tC,OAAQ,OACRvyB,OAAQ,CAAEod,GAAG0V,EAAI,GAAID,GAAGC,EAAI,GAAI9D,GAAG+D,EAAI,GAAIjE,GAAGiE,EAAI,KAEtD,CAEAriB,SAAU7Y,EAAEy1B,EAAGY,EAAGC,GAElB,IAAIr2B,EAAKtR,KAAKmsC,eAAgB96B,EAAGy1B,GAG/B9mC,KAAKnC,IAAII,KAAM,YAAY,CACzB8tC,OAAQ,WACRvyB,OAAQ,CAAEnI,EAAEC,EAAG,GAAIw1B,EAAEx1B,EAAG,GAAIo2B,EAAEA,EAAGC,MAErC,CAEDG,UAEA,GA30TwBjqC,GACvBA,EAAI8H,QAAU,IA0hThB,MAECnE,YAAa3D,GACZmC,KAAKnC,IAAMA,EAEXmC,KAAKwsC,QAAU,EACfxsC,KAAKysC,aAAc,EACnBzsC,KAAKkQ,KAAO,IACX,CAEAb,OAAQjO,GACPpB,KAAKysC,YAAcrrC,CACpB,CAEAY,IAAKkO,GACJlQ,KAAKkQ,KAAOA,CACb,CAEAmS,UACC,OAAOriB,KAAKysC,WACb,CAEA7f,UAAW8f,EAAK1qB,EAAI5gB,GACrBpB,KAAKnC,IAAII,KAAM,WACd,CACCsB,UAAWmtC,EACX1qB,GAAIA,EACJ5gB,KAAMA,GAEP,CAGF+qB,OAAQugB,EAAK1qB,GACZ,GAAIA,GAAMhiB,KAAKkQ,KAAKpR,OACnB,KAAM,qBAAuBkjB,EAG9B,GAAuB,MAAnBhiB,KAAKkQ,KAAM8R,GACd,KAAM,uBAGPhiB,KAAKnC,IAAII,KAAM,WACd,CACCsB,UAAWmtC,EACX1qB,GAAIA,IAGNhiB,KAAKwsC,QAAUxqB,CAChB,CAGAsK,UAAWogB,EAAK1qB,EAAI3Q,EAAGy1B,GACtB,GAAI9kB,GAAMhiB,KAAKkQ,KAAKpR,OACnB,KAAM,qBAAuBkjB,EAG9B,GAAuB,MAAnBhiB,KAAKkQ,KAAM8R,GACd,KAAM,uBAGPhiB,KAAKnC,IAAII,KAAM,cACd,CACCsB,UAAWmtC,EACX1qB,GAAIA,EACJ3Q,EAAGA,EACHy1B,EAAGA,GAGN,CAGAra,WAAYigB,EAAK1qB,EAAI3Q,EAAGy1B,EAAGY,EAAGC,GAC7B,GAAI3lB,GAAMhiB,KAAKkQ,KAAKpR,OACnB,KAAM,qBAAuBkjB,EAG9B,GAAuB,MAAnBhiB,KAAKkQ,KAAM8R,GACd,KAAM,uBAGPhiB,KAAKnC,IAAII,KAAM,aACd,CACCsB,UAAWmtC,EACX1qB,GAAIA,EACJ3Q,EAAGA,EACHy1B,EAAGA,EACHY,EAAGA,EACHC,EAAGA,GAGN,CAEAxxB,KAAMu2B,EAAKC,EAAMC,EAAMC,GAKtB7sC,KAAKnC,IAAII,KAAM,SACd,CACCsB,UAAWmtC,EACX1qB,GAAI2qB,EACJC,KAAMA,EAAMC,KAAMA,EAClBC,QAAS,EAAGC,QAAS,GAExB,CAEAC,SAAUN,EAAKC,EAAM5jB,EAAIC,EAAIikB,EAAKC,EAAKN,EAAMC,GAM5C7sC,KAAKnC,IAAII,KAAM,SACd,CACCsB,UAAWmtC,EACX1qB,GAAI2qB,EACJQ,YAAantC,KAAKwsC,SAAWG,EAC7B5jB,GAAIA,EAAIC,GAAIA,EACZokB,GAAIH,EAAKI,GAAIH,EACbN,KAAMA,EAAMC,KAAMA,EAClBC,QAAS,EAAGC,QAAS,GAExB,GAppT+BlvC,GAC9BA,EAAIgI,MAAQ,IAm1Td,MAECrE,YAAa3D,GACZmC,KAAKnC,IAAMA,EACXmC,KAAKstC,WAAY,CACjB,CAEDC,gBACCvtC,KAAKstC,WAAY,CAClB,CAEC1mB,SAAU4mB,EAASC,EAAW/+B,GAEzB1O,KAAKstC,WACRttC,KAAKnC,IAAII,KAAM,QACf,CACM0K,OAAQ,WACb+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAI8R,EACJ7R,GAAIltB,GAGP,CAEDqY,UAAWymB,EAASC,EAAW/+B,GAEzB1O,KAAKstC,WACRttC,KAAKnC,IAAII,KAAM,QACf,CACM0K,OAAQ,YACb+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAI8R,EACJ7R,GAAIltB,GAGP,CAED2Y,OAAQA,GAEFrnB,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,YACR+kC,SAAU,EACVhS,GAAIrU,GAGR,CAEAnS,QAEMlV,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACd,CACG0K,OAAQ,QACR+kC,SAAU,GAIf,CAEAxmB,mBAAoBsmB,EAASG,EAASC,EAAQC,GAExC7tC,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,+BACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIgS,EACJ/R,GAAIgS,EACJE,GAAID,GAGR,CAEAlmB,cAAe6lB,EAAS/6B,GAElBzS,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,gBACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIlpB,GAGR,CAEA+U,iBAAkBgmB,EAAS/6B,GAErBzS,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,mBACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIlpB,GAGR,CAGAqV,qBAAsB0lB,EAAS/6B,GAEzBzS,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,yBACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIlpB,GAGR,CAEAwV,UAAWulB,EAAUtvC,EAAOiO,EAAOrB,GAC7B9K,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,YACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIz9B,EACJ09B,GAAIzvB,EACJ2hC,GAAIhjC,GAGP,CAEAsd,YAAaolB,GACRxtC,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,cACR+kC,SAAU,EACVhS,GAAI8R,GAIP,CAEDhlB,WAAYglB,EAASjlB,GACfvoB,KAAKstC,WACVttC,KAAKnC,IAAII,KAAM,QACf,CACG0K,OAAQ,aACR+kC,SAAU,EACVhS,GAAI8R,EACJ7R,GAAIpT,GAIR,GA9+TwB1qB,GACvBA,EAAIkwC,YAAc,EAKlBC,KAAKC,UAAY,SAAU5H,GAEvB,IACE,IAAI1mC,EAAO0mC,EAAI1mC,KAEf,GAAiB,WAAbA,EAAKzB,KAEPL,EAAI+H,MAAMghC,gBAAiBjnC,GAC3B9B,EAAIgI,MAAM0nC,qBAGP,GAAiB,WAAb5tC,EAAKzB,KAAmB,CAC/B,IAAIunC,EAAK9lC,EAAKJ,WACV8kB,EAAUxmB,EAAIgmC,UAAU/iC,IAAK2kC,IAEzB52B,eAAgBlP,EAAKxB,QAASwB,EAAKuuC,cAE7C,MACK,GAAiB,cAAbvuC,EAAKzB,KAERunC,EAAK5nC,EAAIgmC,UAAU2B,MAAO7lC,EAAKJ,gBAGhC,GAAiB,aAAbI,EAAKzB,MACRmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAE7BtgC,UAAW,EAAG9N,EAAKwuC,IAAKxuC,EAAKA,WAIlC,GAAiB,WAAbA,EAAKzB,KAAoB,CAEhCL,EAAIQ,IAAI,sCAAwCsB,EAAK+P,QAAQ5Q,OAAS,YAEtE,IAAIuG,EAAS,IAAIzB,EAAQ/F,GACrBwmB,EAAU,IAAIjf,EAAcvH,EAAKwH,GACrCxH,EAAIQ,IAAI,oCAER,IAAIsR,EAAK0U,EAAQzU,QAASjQ,EAAK+P,QAAS/P,EAAKyuC,OAC7CvwC,EAAIQ,IAAI,yBAEJsR,GACF0U,EAAQvU,SACRjS,EAAIQ,IAAI,uBAGRgmB,EAAQtU,OAGN01B,EAAK5nC,EAAIgmC,UAAUuC,SAAU/hB,GACjCxmB,EAAIQ,IAAI,uCAAyConC,EAAK,MAE/B,GAAnB5nC,EAAIkwC,aACNlwC,EAAIkwC,WAAatI,GAEnB5U,EAAOC,WAAYzM,EAGrB,MACK,GAAiB,eAAb1kB,EAAKzB,KAEZL,EAAIQ,IAAK,cAAgBW,KAAKC,UAAWU,IAEzC9B,EAAIiG,IAAIqlC,OAAQxpC,EAAK+nC,EAAG/nC,EAAKgoC,QAI1B,GAAiB,cAAbhoC,EAAKzB,KAEZL,EAAIQ,IAAK,qBAAuBW,KAAKC,UAAWU,IAEhD9B,EAAIiG,IAAI8Q,WAAYjV,EAAKgV,OAAOE,GAAIlV,EAAKgV,OAAOG,IAChDjX,EAAIiG,IAAI+L,QAAS,GAAIlQ,EAAKgV,OAAOI,QACjClX,EAAIiG,IAAIoR,aAGL,GAAiB,cAAbvV,EAAKzB,KAEZL,EAAIQ,IAAK,oBAAsBW,KAAKC,UAAWU,GAAO0D,OAAO,EAAE,IAAM,OACrExF,EAAIwwB,YAAc1uB,EAAKyuB,MACvBvwB,EAAIiP,YAAcnN,EAAKyP,KACvBvR,EAAIwwC,YAAc1uC,EAAK0uC,YACvBxwC,EAAIywC,aAAe3uC,EAAK2uC,kBAGrB,GAAiB,UAAb3uC,EAAKzB,KAEZL,EAAIQ,IAAK,cAAgBW,KAAKC,UAAWU,IAEzC9B,EAAIiC,OAAQH,EAAKI,UAGd,GAAiB,cAAbJ,EAAKzB,KAEZL,EAAIQ,IAAK,cAAgBW,KAAKC,UAAWU,IACzC9B,EAAI4H,KAAK0jC,OAAQxpC,EAAK+nC,EAAG/nC,EAAKgoC,QAG3B,GAAiB,iBAAbhoC,EAAKzB,KAA0B,CAEtC,IAEI+C,GAFAojB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAElB5gC,mBAEnBtP,EAAImD,OAAQC,EAAM,aAEdojB,EAAQnH,YACVmH,EAAQhS,UAAU,kCAClBgS,EAAQzT,cAEV/S,EAAIQ,IAAK,iBAEX,MACK,GAAiB,UAAbsB,EAAKzB,KAIR+C,GAFAojB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAElB5gC,mBAEnBtP,EAAImD,OAAQC,EAAM,QAEdojB,EAAQnH,YACVmH,EAAQhS,UAAU,6BAClBgS,EAAQzT,cAEV/S,EAAIQ,IAAK,uBAGN,GAAiB,YAAbsB,EAAKzB,KAAqB,CAE7BmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,YAArC,IAEI79B,EAAOvQ,EAAKuQ,KAEhBmU,EAAQ/T,cAAcJ,EAExB,MACK,GAAiB,QAAbvQ,EAAKzB,KAAiB,CAEzBmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,YAEjC79B,EAAO,CAAC,OAAO,IACnB,IAAK,MAAM4G,KAAKuN,EAAQpe,QAGP4S,SAAS/B,EAAE,IAExB5G,EAAKnR,KAAM+X,EAAE,IAGjBuN,EAAQ/T,cAAcJ,EAExB,MACK,GAAiB,YAAbvQ,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAE7B7uB,gBAAiB,GAAG,IAExBhP,EAAO,CAAC,YACZmU,EAAQ/T,cAAcJ,QAGnB,GAAiB,OAAbvQ,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAExB99B,cACXoU,EAAQrB,MAGRqB,EAAQ/T,cADK,CAAC,MAAO,WAIpB,GAAiB,WAAb3Q,EAAKzB,MAIZ,KAFImmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAExB99B,YAAc,CACzBoU,EAAQrB,MACRqB,EAAQrP,eAER,IAAIsI,EAAS+G,EAAQvS,eAAgBnS,EAAKA,KAAKoD,MAAM,OACjD0L,EAAM6O,EAAO7O,IAGjB,GAFA4V,EAAQrS,WAAYvD,GAEhB6O,EAAOsG,UACT,MAAMtG,EAAOsG,SAGjB,OAEG,GAAiB,QAAbjkB,EAAKzB,KAAiB,CAE7B,IAEI2N,GAFAwY,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEfriC,iBACtBG,EAAQiyB,QAAS,IACjBjyB,EAAQiyB,QAAS,QAEjBzZ,EAAQ/T,cAAezE,EAEzB,MACK,GAAiB,cAAblM,EAAKzB,KAAuB,CAI/BgS,GAFAmU,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAElB5wB,gBAGnB,IALA,IAGIoxB,EAAY,CAAC,aAAa,IAErB1vC,EAAE,EAAEA,EAAEqR,EAAKpR,OAAOD,IACzB0vC,EAAUxvC,KAAMmR,EAAKrR,IAGvBwlB,EAAQ/T,cAAei+B,EAEzB,MACK,GAAiB,YAAb5uC,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB99B,aACVoU,EAAQtU,OACRsU,EAAQ7S,cAGR6S,EAAQ7S,kBAIP,GAAiB,cAAb7R,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAC7Bv8B,kBAGL,GAAiB,QAAb7R,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB7wB,YACVmH,EAAQxb,cACRwb,EAAQhS,UAAU,QAClBgS,EAAQ9P,YACR8P,EAAQhS,UAAU,IAClBgS,EAAQhS,UAAU,uBAClBgS,EAAQhS,UAAU,iBAClBgS,EAAQhS,UAAU,IAClBgS,EAAQzT,mBAIP,GAAiB,OAAbjR,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB7wB,YACVmH,EAAQxb,cACRwb,EAAQhS,UAAU,OAClBgS,EAAQvU,eAGP,GAAiB,QAAbnQ,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB99B,aACVoU,EAAQtU,YAGP,GAAiB,gBAAbpQ,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB7wB,WACVmH,EAAQrP,oBAGP,GAAiB,cAAbrV,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB7wB,WACVmH,EAAQ3P,WAAY/U,EAAKgV,aAGxB,GAAiB,eAAbhV,EAAKzB,MAERmmB,EAAUxmB,EAAIgmC,UAAU/iC,IAAKjD,EAAIkwC,aAEzB7wB,WACVmH,EAAQxb,kBAGP,CACH,IAAI3K,EAAOmoC,EAAI1mC,KACVzB,IAIHA,EAAKA,EAAKA,QAHVA,EAAO,QAQTL,EAAIqB,OAAQ,sCAAsChB,EAAK,gBAAgBL,EAAIC,QAAQ,OAASkB,KAAKC,UAAWonC,EAAI1mC,MAElH,CAaF,CAXA,MAAO2D,GACDA,EAAEnF,QACJN,EAAIqB,OAAQoE,EAAEnF,QAAU,OAASmF,EAAEyO,SAAW,IAAKzO,EAAEqX,YAE7CrX,EAAEf,QACV1E,EAAIqB,OAAQoE,EAAEf,MAAQ,KAAOe,EAAEvB,OAAS,OAAQuB,EAAEb,QAClD5E,EAAIiG,IAAImB,QAAS,IAAM3B,EAAEf,MAAQ,aAAee,EAAEb,SAGpD5E,EAAIqB,OAAQF,KAAKC,UAAWqE,GAE9B,CAEF,C","sources":["webpack://B3/./tmp/basicworker.js"],"sourcesContent":["//src/sys/modules/basic/worker/sys.js\n//src/sys/modules/basic/worker/basicarray.js\n//src/sys/modules/basic/worker/basicerrorhandler.js\n//src/sys/modules/basic/worker/coding/codingeditor.js\n//src/sys/modules/basic/worker/basicruntime.js\n//src/sys/modules/basic/worker/extendedcommands.js\n//src/sys/modules/basic/worker/pgmmanager.js\n//src/sys/modules/basic/worker/basiccommands.js\n//src/sys/modules/basic/worker/basicparser.js\n//src/sys/modules/basic/worker/basictokenizer.js\n//src/sys/modules/basic/worker/input.js\n//src/sys/modules/basic/worker/processes.js\n//src/sys/modules/basic/worker/commandhelp.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//src/sys/modules/basic/worker/workerbootstrap_static.js\n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n\n// ## sys.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/sys.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/sys.js\n\nvar sys = {\n  appName: \"unknown\",\n  unique: 0\n\n};\n\nconsole = sys;\n\n/* LOGGER */\n\nfunction init_sys() {\n\n  function post( type, message ) {\n    postMessage( { type: type, message: message } );\n  }\n\n  sys.post = post;\n\n  sys.log = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      var args2 = [];\n\n      for( var i=0; i<args.length ; i++) {\n        args2.push( JSON.stringify( args[ i ]) );\n      }\n      post(\"syslog\",args2 );\n\n  }\n\n  sys.logerr = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post(\"syserr\",args );\n\n  }\n\n  sys.load = function( rt, path, device ) {\n\n      post(\"load\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n  sys.loaddata = function( rt, path, type, label ) {\n\n      post(\"loaddata\", { processId: rt.processId, path:path, type: type, label: label } );\n\n  }\n\n  sys.save = function( rt, path, device, data ) {\n\n      post(\"save\", { processId: rt.processId, path:path, device: device , data: data } );\n\n  }\n\n  sys.delete = function( rt, path, device ) {\n\n      post(\"delete\", { processId: rt.processId, path:path, device: device  } );\n\n  }\n\n  sys.dir = function( rt, path, device ) {\n\n      post(\"dir\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n\n  sys.setcfg = function( cfg ) {\n      this.cfg = cfg;\n  }\n\n  sys.listfs = function( rt  ) {\n\n      post(\"listfs\", { processId: rt.processId } );\n\n  }\n\n  sys.postsynchrequest = function( procId  ) {\n\n    post(\"synch\", { procId: procId } );\n\n  }\n\n  sys.poststatus = function( procId, status  ) {\n\n      post(\"status\", { procId: procId, status: status } );\n\n  }\n\n  sys.setfs = function( rt, path  ) {\n\n      this.fs = path;\n      post(\"setfs\", { path: path, processId: rt.processId } );\n\n  }\n\n  sys.setDisplayMode = function( rt, m ){\n    post( \"displaymode\", { processId: rt.processId, m:m } );\n  }\n\n  sys.blinkMode = function( m ){\n    post( \"blinkMode\", { m:m } );\n  }\n\n  sys.html = {}\n\n  sys.html.executeFunction = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"htmldofun\",args );\n\n  }\n\n  sys.html.html = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"html\",args );\n\n  }\n\n  sys.html.htmlnode = function() {\n\n    var args = Array.prototype.slice.call(arguments);\n    post( \"htmlnode\",args );\n\n  }\n\n\n  sys.html.get = function() {\n\n    post( \"htmlget\", args );\n    return { wait_for_result: true }\n\n  }\n\n  sys.export = function( code, destination ) {\n    post( \"export\", { code: code, destination: destination } );\n  }\n\n  sys.signalHideMenu = function( flag ) {\n    post( \"signalHideMenu\", { hide: flag } );\n  }\n\n}\n\nfunction start_sys() {\n  sys.log(\"Starting wsys\");\n\n  sys.processes = new processes( sys );\n  sys.input = new Input( sys );\n  sys.out = new TextArea( sys );\n  sys.bout = new BitMap( sys );\n  sys.pfields = new Playfields( sys );\n  sys.audio = new Audio( sys );\n  sys.rootProcId = -1;\n\n  /* APPLICATION */\n\n  /* HANDLERS */\n  self.onmessage = function( obj ) {\n\n      try {\n        var data = obj.data;\n\n        if( data.type == \"keydown\" ) {\n\n          sys.input.inputKeyHandler( data );\n          sys.audio.flagUserInput();\n\n        }\n        else if( data.type == \"message\") {\n          var id = data.processId;\n          var runtime = sys.processes.get( id );\n\n          runtime.receiveMessage( data.message, data.messageObject );\n\n        }\n        else if( data.type == \"synchreply\" ) {\n\n          var id = sys.processes.synch( data.processId );\n\n        }\n        else if( data.type == \"interrupt\") {\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.interrupt( 0, data.sub, data.data );\n\n          //TODO, index of runtime.\n        }\n        else if( data.type == \"loadpgm\" ) {\n\n          sys.log(\"Received 'loadpgm' message. Loaded \" + data.pgmData.length + \" bytes..\" );\n\n          var editor = new Editor( sys );\n          var runtime = new BasicRuntime( sys, editor );\n          sys.log(\"Context created, parsing program\");\n\n          var ok = runtime.bootPGM( data.pgmData, data.QPath  );\n          sys.log(\"Parsed program => RUN\");\n\n          if( ok ) {\n            runtime.runPGM();\n            sys.log(\"Program started...\");\n          }\n          else {\n            runtime.stop();\n          }\n\n          var id = sys.processes.register( runtime );\n          sys.log(\"Basic program registered as process \" + id + \".\");\n\n          if( sys.rootProcId == -1 ) {\n            sys.rootProcId = id;\n          }\n          pgmman.addRuntime( runtime );\n\n\n        }\n        else if( data.type == \"inittxtarea\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) )\n\n          sys.out.attach( data.w, data.h );\n\n\n        }\n        else if( data.type == \"initcolors\" ) {\n\n          sys.log( \"init colors with: \" + JSON.stringify( data ) )\n\n          sys.out.setDefault( data.colors.fg, data.colors.bg );\n          sys.out.control( 18, data.colors.border );\n          sys.out.reset();\n\n        }\n        else if( data.type == \"systeminfo\" ) {\n\n          sys.log( \"systeminfo with: \" + JSON.stringify( data ).substr(0,50) + \"...\" );\n          sys.screenModes = data.modes;\n          sys.displayMode = data.mode;\n          sys.windowWidth = data.windowWidth;\n          sys.windowHeight = data.windowHeight;\n\n        }\n        else if( data.type == \"setcfg\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n\n          sys.setcfg( data.cfg );\n\n        }\n        else if( data.type == \"initbitmap\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n          sys.bout.attach( data.w, data.h );\n\n        }\n        else if( data.type == \"clipboardCopy\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"clipboard\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Copied program to clipboard\");\n            runtime.printReady();\n          }\n          sys.log( \"clipboard copy\" )\n\n        }\n        else if( data.type == \"export\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"disk\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Export program to disk\");\n            runtime.printReady();\n          }\n          sys.log( \"Export to disk\" )\n\n        }\n        else if( data.type == \"showList\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = data.list;\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"list\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = [\"LIST\",\"\"];\n          for (const l of runtime.program)\n            {\n\n              var lineNr = parseInt(l[0]);\n\n              list.push( l[2] );\n            }\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"renumber\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.renumberProgram( 10,10 );\n\n          var list = [\"RENUMBER\"];\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"new\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n\n            var output = [\"NEW\", \"\"];\n            runtime.enterListMode( output );\n          }\n        }\n        else if( data.type == \"pastpgm\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n            runtime.resetConsole();\n\n            var result = runtime.textLinesToBas( data.data.split(\"\\n\") );\n            var pgm = result.pgm;\n            runtime.setProgram( pgm );\n\n            if( result.exception ) {\n              throw result.exception;\n            }\n\n          }\n        }\n        else if( data.type == \"vars\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var varList = runtime.getFullVarList();\n          varList.unshift( \"\" );\n          varList.unshift( \"VARS\" );\n\n          runtime.enterListMode( varList );\n\n        }\n        else if( data.type == \"datablocks\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = runtime.getDataBlocks();\n          var blockList = [\"DATABLOCKS\",\"\"];\n\n          for( var i=0;i<list.length;i++) {\n            blockList.push( list[i] );\n          }\n\n          runtime.enterListMode( blockList );\n\n        }\n        else if( data.type == \"stopMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n            runtime.toggleMenu();\n          }\n          else {\n            runtime.toggleMenu();\n          }\n\n        }\n        else if( data.type == \"toggleMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n          runtime.toggleMenu();\n\n        }\n        else if( data.type == \"help\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"HELP\");\n            runtime.printHelp();\n            runtime.printLine(\"\");\n            runtime.printLine(\"For more help type:\");\n            runtime.printLine(\"HELP <option>\");\n            runtime.printLine(\"\");\n            runtime.printReady();\n          }\n\n        }\n        else if( data.type == \"run\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"RUN\");\n            runtime.runPGM();\n          }\n        }\n        else if( data.type == \"stop\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n          }\n        }\n        else if( data.type == \"resetConsole\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.resetConsole();\n          }\n        }\n        else if( data.type == \"colorReset\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.colorReset( data.colors );\n          }\n        }\n        else if( data.type == \"clearScreen\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n          }\n        }\n        else {\n          var type = obj.data;\n          if(! type ) {\n            type = \"????\";\n          }\n          else {\n            type=type.type;\n            if(! type ) {\n              type = \"????\";\n            }\n          }\n          sys.logerr( \"Ignored unclassified message type (\"+type+\") for 'APP://\"+sys.appName+\"':  \" + JSON.stringify( obj.data ) );\n          //postMessage( self.onAppMessage( obj ) );\n        }\n      }\n      catch( e ) {\n        if( e.message ) {\n          sys.logerr( e.message + \" at \" + e.fileName + \":\"+ e.lineNumber );\n        }\n        else if ( e.clazz ) {\n          sys.logerr( e.clazz + \": \" + e.detail + \" at \"+ e.lineNr );\n          sys.out.writeln( \"?\" + e.clazz + \" error at \" + e.lineNr );\n        }\n\n        sys.logerr( JSON.stringify( e ) );\n\n      }\n\n    }\n}\n\ninit_sys();\n\n//--EOC \n\n// ## basicarray.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicarray.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicarray.js\n\nclass  BasicArray {\n\n  constructor( name, indices, defaultValue  ) {\n    this.name = name;\n    this.indices = indices;\n    this.buffer = null;\n    this.defaultValue = defaultValue;\n  }\n\n  getIndexCount() {\n    return this.indices.length;\n  }\n\n  _check( indices ) {\n    if( indices.length != this.indices.length ) {\n      throw \"BasicArray:00:index dimension mismatch:For array \" + this.name;\n    }\n    for( var i=0; i<indices.length; i++) {\n      if ( indices[i] > this.indices[ i ]) {\n        var detail = \"\\\"\" + this.name + \"[\" + indices[i] + \"]\"+\"\\\" does not exist\";\n        if( indices.length > 1) {\n          detail = \"\\\"\" + this.name + \"\\\" with index \" + indices[i] + \" does not exist\";\n          detail += \" for index dimension \" + i;\n        }\n        throw \"BasicArray:01:index out of bounds:\" + detail;\n      }\n      else if ( indices[i] < 0) {\n        throw \"BasicArray:02:index smaller then zero:For array \" + this.name;\n      }\n\n    }\n  }\n\n  set( indices, val ) {\n    this._check( indices );\n    if( this.buffer == null ) {\n      this.buffer = [];\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        ptr[ indices[ i ]] = val;\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          ptr[ indices[ i ]] = [];\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n  get( indices ) {\n    this._check( indices );\n\n    if( this.buffer == null ) {\n      return this.defaultValue;\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        return ptr[ indices[ i ]];\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          return this.defaultValue;\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n}\n\n//--EOC \n\n// ## basicerrorhandler.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicerrorhandler.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicerrorhandler.js\n\nclass ErrorHandler {\n\n  newError( clazz, detail, context, lineNr ) {\n    return { context: context, clazz: clazz, detail: detail, lineNr: lineNr };\n  }\n\n  throwError( clazz, detail, context, lineNr ) {\n    throw this.newError( clazz, detail, context, lineNr );\n  }\n\n\n  fromSimpleExternalError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n\n    var parts = s.split(\":\");\n    if( !parts.length == 3) {\n      return undefined;\n    }\n\n    var err = this.newError( parts[2], parts[3], context, lineNr );\n\n    err.extCode0 = parts[0];\n    err.extCode1 = parts[1];\n\n    return err;\n\n  }\n\n  fromSerializedError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n    if( ! this.isSerializedError( s ) ) {\n      return this.newError( \"unknown\", null, context, lineNr );\n    }\n    var parts = s.substr(1).split(\"@\");\n    if( parts.length == 1 ) {\n        return this.newError( parts[0], null, context, lineNr );\n    }\n    return this.newError( parts[0], parts[1], context, lineNr );\n\n  }\n\n  isSerializedError( e ) {\n    if( typeof e != \"string\" ) {\n      return false;\n    }\n    return e.startsWith( \"@\" );\n  }\n\n  isError( e ) {\n    if( Object.prototype.toString.call( e ) === '[object Object]' ) {\n      var ctx = e[ \"context\" ];\n      var clss = e[ \"clazz\" ];\n      var dtl = e[ \"detail\" ];\n\n      if( !( clss === undefined ) ) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\n//--EOC \n\n// ## coding/codingeditor.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/coding/codingeditor.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/coding/codingeditor.js\n\nclass Editor {\n\n  constructor( sys ) {\n    this.sys = sys;\n    this.output = sys.out;\n    this.keyMode = \"insert\";\n\n    //this.lineMarkers = [ 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0 ];\n  }\n\n\n  addRunTime( rt ) {\n    this.runTime = rt;\n  }\n\n  keyHandlerForCLE( e ) {\n\n      if( e.keyLabel == \"Enter\"  && !e.shiftKey ) {\n        var command = sys.out.getCurrentLine();\n        this.output.writeln(\"\");\n\n        this.runTime.executeInteractiveLine( command );\n\n      }\n      else if( e.keyLabel == \"Enter\" && e.shiftKey ) {\n\n        this.output.ScrollDownByCurrentLine();\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            this.output.backspace();\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowUp\" && !e.ctrlKey) {\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && !e.ctrlKey) {\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowUp\" && e.ctrlKey ) {\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && e.ctrlKey ) {\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey ) {\n        this.output.cursorMove(\"left\");\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"line-start\");\n      }\n      else if( e.keyLabel == \"Home\" && e.shiftKey && !e.ctrlKey ) {\n        this.output.clear();\n      }\n      else if( e.keyLabel == \"End\" && !e.ctrlKey ) {\n        this.output.jumpTo(\"line-end\");\n      }\n      else if( e.keyLabel == \"Home\" && e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"home\");\n      }\n      else if( e.keyLabel == \"End\" && e.ctrlKey ) {\n        this.output.jumpTo(\"end\");\n      }\n      else if( e.keyLabel == \"Tab\" ) {\n        if( this.keyMode == \"insert\") {\n          this.output.insert(  \"        \" );\n        }\n        else {\n          this.output.write(  \"        \" );\n        }\n\n      }\n      else if( e.keyLabel == \"Insert\" ) {\n\n        if( this.keyMode == \"insert\") {\n          this.keyMode = \"overwrite\";\n        }\n        else {\n          this.keyMode = \"insert\";\n        }\n        this.output.setCursorMode( this.keyMode )\n      }\n      else {\n        if( e.key != null ) {\n          if( this.keyMode == \"insert\") {\n            this.output.insert( e.key );\n          }\n          else {\n            this.output.write( e.key );\n          }\n        }\n      }\n\n  }\n\n\n  interactiveKeyHandler( e ) {\n    this.keyHandlerForCLE( e );\n  }\n}\n\n//--EOC \n\n// ## basicruntime.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicruntime.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicruntime.js\n\nclass BasicRuntime {\n\n  constructor( sys, editor ) {\n\n    this.debugFlag = false;\n    this.sys = sys;\n    this.editor = editor;\n    this.editor.addRunTime( this );\n    this.listSpeed = 15;\n\n    this.output = sys.out;\n    this.bitmap = sys.bout;\n    this.playfields = sys.pfields;    \n    this.input = sys.input;\n    this.audio = sys.audio;\n    this.input.setHandler( this );\n    this.input.setInterActive( false);\n    this.html = sys.html;\n    this.menuEnable = false;\n\n    this.program = [];\n    this.runFlag = false;\n    this.isWaitingFlag = false;\n    this.isSynchingFlag = false;\n    this.waitingTime = 0;\n    this.immediate = 0; \n    this.printWaitSynchCounter= 0;\n\n    this.waitForMessageFlag = false;\n    this.waitForMessageVariable = null;\n    this.executeLineFlag = false;\n    this.goPlayExampleFlag = false;\n\n    this.inputFlag = false;\n    this.inputCommand = false;\n    this.listFlag = false;\n    this.immersiveFlag = false;\n    this.statusChanged = false;\n\n    this.gosubReturn = [];\n    this.nullTime = new Date().getTime();\n\n    this.turboMode = false;\n    this.cmdCountPerCycleDefault = 20000;\n    this.cmdCountPerCycleTurbo = 20000;\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n\n    var c = this.output;\n    this.commands = new BasicCommands( this );\n    this.extendedcommands = new ExtendedCommands( this.commands, this );\n\n    this.erh = new ErrorHandler();\n    this.vars = {};\n    this.functions = [];\n    this.data = [];\n    this.loadedData = { default: [] };\n    this.loadedLabel = null;\n\n    this.kbBuffer = [];\n\n    this.yPos = -1;\n\n    this.SHORTLINE = 0;\n    this.LONGLINESTART = 1;\n    this.LONGLINEEND = 2;\n\n    this.forContext = { default:[] }\n\n    this.outputCallBacksAll = {\n        lineOverFlow: { clazz: this, method: \"cbLineOverFlow\" },\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    this.outputCallBacksClScr = {\n        lineOverFlow: undefined,\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    //this.setTurbo( true );\n    this.synchClock( );\n    this.exitMode = \"stay\";\n\n    this.code2colMap = [];\n    var km = this.code2colMap;\n\n    km[0x90] = 0;\n    km[0x05] = 1;\n    km[0x1c] = 2;\n    km[0x9f] = 3;\n    km[0x9c] = 4;\n    km[0x1e] = 5;\n    km[0x1f] = 6;\n    km[0x9e] = 7;\n\n    km[0x81] = 8;\n    km[0x95] = 9;\n    km[0x96] = 10;\n    km[0x97] = 11;\n    km[0x98] = 12;\n    km[0x99] = 13;\n    km[0x9a] = 14;\n    km[0x9b] = 15;\n\n    this.symbolTable = {};\n\n    this.symbolTable.up     = 0x91;\n    this.symbolTable.down   = 0x11;\n    this.symbolTable.left   = 157;\n    this.symbolTable.right  = 29;\n    this.symbolTable[\"reverse on\"]  = 0x12;\n    this.symbolTable[\"reverse off\"]  = 0x92;\n    this.symbolTable[\"clear\"]  = 0x93;\n    this.symbolTable[\"home\"]  = 0x13;\n    this.symbolTable.black  = 144;\n    this.symbolTable.white  = 5;\n    this.symbolTable.red  = 28;\n    this.symbolTable.cyan  = 159;\n    this.symbolTable.purple  = 156;\n    this.symbolTable.green  = 30;\n    this.symbolTable.blue  = 31;\n    this.symbolTable.yellow  = 158;\n    this.symbolTable.orange  = 129;\n    this.symbolTable.brown  = 149;\n    this.symbolTable.pink  = 150; // light red\n    this.symbolTable.grey1  = 151;  //dark grey\n    this.symbolTable.grey2  = 152;\n    this.symbolTable[\"light green\"]  = 153;\n    this.symbolTable[\"light blue\"]  = 154;\n    this.symbolTable.grey3  = 155; //light grey\n\n\n    var backmap = []\n    var mapInfo = Object.entries(this.symbolTable);\n    for( var i=0; i<mapInfo.length; i++) {\n      backmap[ mapInfo[i][1]] = mapInfo[i][0];\n    }\n    this.symbolTableBM = backmap;\n\n  }\n\n  flagStatusChange() {\n    this.statusChanged = true;\n  }\n\n  clearInputCommand() {  /* for GET and GETKEY, for input we use something else */\n    this.inputCommand = false;\n  }\n\n  flagInputCommand() {  /* for GET and GETKEY, for input we use something else */\n    this.inputCommand = true;\n  }\n\n  setWaiting( time ) {  /* for GET and GETKEY, for input we use something else */\n    this.isWaitingFlag = true;\n    this.waitingTime = time;\n  }\n\n  clearWaiting() {  /* for GET and GETKEY, for input we use something else */\n    this.isWaitingFlag = false;\n  }\n\n\n  setImmediate( immediate ) {\n    this.immediate = immediate;\n    if( this.immediate == 0 ) {\n      this.printWaitSynchCounter = 0;\n    }\n\n    this.output.setPokeFlush( immediate != 0 );\n  }\n\n\n  synchPrint() {\n    if( this.immediate == 0) {\n      this.printWaitSynchCounter++;\n      if( this.printWaitSynchCounter > 100 ) {\n        this.enableSynching(); \n        this.printWaitSynchCounter = 0;          \n      }\n    }\n  }\n\n  printNewLine() {\n    this.output.nl();\n    if( this.immediate == 0) {\n      this.enableSynching(); \n      this.printWaitSynchCounter = 0;\n    }\n  }\n\n  enableSynching( ) {  \n    this.isSynchingFlag = true;\n    this.synchingTime0=new Date().getTime();\n  }\n\n  clearSynching() {  \n    this.isSynchingFlag = false;\n    this.synchingTime= ( new Date().getTime() ) - this.synchingTime0;\n  }\n  \n\n  getScopeVars( s ) {\n    return s.vars;\n  }\n\n  getFullVarList() {\n    var scopes = this.getFullScopes();\n    var varList = [];\n\n    for( var si = 0; si< scopes.length; si++ ) {\n\n      var fullscope = scopes[si];\n      var vars = this.getScopeVars( fullscope.scope );\n      var names = Object.getOwnPropertyNames( vars );\n\n      for( var i=0;i<names.length;i++) {\n        var name = names[i];\n        var value = vars[ name ];\n        var path = fullscope.path;\n        if( path == \"\" ) { path = \"\"; }\n        else { path += \"/\"; }\n        if( ! name.startsWith( \"@array_\" ) ) {\n            if( name.endsWith(\"$\") ) {\n                varList.push( path + name + \" = \\\"\" + value + \"\\\"\" );\n            }\n            else {\n                varList.push( path + name + \" = \" + value );\n            }\n        }\n        else {\n            var descr = \"\";\n            for( var ii=0; ii<value.indices.length; ii++ ) {\n              if( ii>0 ) { descr += \",\"; }\n              descr += value.indices[  ii ];\n\n            }\n            varList.push( name.substr(7) + \" = array with dim(\" + descr + \")\" );\n        }\n      }\n    }\n\n    return varList;\n  }\n\n  getFullScopes() {\n    var scopes = [];\n    var path = \"\";\n    for( var si = 0 ; si < this.scopes.length; si++ ) {\n      var scope = this.scopes[si].name;\n\n      if( si > 0) {\n        if( path != \"\" ) {\n          path += \"/\";\n        }\n        path += scope;\n      }\n\n      scopes.push( { path: path, scope: this.scopes[si]  } );\n    }\n\n    return scopes;\n  }\n\n  cpuNeeded() {\n    if (this.runFlag ) { return 1; }\n    else if (this.listFlag ) { return .8; }\n    return .1;\n\n  }\n\n  getStatus() {\n\n    var status = \"\";\n    var lineNr;\n    if( this.runFlag ) {\n      lineNr = this.program[ this.runPointer ][0];\n      status = \"running[\" + lineNr + \"]\";\n    }\n    else {\n      status = \"stopped\";\n    }\n\n    if( this.runFlag && this.inputFlag ) {\n      status = \"running[\" + lineNr + \"]/input\";\n    }\n    else if( !this.runFlag && this.listFlag ) {\n      status = \"stopped/listing\";\n    }\n\n    var vlen = Object.getOwnPropertyNames( this.getVars() ).length;\n\n\n    this.statusChanged = false;\n\n    return {\n      status: status,\n      pgmLen: this.program.length,\n      varLen: vlen,\n      displayMode: this.sys.displayMode\n    }\n  }\n\n  dir( path, device ) {\n    this.sys.dir( this, path, device );\n    this.startWaitForMessage( \"dir\" )\n  }\n\n  listfs() {\n    this.sys.listfs( this );\n    this.startWaitForMessage( \"listfs\" )\n  }\n\n  setfs( path ) {\n    this.sys.setfs( this, path );\n    this.startWaitForMessage( \"path\" )\n  }\n\n  load( path, start, device ) {\n    this.sys.load( this, path, device );\n    this.startWaitForMessage( \"load\" )\n    this.autoStartAfterLoad = start;\n\n  }\n\n  loaddata( path, type, label ) {\n    this.sys.loaddata( this, path, type, label );\n    this.startWaitForMessage( \"loaddata\" )\n\n  }\n\n  save( path0, device ) {\n\n    var data = this.getProgramAsText();\n    var path = path0;\n    if( path0 == null ) {\n      path = \"default.bas\";\n    }\n    this.sys.save( this, path, device, data );\n    this.startWaitForMessage( \"save\" )\n  }\n\n  deleteFile( path, device ) {\n\n    this.sys.delete( this, path, device );\n    this.startWaitForMessage( \"delete\" )\n  }\n\n\n  startWaitForMessage( variable ) {\n    this.waitForMessageFlag = true;\n    this.waitForMessageVariable = variable;\n  }\n\n\n  keyInterrupt( _type, _data ) {\n    this.interrupt( 0, _type, {} );\n  }\n\n  interrupt( _ix, _type, _data ) {\n\n\n\n    if( _ix == 0 && this.interruptFlag0 ) {\n        return; //allready in an interrupt0\n    }\n\n    if( _ix == 1 && this.interruptFlag1 ) {\n        return; //allready in an interrupt1\n    }\n\n\n    var line, useLabel;\n    if( _ix == 0 ) {\n\n      line = this.handlers.interrupt0;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag0 = true;\n      useLabel = this.handlers.interrupt0ParamIsLabel;\n    }\n    else {\n\n      line = this.handlers.interrupt1;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag1 = true;\n      useLabel = this.handlers.interrupt1ParamIsLabel;\n    }\n\n\n    this.newScope( \"interrupt\" + _ix,\n      { runPointer: this.runPointer, runPointer2: this.runPointer2 } );\n\n    var variables = Object.entries( _data );\n    this.setVar( \"itr0$\".toUpperCase(), _type.toUpperCase() );\n    for( var i=0; i<variables.length; i++) {\n      this.setVar( variables[i][0].toUpperCase(), variables[i][1] );\n    }\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n\n    if( useLabel ) {\n\n      line = this.labels[line];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n        break;\n      }\n    }\n\n    if(!found ) {\n      throw \"@invalid interrupt handler\";\n    }\n\n  }\n\n  receiveMessage( _message, _data ) {\n\n    this.vars[ this.waitForMessageVariable ] = _message;\n    this.waitForMessageFlag = false;\n\n    if( _message.startsWith( \"displaymode:\" )) {\n        this.output.reInit( _data.textW, _data.textH );\n        this.bitmap.reInit( _data.bitmapW, _data.bitmapH );\n        //this.playfields.reInit( _data.playfields );\n        this.sys.displayMode = _data.mode;    \n        this.playfields.enable( _data.pfEnabled ); \n        this.playfields.set( _data.playfields ); \n        \n\n    }\n    else if( _message.startsWith( \"pfinit:current:\" )) {\n        /*\n            Reinit current playfield\n            Other ones are only stored in webworker\n\n        */\n        \n        this.output.set( _data.textW, _data.textH, _data.cells );\n        this.playfields.set( _data.playfields );\n\n    }\n    else if( _message.startsWith( \"pfinit:other:\" )) {\n        \n        this.playfields.set( _data.playfields );\n    \n    }\n    else if( _message.startsWith( \"pfselect:\" )) {\n        \n        this.output.set( _data.textW, _data.textH, _data.cells );\n    \n    }    \n    else if( _message == \"load:error\" ) {\n\n      if( this.runFlag == false ) {\n          this.printError(\"load\", false, undefined, _data.reason );\n      }\n    }\n    else if( _message == \"load:completed\" ) {\n\n      sys.log(\"Received 'load:completed' message. Loaded \" + _data.pgmData.length + \" bytes..\" );\n\n      var ok = this.bootPGM( _data.pgmData, _data.path  );\n      sys.log(\"Parsed program => RUN\");\n\n      if( ok && this.autoStartAfterLoad ) {\n        this.output.control( 24 )\n        this.runPGM();\n        sys.log(\"Program started...\");\n      }\n      else {\n        this.stop();\n      }\n    }\n    else if( _message == \"loaddata:completed\" ) {\n\n      sys.log(\"Received 'loaddata:completed' message. Loaded \" + _data.data.length + \" bytes..\" );\n\n      this.insertData( _data.data, _data.type, _data.label  );\n\n    }\n    else if( _message == \"loaddata:error\" ) {\n\n      sys.log(\"Received 'loaddata:error' message. Error \" + _data.reason );\n\n      this.printError(\"loaddata\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"delete:completed\" ) {\n\n      sys.log(\"Received 'delete:completed' message.\" );\n\n    }\n    else if( _message == \"delete:error\" ) {\n\n      sys.log(\"Received 'delete:error' message. Error \" + _data.reason );\n\n      this.printError(\"delete\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"save:completed\" ) {\n\n      sys.log(\"Received 'save:completed' message.\" );\n\n      if( !this.isRunning() ) {\n      }\n    }\n    else if( _message == \"save:error\" ) {\n\n      sys.log(\"Received 'save:error' message. Error \" + _data.reason );\n\n      this.printError(\"save\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"dir:completed\" ) {\n\n      sys.log(\"Received 'dir:completed' message.\" );\n\n      var list = [\"\",\"Directory of: \\\"\" + _data.title + \"\\\" on \" + _data.fs, \"\" ];\n\n      for( var i=0; i<_data.files.length; i++) {\n          list.push( _data.files[i].fname );\n      }\n\n      list.push( _data.files.length + \" files\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"dir:error\" ) {\n\n      sys.log(\"Received 'dir:error' message. Error \" + _data.reason );\n\n      this.printError(\"dir\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"listfs:completed\" ) {\n\n      sys.log(\"Received 'listfs:completed' message.\" );\n\n      var list = [\"\", \"Default Filesystem: \\\"\" + _data.currentFs + \"\\\"\", \"\", \"Devices:\", \"\" ];\n\n      //var fs = fsList[i];\n\n\n      for( var i=0; i<_data.fs.length; i++) {\n\n          var fs = _data.fs[i];\n          var str = \"\\\"\" + fs.name + \"\\\"\";\n          var deviceNumberLen = (fs.device + \"\").length;\n          str = str + \"                  \".substr( 0,(18-str.length-deviceNumberLen) ) + fs.device;\n\n\n          list.push(\"     \" + str );\n      }\n\n      list.push( \"\" );\n      list.push( _data.fs.length + \" Filesystem Devices Found\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"setfs:completed\" ) {\n\n      if( !this.isRunning() ) {\n        if( _data.status == \"ok\" ) {\n        }\n        else {\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n        }\n\n      }\n      else {\n        if( _data.status != \"ok\" ) {\n\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n          this.stop();\n        }\n      }\n    }\n\n    if( this.stopAfterMessage ) {\n      this.stopAfterMessage = false;\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n    }\n\n    if( !this.isRunning() && this.listFlag == false ) {\n      this.printReady();\n    }\n\n  }\n\n  stop() {\n    if( this.runFlag ) {\n      this.runStop();\n    }\n    if( this.listFlag ) {\n      this.listStop();\n    }\n  }\n\n  interactiveKeyHandler( e ) {\n\n    if( this.runFlag == true ) {\n      if( e.keyLabel == \"Enter\" ) {\n\n        var cxy = this.output.getCursorPos();\n\n        var string = this.output.getLineFrom( this.inputStartInputPosX, cxy[1]);\n        this.output.writeln(\"\");\n\n        this.handleLineInput( string, true );\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n        var x = this.output.getCursorPos()[0];\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            if( x > this.inputStartInputPosX ) {\n                this.output.backspace();\n            }\n            else {\n              this.output.delete();\n            }\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey) {\n        var cx = this.output.getCursorPos();\n        if( cx[0] > this.inputStartInputPosX ) {\n          this.output.cursorMove(\"left\");\n        }\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey ) {\n        var xy = this.output.getCursorPos();\n\n        this.output.setCursorPos( this.inputStartInputPosX, xy[1]);\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey)) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( e.keyLabel == \"End\" ) {\n        this.output.jumpTo(\"text-end-all\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n        var xy = this.output.getCursorPos();\n        if( xy[0]< this.inputStartInputPosX ) {\n          this.output.setCursorPos( this.inputStartInputPosX, xy[1] );\n        }\n      }\n      else {\n        if( e.key != null ) {\n          this.output.write( e.key );\n        }\n      }\n    }\n    else {\n      this.editor.interactiveKeyHandler( e );\n    }\n  }\n\n  toggleMenu()  {\n    this.menuEnable = !this.menuEnable;\n\n    if( this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n    else {\n      this.sys.signalHideMenu( true );\n    }\n  }\n\n  HandleStopped( startingProgram ) {\n\n    this.clearWaiting();\n    this.input.setInterActive( true);\n    this.input.flush();\n    if( !startingProgram && this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n\n    this.flagStatusChange();\n  }\n\n  importPGMHandler( content, filename ) {\n    var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n    this.fileName = filename;\n\n    this.program = pgm;\n    this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n  }\n\n  bootPGM( content, filename ) {\n    try {\n      var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n      this.fileName = filename;\n\n      this.program = pgm;\n      this.setProgram( pgm );\n\n      this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n      return true;\n    }\n    catch ( e ) {\n      var tmp = 1;\n\n      var pgm = this.textLinesToBas( \"\" ).pgm;\n      this.program = pgm;\n      this.HandleStopped( false );\n      this.printError(\"parsing syntax\", false, e.lineNr, e.detail );\n      this.printReady();\n      return false;\n\n    }\n  }\n\n\n/*  exportPGM() {\n    var exportName = \"program.bas\";\n    if( this.fileName ) {\n      exportName = this.fileName;\n    }\n\n    var text = this.getProgramAsText();\n    this.DESKTOP.requestDownload( text, exportName );\n  }\n*/\n\n  exitProgram() {\n    this.closeWindow( this.windowId );\n  }\n\n\n  enterListMode( list ) {\n    this.listFlag = true;\n    this.list = list;\n    this.listPointer = 0;\n    this.printLine(\"\");\n    this.listFlagBakInteractive = this.input.getInterActive();\n    this.input.setInterActive( false );\n    this.flagStatusChange();\n  }\n\n  setExitMode( v ) {\n    this.exitMode = v;\n  }\n\n  synchClock() {\n\n    //var clock = new Date().getTime();\n    var nullClock = new Date();\n    nullClock.setHours(0);\n    nullClock.setSeconds(0);\n    nullClock.setMinutes(0);\n    nullClock.setMilliseconds(0);\n\n    this.nullTime = nullClock;\n\n  }\n\n  setTurbo( on ) {\n    if( on ) {\n      this.cmdCountPerCycle = this.cmdCountPerCycleTurbo ;\n      this.turboMode = true;\n      return;\n    }\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n    this.turboMode = false;\n  }\n\n  setProgram( pgm ) {\n    this.program = pgm;\n    this.runFlag = false;\n    this.HandleStopped( true );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n\n    this.flagStatusChange();\n\n  }\n\n  appendProgram( pgm ) {\n\n    for(var i=0; i<pgm.length; i++) {\n      var exists = -1;\n\n      for(var j=0; j<this.program.length; j++) {\n        if( this.program[j][0] == pgm[i][0] ) {\n          exists = j;\n        }\n      }\n\n      if( exists>-1 ) {\n        this.program[ exists ] = pgm[ i ];\n      }\n      else {\n        this.program.push( pgm[ i ] );\n      }\n    }\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    this.program.sort( sortF );\n\n    this.runFlag = false;\n    this.HandleStopped( false );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n    //this.output.clearCursor();\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  getProgramState() {\n    return {\n      runFlag: this.runFlag,\n      inputFlag: this.inputFlag,\n      vars: this.vars,\n      functions: this.functions,\n      forContext: this.forContext,\n      runPointer: this.runPointer,\n      runPointer2: this.runPointer2\n    }\n  }\n\n  setProgramState( pgmState ) {\n      this.runFlag = pgmState.runFlag;\n      this.HandleStopped( false );\n      this.inputFlag = pgmState.inputFlag;\n      this.vars = pgmState.vars;\n      this.functions = pgmState.functions;\n      this.forContext = pgmState.forContext;\n      this.runPointer = pgmState.runPointer;\n      this.runPointer2 = pgmState.runPointer2;\n  }\n\n  _setByteBits( bits ) {\n\n   var byte = 0b00000000;\n\n   for( var i=0; i<8; i++) {\n     if(i>0) {\n       byte = byte >> 1;\n     }\n     if( bits[i]) {\n       byte = byte | 128;\n     }\n   }\n   return byte;\n  }\n\n  _getByteBits( byte ) {\n    var masks = [\n      0b00000001,0b00000010,0b00000100,0b00001000,\n      0b00010000,0b00100000,0b01000000,0b10000000\n    ];\n\n   var results = [ false, false, false, false, false, false, false, false ];\n\n   for( var i=0; i<8; i++) {\n\n     results[ i ] = (byte & masks[i]) > 0;\n\n   }\n\n   return results;\n  }\n\n  upperFirst( s ) {\n    if( s ) {\n      if ( s.length > 1 ) {\n          return s.substr(0,1).toUpperCase() + s.substr( 1 );\n      }\n    }\n    return s;\n  }\n\n  printError( s, supressLine, explicitline, detail ) {\n\n    var line1 = (\"?\" + this.upperFirst( s ) + \" error\" + this.onLineStr());\n\n    if( explicitline ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error in \" + explicitline ) );\n    }\n    if( supressLine ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error\") );\n    }\n\n    this.output.writeln(  line1 );\n    if( detail ) {\n      this.output.writeln(  \">> \" + detail );\n    }\n\n  }\n\n  printInfo( s ) {\n\n    this.sys.log(  ( s + this.onLineStr()).toUpperCase() );\n\n  }\n\n  printHelp() {\n    this.extendedcommands[\"_stat_help\"]([]);\n  }\n\n  printLine( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n  print( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n//{ fg: 5, bg:1, border: 7 }\n  colorReset( colors ) {\n    this.output.setDefault( colors.fg, colors.bg );\n    this.output.control( 18, colors.border );\n    this.output.colorReset();\n  }\n\n  resetConsole() {\n    var wh = this.output.getDimensions();\n\n    //this.output.textArea(  wh[0], wh[1], -1, -1 );\n\n    this.output.reset();\n    //this.output.setPos(0,0);\n  }\n\n  clearScreen() {\n    this.output.clear();\n    this.output.setPos(0,0);\n  }\n\n  getMillis() {\n    var millis=new Date().getTime() - this.nullTime;\n    return millis;\n  }\n\n  getJiffyTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    var jiffis = Math.floor(millis / (1000 / 60));\n\n    return jiffis % 5184000;\n  }\n\n  getTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    millis = millis % 86400000;\n\n    var hours = Math.floor(millis / 3600000);\n    millis = millis - (hours * 3600000 );\n    var minutes = Math.floor(millis / 60000);\n    millis = millis - (minutes * 60000 );\n    var seconds = Math.floor(millis / 1000);\n    //millis = millis - (seconds * 1000 );\n    return [hours,minutes,seconds];\n  }\n\n  reset( hard, muteReady ) {\n    this.output.clearScreen();\n    this.output.writel(\"Ready.\");\n\n    this.inputFlag = false;\n    this.runFlag = false;\n    this.listFlag = false;\n\n    this.clrPGM();\n    this.setTurbo( false );\n  }\n\n  compressPGMText( pgmTxt ) {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var kws = p.getKeyWordCodes();\n    var txt2 = pgmTxt;\n\n    for( var i=0; i<kws.length; i++) {\n      var kw = kws[i];\n      if( !(kw===undefined || kw === null )) {\n          txt2 = txt2.replaceAll( kw.toLowerCase() , String.fromCharCode(i));\n      }\n    }\n\n    return txt2;\n  }\n\n\n  getProgramAsTextNoPETSCII() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        text +=  this.prepareLineForExportNoPETSCII( l[2].trim(), true );\n      }\n    return text;\n  }\n\n  getProgramSize() {\n    return this.program.length;\n  }\n\n  getProgramAsText() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        //text +=  this.prepareLineForExport( l[2].trim() );\n        if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n            text += \"\\n\";\n        }\n        text += l[2].trim();\n      }\n    return text;\n  }\n\n  prepareLineForExport( txt0 ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      if( c<31 || c==92 || c>=126 ) {\n        var symdef = this.symbolTableBM[ c ];\n        if( ! ( symdef === undefined ) ) {\n            dst += \"{\" + symdef + \"}\";\n        }\n        else {\n            dst += \"{\"+c+\"}\"\n        }\n\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n    }\n    return dst.toLowerCase();\n  }\n\n  replaceAll( src, str1, str2 ) {\n\n    var rv = src;\n    while( rv.indexOf( str1 ) > -1 ) {\n      rv = rv.replace( str1, str2 );\n    }\n    return rv;\n  }\n\n\n  rebuildNoPETSCIILineString( raw )\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var noPetsciiLine = this.prepareLineForExportNoPETSCII( raw, false );\n    var rec = p.parseLine( noPetsciiLine );\n    return rec;\n  }\n\n\n  prepareLineForExportNoPETSCII( txt0, toLower ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n    var last= \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      var cc = txt.charAt( i );\n      if( c<31 || c==92 || c>=94 ) {\n\n        var prevCharIsQuote = false, nextCharIsQuote=false;\n        if( (i+1)<txt.length) {\n          var cc2 = txt.charAt( i+1 );\n          if( cc2 == \"\\\"\" ) {\n            nextCharIsQuote = true;\n          }\n        }\n        if( last == \"\\\"\" ) {\n            prevCharIsQuote = true;\n          }\n\n        if( prevCharIsQuote && !nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\");\\\"\";\n        }\n        else if( prevCharIsQuote && nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\")\";\n            i++;\n        }\n        else if( !prevCharIsQuote && nextCharIsQuote ) {\n            dst += \"\\\";CHR$(\"+c+\")\";\n            i++;\n        }\n\n        else {\n            dst += \"\\\";CHR$(\"+c+\");\\\"\";\n        }\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n      last = cc;\n    }\n\n    var dst2= this.replaceAll( dst, \";\\\"\\\";\",\";\");\n\n    if( toLower ) { return dst2.toLowerCase(); }\n    return dst2;\n  }\n\n  ResolveStringSymbolToCode( x ) {\n\n    if(this.symbolTable[x]) {\n      return this.symbolTable[x];\n    }\n\n    return x;\n  }\n\n  prepareLineForImport( txt0 ) {\n    var txt;\n    txt = txt0.trim(); //.toUpperCase();\n    var dst = \"\";\n\n    var i=0; while( i<txt.length ) {\n      var c = txt.charCodeAt( i );\n      if( c == 123 ) {\n        i++;\n        var num = \"\";\n        while( i < txt.length ) {\n            c = txt.charCodeAt( i );\n            if( c == 125 ) {\n              i++;\n              break;\n            }\n            num += String.fromCharCode( c );\n\n            if( this.debugFlag ) {\n              console.log(\"found ESC seq char \" + String.fromCharCode( c ) );\n              console.log(\"found ESC seq char code \" + c);\n            }\n            i++;\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"found ESC seq \" + num);\n        }\n\n        num = this.ResolveStringSymbolToCode(num.toLowerCase());\n\n        if( this.debugFlag ) {\n          console.log(\"found resolved ESC seq \" + num);\n        }\n\n        dst += String.fromCharCode( parseInt( num, 10) );\n      }\n      else if( c == 8221 || c == 8220) { //looks like a double quote\n        dst += \"\\\"\";\n        i++;\n      }\n      else {\n        dst += txt.charAt( i );\n        i++;\n      }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"dst:\" + dst);\n    }\n\n    return dst;\n  }\n\n  getProgramLines() {\n\n    return this.program;\n  }\n\n  padZeros2( x ) {\n    var s = x + \"\";\n    for(var i=s.length; i<2; i++) {\n      s=\"0\"+s;\n    }\n    return s;\n  }\n\n  evalExpressionPart( p ) {\n    var val=0;\n\n    if( p.type==\"num\" ) {\n      if( p.data == \".\" ) {\n        val = 0;\n      }\n      else if((\"\"+p.data).indexOf(\".\") >= 0) {\n        val = parseFloat(p.data);\n      }\n      else {\n        val = parseInt(p.data);\n      }\n    }\n    else if( p.type==\"str\" ) {\n      val = p.data;\n    }\n    else if( p.type==\"var\" ) {\n      if(p.data.startsWith(\"TI\")) {\n        val = this.getMillis();\n        if(p.data.endsWith(\"$\")) {\n          val = this.getTime();\n          val = \"\" +\n            this.padZeros2(val[0]) +\n            this.padZeros2(val[1]) +\n            this.padZeros2(val[2]);\n        }\n      }\n      if(p.data.startsWith(\"STI\")) {\n        val = this.synchingTime;\n      }      \n      else if(p.data == \"CURRENTLINE\") {\n        val = this.runPointer;\n        if( val != -1 ) {\n          val = parseInt( this.program[ val ][0] );\n        }\n      }\n      else if(p.data == \"PI\") {\n        val = Math.PI;\n      }\n      else {\n        val = this.vars[ p.data ];\n      }\n      if( val == undefined ) {\n        val = 0;\n        if( this.scopes[0].vars[ p.data ] ) {\n          val = this.scopes[0].vars[ p.data ];\n        }\n      }\n    }\n    else if( p.type==\"array\" ) {\n      var varIntName = \"@array_\" + p.data;\n      var arr = this.vars[ varIntName ];\n\n      if( arr === undefined ) {\n        if( this.scopes[0].vars[ varIntName ] ) {\n          arr = this.scopes[0].vars[ varIntName ];\n        }\n        if( arr === undefined ) {\n          throw \"@no such array@Array '\"+ varIntName+\"' does not exist\";\n        }\n      }\n\n      if( arr.getIndexCount() != p.indices.length ) {\n          throw \"@bad subscript@Array index dimensions do not match\";\n      }\n\n      var indices = [];\n      for( var ai=0; ai<p.indices.length; ai++) {\n        indices[ai] = this.evalExpression( p.indices[ ai ] );\n      }\n\n      val = arr.get( indices );\n      if( val === undefined ) {\n        val = 0;\n      }\n\n    }\n    else if( p.type==\"expr\" ) {\n      val = this.evalExpression( p );\n    }\n    else if( p.type==\"funCall\" ) {\n\n      var values = [];\n      for( var j=0; j<p.params.length; j++) {\n        var par = this.evalExpression( p.params[j] );;\n        values.push( {value: par} );\n      }\n      try {\n        var commands = this.commands;\n        var ecommands = this.extendedcommands;\n        var cmds = this.commands;\n\n        var nFunName = \"_fun_\" + p.functionName.toLowerCase().replace(\"$\",\"_DLR_\");\n\n        var stc = commands[ nFunName ];\n        if( stc === undefined ) {\n\n          stc = ecommands[ nFunName ];\n\n          if( stc === undefined ) {\n\n            stc = ecommands[ nFunName ];\n\n            this.printError(\"no such function: \" + p.functionName);\n            console.log(\"Cannot find functionName \" + nFunName );\n\n            throw \"@no such function \" + p.functionName;\n\n          }\n          else {\n            cmds = ecommands;\n          }\n        }\n\n        val = cmds[ nFunName ]( values );\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n    else if( p.type==\"defFnCall\" ) {\n\n      try {\n        var fName = p.functionName;\n        var parValue = this.evalExpression( p.params[0] );\n        var restore = null;\n\n        if( this.functions[ fName ] === undefined ) {\n          throw \"@undef'd function\";\n        }\n        var functRecord = this.functions[ fName ];\n\n        if(!(  this.vars[ functRecord.par ] === undefined )) {\n          restore= this.vars[ functRecord.par ];\n        }\n\n        this.vars[ functRecord.par ] = parValue;\n        val  = this.evalExpression( functRecord.expr );\n\n        if( restore != null ) {\n          this.vars[ restore.name ] = restore;\n        }\n        else {\n          this.vars[ functRecord.par ] = 0; //TODO, actually should delete it\n        }\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n\n    return val;\n  }\n\n  evalExpression( expr ) {\n\n    if( expr == null ) {\n      return null;\n    }\n\n    if( expr.parts.length == 0 ) {\n      return null;\n    }\n\n    var val = this.evalExpressionPart( expr.parts[ 0 ] );\n\n    for( var i=1; i<expr.parts.length; i++) {\n      var p = expr.parts[ i ];\n      if( p.op == \"+\" ) {\n        val += this.evalExpressionPart( p );\n      }\n      else if( p.op == \"^\" ) {\n        val = Math.pow( val, this.evalExpressionPart( p ) );\n      }\n      else if( p.op == \"-\" ) {\n        val -= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"*\" ) {\n        val *= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"/\" ) {\n        if( this.evalExpressionPart( p ) == 0) {\n          throw \"@division by zero\";\n        }\n        val /= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"%\" ) {\n        val %= this.evalExpressionPart( p );\n      }\n      else if( p.op == \";\" ) {\n        val += (\"\" + this.evalExpressionPart( p ));\n      }\n      else if( p.op == \"OR\"  ) {\n          val |= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"AND\"  ) {\n          val &= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"<\" ) {\n        if( val < (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">\" ) {\n        if( val > (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"=\" ) {\n        if( val == (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<>\" ) {\n        if( val != (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<=\" ) {\n        if( val <= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">=\" ) {\n        if( val >= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n\n      else {\n        throw \"@syntax@unknown operator '\"+p.op+\"'\";\n      }\n    }\n\n    if( expr.negate ) {\n      return -val;\n    }\n    if( expr.binaryNegate ) {\n      if( val == 0 ) {\n        return -1;\n      }\n      return 0;\n    }\n    return val;\n  }\n\n  exitInputState() {\n    var con = this.output;\n    var p = this.program;\n\n    this.inputFlag = false;\n\n\n    var l = this.program[ this.runPointer ];\n    var cmds = l[1];\n\n    this.input.setInterActive( false);\n\n    this.runPointer2++;\n\n    if( this.runPointer2 >=  cmds.length ) {\n\n      this.runPointer2 = 0;\n      this.runPointer++;\n\n      if( this.runPointer >=  p.length ) {\n\n        this.runFlag = false;\n\n        this.HandleStopped( false );\n\n        this.printLine(\"\");\n        this.printReady();\n\n      }\n\n    }\n\n\n  }\n\n  cycle() {\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n    var WAIT_SPECIFIC_TIME = 50;\n    var WAIT_SYNCH = 60;\n\n    var c = this.output;\n\n    var cmdCount = this.cmdCountPerCycle;\n    var lineNumber = -1;\n    try {\n\n      if( this.bitmap.isActive() ) {\n        this.bitmap.triggerFlush();\n      }\n      if( this.output.isActive() && this.output.changeCount() > 0) {\n        this.output.triggerFlush();\n      }\n\n      if( !this.runFlag ||\n            this.inputFlag ||\n            this.listFlag\n             ) {\n\n        if( this.listFlag ) {\n           var countdown = this.listSpeed;\n           while( this.listPointer < this.list.length && countdown-- > 0 ) {\n               this.listCodeLine( this.list[ this.listPointer ] );\n               this.listPointer++;\n           }\n           if (  this.listPointer >= this.list.length ){\n             this.listStop();\n             this.flagStatusChange();\n           }\n\n        }\n      }\n      else {\n\n        if(this.debugFlag) console.log(\"START CYCLE------------------------------\" );\n\n        var p = this.program;\n\n        while (true) {\n\n\n          if( this.waitForMessageFlag ) {\n              break;\n              //return this.statusChanged;\n          }\n\n          if(this.debugFlag) console.log(\"START CYCLE LOOP-------------\" );\n          var l = p[ this.runPointer ];\n          lineNumber = l[0];\n\n          if( l === undefined ) {\n            var t=1;\n          }\n          var bf = this.runPointer2;\n          if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n          if(this.debugFlag) console.log(\" cmdCount = \" + cmdCount);\n          var rv = this.runCommands( l[1], cmdCount );\n\n          if(! ( this.traceVars === undefined )) {\n              for( var tvi=0; tvi<this.traceVars.length; tvi++) {\n                var thisVar = this.traceVars[ tvi ];\n                var thisValue = this.vars[ thisVar ];\n                var oldValue = this.traceOldValues[ thisVar ];\n\n                if( ! ( thisValue === undefined )) {\n                  if( oldValue != thisValue ) {\n                    this.traceList.push(\n                      \"TRC(\" + lineNumber + \") \" + thisVar + \"=\" + thisValue\n                    );\n\n                    this.traceOldValues[ thisVar ] = thisValue;\n                  }\n\n                }\n              }\n          }\n\n          //console.log(\" rv = \", rv);\n          var af = rv[ 1 ];\n\n          if( rv[0] == MIDLINE_INTERUPT) {\n            this.runPointer2 = af;\n          }\n\n          var executedCount = rv[2];\n\n          if(this.debugFlag) console.log(\" bf = \" + bf, \" af = \" + af);\n          if(this.debugFlag) console.log(\" executedCount = \" + executedCount);\n          if(this.debugFlag) console.log(\" rv = \" + rv);\n\n          cmdCount = cmdCount - executedCount;\n\n          if( rv[0]<=0 ) {\n            if(this.debugFlag) console.log(\" PGM END!!!!\" );\n            this.runFlag = false;\n            var e = null;\n            if( rv.length >= 4 ) {\n              e = rv[3];\n            }\n            this.printLine(\"\");\n            this.printReady();\n            this.HandleStopped( false );\n            if( rv[0] == END_W_ERROR ) {\n\n              this.setVar(\"LINE\", lineNumber );\n              console.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n              console.log(\"PARAMETER DUMP:\", this.vars );\n              console.log(\"FUNCTION DUMP:\", this.functions );\n            }\n            if(this.debugFlag) console.log(\"CYCLE RETURN END\");\n            //return this.statusChanged;\n            break;\n          }\n          else if( rv[0] == LINE_FINISHED ) {\n            this.runPointer ++;\n            this.runPointer2 = 0;\n            if(this.debugFlag) console.log(\" new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n            if( this.runPointer >=  p.length ) {\n              if(this.debugFlag) console.log( \"end program\");\n\n              this.setVar(\"LINE\", lineNumber );\n\n              if( !this.waitForMessageFlag ) {\n                this.runFlag = false;\n                this.HandleStopped( false );\n                this.printReady();\n              }\n              else {\n                this.stopAfterMessage = true;\n              }\n              break;\n            }\n          }\n          else if( rv[0] == TERMINATE_W_JUMP ) {\n\n            if(this.debugFlag) console.log(\" jump to new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n          }\n          else if( rv[0] == PAUSE_F_INPUT ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 INPUT\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }\n          else if( rv[0] == WAIT_SPECIFIC_TIME ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 SPECIFIC TIME\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }\n          else if( rv[0] == WAIT_SYNCH ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 SYNCH\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }          \n\n          if( cmdCount<=0 ) {\n            if(this.debugFlag) console.log(\"Breaking cmdCount=\" + cmdCount)\n            break;\n          }\n\n        }\n\n        if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n      }\n\n    }\n    catch (e) {\n      //c.clearCursor();\n\n      sys.log(\"DEBUG: \", typeof e );\n\n      this.setVar(\"LINE\", lineNumber );\n\n\n      if( this.erh.isError( e ) ) {\n        var err = e;\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else if( this.erh.isSerializedError( e ) ) {\n        var err = this.erh.fromSerializedError( e );\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else {\n        var err = this.erh.fromSimpleExternalError( e, undefined, undefined );\n\n        if( err ) {\n\n            this.setVar(\"ERR\", err.clazz );\n            this.setVar(\"ERRDETAIL\", err.detail  );\n            this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else {\n\n            this.setVar(\"ERR\", \"unexpected\" );\n            this.setVar(\"ERRDETAIL\", \"unexpected\"  );\n            this.printError( \"unexpected\", undefined, undefined, e );\n        }\n\n      }\n\n      this.printReady();\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n      sys.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n      sys.log(\"PARAMETER DUMP:\", this.vars );\n      sys.log(\"FUNCTION DUMP:\", this.functions );\n\n    }\n\n    var pi = this.procIf;\n\n    var cstate = pi.STATE_CLI;\n\n    if( this.isWaitingFlag  ) { cstate = pi.STATE_WAITING ;}\n    else if( this.isSynchingFlag  ) { cstate = pi.STATE_SYNCHING ;  sys.log(\"RT:Synch\" );}\n    else if( this.inputFlag  ) { cstate = pi.STATE_INPUT ;}\n    else if( this.runFlag | this.listFlag ) { cstate = pi.STATE_RUNNING; }\n\n    return [ this.statusChanged, cstate, this.waitingTime ];\n  }\n\n  doReturn() {\n\n    var oldPointers = this.gosubReturn.pop();\n    if( oldPointers === undefined ) {\n      throw \"@return without gosub\";\n    }\n\n    this.runPointer2 = oldPointers[ 1 ];\n    this.runPointer = oldPointers[ 0 ];\n\n    //this.goto( oldLine );\n  }\n\n\n  doInterruptReturn() {\n\n    if( this.scope.name == \"interrupt0\" ) {\n      this.interruptFlag0 = false; // TODO interrupt, take from scope which flag\n    }\n    else {\n      this.interruptFlag1 = false; // TODO interrupt, take from scope which flag\n    }\n\n    this.runPointer = this.scope.data.runPointer;\n    this.runPointer2 = this.scope.data.runPointer2;\n\n    this.closeScope();\n\n  }\n\n\n\n\n  gosub( line0, runPointer2 ) {\n\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var retLine = null;\n    var retCmd = null;\n\n    var line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    this.runPointer2 = runPointer2;\n\n    if( ( this.runPointer2 + 1) < this.program[ this.runPointer ][1].length ) {\n      retCmd = this.runPointer2 + 1;\n      retLine = this.runPointer;\n    }\n    else {\n      if( (this.runPointer+1) < len ) {\n        retCmd=0;\n        retLine = this.runPointer+1 ;\n      }\n      else {\n        retCmd=9999;\n        retLine = this.runPointer;\n      }\n    }\n\n    this.gosubReturn.push( [ retLine, retCmd ] );\n    this.goto( line );\n  }\n\n  goto( line0 ) {\n\n    //console.log( \"goto line \" + line)\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n    var line;\n\n    line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n      }\n    }\n\n    if(!found ) {\n      throw \"@undef'd statement\";\n    }\n\n    if(!this.runFlag ) {\n      this.startAsGoto = true;\n      this.runPGM();\n    }\n  }\n\n  listStop() {\n    if( this.listFlag ) {\n      if( this.runFlag ) {\n        this.listFlag = false;\n        this.input.setInterActive( this.listFlagBakInteractive );\n      }\n      else {\n        var c = this.output;\n        this.listFlag = false;\n        this.HandleStopped( false );\n        this.printLine( \"\" );\n        this.printReady();\n      }\n    }\n  }\n\n\n  runStop() {\n    if( this.runFlag ) {\n      var c = this.output;\n      this.runFlag = false;\n      this.handlers.interrupt0 = undefined;\n      this.handlers.interrupt1 = undefined;\n\n      this.HandleStopped( false );\n\n      console.log( \"break in \" + this.program[ this.runPointer ][0] );\n\n      this.setVar( \"LINE\", this.program[ this.runPointer ][0] );\n      this.setVar(\"ERR\", \"BREAK\" );\n\n      this.printLine(\"\");\n      this.printLine( \"break in \" + this.program[ this.runPointer ][0]);\n      this.printReady();\n    }\n  }\n\n  isRunning() {\n    return this.runFlag;\n  }\n\n  isListing() {\n    return this.listFlag;\n  }\n\n  isInput() {\n    return this.inputFlag;\n  }\n\n  isReady() {\n    return !this.runFlag && !this.listFlag && ! this.executeLineFlag;\n  }\n\n\n  getDataBlocks() {\n    var list = [];\n\n    var mapInfo = Object.entries( this.loadedData );\n    for( var i=0; i<mapInfo.length; i++) {\n      if( mapInfo[i][1].length > 0) {\n        list.push( mapInfo[i][0] + \": \" + mapInfo[i][1].length  );\n      }\n\n    }\n\n    return list;\n\n  }\n\n  readData() {\n\n    if( this.dataPointer >= this.data.length ) {\n      return undefined;\n    }\n\n    var result = this.data[ this.dataPointer ];\n    this.dataPointer++;\n\n    return result;\n  }\n\n\n  getDataLength() {\n\n    return this.data.length;\n\n  }\n\n  setData( label0 ) {\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n\n    this.data = this.loadedData[ label ];\n    this.dataPointer = 0;\n\n  }\n\n  insertData( data, type, label0 ) {\n\n    //this.loadedData = { default: [] };\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n    this.loadedLabel = label;\n    this.dataPointer = 0;\n\n    var arr = [];\n    this.loadedData[label ] = arr;\n\n    var typeParts = type.split(\":\");\n    var typeData = typeParts[0].toUpperCase();\n    var dataSyntax = typeParts[1].toUpperCase();\n\n    this[\"parseSimpleData\" + typeData + \"_\" + dataSyntax]( data, arr );\n\n    this.data = arr;\n  }\n\n\n  parseSimpleDataI_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n\n  parseSimpleDataS_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  parseSimpleDataS_LINES( data, toArr ) {\n    var data2;\n    data2 = data.split(\"\\n\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  printChar( c  ) {\n    this.output.write( c );\n  }\n\n  listCodeLine( rawLine ) {\n    if( rawLine === undefined ) {\n        this.printLine( \"???\" );\n        return;\n    }\n\n    this.printLine( rawLine );\n\n  }\n\n  rebuildLineString( nr, raw,\n      removePadding,\n      renumbering,\n      addSmartPadding,\n      shortenKeywords)\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n\n    var tokens = p.getTokens( raw, false, false );\n\n    if( ! ( renumbering === undefined )) {\n\n\n\n      var nopadTokens = [];\n      for( i = 0; i<tokens.length; i++) {\n        if( tokens[i].type != \"pad\") {\n          nopadTokens.push( tokens[ i ] );\n        }\n      }\n\n      var foundGoto = false;\n      var foundGotoParIndex = -1;\n\n      for( i = 0; i<nopadTokens.length; i++) {\n\n          if( i>1 ) {\n            if( nopadTokens[i].type == \"num\" &&\n                nopadTokens[i-1].type == \"name\" && nopadTokens[i-1].data == \"THEN\" ) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n            else if( nopadTokens[i].type == \"num\" &&\n                  nopadTokens[i-1].type == \"name\" &&\n                  ( nopadTokens[i-1].data == \"GOTO\" || nopadTokens[i-1].data == \"GOSUB\" )) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n        }\n\n        if( nopadTokens[i].type == \"num\" && foundGoto &&  i == foundGotoParIndex ) {\n          var newLine = renumbering[ \"old_\" + nopadTokens[i].data ];\n          if( newLine == undefined ) { newLine = 99999;}\n          nopadTokens[i].data =newLine;\n          foundGoto = false;\n        }\n      }\n    }\n    tokens[0].data = nr;\n    var newString;\n\n    newString = nr;\n    if( removePadding ) {\n      newString = nr + \" \" ;\n    }\n    for( var i = 1 ; i< tokens.length; i++) {\n      if( removePadding ) {\n         if( tokens[i].type == \"pad\" ) {\n           continue;\n         }\n       }\n\n       if( shortenKeywords ) {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"PRINT\" ) {\n           tokens[i].data = \"?\";\n         }\n       }\n       else {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"?\" ) {\n           tokens[i].data = \"PRINT\";\n         }\n      }\n\n      if( tokens[i].type == \"str\" ) {\n        newString += \"\\\"\" + tokens[i].data + \"\\\"\";\n      }\n      else if( tokens[i].type == \"name\" && addSmartPadding == true) {\n        newString += tokens[i].data + \" \";\n      }\n      else if( tokens[i].type == \"num\" && addSmartPadding == true) {\n        if( tokens[i].data.length == 1 ) {\n            newString += \" \" + tokens[i].data;\n        }\n        else {\n            newString += tokens[i].data;\n        }\n      }\n      else {\n        newString += tokens[i].data;\n      }\n\n    }\n\n    var rec = p.parseLine( newString );\n\n    return rec;\n  }\n\n  lineIsData( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"DATA\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsRem( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"REM\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsSub( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"SUB\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  renumberProgram( start, gap ) {\n\n    var p = this.program;\n\n    var newLineNr = start;\n    var renumbering = {};\n    var lineNumbers = [];\n\n    var method = \"sub\";\n\n    if( method  == \"plain\" ) {\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n      }\n    }\n    else if( method  == \"data\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n      //data\n      var kNumber = Math.ceil( newLineNr / 1000 );\n      var newLineNr2 = 1000 * ( kNumber  );\n      if( newLineNr2 - newLineNr  < 100 ) {\n        newLineNr2+=1000;\n      }\n      newLineNr = newLineNr2;\n\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( !data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n    }\n    else if( method  == \"rem\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsRem( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    else if( method  == \"sub\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsSub( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    //newLineNr = start;\n    for( var i=0; i<p.length; i++) {\n        newLineNr = lineNumbers[ i ]\n        var line = p[ i ];\n        var lRec = this.rebuildLineString( newLineNr, line[2], true, renumbering, true );\n\n        line[0] = newLineNr;\n        line[1] = lRec.commands;\n        line[2] = lRec.raw.trim();\n\n        //newLineNr += gap;\n    }\n  }\n\n  PETSCIIreplace( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildNoPETSCIILineString( line[2] );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  compressProgram( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n       var lRec = this.rebuildLineString( line[0], line[2], true, undefined, false, keywordCompress );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  normalizeProgram() {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildLineString( line[0], line[2], true, undefined, true );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  clrPGM() {\n    this.vars = {};\n    this.functions = [];\n    this.restoreDataPtr();\n  }\n\n  restoreDataPtr() {\n    this.dataPointer = 0;\n    this.data = this.loadedData[ \"default\" ];\n  }\n\n  normalizeData( dataRec ) {\n    var data = dataRec.data;\n\n    if( dataRec.type == \"num\" ) {\n      if( (typeof data).toLowerCase() == \"string\" ) {\n        data = parseInt( data );\n      }\n    }\n    else {\n      if( (typeof data).toLowerCase() == \"number\" ) {\n        data = \"\" + data ;\n      }\n    }\n\n    return data;\n  }\n\n  runPGM() {\n\n    this.executeLineFlag = false;\n    this.stopAfterMessage = false;\n\n    if( this.startAsGoto ) {\n        this.startAsGoto = false;\n\n        var bak1 = this.runPointer;\n        var bak2 = this.runPointer2;\n\n        this.runPGM();\n\n        this.runPointer = bak1;\n        this.runPointer2 = bak2;\n\n\n        return;\n    }\n\n    this.input.setInterActive( false);\n    this.input.flush();\n\n    var c = this.output;\n    var p = this.program;\n\n    this.loadedData[ \"default\" ] = [];\n    this.restoreDataPtr();\n\n    this.gosubReturn = [];\n    this.scopes = [];\n    this.newScope( \"global\", {} );\n    this.functions = [];\n    this.handlers = {}\n    this.labels = {};\n    this.traceList = [];\n    this.traceOldValues = {};\n\n    var normalize = this.normalizeData;\n\n    for( var i=0; i<p.length; i++) {\n\n        var line = p[ i ];\n        var commands = line[1];\n\n        for( var j=0; j<commands.length; j++) {\n\n          var command = commands[j];\n\n          if( command.type  == \"control\" && command.controlKW == \"data\") {\n            for( var k=0; k<command.params.length; k++) {\n              this.loadedData[ \"default\" ].push( normalize( command.params[k] ) );\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"on\") {\n            if( command.params[0] == \"interrupt1\") {\n              this.handlers.interrupt1 = command.params[1];\n              this.handlers.interrupt1ParamIsLabel = command.label;\n            }\n            else if( command.params[0] == \"interrupt0\") {\n              this.handlers.interrupt0 = command.params[1];\n              this.handlers.interrupt0ParamIsLabel = command.label;\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"sub\") {\n            var label = command.label;\n            this.labels[ label ] = parseInt(line[0]);\n          }\n        }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"data dump:\",this.data);\n    }\n\n\n    if( this.program.length > 0) {\n      this.runFlag = true;\n      this.inputFlag = false;\n      this.waitingTime = 0;\n      this.isWaitingFlag = false;\n      this.isSynchingFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n      this.setImmediate( 0 );\n\n    }\n    else {\n      this.runFlag = false;\n      this.inputFlag = false;\n      this.waitingTime = 0;\n      this.isWaitingFlag = false;\n      this.isSynchingFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n      this.setImmediate( 0 );\n      this.input.setInterActive( true);\n    }\n\n    this.flagStatusChange();\n  }\n\n  getVars() {\n    return this.vars;\n  }\n\n\n\n\n  doForInit( from, to, step, varName, cmdPointer, cmdArrayLen, linePointersLen ) {\n\n    var ctx = this.forContext;\n\n    if( this.vars[ varName ] === undefined ) {\n      this.vars[ varName ] = 0;\n    }\n    this.vars[ varName ] = this.evalExpression( from );\n\n    ctx.default.push( varName );\n    ctx[varName] = {};\n\n    var ctxv = ctx[varName];\n    ctxv.to = this.evalExpression( to );\n\n    if( step == null ) {\n        ctxv.step = 1;\n    }\n    else {\n      ctxv.step = this.evalExpression( step );\n    }\n\n    ctxv.jumpTo =\n      { line: this.runPointer,\n        cmdPointer: cmdPointer+1 }\n    if( ctxv.jumpTo.cmdPointer >= cmdArrayLen )  {\n\n      if( this.runPointer == -1) {\n        throw \"@syntax@Can't find command after 'FOR'\";\n      }\n      else {\n        if( ( this.runPointer + 1) >= linePointersLen ) {\n          throw \"@syntax@Can't find command after 'FOR', on next line\";\n        }\n        ctxv.jumpTo.line++;\n        ctxv.jumpTo.cmdPointer = 0;\n      }\n    }\n\n  }\n\n  doForNext( nextVarName ) {\n    var ctx = this.forContext;\n    if( ctx.default.length == 0 ) {\n      throw \"@syntax@Next without for\";\n    }\n    var varName = ctx.default[ctx.default.length-1];\n    if( nextVarName  != null ) {\n      varName = nextVarName;\n    }\n\n    var ctxv = ctx[varName];\n\n    this.vars[ varName ] += ctxv.step;\n    if( ctxv.step > 0) {\n      if(this.vars[ varName ]<=ctxv.to) {\n\n        return ctxv.jumpTo;\n      }\n    }\n    else if( ctxv.step == 0) {\n      return ctxv.jumpTo;\n    }\n    else {\n      if(this.vars[ varName ]>=ctxv.to) {\n        return ctxv.jumpTo;\n      }\n    }\n\n    ctx.default.pop();\n    return -1;\n  }\n\n  onLineStr() {\n\n    var line = this.retreiveLine();\n    if( line == -1 || line == \"\") { return \"\"; }\n\n    return \" in \" + line;\n\n  }\n\n  retreiveRuntimeLine() {\n    if( this.runPointer > -1 ) {\n      var line = this.program[this.runPointer];\n      return line[0];\n    }\n    return -1;\n  }\n\n\n  retreiveLine() {\n    if( this.runFlag ) {\n      return this.retreiveRuntimeLine();\n    }\n    else {\n      if( this[\"parseLineNumber\"] === undefined ) {\n        return -1;\n      }\n      if( this.parseLineNumber == -1) { return \"\"; }\n      return this.parseLineNumber;\n    }\n    return -1;\n  }\n\n\n  commandToString( cmd ) {\n    if( cmd.type == \"control\" )  {\n      return cmd.controlKW.toUpperCase();\n    }\n    else if( cmd.type == \"call\" ) {\n      return cmd.statementName;\n    }\n    else if( cmd.type == \"assignment\" )  {\n      return \"assign ->\" + cmd.var;\n    }\n    return \"????\";\n  }\n\n  runCommands( cmds, limit ) {\n    /* return values\n      false -> error or end program\n      true  -> executed ok\n\n      should return\n      end_w_error\n      terminate_program\n      line_finished\n      goto_gosub\n    */\n\n    var commands = this.commands;\n    var ecommands = this.extendedcommands;\n    var EXPR = 0, PAR = 1;\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n    var WAIT_SPECIFIC_TIME = 50;\n    var WAIT_SYNCH = 60;\n\n    var end = cmds.length;\n    var i=this.runPointer2;\n    var cnt=0;\n\n    if(!(limit == undefined )) {\n      //nothing\n    }\n    else {\n      limit = 9999; //reaching to infinite (max on line maybe  40)\n    }\n\n    while( i<end && cnt<limit ) {\n\n\n      var cmd=cmds[i];\n\n      var l=this.program[this.runPointer];\n      if( l ) {\n        if(parseInt(l[0]) == 3155 ) {\n          console.log(\"bump\");\n        }\n      }\n\n      if( cmd.type == \"control\" )  {\n        var cn = cmd.controlKW;\n        if( cn == \"goto\" ) {\n          this.goto( cmd.params[0] );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"end\" ) {\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"stop\" ) {\n          this.printInfo(\"break\");\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"gosub\" ) {\n          this.gosub( cmd.params[0], i );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"on\" ) {\n          var onCommand = cmd.params[ 0 ];\n\n          if( onCommand != \"interrupt0\"  && onCommand != \"interrupt1\" ) {\n            var onExpr = cmd.params[ 1 ];\n            var onLineNrs = cmd.params[ 2 ];\n\n            var value = this.evalExpression( onExpr );\n            if( (value-1)>=0 && (value-1)<onLineNrs.length ) {\n              if( onCommand == \"goto\" ) {\n                this.goto( onLineNrs[ (value-1) ] );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n              else if( onCommand == \"gosub\" ) {\n                this.gosub( onLineNrs[ (value-1) ], i );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n            }\n          }\n\n          //if not jumping, do nothing\n        }\n        else if( cn == \"return\" ) {\n\n          if( this.interruptFlag0 || this.interruptFlag1) {\n\n            this.doInterruptReturn();\n\n          }\n          else {\n            this.doReturn();\n          }\n\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"if\" ) {\n          var IF_ERROR = -1;\n          var IF_TRUE = 1;\n          var IF_FALSE = 0;\n\n          var ifresult = this.evalExpression( cmd.params[0] );\n          if( ifresult != IF_FALSE ) {\n             //return [MIDLINE_INTERUPT,i+1];\n          }\n          else  {\n             return [LINE_FINISHED,i+1,cnt+1];\n          }\n        }\n        else if( cn == \"data\" ) {\n          //Nothing\n        }\n        else if( cn == \"rem\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"sub\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"for:init\" ) {\n          this.doForInit( cmd.params[0], cmd.params[1], cmd.params[2], cmd.variable, i, cmds.length );\n        }\n        else if( cn == \"for:next\" ) {\n\n          var jump = this.doForNext( cmd.nextVar );\n\n          if( !(jump === -1 ) ) {\n\n            if( jump.line != -1 ) {\n                if( this.runPointer == jump.line ) {\n                  i = jump.cmdPointer;\n                  cnt++;\n                  continue;\n                }\n                else {\n                  this.runPointer = jump.line;\n                  this.runPointer2 = jump.cmdPointer;\n                }\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n            }\n            else {\n              i = jump.cmdPointer;\n              cnt++;\n              continue;\n            }\n          }\n        }\n        else if( cn == \"dim\" ) {\n          var vars = this.vars;\n\n          for( var ix=0; ix<cmd.params.length; ix++) {\n\n            var indices = [];\n            for( var ai=0;ai<cmd.params[ix].length;ai++){\n              indices[ai] = this.evalExpression( cmd.params[ix][ai] );\n            }\n\n            var arrRec = new BasicArray( cmd.arrayNames[ix], indices, 0 );\n\n            var varIntName = \"@array_\" + cmd.arrayNames[ix];\n\n            if( ! ( this.vars[ varIntName ] === undefined )) {\n              this.printError( \"redim'd array\" );\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ varIntName ] = arrRec;\n          }\n\n        }\n        else if( cn == \"def\" ) {\n          this.functions[ cmd.params[0] ] = {\n            par: cmd.params[1],\n            expr: cmd.params[2]\n          };\n        }\n        else {\n          this.printError( \"illegal ctrl token '\" + cn  +\"'\");\n          return [END_W_ERROR,i+1,cnt+1];\n        }\n      }\n      else if( cmd.type == \"call\" )  {\n        var values = [];\n        var pardefs = [];\n        var mycommands = commands;\n        var stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n        if( stc === undefined ) {\n          //cmd.statementName.toLowerCase().startsWith(\"x\") )\n          mycommands = ecommands;\n\n          stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n          if( stc === undefined ) { }\n          else {\n            if( mycommands.enabled == false &&\n              cmd.statementName.toLowerCase() != \"xon\") {\n                  this.printError( \"extended not enabled\" );\n                  return [END_W_ERROR,i+1,cnt+1];\n            }\n          }\n        }\n\n        var intf = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()];\n        if( !( intf === undefined ) ) {\n            pardefs = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()]();\n        }\n        else {\n          for( var j=0; j<cmd.params.length; j++) {\n            pardefs[j] = EXPR;\n          }\n        }\n\n        for( var j=0; j<cmd.params.length; j++) {\n          if( pardefs[j] == EXPR ) {\n\n            var p = this.evalExpression( cmd.params[j] );  //NOTE this one gets the trailing ;, from a \"PRINT ;\" command\n\n            if( p != null ) {\n              values.push( { type: \"value\", value: p } );\n            }\n          }\n          else if( pardefs[j] == PAR ) {\n            var varName = cmd.params[j].parts[0].data;\n            var varType0 = cmd.params[j].parts[0].type;\n\n            if( varType0 == \"array\" ) {\n\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType0 + \":\" + varType } );\n\n\n            }\n            else {\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType } );\n\n            }\n\n          }\n          else { /*RAW*/\n            //values.push( cmd.params[j].parts );\n            values.push( cmd.params[j] );\n\n          }\n        }\n        try {\n          //var stc = ;\n          if( stc === undefined ) {\n            this.printError(\"syntax\");\n            return [END_W_ERROR,i+1,cnt+1];\n          }\n          else {\n\n              this.inputCommand  = false;\n\n              mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()]( values );\n\n              if( this.inputFlag ) {  //}|| this.inputCommand ) {\n                return [PAUSE_F_INPUT,i+1,cnt+1];\n              }\n              else if ( this.isWaitingFlag )  {\n                return [WAIT_SPECIFIC_TIME,i+1,cnt+1];\n              }\n              else if ( this.isSynchingFlag )  {\n                return [WAIT_SYNCH,i+1,cnt+1];\n              }\n\n          }\n\n        }\n        catch ( e ) {\n          console.log(e);\n\n          if( this.erh.isSerializedError( e ) ) {\n            var err = this.erh.fromSerializedError( e );\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else if( this.erh.isError( e ) ) {\n            var err = e;\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else {\n            this.printError(\"unexpected \" + e );\n          }\n\n          return [END_W_ERROR,i+1,cnt];\n        }\n      }\n      else if( cmd.type == \"assignment\" )  {\n        if( cmd.arrayAssignment ) {\n          var varIntName = \"@array_\" + cmd.var;\n          if( this.vars[ varIntName ] === undefined ) {\n            this.printError(\"bad subscript\",false, false, \"No such Array\");\n            //printError( s, supressLine, explicitline, detail ) {\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var arr = this.vars[ varIntName ];\n          if( cmd.indices.length != arr.getIndexCount() ) {\n            this.printError(\"bad subscript\",false, false, \"Wrong dimensions\");\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var indices = [];\n          for( var ai=0;ai<cmd.indices.length;ai++){\n            indices[ai] = this.evalExpression( cmd.indices[ai] );\n          }\n\n          if( cmd.var.endsWith(\"%\") ) {\n              arr.set( indices, Math.floor( this.evalExpression( cmd.expression ) ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n          else {\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n\n        }\n        else { //single var (not an array)\n          if( this.vars[ cmd.var ] === undefined ) {\n            if(cmd.var.startsWith(\"TI\")) {\n              this.printError(\"syntax\");\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ cmd.var ] = 0;\n          }\n          if(cmd.var.endsWith(\"%\")) {\n            this.vars[ cmd.var ] = Math.floor( this.evalExpression( cmd.expression ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n          else {\n            this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n        }\n      }\n      //cnt++;\n      i++;\n      cnt++;\n    }\n\n    if( i== cmds.length ) {\n      return [LINE_FINISHED,i,cnt];\n    }\n\n    return [MIDLINE_INTERUPT,i,cnt];\n\n  }\n\n  newScope( name, data ) {\n    var scope = { name: name, vars: {}, data: data };\n    this.scopes.push( scope );\n    this.vars = scope.vars;\n    this.scope = scope;\n  }\n\n  closeScope() {\n    this.scopes.pop();\n    this.vars = this.scopes[ this.scopes.length - 1 ].vars;\n  }\n\n\n  getArray( a ) {\n   return this.vars[  \"@array_\" + a ];\n  }\n\n  setVar( a, b ) {\n    this.vars[ a ] = b;\n  }\n\n  getTraceList() {\n    if( this.traceList === undefined ) {\n      return [];\n    }\n\n    return this.traceList;\n  }\n\n  setTraceVar( v ) {\n    if( this.traceVars === undefined ) {\n        this.traceVars = [];\n    }\n    this.traceVars.push( v.toUpperCase() );\n\n  }\n\n  resetTraceVar( v ) {\n    this.traceVars = undefined;\n  }\n\n\n  old( ) {\n    this.program = this.oldProgram;\n  }\n\n  new( ) {\n    this.oldProgram = this.program ;\n    this.program = [];\n  }\n\n  removePgmLine( linenr ) {\n\n    var pgm2 = [];\n\n    for( var i=0; i<this.program.length; i++) {\n      var pl=this.program[i];\n      if( pl[0] != linenr ) {\n        pgm2.push(pl);\n      }\n    }\n    this.program = pgm2;\n\n  }\n\n\n  padSpaces6( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<6; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n  padSpaces8( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<8; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n\n  insertPgmLine( linenr, commands, handlers, raw ) {\n\n    this.insertPgmLineLocal( linenr, commands, handlers, raw, this.program );\n  }\n\n  insertPgmLineLocal( linenr, commands, handlers, raw, myProgram ) {\n\n    for( var i=0; i<myProgram.length; i++) {\n      var pl=myProgram[i];\n      if( pl[0] == linenr ) {\n        myProgram[i] = [linenr, commands, raw.trim() ];\n        return;\n      }\n    }\n\n    myProgram.push( [linenr, commands, raw.trim(), handlers ]);\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    myProgram.sort( sortF );\n\n  }\n\n  textLinesToBas( lines ) {\n\n    var myProgram = [];\n    var exception = undefined;\n\n    if( this.debugFlag ) {\n      console.log( \"textLinesToBas\" );\n    }\n    for( var i = 0; i<lines.length; i++ ) {\n\n      var line = this.prepareLineForImport( lines[ i ] );\n      var p = new Parser( this.commands, this.extendedcommands );\n      p.init();\n\n      var l = null;\n\n      try {\n          l = p.parseLine( line );\n      }\n      catch ( e ) {\n        if( exception === undefined ) {\n            exception = e;\n        }\n\n        try {\n          l = p.parseErrorLine( line );\n        }\n        catch ( e ) {\n            this.printError( \"unexpected text (at \"+i+\")\", true );\n            console.log(\"Illegal Line: \", line );\n        }\n      }\n\n      if( l == null ) {\n        continue;\n      }\n      if( l.lineNumber != -1 ) {\n        if( l.commands.length > 0) {\n          this.insertPgmLineLocal( l.lineNumber, l.commands, l.handlers, l.raw,  myProgram);\n          //this.program[ l.lineNumber ] = [l.commands,l.raw];\n        }\n        else {\n          throw \"Error, no commands on line \" + l.lineNumber;\n        }\n      }\n      else {\n        throw \"Error, command must start with number to be part of program\";\n      }\n\n      if( this.debugFlag ) {\n        console.log(\"program:\",myProgram);\n        console.log(\"Line: \", l );\n      }\n    }\n    return { pgm: myProgram, exception: exception };\n  }\n\n  printReady() {\n    this.printLine(\"Ready.\");\n  }\n\n\n  startConsoleDataInput( vars ) {\n\n    if( this.debugFlag ) {\n      console.log(\"inputvars=\",vars);\n    }\n    this.inputFlag = true;\n    this.inputVars = vars;\n    this.input.setInterActive( true);\n    this.inputVarsPointer = 0;\n    this.output.write( \"? \");\n    this.inputStartInputPosX = this.output.getCursorPos()[0];\n\n    this.flagStatusChange();\n\n  }\n\n  executeInteractiveLine( str ) {\n    this.handleLineInput( str, false );\n  }\n\n  handleLineInput( str, isInputCommand ) {\n\n    if( this.debugFlag ) {\n      console.log(\"handleLineInput: start debug / isInputCommand=\" + isInputCommand + \" -------------\");\n    }\n\n    if( isInputCommand ) {\n\n        var input=str;\n        var qMark = input.indexOf(\"?\");\n        while( qMark > -1 ) {\n          input = input.substr(qMark+2);\n          qMark = input.indexOf(\"?\");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: start debug / input, name -------------\");\n          console.log( \"InputVarsPointer:\" , this.inputVarsPointer );\n          console.log( \"InputVars:\" , this.inputVars );\n\n          console.log( \"Input String:\" ,input );\n          console.log( \"Input Vars[current]:\" ,this.inputVars[ this.inputVarsPointer ] );\n        }\n\n\n        var vName = this.inputVars[ this.inputVarsPointer ];\n        if( vName.indexOf(\"$\") >-1 ) {\n            this.setVar( this.inputVars[ this.inputVarsPointer ], input.trim() );\n        }\n        else {\n          var num = parseFloat( input.trim() );\n\n          if( isNaN( num ) ) {\n            this.printLine(\"?redo from start\");\n            this.printChar( \"? \");\n            return;\n          }\n          this.setVar( this.inputVars[ this.inputVarsPointer ], num );\n        }\n\n        this.inputVarsPointer++;\n        if( this.inputVarsPointer >= this.inputVars.length ) {\n\n          this.exitInputState();\n        }\n        else {\n          this.printChar( \"?? \");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: end debug -------------\");\n        }\n        return;\n    }\n\n    this.executeLineFlag = true;\n\n    if( this.debugFlag ) {\n      console.log( str );\n    }\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    try {\n      var l = p.parseLine( str );\n    }\n    catch( e ) {\n\n      this.parseLineNumber = -1;\n      if( this.erh.isError( e ) ) {\n        this.parseLineNumber = e.lineNr;\n        this.printError( e.clazz, true, undefined, e.detail );\n      }\n      else {\n        this.printError( \"syntax\", true );\n      }\n      this.printReady();\n    }\n    if( l == null ) {\n      if( this.debugFlag ) {\n        console.log(\"handleLineInput: end debug -------------\");\n      }\n\n      this.executeLineFlag = false;\n      return;\n    }\n\n    if( l.lineNumber != -1 ) {\n      if( l.commands.length > 0) {\n        this.insertPgmLine( l.lineNumber, l.commands, l.handlers, l.raw);\n      }\n      else {\n        this.removePgmLine( l.lineNumber  );\n      }\n    }\n    else {\n      this.runPointer = -1;\n      this.runPointer2 = 0;\n\n      try {\n        this.runCommands( l.commands );\n      }\n      catch( e ) {\n\n        this.parseLineNumber = -1;\n\n        if( this.erh.isSerializedError( e ) ) {\n          var err = this.erh.fromSerializedError( e );\n          this.parseLineNumber = err.lineNr;\n          this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else if( this.erh.isError( e ) ) {\n          var err = e;\n          this.printError( err.clazz );\n          this.parseLineNumber = err.lineNr;\n        }\n        else {\n          this.printError(\"unexpected \" + e );\n        }\n\n        this.runFlag = false;\n      }\n\n      if( ! this.runFlag && ! this.listFlag && !this.waitForMessageFlag) {\n        this.printReady();\n      }\n\n    }\n\n    this.executeLineFlag = false;\n\n    if( this.debugFlag ) {\n      console.log(\"program:\",this.program);\n      console.log(\"Line: \", l );\n\n      console.log(\"handleLineInput: end debug -------------\");\n    }\n  }\n\n}\n\n//--EOC \n\n// ## extendedcommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/extendedcommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/extendedcommands.js\n\nclass ExtendedCommands {\n\n  constructor( basicCmds, runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.playfields = runtime.playfields;\n    this.audio = runtime.audio;\n    this.html = runtime.html;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n    this.basicCmds = basicCmds;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n\n  getAllCategories() {\n    var categoryIndexes = this.basicCmds.getCategories();\n    var categoryIndexes2 = this.getCategories( categoryIndexes );\n\n    return new CommandHelp().getCategoriesNormalize( categoryIndexes2 );\n  }\n\n  getCategories( categoryIndexes ) {\n\n    return new CommandHelp().getCategoriesIntermediate( categoryIndexes, this );\n\n  }\n\n\n\n  /************************ commands ************************/\n\n\n  _stat_info_help() { return \"general:Show help on commands:[<Help Category Index>]\"; }\n\n  _stat_help( pars ) {\n\n  this.output.writeln(\"\");\n  var catRecord = this.getAllCategories();\n  var lst = catRecord[0];\n  var catLists = catRecord[1];\n  var hlpctx = 1000;\n\n  if( pars.length == 1 ) {\n    hlpctx = pars[0].value;\n  }\n\n  if( hlpctx == 1000 ) {\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help Categories:\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      this.output.writeln( i + \" \" + lst[i].toUpperCase() );\n    }\n  }\n  else {\n\n    var lbl = lst[ hlpctx ];\n    lst = catLists[ lbl ];\n    if(lst === undefined ) {\n      this.erh.throwError( \"invalid help index\" );\n    }\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help on Category: \\\"\" + lbl.toUpperCase() + \"\\\"\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      //this.context.printLine( ((hlpctx * 100) + i) + \" \" + lst[i] );\n      var attr = lst[i].attribs;\n      var padLen = 11-lst[i].name.length;\n      var pad = \"               \".substr(0,padLen );\n\n\n      if( attr.description ) {\n          this.output.writeln( \" \" + lst[i].name  + pad + \" ; \" + attr.description );\n      }\n      else {\n          this.output.writeln( \" \" + lst[i].name  );\n      }\n      if( attr.input ) {\n        var lines = attr.input.split(\"\\n\");\n\n        this.output.writeln( \"               input : \" + lines[0] );\n        for( var l=1; l<lines.length; l++) {\n            var line = lines[ l ];\n\n            this.output.writeln( \"                       \" + line );\n          }\n          this.output.writeln( \"\" );\n        }\n\n        if( attr.output ) {\n          var lines = attr.output.split(\"\\n\");\n\n          this.output.writeln( \"               output : \" + lines[0] );\n          for( var l=1; l<lines.length; l++) {\n              var line = lines[ l ];\n\n              this.output.writeln( \"                       \" + line );\n            }\n            this.output.writeln( \"\" );\n        }\n      }\n    }\n  this.output.writeln(\"\");\n\n  }\n\n  _if_cls() {\n    var EXPR = 0, PAR = 1, RAW=2;\n    return [RAW];\n  }\n\n  _stat_info_cls() { return \"general:Clears the screen:[<ResetScreenFlag>]\"; }\n\n  _stat_cls( pars ) {\n    var reset = false;\n\n    if( pars.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length == 1 ) {\n      if( pars[0].parts[0].data.toUpperCase() == \"RESET\" ) {\n          reset = true;\n      }\n      else {\n        throw \"parameters\";\n      }\n    }\n\n    if( reset ) {\n      this.output.control( 12 );\n    }\n    else {\n      this.output.control( 24 );\n    }\n  }\n\n  _stat_info_reset() { return \"general:Resets the audio and the terminal:[ <Mode> (0=screen, 1=audio, 2=all) ]\"; }\n  _stat_reset( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.reset();\n      this.audio.reset();\n      this.runtime.resetTraceVar();\n      return;\n    }\n\n    var mode = pars[0].value;\n\n    if( mode != 0 && mode != 1 && mode != 2 ) {\n      this.erh.throwError( \"mode\", \"only 0, 1, 2 supported\" );\n      return\n    }\n\n    if( mode == 0) {\n      this.output.reset();\n    }\n    if( mode == 1) {\n      this.audio.reset();\n    }\n    else  {\n      this.output.reset();\n      this.audio.reset();\n    }\n\n  }\n\n\n  _stat_info_menu() { return \"general:Enable the programmers menu\"; }\n  _stat_menu( pars ) {\n\n    if( pars.length == 0 ) {\n      this.runtime.toggleMenu();\n      return;\n    }\n\n  }\n\n  _stat_info_reverse() { return \"print:Reverse the print output:<ReverseFlag>\"; }\n\n  _stat_reverse( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.control( 65 );\n      return;\n    }\n\n    var reverse = pars[0].value;\n    if( reverse <0 || reverse >1 ) {\n      return;\n    }\n\n    this.output.control( 64 + reverse );\n  }\n\n  _stat_info_beep() { return \"sound:Make a short sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_beep( pars ) {\n\n\n    if( pars.length == 0 ) {\n      this.audio.playBeep( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playBeep( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n\n  _stat_info_sound() { return \"sound:Make a pre defined sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_sound( pars ) {\n\n    if( pars.length == 0 ) {\n      this.audio.playSound( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playSound( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n  _stat_info_setadr() { return \"sound:Define Attach,Decay and Release:<Channel>, <AttackT>, <decayT>, <releaseT>\"; }\n  _stat_setadr( pars ) {\n\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, attackT, decayT, releaseT\" );\n      return\n    }\n\n    this.audio.attackDecayRelease(\n       pars[0].value,\n       pars[1].value,\n       pars[2].value,\n       pars[3].value\n      );\n\n  }\n\n  _stat_info_volume() { return \"sound:Change the audio volume:<Volume>\"; }\n  _stat_volume( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected volume\" );\n      return\n    }\n\n    this.audio.volume( pars[0].value );\n\n  }\n\n  _stat_info_chfreq() { return \"sound:Change the channel audio frequency:<Channel, Frequency>\"; }\n  _stat_chfreq( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, frequency\" );\n      return\n    }\n\n    this.audio.channelFrequency( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chvolume() { return \"sound:Change the channel audio volume:<Channel>, <Volume>\"; }\n  _stat_chvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chsvolume() { return \"sound:Change the channel sustain volume:<Channel>, <Volume>\"; }\n  _stat_chsvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelSustainVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_addfx() { return \"sound:Add a Sound FX part to the channel:<Channel>, <Type>, <Value>, <Time>\"; }\n  _stat_addfx( pars ) {\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, type, value and time(ms)\" );\n      return\n    }\n\n    this.audio.addEffect(\n        pars[0].value,\n        pars[1].value,\n        pars[2].value,\n        pars[3].value\n       );\n\n  }\n\n  _stat_info_clearfx() { return \"sound:Clear a sound effect:<Channel>\"; }\n  _stat_clearfx( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected channel\" );\n      return\n    }\n\n    this.audio.clearEffect( pars[0].value  );\n\n  }\n\n  _stat_info_playfx() { return \"sound:Change the channel sustain volume:<Channel> [,<Frequency> ]\"; }\n  _stat_playfx( pars ) {\n\n    if( pars.length < 1 || pars.length >2 ) {\n      this.erh.throwError( \"parameter count\", \"expected <Channel> [,<Frequency> ]\" );\n      return\n    }\n\n    var freq = 0;\n    if( pars.length >1 ) {\n      freq = pars[1].value;\n    }\n\n    this.audio.playEffect( pars[0].value, freq );\n\n  }\n\n\n  _stat_info_textarea() { return \"print:Limit text to certain area: <CollSize>,<RowSize>\\n [,<xOffset>,<yOffset>]\"; }\n  _stat_textarea( pars ) {\n\n    var result;\n\n    if( pars.length != 2 && pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected cols, rows [, xoffset, yoffset ]\" );\n      return\n    }\n\n    var cols = Math.round( pars[0].value );\n    var rows = Math.round( pars[1].value );\n\n    var wh = this.output.getDimensions();\n\n    var xo, yo;\n    xo = -1, yo = -1;\n    if( pars.length == 4) {\n      var xo = Math.round( pars[2].value );\n      var yo = Math.round( pars[3].value );\n    }\n\n    if( cols > 0 && rows > 0  && cols <= wh[0] && rows <= wh[1] ) {\n\n        var divx = wh[0] - cols;\n        var divy = wh[1] - rows;\n\n        if( xo > 0 && xo > divx ) {\n          this.erh.throwError( \"parameter\", \"xo to big\");\n        }\n        if( yo > 0 && yo > divy ) {\n          this.erh.throwError( \"parameter\", \"yo to big\");\n        }\n\n        this.output.textArea(  cols, rows, xo, yo );\n\n        return\n    }\n\n  }\n\n  _stat_info_gcolor() { return \"graphics:Set graphics pen color index:<Color Index>\"; }\n  _stat_gcolor( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected color\" );\n      return\n    }\n\n    if( pars.length == 1) {\n        var col = Math.round( pars[0].value );\n        if( col > 0 && col < 32) {\n            this.bitmap.setLineColor(  col );\n        }\n        return\n    }\n\n  }\n\n  _stat_info_fcolor() { return \"graphics:Set graphics fill color index:<Color Index>\"; }\n  _stat_fcolor( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected color\" );\n      return\n    }\n\n    if( pars.length == 1) {\n        var col = Math.round( pars[0].value );\n        if( col > 0 && col < 32) {\n            this.bitmap.setFillColor(  col );\n        }\n        return\n    }\n\n  }\n\n  _stat_info_origin() { return \"graphics:Specify origin of graphics console:<X0>,<Y0>,<Dx>,<Dy>\"; }\n  _stat_origin( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 4 (x0,y0,dx,dy), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    if( pars[2].value != 1 && pars[2].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dx must be 1 or -1\" );\n      return;\n    }\n\n    if( pars[3].value != 1 && pars[3].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dy must be 1 or -1\" );\n      return;\n    }\n\n    this.bitmap.origin(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_line() { return \"graphics:Draw a line:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_line( pars ) {\n    if( pars.length != 4 && pars.length != 2 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 or 4 ([x0,y0,] y1,y1), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    if( pars.length == 2 ) {\n\n      this.bitmap.line(\n        undefined, undefined,\n        pars[0].value,\n        pars[1].value\n      );\n      return;\n    }\n\n    this.bitmap.line(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_box() { return \"graphics:Draw a filled rectangle:<X>,<Y>,<W>,<H>\"; }\n  _stat_box( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 4 (x,y,w,h), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.fillRect(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_plot() { return \"graphics:Plot a pixel:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_plot( pars ) {\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 (x,y), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.plot( pars[0].value, pars[1].value );\n  }\n\n  \n_if_center() {\n    var EXPR = 0, PAR = 1, RAW=2;\n    return [RAW];\n}\n\nisNumber(value) {\n  return typeof value === 'number' && isFinite(value);\n}\n\nnormalizeIfNumber( x )  {\n  if( this.isNumber( x ) ) {\n    if ( x >= 0 ) {\n      return \" \" + x;\n    }\n  }\n  return \"\" + x;\n}\n\n\n  _stat_info_center() { return \"print:Print center text or values to the console:<Value>[;<Value>][;]\"; }\n  _stat_center( pars ) {\n\n    var runtime = this.runtime;\n    var con= this.output;\n\n    if( pars.length == 0 ) {\n      con.nl();\n      return;\n    }\n    else if( pars.length == 1 ) {\n      if( pars[0].parts.length == 0 ) {\n        con.nl();\n        return;\n      }\n    }\n\n    var newLine = true;\n    var value;\n    for( var i=0; i<pars.length; i++) {\n\n      newLine = true;\n      if( i<(pars.length-1)) {\n        newLine = false;\n      }\n\n      if( i>0) {\n        con.write( \"         \" );\n      }\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \";\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              //console.log( \"i=\"+i+\" newline: set to false\");\n          newLine = false;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n\n      value = runtime.evalExpression( exparts2 );\n\n      if( i == 0) {\n        //this.output.center( string, inhibitNL );\n        con.center( this.normalizeIfNumber( value ), true );\n      }\n      else {\n        con.center( \"\" + value , true);\n      }\n      if( newLine ) { con.nl(); runtime.setWaiting( 1 ); }\n\n    }\n\n  }\n\n\n  _stat_info_gtext() { return \"experimental:Write text at position x,y:<X>,<Y>,<Text>\"; }\n  _stat_gtext( pars ) {\n\n    var string;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected x,y and text parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.gtext( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n\n\n\n\n  _stat_info_pokeccl() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>,<FGColor>,<BGColor>\"; }\n  _stat_pokeccl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length < 3 ) {\n      this.erh.throwError( \"parameters\", \"expected at least 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    var fg = undefined;\n    var bg = undefined;\n\n    if( pars.length >= 4 ) { fg = pars[3].value; }\n    if( pars.length >= 5 ) { bg = pars[4].value; }\n    this.output.pokeccl( pars[0].value, pars[1].value, pars[2].value, fg, bg );\n  }\n\n  _stat_info_pokec() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>\"; }\n  _stat_pokec( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokec( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n  _stat_info_pokecl() { return \"poke:Put color directly into the screen buffer:<X>,<Y>,<FGColor>[,<BGColor>]\"; }\n  _stat_pokecl( pars ) {\n\n    var row = -1, col = -1;\n    var bg = undefined;\n\n    if( pars.length != 3 &&  pars.length != 4 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 or 4 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 4 ) {\n      bg = pars[3].value;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, pars[2].value, bg );\n  }\n\n  _stat_info_pokebcl() { return \"poke:Put background color directly into the screen buffer:<Y>,<X>,<BGColor>\"; }\n  _stat_pokebcl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, undefined, pars[2].value );\n  }\n\n\n  _int_checkPlayfieldNo( no ) {\n\n    if( no != 0 && \n        no != 1 &&\n        no != 2 &&\n        no != 3 &&\n        no != 4 &&\n        no != 5 \n         ) {\n      this.erh.throwError( \"parameters\", \"Value must be 0,1,2,3,4 or 5\" );\n      return;\n    }\n  }\n\n\n\n _stat_info_pfinit() { \n      return  \"playfield:(re)Initialize of playfield buffer: <pfIndex>, <Cols>, <Rows>\"; \n    }\n\n  _stat_pfinit( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.init( \n        this.runtime.processId,\n        pars[0].value, \n        0,0, \n        pars[1].value, pars[2].value,\n        pars[1].value, pars[2].value \n    );\n\n    this.runtime.startWaitForMessage( \"pfinit\" )\n  }\n\n  _stat_info_playfield() { return \"playfield:Select current playfield:<Nr> ; 0 to 3\"; }\n  _stat_playfield( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 1 ) {\n      this.erh.throwError( \"parameters\", \"expected 1 parameter, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.select( \n              this.runtime.processId,\n              pars[0].value );\n    this.runtime.startWaitForMessage( \"pfselect\" );\n  }\n\n  _stat_info_pfscroll() { \n      return  \"playfield:Set scroll pos of playfield view: <pfIndex>, <sX>, <sY>\"; \n    }\n\n  _stat_pfscroll( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.scrollpos( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value, pars[2].value\n    );\n\n  }\n\n  _stat_info_pfview() { \n      return  \"playfield:Initialize size of playfield view: <pfIndex>, <X>, <Y>, <W>, <H>\"; \n    }\n\n  _stat_pfview( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 5 ) {\n      this.erh.throwError( \"parameters\", \"expected 5 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.viewdefine( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value, pars[2].value,\n        pars[3].value, pars[4].value\n    );\n\n  }\n\n\n \n\n\n  _stat_info_pfenable() { \n      return  \"playfield:Enable  a playfield to be visible: <pfIndex>, <OnOfFlag>\"; \n    }\n\n  _stat_pfenable( pars ) {\n\n    if( !this.playfields.enabled() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode does not have playfields\" );\n      return;\n    }\n\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 parameters, not \" + pars.length );\n      return;\n    }\n\n    this._int_checkPlayfieldNo( pars[0].value );\n\n    this.playfields.setEnable( \n        this.runtime.processId,\n        pars[0].value, \n        pars[1].value\n    );\n\n  }\n\n  _stat_info_locate() { return \"print:Set the cursor position:<Y>,<X>\"; }\n  _stat_locate( pars ) {\n\n    var row = undefined, col = undefined;\n\n    if( pars.length > 2 ) {\n      this.erh.throwError( \"too many parameters\", \"expected max 2, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    if( pars.length >= 1 ) {\n      row = pars[0].value;\n    }\n\n    if( pars.length >= 2 ) {\n      col = pars[1].value;\n    }\n\n    this.output.setCursorPos( col, row );\n  }\n\n  _stat_info_hide() { return \"general:Hide the terminal\"; }\n  _stat_hide( pars ) {\n    this.output.control( 25 );\n  }\n\n\n  _if_html() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_html() { return \"html:Unsupported command\"; }\n  _stat_html( pars ) {\n    var html = this.html;\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    var newLine = true;\n    var value;\n    var contentIx = 0;\n    var handleIx = -1;\n    var htmlHandle = null;\n    var htmlValue = \"\";\n    var htmlAppend = false;\n\n    if( pars.length == 2) {\n      contentIx = 1;\n      handleIx = 0;\n    }\n\n    for( var i=0; i<pars.length && i<2; i++) {\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \"+\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              htmlAppend = true;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n      value = this.runtime.evalExpression( exparts2 );\n\n      if( i == handleIx ) {\n        htmlHandle =  value;\n      }\n      else {\n        htmlValue = value;\n      }\n    }\n\n    this.html.html(\n        {\n          htmlHandle: htmlHandle,\n          htmlValue: htmlValue,\n          htmlAppend: htmlAppend\n        }\n      );\n  }\n\n  _stat_info_htmlnode() { return \"html:Unsupported command\"; }\n  _stat_htmlnode( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var node = pars[0];\n\n    this.html.htmlnode( node );\n\n  }\n\n\n  _stat_info_htmlbg() { return \"html:Unsupported command\"; }\n  _stat_htmlbg( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var url = pars[0].value;\n\n    this.html.executeFunction( \"body.style.backgroundImage\", url );\n\n  }\n\n  _stat_info_color() { return \"print:Sets the console color index:<PenColor>[, <PaperColor>\\n[, <BorderColor>]]\"; }\n  _stat_color( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length == 1) {\n        var col = pars[0].value;\n        this.output.control( 16, col );\n        return\n    }\n\n    var bgcol = pars[1].value;\n    var col = pars[0].value;\n    this.output.control( 16, col   );\n    this.output.control( 17, bgcol );\n\n    if( pars.length == 3) {\n        var border = pars[2].value;\n        this.output.control( 18, border );\n        return\n    }\n\n  }\n\n  _stat_info_display() { return \"general:Set the console display mode:<DisplayModeNumber>\"; }\n  _stat_display( pars ) {\n\n    var result;\n    var modes = this.sys.screenModes;\n\n    if( pars.length == 0) {\n\n        var list = [ ];\n\n\n        for( var i=0 ; i<modes.length ; i++) {\n          if( modes[ i] ) {\n            list.push( i + \":   \" + modes[i]);\n          }\n        }\n        //list.push( \"Current Mode: \" + this.sys.displayMode );\n\n        this.runtime.enterListMode( list );\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many variables\", \"expected one parameter only\" );\n    }\n\n    var mode = pars[0].value;\n    if( modes[mode] === undefined ) {\n      this.erh.throwError( \"Invalid mode\", \"No such display mode\" );\n    }\n    this.sys.setDisplayMode( this.runtime, mode );\n    this.sys.blinkMode( !this.runtime.isRunning() );\n    this.runtime.flagStatusChange();\n    this.runtime.startWaitForMessage( \"displaysize\" )\n\n\n  }\n\n\n  _stat_info_gfilter() { return \"experimental:Add a html filter to the display:<FilterString>\"; }\n  _stat_gfilter( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n        this.erh.throwError( \"too many variables\", \"expected one parameter only\" );\n    }\n\n    var filter = pars[0].value;\n   \n    this.output.setFilter( filter );\n\n  }\n\n  _stat_info_border() { return \"general:Changes the border color:<ColorIndex>\"; }\n  _stat_border( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many parameters\", \"expected one parameter only\" );\n    }\n\n    var bcol = pars[0].value;\n    this.output.control( 18, bcol );\n\n  }\n\n  _stat_info_export() { return \"program:Export program for download\"; }\n  _stat_export( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"export needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"disk\" );\n  }\n\n  _stat_info_copy() { return \"program:Copy program to clipboard\"; }\n  _stat_copy( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"copy needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"clipboard\" );\n    this.runtime.printLine(\"Copied \" + this.runtime.getProgramSize() + \" program lines to the clipboard\" );\n  }\n\n\n  _stat_info_txtcopy() { return \"experimental:Copy data to clipboard:<StringData$>\"; }\n  _stat_txtcopy( pars ) {\n    if( pars.length != 1) {\n        this.erh.throwError( \"parameter count\", \"dcopy needs 1 parameter\" );\n    }\n\n    this.sys.export( pars[0].value + \"\", \"clipboard\" );\n\n  }\n\n\n\n  _fun_info_peekcl() { return \"poke:Get color information directly from from screen buffer:<Y>,<X>[,<Mode]\"; }\n  _fun_peekcl( pars ) {\n\n    var row = -1, col = -1;\n    var mode = 0;\n\n    if( pars.length != 3  && pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 or 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 3 ) {\n      mode = pars[2].value;\n    }\n    return this.output.peekcl( pars[0].value, pars[1].value, mode );\n  }\n\n\n  _fun_info_peekc() { return \"poke:Get a character directly into from screen buffer:<Y>,<X>\"; }\n  _fun_peekc( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 parameters, not \" + pars.length );\n      return;\n    }\n\n    return this.output.peekc( pars[0].value, pars[1].value );\n  }\n\n\n  _fun_info_ucbase() { return \"string:Return unicode-set base character code:<SetName$>\"; }\n  _fun_ucbase( pars ) {\n\n    if( pars.length != 1 ) {\n      this.erh.throwError( \"parameters\", \"UCBASE() needs one parameter\" );\n    }\n\n    var baseLabel = pars[0].value;\n\n    if( baseLabel.toLowerCase() == \"box\" ) {\n      return parseInt( \"2500\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"blocks\" ) {\n      return parseInt( \"2580\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"symbol\" ) {\n      return parseInt( \"2b00\", 16 ); //can be too wide\n    }\n    else if( baseLabel.toLowerCase() == \"legacy\" ) {\n      return parseInt( \"1fb00\", 16 );\n    }\n    return 0;\n  }\n\n  _fun_info_uc_DLR_() { return \"string:Create unicode character:<UnicodeHexCode$>\"; }\n  _fun_uc_DLR_( pars ) {\n\n    if( pars[0].value ) {\n      if( typeof pars[0].value == \"string\" ) {\n          return String.fromCodePoint( parseInt( pars[0].value, 16 ) );\n      }\n      return String.fromCodePoint( pars[0].value);\n    }\n    return \"?\";\n  }\n\n  _fun_info_dc_DLR_() { return \"print:Return device control char. sequence:<Parameter1>, <Parameter2>\"; }\n  _fun_dc_DLR_( pars ) {\n\n    var val = \"\";\n\n    val = String.fromCodePoint( 17 ) + String.fromCodePoint( pars[0].value) + String.fromCodePoint( pars[1].value);\n\n    return val;\n  }\n\n  _fun_info_html_DLR_() { return \"html:Unsupported function\"; }\n  _fun_html_DLR_( pars ) {\n    return\n      this.html.get();\n  }\n\n\n  _fun_info_width() { return \"general:Return the console width in pixels\"; }\n  _fun_width( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_height() { return \"general:Return the console height in pixels\"; }\n  _fun_height( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[1];\n  }\n\n  _fun_info_cols()  { return \"print:Return the console width in columns\"; }\n  _fun_cols( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"cols() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_columns() { return \"print:Return the console width in columns\"; }\n  _fun_columns( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"columns() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_rows() { return \"print:Return the console height in rows\"; }\n  _fun_rows( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"rows() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[1];\n  }\n\n}\n\n//--EOC \n\n// ## pgmmanager.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/pgmmanager.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/pgmmanager.js\n\nclass BasicProgramManager {\n\n  constructor() {\n    this.rt = [];\n  }\n\n  addRuntime = function( ctx ) {\n\n    this.rt.push( ctx );\n\n  }\n\n}\n\nvar pgmman = new BasicProgramManager();\n\n//--EOC \n\n// ## basiccommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basiccommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basiccommands.js\n\nclass BasicCommands {\n\n  constructor( runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n    this.keyLabelCodes = {};\n\n    this.randnrs = [];\n    for(var i=0; i<10000;i++) {\n      this.randnrs.push( Math.random() );\n    }\n    this.randIndex = 0;\n    this.randStep = 1;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getCategories() {\n\n    return new CommandHelp().getCategoriesIntermediate( [{},{}], this );\n\n  }\n\n\n  /************************ commands ************************/\n\n  _stat_info_new() { return \"program:Delete the current program from memory:\"; }\n  _stat_new( pars ) {\n\n    this.runtime.new();\n  }\n\n  _stat_info_list() { return \"program:List the basic program\"; }\n  _stat_list( pars ) {\n\n    var start = 0;\n    var end   = 999999;\n    var parts = [];\n\n    var mode = \"noparam\";\n\n    if( pars.length==1 ) {\n      parts = pars[0].parts;\n    }\n\n    if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data >=0 ) {\n      start = parts[0].data;\n      end = parts[0].data;\n    }\n    else if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data <0 ) {\n      /*NOTE, this will stop working if RAW changes to return uniop + posnum */\n      end = -parts[0].data;\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"num\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n      end = parts[1].data;\n\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"uniop\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n    }\n\n    var runtime = this.runtime;\n    var list = [];\n    for (const l of runtime.program)\n      {\n\n        var lineNr = parseInt(l[0]);\n        if(  l[0] == null || (lineNr>= start && lineNr<= end) ) {\n          if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n              list.push( \"\" );\n          }\n          list.push( l[2] );\n        }\n      }\n\n      this.runtime.enterListMode( list );\n  }\n\n\n  _if_get() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_getkey() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_read() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_input() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW];\n  }\n\n  _if_list() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _if_run() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_read() { return \"io:Read a value from the data::<Data$ or Data>\"; }\n  _stat_read( pars ) {\n    var p0 = pars[ 0 ];\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var data = this.runtime.readData();\n    if( data === undefined ) { this.erh.throwError( \"out of data\" ); }\n\n    if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"string\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"string\" ) {\n\n          data = parseInt ( data );\n\n          if( isNaN( data ) ) {\n            this.erh.throwError( \"expected number\" );\n          }\n          this.runtime.setVar(\n            p0.value, data );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  \"\" + data  );\n    }\n\n  }\n\n  _stat_info_get() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_get( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\"); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, \"???\" );\n      }\n    }\n\n    this.runtime.flagInputCommand();\n  }\n\n  _stat_info_getkey() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_getkey( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\" ); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, k.keyLabel );\n      }\n    }\n\n    this.runtime.flagInputCommand();\n  }\n\n  _stat_info_input() { return \"io:Waits for the user to type in a value::<Value>\"; }\n  _stat_input( pars ) {\n\n    var vars = [];\n    var con = this.output;\n\n    for( var i=0; i<pars.length; i++) {\n      if( i == 0 ) {\n        var par = pars[0];\n\n        if( par.parts.length == 2 ) {\n          if( par.parts[0].type == \"str\" ) {\n            con.write( par.parts[0].data );\n            if( par.parts[1].type == \"var\" && par.parts[1].op == \";\" ) {\n              vars.push( par.parts[1].data );\n            }\n          }\n        }\n        else if( par.parts.length == 1 ) {\n          vars.push( par.parts[0].data );\n        }\n\n      }\n      else {\n        sys.log( \"PARS[\"+i+\"]\", pars[i] );\n        if( pars[i].parts[0].type != \"var\" ) {\n\n          this.erh.throwError( \"not a var\", \"parameter \" + i);\n        }\n        vars.push( pars[i].parts[0].data );\n      }\n    }\n\n    this.runtime.startConsoleDataInput( vars );\n\n  }\n\n  _stat_info_restore() { return \"io:Set the READ-pointer, to the beginning:\"; }\n  _stat_restore( pars ) {\n    this.runtime.restoreDataPtr();\n  }\n\n  _stat_info_waitms() { return \"program:Wait a certain time:<MilliSeconds>\"; }\n  _stat_waitms( pars ) {\n    this.runtime.setWaiting( pars[0].value );\n  }\n\n  _stat_info_rsynch() { return \"program:Synch with the renderer thread\"; }\n  _stat_rsynch( pars ) {\n    //sys.log( \"CMDS.Synch\" );\n    this.runtime.enableSynching();\n  }\n\n  \n\n  _stat_info_load() { return \"program:Load a program in memory:<FileName>\"; }\n  _stat_load( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \\\"\" + pars[0].value + \"\\\"\" );\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", false, -1 );\n    }\n    else {\n      if( pars.length == 1) {\n        result = runtime.load( pars[0].value, false, -1 );\n      }\n      else if( pars.length == 2) {\n        result = runtime.load( pars[0].value, false, pars[1].value );\n      }\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_setdata() { return \"experimental:Set data pointer:[<Label>]\"; }\n  _stat_setdata( pars ) {\n\n    var runtime = this.runtime;\n    var label = null;\n\n    if( pars.length > 1  ) {\n      this.erh.throwError( \"parameters\", \"Setdata takes one optional parameter\" );\n    }\n\n    if( pars.length == 1 ) {\n      label = pars[0].value ;\n    }\n\n    var list = runtime.setData( label );\n\n  }\n\n  _stat_info_datablocks() { return \"experimental:Dump data blocks in memory\"; }\n  _stat_datablocks( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n\n    if( pars.length != 0 ) {\n      this.erh.throwError( \"parameters\", \"Listdata takes no parameterss\" );\n    }\n\n    var list = runtime.getDataBlocks();\n    runtime.enterListMode( list );\n\n  }\n\n  _stat_info_loaddata() { return \"experimental:Load data in memory:<Filename> [, <Type>, <Label>]\"; }\n  _stat_loaddata( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n    var label = null;\n    var type = \"I:CSV\";\n    runtime.printLine(\"\");\n\n    if( pars.length != 1 && pars.length != 2 && pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"loaddata takes one mandatory and two optional parameters\" );\n    }\n\n    if( pars.length >= 2 ) {\n      type = pars[1].value ;\n    }\n\n    if( type.indexOf(\":\") < 0) {\n      this.erh.throwError( \"invalid type specification\", \"Expected <Type>:<FileSyntax>. Example: \\\"I:CSV\\\"\" );\n    }\n\n    if( pars.length == 3 ) {\n      label = pars[2].value ;\n    }\n\n    result = runtime.loaddata( pars[0].value, type, label );\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_dir() { return \"program:List a files on the current file system:[<Path> [,<Device>]]\"; }\n  _stat_dir( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.dir( \"\" );\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.dir( pars[0].value, -1 );\n      return;\n    }\n    else if( pars.length == 2) {\n      runtime.dir( pars[0].value, pars[1].value );\n      return;\n    }\n\n    this.erh.throwError( \"parameter\", \"dir takes 0,1 or 2 parameter(s)\"  );\n\n    this.aSync = true;\n\n  }\n\n  _stat_info_fs() { return \"program:Set or List (the) filesystem(s):[<FileSystem$>]\"; }\n  _stat_fs( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      runtime.listfs();\n    }\n    else if( pars.length == 1) {\n      runtime.setfs( pars[0].value );\n    }\n\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_renumber() { return \"program:Renumber the current program\"; }\n  _stat_renumber( pars ) {\n\n    var runtime = this.runtime;\n    runtime.renumberProgram( 10,10 );\n\n  }\n\n  _stat_info_vars() { return \"program:List all variables to the screen\"; }\n  _stat_vars( pars ) {\n\n\n    var runtime = this.runtime;\n\n    var varList = runtime.getFullVarList();\n    this.runtime.enterListMode( varList );\n\n  }\n\n\n  _stat_info_tracevar() { return \"program:Trace variable changes:[<VariableName$>]\"; }\n  _stat_tracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.getTraceList();\n      this.runtime.enterListMode( traceList );\n\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.setTraceVar( pars[0].value );\n      return;\n    }\n\n  }\n\n  _stat_info_clrtracevar() { return \"program:Stop tracing variables\"; }\n  _stat_clrtracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.resetTraceVar();\n    }\n  }\n\n\n  _stat_info_boot() { return \"program:Load and run a program:<FileName>\"; }\n  _stat_boot( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \" + pars[0].value);\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", true, -1 );\n    }\n    else {\n      result = runtime.load( pars[0].value, true, -1 );\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_save() { return \"program:Save the current program:<FileName>\"; }\n  _stat_save( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n        runtime.save( null );\n    }\n    else if ( pars.length == 1 ){\n      runtime.save( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.save( pars[0].value, pars[1].value );\n    }\n  }\n\n  _stat_info_delete() { return \"program:Delete a file:<FileName>\"; }\n  _stat_delete( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length != 1 && pars.length != 2) {\n        this.erh.throwError( \"parameter\", \"delete without filename\" );\n    }\n    else if ( pars.length == 1 ){\n      runtime.deleteFile( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.deleteFile( pars[0].value, pars[1].value );\n    }\n  }\n\n\n\n\n  _stat_info_run() { return \"program:Run the current program\"; }\n  _stat_run( pars ) {\n    var runtime = this.runtime;\n\n    runtime.runPGM();\n  }\n\n\n  _if_print() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  isNumber(value) {\n    return typeof value === 'number' && isFinite(value);\n  }\n\n  normalizeIfNumber( x )  {\n    if( this.isNumber( x ) ) {\n      if ( x >= 0 ) {\n        return \" \" + x;\n      }\n    }\n    return \"\" + x;\n  }\n\n\n  _stat_info_immediate() { return \"program:Set flag to flush the render pipeline after each print or poke:<RenderImmediateFlag>\"; }\n  _stat_immediate( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameters\", \"expected 1 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.runtime.setImmediate( pars[0].value );\n  }\n\n\n  _stat_info_print() { return \"print:Print text or values to the console:<Value>[;<Value>][;]\"; }\n  _stat_print( pars ) {\n\n    var runtime = this.runtime;\n    var con= this.output;\n\n    if( pars.length == 0 ) {\n\n      this.runtime.printNewLine();      \n      return;\n    }\n    else if( pars.length == 1 ) {\n      if( pars[0].parts.length == 0 ) {\n        this.runtime.printNewLine();  \n        return;\n      }\n    }\n\n    var newLine = true;\n    var value;\n    for( var i=0; i<pars.length; i++) {\n\n      newLine = true;\n      if( i<(pars.length-1)) {\n        newLine = false;\n      }\n\n      if( i>0) {\n        con.write( \"         \" );\n      }\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \";\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              //console.log( \"i=\"+i+\" newline: set to false\");\n          newLine = false;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n\n      value = runtime.evalExpression( exparts2 );\n\n      if( i == 0) {\n        con.write( this.normalizeIfNumber( value ) );\n      }\n      else {\n        con.write( \"\" + value );\n      }\n      if( newLine ) { \n        this.runtime.printNewLine();  \n        return;\n      }\n      this.runtime.synchPrint();  \n\n    }\n\n  }\n\n  _stat_info_clr() { return \"program:Clear all variables\"; }\n  _stat_clr( pars ) {\n    return this.runtime.clrPGM();\n  }\n\n  /************************ functions ************************/\n\n  _fun_info_datalen() { return \"experimental:Return length of current datablock\"; }\n  _fun_datalen( pars ) {\n    var runtime = this.runtime;\n    return runtime.getDataLength();\n  }\n\n  _fun_info_chr_DLR_() { return \"string:Return ascii character:<Ascii Code>\"; }\n  _fun_chr_DLR_( pars ) {\n    return String.fromCharCode( pars[0].value );\n  }\n\n  _fun_info_str_DLR_() { return \"string:Converts number to string: <Number>[,<Base>[,<Trim>]]\"; }\n  _fun_str_DLR_( pars ) {\n\n    if( pars.length <1 || pars.length >3  ) {\n      this.erh.throwError( \"parameter\", \"str$() takes 1,2 or 3 parameters\"  );\n    }\n\n    var number = pars[0].value;\n    var base = 10;\n    var trim = false;\n\n    if( pars.length>=2  ) {\n      base = pars[1].value;\n    }\n\n    if( pars.length==3  ) {\n      trim = ( pars[1].value > 0);\n    }\n\n    var numberStr = number.toString(base);\n\n    if( number >=0 && !trim) {\n      return \" \" +  numberStr;\n    }\n\n    return numberStr;\n  }\n\n  _fun_info_abs() { return \"math:Absolute value\"; }\n  _fun_abs( pars ) {\n    if( pars[0].value < 0 ) {\n      return -pars[0].value;\n    }\n    return pars[0].value;\n  }\n\n  _fun_info_len() { return \"string:Length of a string\"; }\n  _fun_len( pars ) {\n    return pars[0].value.length;\n  }\n\n  _fun_info_asc() { return \"string:ASCII value of a character\"; }\n  _fun_asc( pars ) {\n    if( (typeof pars[0].value).toUpperCase() == \"STRING\" ) {\n\n      if ( pars[0].value.length > 0) {\n          return pars[0].value.charCodeAt(0);\n      }\n    }\n    return 0;\n  }\n\n  _fun_info_val() { return \"string:Retrieve number from string\"; }\n  _fun_val( pars ) {\n    var base = 10;\n\n    if( pars.length==2  ) {\n      base = pars[1].value;\n    }\n\n    if(base < 2 || base > 16) {\n      this.erh.throwError( \"base\", \"base should be inbetween 2 and 16\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n  _fun_info_hex2dec() { return \"string:Retrieve number from hexadecimal string\"; }\n  _fun_hex2dec( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX2DEC() needs one parameter\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n\n  _fun_info_hex_DLR_() { return \"string:Format a number as a hexadecimal string\"; }\n  _fun_hex_DLR_( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX$() needs one parameter\" );\n    }\n\n    var hexString = (pars[0].value * 1).toString(16);\n\n    return hexString;\n }\n\n\n\n\n  _fun_info_exp() { return \"math:Exponent\"; }\n  _fun_exp( pars ) {\n    return Math.exp( pars[0].value );\n  }\n\n  intGetNextRand() {\n    this.randIndex = (this.randIndex + this.randStep) % this.randnrs.length;\n    return this.randnrs[ this.randIndex ];\n  }\n\n  intSeedRand( x0 ) {\n\n    if( x0 < 0) {\n      var x = -x0;\n      var base = Math.floor( x * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n    else {\n\n      const minute = 1000 * 60;\n      const hour = minute * 60;\n      const day = hour * 24;\n      const year = day * 365;\n\n      const d = new Date();\n      let seedModifier = Math.round(d.getTime() / year);\n\n      x = -x;\n      var base = Math.floor( seedModifier * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n\n  }\n\n\n  _fun_info_pad_DLR_() { return \"string:Add string padding:<String>, <padChar>,<Length>[,<PadLeft>]\"; }\n  _fun_pad_DLR_( pars ) {\n\n    if( pars.length < 3 || pars.length >4 ) {\n      this.erh.throwError( \"syntax\", \"pad$() takes 3 or 4 parameters\" );\n    }\n\n    var str = pars[0].value;\n    var ch = pars[1].value;\n    var len = pars[2].value;\n    var left = true;\n\n    if( pars.length == 4 ) {\n      left= pars[3].value;\n\n      if( left !== 0 ) {\n        left = true;\n      }\n      else { left = false; }\n    }\n\n    var dest = \"\";\n\n    var strLen = str.length;\n    var toPad = len-strLen;\n    for( var i = 0; i<toPad ; i++) {\n      dest += ch;\n    }\n\n    if( left ) {\n      dest = dest + str;\n    }\n    else {\n      dest = str + dest;\n    }\n\n    return dest;\n  }\n\n\n  _fun_info_rnd() { return \"math:Random number between 0 and 1:<SeedOrMode> (0=JS, 1=Seed, NoValue=Default)\"; }\n  _fun_rnd( pars ) {\n\n    if( pars.length >1) {\n      this.erh.throwError( \"syntax\", \"rnd takes one parameter\" );\n    }\n\n    if( pars.length == 1) {\n\n      if( pars[0].value == 0 ) {\n        return Math.random();\n      }\n      this.intSeedRand( pars[0].value );\n    }\n\n    return this.intGetNextRand();\n  }\n\n  _fun_info_sqr() { return \"math:Square Root\"; }\n  _fun_sqr( pars ) {\n    return Math.sqrt( pars[0].value);\n  }\n\n  _fun_info_log() { return \"math:Logaritm\"; }\n  _fun_log( pars ) {\n    return Math.log( pars[0].value);\n  }\n\n  _fun_info_pos() { return \"print:Position\"; }\n  _fun_pos( pars ) {\n    return this.runtime.getLinePos();\n  }\n\n  _fun_info_left_DLR_() { return \"string:Left part of the string\"; }\n  _fun_left_DLR_( pars ) {\n      //? LEFT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr(0,pars[1].value);\n  }\n\n  _fun_info_right_DLR_() { return \"string:Right part of the string\"; }\n  _fun_right_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr( s.length - pars[1].value );\n  }\n\n  _fun_info_mid_DLR_() { return \"string:A substring\"; }\n  _fun_mid_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      if( pars.length == 3) {\n        return s.substr( pars[1].value-1, pars[2].value );\n      }\n      else if( pars.length == 2) {\n        return s.substr( pars[1].value-1 );\n      }\n  }\n\n  _fun_info_sin() { return \"math:Sinus\"; }\n  _fun_sin( pars ) {\n    return Math.sin( pars[0].value);\n  }\n\n  _fun_info_tri() { return \"math+:Triangle\"; }\n  _fun_tri( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    if( v<=0.5 ) {\n        return v*2;\n    }\n    else if( v<=1 ) {\n        return 1-((v-0.5) * 2);\n    }\n  }\n\n  _fun_info_saw() { return \"math+:Saw Tooth\"; }\n  _fun_saw( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    return v;\n\n  }\n\n  _fun_info_tan() { return \"math:Tangent\"; }\n  _fun_tan( pars ) {\n    return Math.tan( pars[0].value);\n  }\n\n  _fun_info_atn() { return \"math:ATan function\"; }\n  _fun_atn( pars ) {\n    return Math.atan( pars[0].value);\n  }\n\n  _fun_info_cos() { return \"math:Cosinus\"; }\n  _fun_cos( pars ) {\n    return Math.cos( pars[0].value);\n  }\n\n  _fun_info_spc() { return \"string:Spaces for padding:<SizeOfPadding>\"; }\n  _fun_spc( pars ) {\n    var out=\"\";\n    for( var i=0; i<pars[0].value; i++) {\n      out+=\" \";\n    }\n    return out;\n  }\n\n  _max(x,m) {\n    if( x<m ) {  return x; }\n    return m;\n  }\n\n\n\n  _fun_info_int() { return \"math:Convert to Integer\"; }\n  _fun_int( pars ) {\n    return Math.floor( pars[0].value );\n  }\n\n  _fun_info_range() { return \"math+:Keep in range:<V>,<MIN>,<MAX>\"; }\n  _fun_range( pars ) {\n\n    if( pars.length <3) {\n      this.erh.throwError( \"parameter\", \"expected 3 parameters\" );\n    }\n    var v = pars[0].value ;\n    var min = pars[1].value ;\n    var max = pars[2].value ;\n\n    if( v<min ) { return min; }\n    if( v>max ) { return max; }\n    return v;\n  }\n\n\n  _fun_info_tab() { return \"print:Tab cursor Xpos to the right:<NumberOfTabs>\"; }\n  _fun_tab( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length <1) {\n      this.erh.throwError( \"syntax\", \"missing parameter 0\" );\n    }\n    var p = pars[0].value;\n    if( p<0 || p > 255 ) {\n      this.erh.throwError( \"illegal quantity\", \"value must be in-between 0 and 255\" );\n    }\n\n    for( var i=0; i<pars[0].value ; i++) {\n        this.output.write( \" \" );\n    }\n\n    return \"\";\n  }\n\n  _fun_info_sgn() { return \"math:Sign of number\"; }\n  _fun_sgn( pars ) {\n    var x = pars[0].value;\n\n    if( x<0 ) { return -1; }\n    else if( x>0 ) { return 1; }\n    return 0;\n  }\n\n  _fun_info_millis() { return \"time:Current time in milliseconds\"; }\n  _fun_millis( pars ) {\n    return this.runtime.getMillis( );\n  }\n\n  _fun_info_jiffies() { return \"time:Current time in 'jiffies'\"; }\n  _fun_jiffies( pars ) {\n    return this.runtime.getJiffyTime( );\n  }\n}\n\n//--EOC \n\n// ## basicparser.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicparser.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicparser.js\n\nclass Parser {\n\n  constructor( cmds, ecmds ) {\n    this.commands = cmds;\n    this.extendedcommands = ecmds;\n    this.erh = new ErrorHandler();\n    this.debugFlag = false;\n  }\n\n  init() {\n\n\t  this.CTRL_KW = [\"IF\",\"THEN\",\"GOTO\",\"AND\", \"NOT\", \"OR\",  \"GOSUB\", \"RETURN\", \"FOR\", \"TO\", \"NEXT\", \"STEP\", \"DATA\", \"REM\", \"GOSUB\", \"DIM\", \"END\", \"LET\", \"STOP\", \"DEF\", \"FN\", \"ON\", \"SUB\", \"INTERRUPT0\", \"INTERRUPT1\" ];\n    this.SHORTCUT_KW = [\"?\"];\n\n    this.KEYWORDS = this.commands.getStatements();\n\n    var more = this.extendedcommands.getStatements();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.commands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.extendedcommands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n     for( var i=0; i<this.CTRL_KW.length; i++) {\n       this.KEYWORDS.push( this.CTRL_KW[ i ] );\n     }\n\n     for( var i=0; i<this.SHORTCUT_KW.length; i++) {\n       this.KEYWORDS.push( this.SHORTCUT_KW[ i ] );\n     }\n     //this.padArray( this.KWCODES, 256 );\n\n     if( this.debugFlag ) { console.log(\"KEYWORDS:\" , this.KEYWORDS ); }\n\n     this.screenCodes2CTRLTable = [];\n     var tab = this.screenCodes2CTRLTable;\n\n     tab['\\x93'] = '\\x13';\n     tab['\\xd3'] = '\\x93';\n  }\n\n  getKeyWordCodes() {\n\n    this.throwError( null, \"(Extended) Keywords not yet supported\", \"extended disabled\" );\n    return this.KWCODES;\n  }\n\n  padArray( arr, nr ) {\n    var missing = nr - arr.length;\n    while( missing > 0) {\n      arr.push( null );\n      missing--;\n    }\n  }\n\n  throwError( ctx, detail, clazz ) {\n\n    var clazz2 = clazz;\n    if( clazz2 === undefined ) {\n      clazz2 = \"syntax\";\n    }\n\n    if( ctx ) {\n      console.log(\" Exception \" + clazz + \" at line \" + ctx.lineNumber+ \" \" + detail );\n    }\n\n    if( ctx ) {\n      if( ! ( ctx.lineNumber == undefined ) ) {\n        this.erh.throwError( clazz2, detail, ctx, ctx.lineNumber );\n      }\n    }\n\n    this.erh.throwError( clazz2, detail, undefined, -1 );\n\n  }\n\n  upperCaseNameTokens( tokens ) {\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type == \"name\" ) {\n\t\t\t\t\ttoken.data = token.data.toUpperCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens;\n\t}\n\n\tremovePadding( tokens ) {\n\t\tvar tokens2 = [];\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type != \"pad\" ) {\n\t\t\t\t\ttokens2.push( token );\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens2;\n\t}\n\n  mergeCompTokens( tokens ) {\n\t\tvar tokens2 = [];\n\n    /* Convert token sequences like (\"<\",\"=\")\n       into single token \"<=\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( i>0 ) {\n        var token2 = tokens[i-1];\n\t\t\t\tif( ( token.type == \"comp\" || token.type == \"eq\" ) &&\n            ( token2.type == \"comp\" || token2.type == \"eq\" ) ) {\n\t\t\t\t\ttoken2.type = \"@@removeme\";\n          token.data = token2.data + token.data;\n          token.type = \"comp\";\n          if( token.data == \"><\" ) {\n            token.data = \"<>\";\n          }\n          else if( token.data == \"=<\" ) {\n            token.data = \"<=\";\n          }\n          else if( token.data == \"=>\" ) {\n            token.data = \">=\";\n          }\n\n  \t\t\t}\n\t\t\t}\n\n      if( ( token.type == \"name\"  && token.data == \"OR\" ) ||\n        ( token.type == \"name\"  && token.data == \"AND\" ) ||\n        ( token.type == \"name\"  && token.data == \"NOT\" )) {\n          token.type = \"bop\";\n        }\n\n\t\t}\n\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens[i].type!=\"@@removeme\") {\n        tokens2.push( tokens[i] );\n      }\n    }\n\n\t\treturn tokens2;\n\t}\n\n\n\n  mergeBrokenUpTokens( tokens ) {\n\n    var splits = [];\n\n    //console.log(\"tokens\",tokens)\n    //standard\n    splits.push( { p1: \"REST\", p2: \"OR\", p3: \"E\", whole: \"RESTORE\" } );\n    splits.push( { p1: \"S\", p2: \"TO\", p3: \"P\", whole: \"STOP\" } );\n\n\n    //extended\n//    splits.push( { p1: \"Dsk\", p2: \"OR\", p3: \"T\", whole: \"DXPORT\" } );\n//    splits.push( { p1: \"LXP\", p2: \"OR\", p3: \"T\", whole: \"LXPORT\" } );\n    splits.push( { p1: \"IMP\", p2: \"OR\", p3: \"T\", whole: \"IMPORT\" } );\n    splits.push( { p1: \"EXP\", p2: \"OR\", p3: \"T\", whole: \"EXPORT\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"URL\", whole: \"LGETURL\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"NAME\", whole: \"LGETNAME\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"ID\", whole: \"LGETID\" } );\n    splits.push( { p1: \"GO\", p2: \"TO\", p3: null, whole: \"GOTO\" } );\n    splits.push( { p1: \"GO\", p2: \"SUB\", p3: null, whole: \"GOSUB\" } );\n\n    splits.push( { p1: \"GO\", p2: \"LINK\", p3: null, whole: \"GOLINK\" } );\n    splits.push( { p1: \"WINDOW\", p2: \"S\", p3: null, whole: \"WINDOWS\" } );\n    splits.push( { p1: \"UN\", p2: \"TAG\", p3: null, whole: \"UNTAG\" } );\n    splits.push( { p1: \"LINK\", p2: \"S\", p3: null, whole: \"LINKS\" } );\n    splits.push( { p1: \"DE\", p2: \"LET\", p3: \"E\", whole: \"DELETE\" } );\n    splits.push( { p1: \"LDE\", p2: \"LET\", p3: \"E\", whole: \"LDELETE\" } );\n    splits.push( { p1: \"TDE\", p2: \"LET\", p3: \"E\", whole: \"TDELETE\" } );\n    splits.push( { p1: \"B\", p2: \"OR\", p3: \"DER\", whole: \"BORDER\" } );\n    splits.push( { p1: \"G\", p2: \"COLOR\", p3: \"S\", whole: \"GCOLORS\" } );\n    splits.push( { p1: \"CHAR\", p2: \"COL\", p3: null, whole: \"CHARCOL\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"CP\", p3: null, whole: \"SFRAMECP\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPX\", p3: null, whole: \"SFRAMEFLIPX\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPY\", p3: null, whole: \"SFRAMEFLIPY\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FX\", p3: null, whole: \"SFRAMEFX\" } );\n    splits.push( { p1: \"TAG\", p2: \"S\", p3: null, whole: \"TAGS\" } );\n    splits.push( { p1: \"X\", p2: \"ON\", p3: null, whole: \"XON\" } );\n    splits.push( { p1: \"S\", p2: \"POS\", p3: null, whole: \"SPOS\" } );\n    splits.push( { p1: \"S\", p2: \"POKE\", p3: null, whole: \"SPOKE\" } );\n    splits.push( { p1: \"WJ\", p2: \"IF\", p3: \"FY\", whole: \"WJIFFY\" } );\n    splits.push( { p1: \"REF\", p2: \"OR\", p3: \"MAT\", whole: \"REFORMAT\" } );\n\n\n    var tokens2 = []; //tokens;\n\n    for( var i=0; i<tokens.length; i++) {\n      tokens2.push( tokens[ i ]);\n    }\n\n    for( var i=0; i<splits.length; i++) {\n      var r=splits[i];\n      tokens2 = this.mergeTokenRange( tokens2, r );\n    }\n\n    if( this.debugFlag ) {  console.log( tokens2 ); }\n    return tokens2;\n  }\n\n\n  mergeTokenRange( tokens, record ) {\n\t\tvar tokens2 = [];\n    var tokens3 = [];\n\n    /* Convert \"S\",\"TO\",\"P\" into \"STOP\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      tokens2[i] = tokens[i];\n\t\t}\n\n    for( \tvar i=1;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( record.p3 == null ) {\n        if(\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n             if(\n                tokens2[i-1].data == record.p1 &&\n                tokens2[i-0].data == record.p2 ) {\n                  tokens2[i-1].data = record.whole;\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n      else {\n        if(i<2) {\n          continue;\n        }\n        if(\n          ( tokens2[i-2].type == \"name\" || tokens2[i-2].type == \"bop\" ) &&\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n\n             if( tokens2[i-2].data == record.p1 &&\n                tokens2[i-1].data == record.p2 &&\n                tokens2[i-0].data == record.p3 ) {\n                  tokens2[i-2].data = record.whole;\n                  tokens2[i-1].type = \"removeme\";\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n\t\t}\n\n    var j=0;\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens2[i].type != \"removeme\" ) {\n          tokens3[j] = tokens2[i];\n          j++;\n      }\n\t\t}\n\n\t\treturn tokens3;\n\t}\n\n\tparseFunParList( context ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar params = [];\n\t\tvar even = true;\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"sep\", data: \"@@@all\" });\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tendTokens.push();\n\n\t\twhile( true ) {\n\n\t\t\tvar token;\n\n      if( tokens.length > 0) {\n        if( tokens[0].type==\"bracket\" && tokens[0].data==\")\") {\n          break;\n        }\n      }\n\n\t\t\tif( even ) {\n        var expr = this.parseBoolExpression( context, endTokens );\n        expr.type = \"expr\";\n\t\t\t\tparams.push( expr );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoken = tokens.shift();\n\n\t\t\t\tif( token.type==\"sep\" ) {\n\t\t\t\t\t//all ok, next par\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected ',' or ')', got '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tpeekIfNextIsOpenBracket( context ) {\n\n\t\tvar tokens = context.tokens;\n\n\t\tif( tokens.length > 0 ) {\n\t\t\tif( tokens[0].type == \"bracket\" && tokens[0].data == \"(\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tparseSubExpression( context ) {\n\n\t\tvar token = context.tokens.shift();\n\n\t\tif( !(token.type == \"bracket\" && token.data == \"(\")) {\n\t\t\tthis.throwError( context, \"parsing subexpression, expected \\\"bracket\\\", not '\" + token.data + \"'\");\n\t\t}\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tvar expr = this.parseBoolExpression( context, endTokens );\n\t\tcontext.tokens.shift();\n\n\t\texpr.type = \"expr\";\n\t\treturn expr;\n\t}\n\n\n  tokensToString( token )  {\n    var str = \"\";\n\n    if(token.data == \"@@@all\") {\n        str = str + \"'\" + token.type + \"'\";\n    }\n    else {\n      //str = str + \"'\" + token.type + \"/\" + token.data + \"'\";\n      str = str + \"'\" + token.data + \"'\";\n    }\n\n    return str;\n  }\n\n  endTokensToString( endTokenArray )  {\n    var str = \"\";\n\n    for( var et=0; et<endTokenArray.length; et++) {\n      var endToken = endTokenArray[et];\n\n      if( str != \"\") { str+= \" \";}\n      str += this.tokensToString( endToken );\n    }\n    return str;\n  }\n\n  isEndToken( token, endTokenArry ) {\n\n    for( var et=0; et<endTokenArry.length; et++) {\n      var endToken = endTokenArry[et];\n\n      if( token.type == endToken.type && token.data == endToken.data ) {\n        return true;\n      }\n      else if( token.type == endToken.type && endToken.data == \"@@@all\" ) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n\n  parseSimpleExpression( context, endTokens ) {\n\n    var endLoop;\n\t\tvar tokens = context.tokens;\n\n    if( tokens.length == 0) {\n      return undefined;\n    }\n\n\t\tvar token, returnValue=undefined;\n\t\ttoken = tokens.shift();\n\n\t\tif( !token ) {\n\t\t\tthis.throwError( context, \"empty simple expression\");\n\t\t}\n\n    endLoop = this.isEndToken( token, endTokens );\n    if( endLoop ) {\n      this.throwError( context, \"empty simple expression\");\n    }\n\n\n    if( token.type == \"op\" && token.data == \"-\" ) {\n\t\t\t\tvar pair = this.parseSimpleExpression( context, endTokens );\n        pair[0].data = -pair[0].data;\n        return pair;\n\t\t}\n\n\t\tif( token.type == \"num\" ) {\n        returnValue= { type: \"num\", data: token.data };\n\t\t}\n\t\telse if( token.type == \"str\" ) {\n\t\t\t\treturnValue= { type: \"str\", data: token.data };\n\t\t}\n\n\n    token = tokens.shift();\n    if( token ) {\n      endLoop = this.isEndToken( token, endTokens );\n      if( ! endLoop ) {\n        endLoop = context.tokens.length == 0;\n      }\n      if( !endLoop ) {\n        this.throwError( context, \"Empty simple expression end expected\");\n      }\n    }\n\n\t\treturn [returnValue, token];\n\t}\n\n\n  parseBoolExpression( context, endTokens0 ) {\n\n    var endTokens = [];\n    var tokens = context.tokens;\n\n    for( var i=0; i < endTokens0.length; i++ ) {\n      endTokens.push( endTokens0[ i ] );\n    }\n\n    endTokens.push( { type: \"bop\", data: \"OR\" });\n    endTokens.push( { type: \"bop\", data: \"AND\" });\n\n    var first = true;\n    var eList = [];\n    var op = null;\n    while( true ) {\n\n      var expr = this.parseExpression( context, endTokens );\n      if( first && tokens.length == 0) {\n        return expr;\n      }\n      first = false;\n\n      var opData = null;\n      if( op != null ) {\n          opData = op.data;\n      }\n\n      //if( expr.parts.length == 1) {\n      //    expr.parts[0].op = opData;\n      //    expr.parts[0].dbg = \"1\";\n      //    eList.push(  expr.parts[0] );\n      //}\n      //else {\n          expr.op = opData;\n          expr.type = \"expr\";\n          expr.dbg = \"1\";\n          eList.push(  expr );\n      //}\n\n      if( tokens.length > 0) {\n        if( tokens[0].type == \"bop\" ) {\n          var op = tokens.shift();\n          continue;\n        }\n      }\n      break;\n    }\n\n    if( eList.length == 1 ) {\n        eList[0].dbg2 = \"len=1\";\n        return eList[0];\n    }\n\n\n    var retExpr = {\n      negate: false,\n      binaryNegate: false,\n      type: \"expr\",\n      parts: [],\n      op: null\n    };\n\n    for( i=0; i<eList.length; i++) {\n      retExpr.parts.push( eList[ i ] );\n    }\n\n    return retExpr;\n\n  }\n\n\tparseExpression( context, endTokens ) {\n\n\t\tvar tokens = context.tokens;\n    if( tokens.length == 0) {\n      return null;\n    }\n\n\t\tvar expression = {\n\t\t\t\t\tparts: [],\n          negate: false,\n          binaryNegate: false\n\t\t};\n\n\t\tvar index = 0;\n\t\tvar even = true;\n\t\tvar op = null;\n\t\tvar parts = expression.parts;\n    var first = true;\n    var negate = false;\n\n    var binaryNegate = false;\n\n\n\t\twhile( true ) {\n\t\t\tvar token, part;\n\t\t\ttoken = tokens.shift();\n\n\t\t\tif( !token ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n      var endLoop = this.isEndToken( token, endTokens );\n      if( endLoop ) {\n\n        tokens.unshift( token );\n        break;\n      }\n\n\t\t\tif( even ) {\n\n\t\t\t\tif( token.type == \"num\" ) {\n\t\t\t\t\tpart = { type: \"num\", data: token.data, op: op };\n          if( negate ) {\n            part.data = -part.data;\n          }\n\t\t\t\t\tparts.push( part );\n          first = false;\n          negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type == \"str\" ) {\n\t\t\t\t\tpart = { type: \"str\", data: token.data, op: op };\n\t\t\t\t\tparts.push( part );\n          if( negate ) {\n            this.throwError( context, \"found negation on a string\", \"type mismatch\");\n          }\n          first = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"bracket\" && token.data==\"(\") {\n\t\t\t\t\t\ttokens.unshift( token );\n\n            var subEndTokens = [];\n            subEndTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\t\t\t\t\tvar expr = this.parseSubExpression( context, subEndTokens );\n            expr.op = op;\n            expr.negate = negate;\n            expr.binaryNegate = binaryNegate;\n\t\t\t\t\t\tparts.push ( expr );\n            first = false;\n            negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"name\" ) {\n\n\t\t\t\t\t\tvar name = token.data;\n\t\t\t\t\t\tvar isFunctionCallOrArray = this.peekIfNextIsOpenBracket( context );\n            var isUserDefinedFunctionCall = (name == \"FN\");\n\n\t\t\t\t\t\tif( isFunctionCallOrArray ) { /*We have a function or an Array */\n\n\t\t\t\t\t\t\ttoken = tokens.shift();\n\t\t\t\t\t\t\tvar parameters = this.parseFunParList( context );\n              tokens.shift();\n\n              part = { type: \"funCall\", params: parameters, op: op, functionName: name };\n\n              if( this.KEYWORDS.indexOf( name ) == -1 ) {\n                //isArray  example: x=a(5)\n                part = { type: \"array\", data: name, op: op, indices: parameters };\n\n              }\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            else if( isUserDefinedFunctionCall ) {\n\n              token = tokens.shift();\n              name = token.data;\n\n              token = tokens.shift();\n              var parameters = this.parseFunParList( context ); //TODO limit to 1 par\n              tokens.shift();\n\n              part = { type: \"defFnCall\", params: parameters, op: op, functionName: name };\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n            }\n\t\t\t\t\t\telse { /* we have an variable*/\n\n\t\t\t\t\t\t\tpart = { type: \"var\", data: token.data, op: op };\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n              else {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            negate = false;\n            first = false;\n\t\t\t\t}\n        else if( token.type==\"op\" && token.data==\"-\" ) {\n          negate = ! negate;\n          continue;\n        }\n        else if( token.type==\"bop\" && token.data==\"NOT\" && first ) {\n          binaryNegate = ! binaryNegate;\n          expression.binaryNegate = binaryNegate;\n          if( this.debugFlag ) {\n            console.log(\"NOT\")\n          }\n          continue;\n        }\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"number\\\", \\\"string\\\", \\\"symbol\\\" or \\\"bracket\\\", not \" + token.data);\n\t\t\t\t}\n        op = null;\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\tif( token.type == \"op\" || token.type == \"comp\" || token.type == \"eq\" || token.type == \"bop\" ) {\n\t\t\t\t\top = token.data;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"operator\\\" or one of (\"+\n          this.endTokensToString(endTokens)+\n          \"), not '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\n\t\t}\n\n    if( op != null ) {\n      part = { type: \"uniop\", data: null, op: op };\n      parts.push ( part );\n    }\n\n\t\tif( expression.parts == null ) {\n\t\t\treturn null;\n\t\t}\n\n    var newParts;\n    newParts = this.groupParts( expression.parts, \"^\" );\n    newParts = this.groupParts( newParts, \"/\" );\n    newParts = this.groupParts( newParts, \"*\" );\n    newParts = this.groupParts( newParts, \"+\" );\n    newParts = this.groupParts( newParts, \"-\" );\n\n    var oldExpression = expression;\n    expression = {\n          parts: newParts,\n          negate: oldExpression.negate,\n          binaryNegate: oldExpression.binaryNegate\n    };\n\n\t\treturn expression;\n\t}\n\n\n  groupParts( parts0 , op ) {\n\n    var parts1=[], parts2=[];\n\n    for( var i=0; i<parts0.length; i++ ) {\n      parts1.push( parts0[ i ] );\n    }\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( i>0 && part.op == op ) {\n        var prevPart = parts1[ i-1 ];\n\n        var subExpr = {\n          negate: false,\n          binaryNegate: false,\n          type: \"expr\",\n          parts: [],\n          op: prevPart.op\n        };\n\n        subExpr.parts[ 0 ] = prevPart;\n        subExpr.parts[ 0 ].op = null;\n        subExpr.parts[ 1 ] = part;\n\n        parts1[i-1] = null;\n        parts1[ i ] = subExpr;\n\n      }\n    }\n\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( part != null ) {\n        parts2.push( part );\n      }\n    }\n\n    return parts2;\n  }\n\n  normalizeStatementName( x ) {\n    if(x == \"?\") {\n      return \"print\";\n    }\n    return x;\n  }\n\n  parseAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = false;\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n  }\n\n  parseArrayAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = true;\n\n    //token = tokens.shift();\n    var indices = this.parseFunParList( context );\n    command.indices = indices;\n\n    tokens.shift();\n    if( this.debugFlag ) {\n      console.log(\"tokens after:\",tokens)\n    }\n\n    token = tokens.shift();\n    if( token === undefined ) {\n      token = { type: \"@@@notoken\" };\n    }\n\n    if( token.type != \"eq\") {\n      this.throwError( context, \"Expected =\");\n    }\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n\n  }\n\n  parseControlStructure(  context, preTokens, commands, command, handlers, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    if( true ) {\n\n      command.type = \"control\";\n      var controlToken = nameToken;\n      command.controlKW = nameToken.toLowerCase();\n      if( token.type != \"@@@notoken\") {\n        tokens.unshift( token );\n      }\n\n      if( controlToken == \"LET\") {\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"LET expects var name\");\n        }\n        nameToken = token.data;\n\n        token = tokens.shift();\n        if( token === undefined ) {\n          token = { type: \"@@@notoken\" };\n        }\n\n/*        if( token.type != \"bracket\") { #TODO array assignments, ex: LET a(8) = 2\n          this.throwError( context, \"LET expects =\");\n        }\n*/\n\n        if( token.type == \"eq\") {\n\n          this.parseAssignment( context, preTokens, commands, command, nameToken, token );\n        }\n        else if( token.type == \"bracket\" && token.data==\"(\" ) {\n\n          this.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n        }\n        else {\n          this.throwError( context, \"Unexpected data after 'LET': '\" + token.data + \"'\" );\n        }\n\n      }\n      else if( controlToken == \"DIM\") {\n\n        var first = true;\n        command.params = [];\n        command.arrayNames = [];\n\n        while( true ) {\n\n          token = tokens.shift();\n          if(!first ) {\n            if( token === undefined ) {\n              break;\n            }\n            if( ! ( token.type == \"sep\" && token.data == \",\" )) {\n              tokens.unshift( token );\n              break;\n            }\n            token = tokens.shift();\n          }\n\n          if( token.type != \"name\" ) {\n            this.throwError( context, \"DIM expects var name\");\n          }\n\n          nameToken = token.data;\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\"(\") ) {\n            this.throwError( context, \"DIM expects (\");\n          }\n\n          var indices = this.parseFunParList( context );\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\")\") ) {\n            this.throwError( context, \"DIM expects )\");\n          }\n\n          command.params.push( indices );\n          command.arrayNames.push( nameToken );\n\n          first = false;\n        }\n\n        commands.push( command );\n      }\n      else if( controlToken == \"DEF\") {\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"FN\" ) ) {\n          this.throwError( context, \"DEF expects FN\");\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"DEF FN expects function name\");\n        }\n        var fName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \"(\" )) {\n          this.throwError( context, \"DEF FN expects function name and ->( varname )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"name\"  )) {\n          this.throwError( context, \"DEF FN expects function name and ( ->varname )\");\n        }\n        var varName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \")\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname -> )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname ) -> =\");\n        }\n\n\n        endTokens = [];\n        var expr_fn = this.parseBoolExpression( context, endTokens );\n\n        if( this.debugFlag ) {\n          console.log(\"expr = \" + expr_fn );\n        }\n\n        command.params=[];\n        command.params[0] = fName;\n        command.params[1] = varName;\n        command.params[2] = expr_fn;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"GOTO\" || controlToken == \"GOSUB\") {\n        var num = -1;\n\n        token = tokens.shift();\n\n        if( token === undefined ) {\n          this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n        }\n\n        if( token.type != \"num\") {\n          //this.throwError( context, \"GOTO/GOSUB expects number\", \"undef'd statement\");\n\n          if( token.type != \"name\") {\n              this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n          }\n\n          var label = token.data;\n\n          token = tokens.shift();\n          if( token !== undefined ) {\n            if( token.type != \"cmdsep\") {\n              this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n            }\n          }\n\n          command.params=[];\n          command.params[0] = label;\n          command.label = true;\n          commands.push( command );\n          return;\n\n        }\n        num = parseInt(token.data);\n        token = tokens.shift();\n        if( token !== undefined ) {\n          if( token.type != \"cmdsep\") {\n            this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n          }\n        }\n\n        command.params=[];\n        command.params[0] = num;\n        command.label = false;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"ON\" ) {\n        var nums = [];\n        var onInterrupt = false;\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        endTokens.push( { type: \"name\", data: \"GOSUB\" });\n\n        token = tokens.shift();\n        var onExpr = null;\n\n        if( token.type == \"name\" && (token.data == \"INTERRUPT0\" || token.data == \"INTERRUPT1\")) {\n          onInterrupt = true;\n          onExpr = {\n            type: \"control\",\n            data: token.data\n          }\n        }\n        else {\n          tokens.unshift( token );\n          onExpr = this.parseBoolExpression( context, endTokens );\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"ON expects GOTO/GOSUB\");\n        }\n\n        if( !onInterrupt ) {\n          if( !( token.data == \"GOTO\" || token.data == \"GOSUB\" )) {\n            this.throwError( context, \"ON expects GOTO/GOSUB\");\n          }\n        }\n        else {\n          if( !( token.data == \"GOTO\" )) {\n            this.throwError( context, \"ON INTERRUPT expects GOTO\");\n          }\n        }\n\n        var onType = token.data;\n\n        token = tokens.shift();\n\n        var labelFlag = false;\n        var label = \"\";\n        var num0;\n\n        if( token.type != \"num\") {\n\n            if( token.type != \"name\") {\n                this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n            }\n\n            labelFlag = true;\n            label = token.data;\n\n        }\n        else {\n          num0  = parseInt(token.data);\n        }\n\n        nums.push( num0 );\n\n        if( !onInterrupt ) {\n          while ( true ) {\n\n            token = tokens.shift();\n            if( token == undefined ) { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( !( token.type == \"sep\" && token.data == \",\" )) {\n              this.throwError( context, \"ON GOTO/GOSUB expects numberlist\");\n            }\n\n            token = tokens.shift();\n            if( token.type != \"num\") {\n              this.throwError( context, \"GOTO/GOSUB expects number\");\n            }\n            nums.push(  parseInt(token.data) );\n          }\n\n          if( nums.length > 1 ) {\n            this.throwError( context, \"ON INTERUPT GOTO expects only a single line number\");\n          }\n\n          command.params=[];\n          command.params[0] = onType.toLowerCase();\n          command.params[1] = onExpr;\n          command.params[2] = nums;\n          commands.push( command );\n        }\n        else {\n\n          command.params=[];\n          command.params[0] = onExpr.data.toLowerCase();\n          if ( labelFlag ) {\n              command.params[1] = label;\n          }\n          else {\n              command.params[1] = num0;\n          }\n          command.label = labelFlag;\n\n          commands.push( command );\n\n        }\n\n      }\n      else if( controlToken == \"RETURN\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"END\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"STOP\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"FOR\") {\n\n        var variable, expr_from, expr_to, expr_step;\n        var endTokens = [];\n\n        token = tokens.shift();\n        if( token.type != \"name\" ) {\n          this.throwError( context,\n                \"For expects variable, no var found, found \" + token.type+\"/\"+token.data);\n        }\n\n        variable = token.data;\n\n        token = tokens.shift();\n        if( !( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context,\n                \"For expects '=', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"TO\" });\n\n        expr_from = this.parseBoolExpression( context, endTokens );\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"TO\" ) ) {\n          this.throwError( context, \"For expects 'to', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"name\", data: \"STEP\" });\n\n        expr_to = this.parseBoolExpression( context, endTokens );\n        expr_step = { parts: [ { data: \"1\", op: null, type: \"num\"} ] };\n\n        token = tokens.shift();\n        if( !( token === undefined ) ) {\n          if( token.type == \"name\" && token.data == \"STEP\") {\n\n              endTokens = [];\n              endTokens.push( { type: \"cmdsep\", data: \":\" });\n              expr_step = this.parseBoolExpression( context, endTokens );\n          }\n          else {\n            if(! ( token.type == \"cmdsep\" && token.data == \":\")) {\n              throw \"FOR: unexpected token '\" + token.data +\"'\";\n            }\n          }\n        }\n\n        command.controlKW = \"for:init\";\n        command.params=[];\n        command.params[0] = expr_from;\n        command.params[1] = expr_to;\n        command.params[2] = expr_step;\n        command.variable = variable;\n        commands.push( command );\n        if( this.debugFlag ) {\n          console.log(\"command=\", command);\n        }\n\n      }\n      else if( controlToken == \"NEXT\") {\n\n        var variable;\n\n        var explicit = false;\n        while( true ) {\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n\n          if( token.type != \"name\" ) {\n            throw \"Next expected variable, not '\" +token.data+ \"'\";\n          }\n\n          var nextcommand = {\n            controlKW: \"for:next\",\n            nextVar: token.data,\n            lineNumber: command.lineNumber,\n            type: command.type\n          };\n\n          commands.push( nextcommand );\n          explicit = true;\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n          if( !( token.type == \"sep\" && token.data == \",\" )) {\n            throw \"Expected comma, found '\" + token.data + \"'\";\n          }\n        }\n\n        if( ! explicit ) {\n          command.controlKW = \"for:next\";\n          command.nextVar = null;\n          commands.push( command );\n        }\n\n      }\n      else if( controlToken == \"IF\") {\n\n        var expr1, expr2, comp;\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"THEN\" });\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        var expr1 = this.parseBoolExpression( context, endTokens );\n        command.params= [ expr1 ];\n\n        token = tokens.shift();\n\n        if( token.type == \"name\" && token.data == \"GOTO\") {\n          var insert = {};\n          insert.data = \"GOTO\";\n          insert.type = \"name\";\n          tokens.unshift( insert );\n        } else {\n          if( tokens.length > 0 ) {\n            if( tokens[0].type == \"num\" ) {\n              var insert = {};\n              insert.data = \"GOTO\";\n              insert.type = \"name\";\n              tokens.unshift( insert );\n            }\n          }\n        }\n\n        //var block = this.parseLineCommands( context );\n        var result = this.parseLineCommands( context );\n        var block = result.commands;\n\n        if( this.debugFlag ) {\n          console.log( block );\n        }\n\n        commands.push( command );\n\n        for( var bi=0; bi<block.length; bi++) {\n          commands.push( block[bi] );\n        }\n\n      }\n      else if( controlToken == \"DATA\") {\n\n        var dataArray = [];\n        var endTokens;\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"sep\", data: \",\" });\n\n        while ( true ) {\n            var pair = this.parseSimpleExpression( context, endTokens );\n\n            var expr1 = pair[0];\n\n\n            if( expr1 === undefined ) {\n              throw \"DATA: expected data\";\n            }\n\n            dataArray.push( expr1 );\n\n            token = pair[1];\n            if( token === undefined ) {\n              break;\n            }\n            if( token.type == \"cmdsep\" && token.data == \":\" ) {\n              break;\n            }\n            else if( token.type == \"sep\" && token.data ==\",\") {\n              continue;\n            }\n            else {\n              this.throwError( context, \"data unknown token found \" + token.type+\"/\"+token.data);\n            }\n        }\n\n        command.params=dataArray;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"SUB\") {\n\n        var label = \"\";\n        token = tokens.shift();\n        if( token == null ) { throw \"SUB expected label\"; }\n\n        if( token.type != \"name\" ) {\n          throw \"SUB expected label not '\" +token.data+ \"'\";\n        }\n\n        label = token.data.toUpperCase();\n\n        token = tokens.shift();\n        if( token != null ) { throw \"SUB unexpected data after label\"; }\n\n        command.label = label;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"REM\" ) {\n\n        while( true ) {\n\n            token = tokens.shift();\n            if( token == null ) { break ; }\n        }\n\n        commands.push( command );\n\n      }\n      else {\n        this.throwError( context, command.controlKW + \" not implemented\");\n      }\n    }\n  }\n\n  parseStatementCall(  context, preTokens, commands, command, nameToken, token0 ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.statementName = this.normalizeStatementName( nameToken );\n    command.type = \"call\";\n\n\n    if( token.type != \"@@@notoken\") {\n      tokens.unshift( token );\n    }\n\n    command.params = [];\n\n    while ( true ) {\n\n      var endCommand = false;\n      var endTokens = [];\n      endTokens.push( { type: \"sep\", data: \"@@@all\" });\n      endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n      var expression = this.parseBoolExpression( context, endTokens );\n      if( this.debugFlag ) {\n        console.log( expression );\n      }\n\n      if( expression != null ) {\n        command.params.push( expression );\n\n        token = tokens.shift();\n        if( token != undefined ) {\n          if( token === undefined ) {\n            endCommand = true;\n          }\n          if( token.type == \"cmdsep\" ) {\n            endCommand = true;\n          }\n          else if( token.type == \"sep\") {\n            continue;\n          }\n          else {\n            this.throwError( context, \"Unexpected characters in statement call: '\" + token.data +\"'\");\n          }\n        }\n        else {\n          endCommand = true;\n        }\n\n      }\n      else {\n        endCommand = true;\n      }\n\n      if( endCommand  ) {\n        commands.push( command );\n        break;\n      }\n    }\n  }\n\n\tparseLineCommands( context, preTokens ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar commands = [];\n    var handlers = {};\n\n\t\tvar i=1;\n\t\twhile( true ) {\n\n\t\t\tvar command = {};\n\t\t\tvar token;\n      var keyword = false;\n      var control = false;\n\n\t\t\tcommand.lineNumber = context.lineNumber;\n\n\t\t\ttoken = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif( token.type == \"cmdsep\" ) {\n\t\t\t\t/* empty command */\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif( token.type != \"name\" ) {\n\t\t\t\tif( token.type != \"trash\" ) {\n          this.throwError( context, \"Unexpected token, expected symbolname, got '\" + oken.data +\"'\") ;\n        }\n        else {\n          this.throwError( context, \"Unexpected character, expected \\\"symbolname\\\", got \" + token.detail ) ;\n        }\n\t\t\t}\n\n\t\t\tvar nameToken = token.data;\n\t\t\tvar cmdType = \"unknown\";\n\n\t\t\tif( this.CTRL_KW.indexOf( token.data ) > -1) {\n\t\t\t\t\tcontrol = true;\n\t\t\t}\n\n      if( this.KEYWORDS.indexOf( token.data ) > -1 || token.data == \"XON\") {\n\t\t\t\t\tkeyword = true;\n\t\t\t}\n      else {\n        if( this.SHORTCUT_KW.indexOf( token.data ) > -1) {\n  \t\t\t\t\tkeyword = true;\n  \t\t\t}\n      }\n\n\t\t  token = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\ttoken = { type: \"@@@notoken\" };\n\t\t\t}\n\n      if (  control ) {\n\n        this.parseControlStructure( context, preTokens, commands, command, handlers, nameToken, token );\n\n      }\n\t\t\telse if( token.type == \"eq\") {\n\n\t\t\t\tthis.parseAssignment( context, preTokens, commands, command, nameToken, token );\n\t\t\t}\n      else if( token.type == \"bracket\" && token.data==\"(\" && !keyword ) {\n\n\t\t\t\tthis.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n\t\t\t}\n      else {\n          if( !keyword ) {\n            console.log(\"Dump: \",context, preTokens, commands, command, nameToken, token);\n            this.throwError( context, \"no such command: \" + nameToken );\n          }\n          this.parseStatementCall( context, preTokens, commands, command, nameToken, token );\n\n      }\n\n\t\t}\n\n    var result = {\n        commands: commands,\n        handlers: handlers\n      };\n\n    return result;\n\t}\n\n  logTokens( tokens ) {\n    if( !this.debugFlag ) { return ; }\n\n    var tokensStr = \"\";\n    for( var i=0; i<tokens.length; i++) {\n      var tok = tokens[i];\n      var tokStr = tok.type + \":\" + tok.data;\n      if( tokensStr != \"\" ) {\n        tokensStr += \", \";\n      }\n      tokensStr += tokStr;\n    }\n\n    console.log( tokensStr );\n\n\n    for( var i=0; i<tokens.length; i++) {\n        var tok = tokens[i];\n        console.log(\"token: \",tok);\n    }\n\n  }\n\n\n\n\n  parseErrorLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n\n    errContext=\"tokenizer\";\n    detail=\"init\";\n\t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n    detail=\"parsing tokens\";\n    var tokens = toker.tokenize();\n    if( this.debugFlag ) {\n      console.log(\"Tokens after tokenizer\");\n    }\n    this.logTokens( tokens );\n\n    detail=\"internal\";\n    tokens = this.upperCaseNameTokens( tokens );\n    tokens = this.removePadding( tokens );\n    tokens = this.mergeCompTokens( tokens );\n    tokens = this.mergeBrokenUpTokens( tokens );\n\n\n    if( this.debugFlag ) {\n      console.log(\"Tokens after merge\");\n    }\n    this.logTokens( tokens );\n\n    if( tokens.length == 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif( tokens[0].type == \"num\" ) {\n\t\t\tlineRecord.lineNumber = tokens[0].data;\n      lineNr = tokens[0].data;\n      var lineRest = line.substr( lineNr.length );\n      return this.parseLine( lineNr + \" REM[ERROR] \" + lineRest  );\n    }\n    else {\n      throw \"Expected line number, when reparsing line with error\";\n    }\n\n  }\n\n  parseLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n    try {\n      errContext=\"tokenizer\";\n      detail=\"init\";\n  \t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n      detail=\"parsing tokens\";\n      var tokens = toker.tokenize();\n      if( this.debugFlag ) {\n        console.log(\"Tokens after tokenizer\");\n      }\n      this.logTokens( tokens );\n\n      detail=\"internal\";\n      tokens = this.upperCaseNameTokens( tokens );\n      tokens = this.removePadding( tokens );\n      tokens = this.mergeCompTokens( tokens );\n      tokens = this.mergeBrokenUpTokens( tokens );\n\n\n      if( this.debugFlag ) {\n        console.log(\"Tokens after merge\");\n      }\n      this.logTokens( tokens );\n\n      if( tokens.length == 0 ) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tif( tokens[0].type == \"num\" ) {\n  \t\t\tlineRecord.lineNumber = tokens[0].data;\n        lineNr = tokens[0].data;\n        tokens.shift();\n      }\n\n  \t\tvar context = {\n        tokens: tokens,\n        lineNumber: lineRecord.lineNumber\n      }\n\n      errContext = \"parser\";\n      detail=\"parsing commands\";\n      var result = this.parseLineCommands( context );\n      var commands = result.commands;\n      lineRecord.commands = commands;\n      lineRecord.raw = line;\n      lineRecord.handlers = result.handlers;\n      return lineRecord;\n    }\n    catch ( e ) {\n\n      if( this.erh.isError( e ) ) {\n        if( e.lineNr == -1 ) {\n          if( lineNr != -1 ) {\n            e.lineNr = lineNr;\n          }\n        }\n        throw e;\n      }\n      this.throwError( null, errContext + \" error (\" +e+ \") while \" + detail );\n    }\n  }\n\n  getTokens( line, merge, noPadding  ) {\n\n    try {\n      var toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n      var tokens = toker.tokenize();\n      if( noPadding) { tokens = this.removePadding( tokens ); }\n      if( merge ) {tokens = this.mergeCompTokens( tokens ); }\n      this.logTokens( tokens );\n      return tokens;\n    }\n    catch ( e ) {\n      console.log( e );\n      this.throwError(null,\"getTokens error\",\"internal\");\n    }\n  }\n}\n\n//--EOC \n\n// ## basictokenizer.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basictokenizer.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basictokenizer.js\n\nclass StringReader {\n\n\tconstructor( strIn ) {\n\t\t\tthis.buffer = strIn;\n\t\t\tthis.index = 0;\n\t\t\tthis.lineIndex = 1;\n\t\t\tthis.line = 1;\n\t\t\tvar a={}; a.b=strIn;\n\n\t}\n\n\tpeek() {\n\t\treturn this.buffer.substr( this.index,1 );\n\t}\n\tpeek2() {\n\t\treturn this.buffer.substr( this.index,2 );\n\t}\n\n\n\tunconsume( x ) {\n\t\tthis.index -= x;\n\t}\n\n\tconsume() {\n\n\t\tvar c = this.buffer.substr( this.index,1 );\n\t\tthis.index ++;\n\t\tif( c == \"\\n\") {\n\t\t\tthis.line++;\n\t\t\tthis.lineIndex = 1;\n\t\t}\n\n\t}\n\n\tEOF() {\n\t\tvar len = this.buffer.length;\n\t\tif( this.index < len ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n\nclass Tokenizer {\n\n\tconstructor( reader, keywords ) {\n\t\t\tthis.tokens = [];\n\t\t\tthis.reader = reader;\n\t\t\tthis.keywords = keywords;\n\t\t\tthis.greedy = false;\n\t}\n\n\tisOpChar( ctx ) {\n\n\t\tvar rv = ctx.c.match(\"[+]|[-]|[*]|[/]|[\\\\%]|[\\\\^]|[;]\") != null;\n\n\t\treturn [rv,0];\n\n\t}\n\n\tisCompChar( ctx ) {\n\n\t\tvar rv =  (ctx.c == \"<\" || ctx.c == \">\");\n\t\treturn [rv,0];\n\t}\n\n\tisEqChar( ctx ) {\n\t\t\tif( ctx.c == \"=\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisNameChar( ctx  ) {\n\n\t\t//console.log(\"SEQ: \" + ctx.seq);\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\t\tvar rv = ctx.c.match(\"[a-zA-Z0-9$%?]\") != null;\n\n\t\tif( ctx.c== \"%\" ) {\n\t\t\t\trv = false;\n\t\t\t\tif( ctx.prev != null ) {\n\t\t\t\t\tvar varNameChar = ctx.prev.match(\"[a-zA-Z0-9]\") != null;\n\t\t\t\t\tif( varNameChar ) {\n\t\t\t\t\t\tctx.endFound = true;\n\t\t\t\t\t\trv = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\n\t\tif( ctx.c==\"$\" ) {\n\t\t\tctx.endFound = true;\n\t\t}\n\n\t\tif( this.greedy ) {\n\t\t\tif( this.keywords.indexOf( ctx.seq.toUpperCase() ) >-1 ) {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\telse if( ! (ctx.seq === undefined )) {\n\t\t\t\tvar trappedKW = false;\n\t\t\t\tvar trapped = null;\n\t\t\t\tfor( var i=0; i<this.keywords.length; i++) {\n\t\t\t\t\tvar kw = this.keywords[i];\n\t\t\t\t\tif( ctx.seq.toUpperCase().indexOf( kw ) > 0 )  {\n\t\t\t\t\t\ttrappedKW = true;\n\t\t\t\t\t\ttrapped = kw;\n\t\t\t\t\t\treturn [rv, kw.length ];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn [rv,0];\n\t}\n\n\tisNumChar( ctx  ) {\n\t\treturn [(ctx.c.match(\"[0-9\\.~]\") != null),0];\n\t}\n\n\tisPadChar( ctx  ) {\n\t\t\tif( ctx.c == \" \" || ctx.c == \"\\t\" || ctx.c == \"\\n\" || ctx.c == \"\\r\") {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\n\t\t\treturn [false,0];\n\t}\n\n\tisCommandSepChar( ctx  ) {\n\t\t\tif( ctx.c == \":\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisSepChar( ctx  ) {\n\t\t\tif( ctx.c == \",\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\tisAnyChar( ctx  ) {\n\t\t\treturn [true,0]; /* Will be executed last */\n\t}\n\n\tisBracket( ctx  ) {\n\t\tif( ctx.c == \"(\" || ctx.c == \")\" || ctx.c == \"[\" || ctx.c == \"]\") {\n\t\t\treturn [true,0];\n\t\t}\n\t\treturn [false,0];\n\t}\n\n\n\tisStrChar( ctx ) {\n\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\n\t\tif( ctx.index == 0) {\n\t\t\tif( ctx.c==\"\\\"\" ) {\n\t\t\t\tctx.inString = true;\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t\t}\n\t\telse if( ctx.inString ) {\n\t\t\tif ( ctx.index > 0 && ctx.c==\"\\\"\") {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\treturn [true,0];\n\t\t}\n\n\t\treturn [false,0];\n\n\t}\n\n\tnormalizeToken( tok0 ) {\n\t\tvar tok = tok0;\n\n\t\ttok.type = tok0.type;\n\n\t\tif( tok.type == \"str\" ) {\n\t\t\t\ttok.data = tok0.data.substr(1,tok0.data.length-2);\n\t\t}\n\t\treturn tok;\n\t}\n\n\treadChars( read, type0, compareF, tokenType ) {\n\t\tvar tok = { type: type0, data : \"\" }\n\t\tvar ctx = { index:0, prev: null, seq: \"\" };\n\n\t\twhile(!read.EOF()) {\n\n\t\t\tvar c = read.peek();\n\n\t\t\tctx.seq += c;\n\t\t\tctx.c = c;\n\n\t\t\tvar rv = this[compareF ] ( ctx );\n\t\t\tif( rv[1] > 0 ) {\n\t\t\t\t\tread.unconsume( rv[1]-1 );\n\t\t\t\t\tctx.seq = ctx.seq.substr(0,ctx.seq.length-rv[1]) ;\n\t\t\t\t\ttok.data = ctx.seq;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( !rv[0] ) {\n\t\t\t\treturn this.normalizeToken( tok );\n\t\t\t}\n\t\t\ttok.data += c;\n\t\t\tread.consume();\n\n\t\t\tctx.index++;\n\t\t\tctx.prev = c;\n\n\t\t\tif( tokenType == \"chr\") {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn this.normalizeToken( tok );\n\t}\n\n\n\ttokenize() {\n\t\tvar read = this.reader;\n\n\t\tvar _this = this;\n\t\tvar tokens = [];\n\n\t\tvar parseRules = [];\n\t\tvar TYPEIX = 0;\n\t\tvar FUNCIX = 1;\n\t\tvar STRINGTYPEIX = 2;\n\n\t\tparseRules.push([\"pad\", \t\t\"isPadChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"str\", \t\t\"isStrChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"num\", \t\t\"isNumChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"name\", \t\t\"isNameChar\"\t, \"str\"] );\n\t\tparseRules.push([\"op\", \t\t\t\"isOpChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"comp\", \t\t\"isCompChar\"  , \"chr\"] );\n\t\tparseRules.push([\"eq\", \t\t\t\"isEqChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"bracket\", \"isBracket\"   , \"chr\"] );\n\t\tparseRules.push([\"sep\", \t\t\"isSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"cmdsep\", \t\"isCommandSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"trash\", \t\"isAnyChar\"   , \"chr\"] );\n\n\t\twhile( !read.EOF() ) {\n\t\t\tvar c = read.peek();\n\t\t\tvar tokenFound = false;\n\n\t\t\tfor( var i=0; i<parseRules.length; i++) {\n\t\t\t\tvar rule = parseRules[ i ];\n\n\t\t\t\tvar ctx = { index: 0, c:c }\n\t\t\t\tvar rv = this[rule[FUNCIX]]( ctx );\n\t\t\t\tif( rv[0] ) {\n\t\t\t\t\t\tvar tok = this.readChars( read, rule[TYPEIX], rule[FUNCIX], rule[STRINGTYPEIX] );\n\n\t\t\t\t\t\tif( tok.type == \"name\") {\n\t\t\t\t\t\t\ttok.data = tok.data.toUpperCase();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( tok.type == \"trash\") {\n\t\t\t\t\t\t\ttok.detail = \"'\" + tok.data + \"' (ASCII-code=\" + tok.data.charCodeAt(0) + \")\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttokens.push( tok );\n\t\t\t\t\t\ttokenFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//do nothing\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!tokenFound) {\n\t\t\t\tthrow \"syntax error, unexpected character: '\" + c + \"' =>\" + read.line + \":\" + read.lineIndex;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n}\n\n//--EOC \n\n// ## input.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/input.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/input.js\n\nclass Input {\n\n  constructor( sys ) {\n    this.keyPress = [];\n    this.interactive = false;\n    this.sys = sys;\n  }\n\n  setHandler( hc ) {\n    this.handlerClazz = hc;\n  }\n\n  setInterActive( flag ) {\n\n    this.interactive = flag;\n    this.sys.blinkMode( flag  );\n\n  }\n\n\n  getInterActive() {\n\n    return this.interactive;\n\n  }\n\n\n  flush() {\n    this.keyPress = [];\n  }\n\n  inputKeyHandler( e )  {\n\n    var hc = this.handlerClazz;\n\n    if( e.keyLabel == \"Escape\" ) {\n        hc[\"stop\"]();\n        return;\n    }\n\n    hc[\"keyInterrupt\"]( \"keypress\", e );\n\n    if( !this.interactive ) {\n        this.keyPress.push( e );\n    }\n    else {\n        hc[\"interactiveKeyHandler\"]( e );\n      }\n  }\n\n  getKey() {\n    var key = this.keyPress.shift();\n    if( key ) {\n      return key;\n    }\n    return null;\n  }\n\n}\n\nclass MutedInput {\n\n  setHandler( hc ) {}\n  setActive( flag ) {}\n  getKey() { return null; }\n  inputKeyHandler(e) {}\n  getKey() { return null;}\n\n}\n\n//--EOC \n\n// ## processes.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/processes.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/processes.js\n\nclass processes {\n\n\tconstructor( sys ) {\n\n\t\tconst STATE_NULL \t\t= 9660;\n\t\tconst STATE_LASTSTATE = 9661;\n\t\tconst STATE_CLI = \t\t9670;\n\t\tconst STATE_RUNNING = 9671;\n\t\tconst STATE_INPUT \t= 9672;\n\t\tconst STATE_WAITING = 9673;\n\t\tconst STATE_SYNCHING = 9674;\n\n\t\tthis.STATE_NULL \t\t\t= STATE_NULL;\n\t\tthis.STATE_LASTSTATE \t= STATE_LASTSTATE;\n\t\tthis.STATE_CLI \t\t\t\t= \t\tSTATE_CLI;\n\t\tthis.STATE_RUNNING \t\t= STATE_RUNNING;\n\t\tthis.STATE_INPUT \t\t\t= STATE_INPUT;\n\t\tthis.STATE_WAITING \t\t= STATE_WAITING;\n\t\tthis.STATE_SYNCHING \t\t= STATE_SYNCHING;\t\t\n\n\t\tthis.sys = sys;\n\t\tthis.processes = [];\n\n\t\tvar _this = this;\n    \tvar processes = _this.processes;\n\n\t\tthis.idlerInterval = null;\n\t\tthis.runInterval = null;\n\t\tthis.waitTimeOut = null;\n\n\t\tvar lastState = STATE_NULL;\n\t\tvar state = STATE_NULL;\n\n\t\tthis.avgIdlerTime = 10;\n\n\t\tvar changeState = function( newState, data ) {\n\n\t\t\tif( newState == STATE_INPUT ) {\n\t\t\t\t_this.killRuntimeInterval();\n\t\t\t}\n\t\t\telse if( newState == STATE_WAITING ) {\n\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t_this.startWaitingTimeOut( data );\n\t\t\t}\n\t\t\telse if( newState == STATE_SYNCHING ) {\n\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t_this.killWaitingTimeOut();\n\t\t\t\t\n\t\t\t\t_this.sys.postsynchrequest( 0 );\n\t\t\t}\n\t\t\telse if( newState == STATE_CLI ) {\n\t\t\t\t_this.killRuntimeInterval();\n\t\t\t\t_this.killWaitingTimeOut();\n\t\t\t}\n\t\t\telse if( newState == STATE_RUNNING ) {\n\t\t\t\t_this.killWaitingTimeOut();\n\t\t\t\t_this.startRuntimeInterval( data );\n\t\t\t}\n\n\t\t\tlastState = state;\n\t\t\tstate = newState;\n\t\t}\n\n\t\tvar flags, pstate, update, wtime, p;\n\n\t\tthis.idlerFunction = function()  {\n\t\t\tvar m1 = new Date().getTime();\n\n\t\t\tif( state == STATE_RUNNING  || state == STATE_WAITING || state == STATE_SYNCHING) {\n\t\t\t\treturn; //don't steal cycles from running or waiting timer, or synching process\n\t\t\t}\n\n\t\t\tp = processes[0];\n\n\t\t\tvar running = p.cpuNeeded();\n\t\t\tif( running>.1 ) { //we do not get this from cycle.  At least not in good time.\n\t\t\t\tvar stat = p.getStatus();\n\t\t\t\t_this.sys.poststatus( 0, stat );\n\n\t\t\t\tchangeState( STATE_RUNNING, running );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tflags = p.cycle();\n\n\t\t\tupdate = flags[ 0 ];\n\t\t\tpstate = flags[ 1 ];\n\t\t\twtime = flags[ 2 ];\n\n\t\t\tif( update ) {\n\t\t\t\tvar stat = p.getStatus();\n\t\t\t\t_this.sys.poststatus( 0, stat );\n\t\t\t}\n\n\t\t\tif( pstate != state ) {\n\t\t\t\tchangeState( pstate, wtime );\n\t\t\t}\n\n\t\t\tvar m2 = new Date().getTime();\n\t\t\tvar m3 = m2-m1;\n\n\t\t\t_this.avgIdlerTime = ((_this.avgIdlerTime * 99) + m3) / 100; \n\t\t}\n\n\t\tthis.runningFunction = function()  {\n\n\t\t\tif( state != STATE_RUNNING ) {\n\t\t\t\treturn; //should never get here\n\t\t\t}\n\n\t\t\t//p = processes[0];\n\t\t\tflags = p.cycle();\n\n\t\t\tpstate = flags[ 1 ];\n\t\t\twtime = flags[ 2 ];\n\n\t\t\tif( pstate != state ) {\n\t\t\t\tchangeState( pstate, wtime );\n\t\t\t}\n\n\t\t}\n\n\t\tthis.waitingFunction = function()  {\n\n\t\t\t_this.runInterval = null;\n\t\t\tp.clearWaiting();\n\t\t\tchangeState( lastState, 0 );\n\n\t\t\tif( state == STATE_RUNNING ) {\n\t\t\t\t_this.runningFunction();\n\t\t\t}\n\t\t}\n\n\t\tthis.synch = function( id )  {\n\n\t\t\t_this.runInterval = null;\n\t\t\tp.clearSynching();\n\n\t\t\tchangeState( lastState, 0 );\n\n\t\t\tif( state == STATE_RUNNING ) {\n\t\t\t\t_this.runningFunction();\n\t\t\t}\n\t\t}\n\n\t\tchangeState( STATE_CLI );\n}\n\n\tstartIdlerInterval()  {\n\t\tif( this.idlerInterval == null ) {\n\t\t\t\t //this.sys.log(\"Starting process interval (first register)\");\n\t\t\t\t this.idlerInterval = setInterval( this.idlerFunction, 200) ;\n\t\t}\n\t}\n\n\tstartRuntimeInterval( cpu )  {\n\t\tif( this.runInterval == null ) {\n\t\t\t\t //this.sys.log(\"Starting running interval \" + cpu);\n\n\t\t\t\t var iv = Math.floor( 220 - (200*cpu) );\n\t\t\t\t //this.sys.log(\"Starting running interval# \" + iv);\n\n\t\t\t\t this.runInterval = setInterval( this.runningFunction, iv) ;\n\t\t}\n\t}\n\n\tkillRuntimeInterval()  {\n\t\tif( this.runInterval != null ) {\n\t\t\t\t //this.sys.log(\"Stopping running interval\");\n\t\t\t\t clearInterval( this.runInterval ) ;\n\t\t\t\t this.runInterval = null;\n\t\t}\n\t}\n\n\tstartWaitingTimeOut( t )  {\n\t\tif( this.waitTimeOut == null ) {\n\t\t\t\t //this.sys.log(\"Starting waiting timeout \" + t);\n\t\t\t\t this.waitTimeOut = setTimeout( this.waitingFunction, t, t ) ;\n\t\t}\n\t}\n\n\tkillWaitingTimeOut()  {\n\t\tif( this.waitTimeOut != null ) {\n\t\t\t\t //this.sys.log(\"Stopping running wait timeout!!\");\n\t\t\t\t clearTimeout( this.waitTimeOut ) ;\n\t\t\t\t this.waitTimeOut = null;\n\t\t}\n\t}\n\n\tgetTicks() {\n\t\treturn this.count;\n\t}\n\n\tget( id ) {\n\t\treturn this.processes[ id ];\n\t}\n\n\tregister( obj ) {\n\n\t\tvar newId = this.processes.length;\n\n\t\tthis.processes.push( obj );\n\t\t//this.processesSleep.push( 0 );\n\t\t//this.fastProcesses.push( false );\n\n\t\tobj.processId = newId;\n\t\tobj.procIf = this;\n\n\t\tthis.startIdlerInterval();\n\n\t\treturn newId;\n\t}\n\n\n\tgetRoot() {\n\n\t\treturn this.processes[ 0 ];\n\t}\n}\n\n//--EOC \n\n// ## commandhelp.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/commandhelp.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/commandhelp.js\n\nclass CommandHelp {\n\n\tconstructor() {}\n\n\n  getCategoriesNormalize(  categoryIndexesInt ) {\n    var categoryIndexes = [\n      Object.getOwnPropertyNames( categoryIndexesInt[0] ),\n      categoryIndexesInt[1]\n    ];\n    return categoryIndexes;\n  }\n\n  getCategoriesIntermediate(  categoryIndexes, clazz ) {\n\n\n    var stats = clazz.getStatements( true );\n    var funs = clazz.getFunctions( true );\n\n    var cat = categoryIndexes[ 0 ];\n    var catLists = categoryIndexes[ 1 ];\n\n    if( cat[ \"general\" ] === undefined ) { cat[ \"general\" ] = 0; catLists[ \"general\" ] = []; }\n\n    for( var i=0;i<stats.length;i++) {\n      var rname = stats[i];\n      var si = rname.replace(\"_stat_\",\"_stat_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) )  { \n          catlabel = clazz[ si ](); \n          var tmp=12;\n      }\n      else { \n        catlabel = \"general\"; \n      }\n\n      var f_attribs = {};\n      if( catlabel.indexOf(\":\") >0 ) {\n\n        var partsLen = catlabel.split(\":\" ).length;\n\n        f_attribs.description =  catlabel.split(\":\" )[1];\n        f_attribs.input =   catlabel.split(\":\" )[2];\n        f_attribs.output =  catlabel.split(\":\" )[3];\n\n        catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_stat_\",\"\").toUpperCase();\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    for( var i=0;i<funs.length;i++) {\n      var rname = funs[i];\n      var si = rname.replace(\"_fun_\",\"_fun_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) ) { catlabel = clazz[ si ](); }\n      else { catlabel = \"general\"; }\n      var f_attribs = {};\n\n      if( catlabel.indexOf(\":\") >0 ) {\n\n          var partsLen = catlabel.split(\":\" ).length;\n\n          f_attribs.description =  catlabel.split(\":\" )[1];\n          f_attribs.input =   catlabel.split(\":\" )[2];\n          f_attribs.output =  catlabel.split(\":\" )[3];\n\n          catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_fun_\",\"\").replace(\"_DLR_\",\"$\").toUpperCase() + \"()\";\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    //var cats = Object.getOwnPropertyNames( cat );\n\n    return [cat,catLists];\n  }\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/textarea.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n\nclass TextArea {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.cursorOn = false;\n\t\tthis.cols = 80;\n\t\tthis.rows = 30;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.hidden = false;\n\n\t\tthis.dc = false;\n\t\tthis.dcCmd = false;\n\n\t\tthis.colors ={};\n\t\tthis.reverse = false;\n\n\t\tthis.defaultFG = 5;\n\t\tthis.defaultBG = 0;\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.initialized = false;\n\n\t\tthis.changes = { all: false, list: [] };\n\t\tthis.pokeFlush = true;\n\n\t\t//this.textArea( this.cols , this.rows , -1, -1 );\n\t}\n\n\tisActive() {\n    \treturn this.initialized && !this.hidden;\n  \t}\n\n\treInit( w, h ) {\n\t\tthis._int_initMode( w, h );\n\t}\n\n\tset( w, h, cells ) {\n\t\tthis._int_initMode( w, h );\n\t\tthis._int_setCells( cells );\n\n\t}\n\n\tdestroy() {\n\t\tthis.cellel = undefined;\n\n\t\tthis.changes = { all: false, list: [] };\n\t\tthis.initialized = false;\n\t}\n\n\n  /* Adding changes, to be posted to MT throught flush */\n\t_int_addChangeAll() {\n\n\t\tthis.changes.all = true;\n\t\tthis.changes.list = [];\n\n\t }\n\n\n\n\tchangeCount() {\n\t\t if( this.changes.all ) { return 65535; }\n\t\t return this.changes.list.length;\n\t }\n\n\t/* Adding single change, to be posted to MT throught flush */\n\t_int_addChange( area ) {\n\n\t\tif(  this.changes.all ) {\n\t\t\tif( this.changes.list.length > 0 ) {\n\t\t\t\t\tthis.changes.list = [];\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar clist = this.changes.list;\n\t\tif( clist.length > 0 ) {\n\t\t\tvar lc = clist[ clist.length -1 ];\n\t\t\tvar nc = area;\n\t\t\tif( lc.y1 == lc.y2 && nc.y1 == nc.y2 && lc.y1 == nc.y1) {\n\t\t\t\tif( nc.x1 == lc.x2 +1 ) {\n\t\t\t\t\t\tvar x2 = lc.x2;\n\t\t\t\t\t\tvar temp=1;\n\t\t\t\t\t\tvar changesTargetArray = lc.cells[0];\n\t\t\t\t\t\tfor( var i=0; i<area.cells[0].length; i++) {\n\t\t\t\t\t\t\tvar cell = area.cells[0][i];\n\t\t\t\t\t\t\tchangesTargetArray.push( cell );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlc.x2 = nc.x2;\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.changes.list.push( area );\n\n\t }\n\n\t /* Force flush to MT the whole buffer */\n\t_int_flushAll() {\n\t\tthis.changes.all = true;\n\t\tthis.changes.list = [];\n\n\t\tthis._int_flush();\n\t}\n\n  \t/* Utility function to prepare input for addChange (which itself prepares for flush )*/\n\t_int_getArea( x1, y1, x2, y2 ) {\n\n\tvar cells = [];\n\n\tfor( var y=y1; y<=y2; y++) {\n\t\t\tvar row = [];\n\t\t\tfor( var x=x1; x<=x2; x++) {\n\t\t\t\trow.push( this.cellel[ y][ x] );\n\t\t\t}\n\t\t\tcells.push( row );\n\t\t}\n\n\t\tvar area =\n\t\t{\n\t\t\t cells: cells,\n\t\t\t x1: x1,\n\t\t\t y1: y1,\n\t\t\t x2: x2,\n\t\t\t y2: y2\n\t\t};\n\n\t\treturn area;\n\n\t}\n\n   /* Flush local changes to Main Thread for actual display updates*/\n\t _int_flush() {\n\n\t\t\tif( this.changes.all ) {\n\t\t\t\tthis.sys.post( \"textupdate-all\",\n\t\t\t\t\t\t{\n \t\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\t\tcells: this.cellel,\n\t\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t\t} );\n\n\t\t\t\tthis.changes.all = false;\n\n\n\t\t\t}\n\t\t\telse if( this.changes.list.length > 0 ) {\n\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  this.changes.list,\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\t\t\t\tthis.changes.list = [];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  [],\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\n\t\t\t}\n\n\t\t}\n\n\tattach( w, h ) {\n\t\tthis._int_initMode( w, h);\n\t}\n\n\tsetPokeFlush( flag ) {\n\t  this.pokeFlush = flag;\n\t}\n\n\n\tpeekc( x, y ) {\n\n\t\tvar cell = this.cellel[y][x];\n     \treturn cell.txt.codePointAt(0);\n\n\t}\n\n\tpeekcl( x, y, m ) {\n\n\t\tvar cell = this.cellel[y][x];\n\n\t\tif( m== 0 ) {\n\t\t\treturn cell.fg;\n\t\t}\n\t\telse if( m== 1 ) {\n\t\t\treturn cell.bg;\n\t\t}\n\t\telse  {\n\t\t\treturn cell.fg + (16*cell.bg);\n\t\t}\n\t}\n\n\tpokec( x, y , c ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\n\t}\n\n\tpokecl( x, y , fg, bg ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\t}\n\n\n\tpokeccl( x, y , c, fg, bg ) {\n\n\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t}\n\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t}\n\t}\n\n\n\ttriggerFlush() {\n\n\t\tthis._int_flush();\n\t}\n\n\n\t_int_initMode( w, h ) {\n\n\t\tif( this.initialized ) {\n\t\t\t\tthis.destroy();\n\t\t}\n\t\tvar sys = this.sys;\n\t\t//var msgs = sys.init.queuedMessages; TODO, what to do with queued messages\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.rows = h;\n\t\tthis.cols = w;\n\n\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.cellel = [];\n\t\tfor( var y=0; y<this.rows; y++) {\n\t\t\tvar rowArray = [];\n\t\t\tfor( var x=0; x<this.cols; x++) {\n\t\t\t\t\tvar cell = {\n\t\t\t\t\t\ttxt: \" \",\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t\t}\n\t\t\t\t\trowArray.push( cell );\n\t\t\t\t}\n\t\t\t\tthis.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\t\t  var _this = this;\n\n\t\tthis._int_flushAll();\n\n\t\tthis.sys.log(\"TEXTAREA w Ready.\");\n\n\t\tthis.initialized = true;\n\t\tthis.pokeFlush = true;\n\t\t/* if true then all pokes in \"character memory\" will be flushed immediately to the */\n\t\t/*main browswer process */\n\t}\n\n\t_int_setCells( srcCells ) {\n\n\t\tthis.cellel = [];\n\t\tfor( var y=0; y<this.rows; y++) {\n\t\t\t\tvar rowArray = [];\n\t\t\t\tfor( var x=0; x<this.cols; x++) {\n\t\t\t\t\tvar cell = {\n\t\t\t\t\t\ttxt: srcCells[ y ][ x ].txt,\n\t\t\t\t\t\tfg:  srcCells[ y ][ x ].fg,\n\t\t\t\t\t\tbg:  srcCells[ y ][ x ].bg\n\t\t\t\t\t}\n\t\t\t\t\trowArray.push( cell );\n\t\t\t\t}\n\t\t\t\tthis.cellel.push( rowArray );\n\t\t\t}\n\n\t\tthis.changes = { all: false, list: [] };\n\t}\n\n\n\tgetDimensions() {\n\t\t\treturn [this.cols, this.rows ];\n\t}\n\n\tgetCurrentLine() {\n\t\tvar y = this.y;\n\t\tvar str = \"\";\n\t\tfor( var i = 0; i< this.acols; i++) {\n\t\t\tvar xi = i + this.ax0;\n\t\t\tstr += this.cellel[ y ][ xi ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\tgetLineFrom( x0, y ) {\n\n\t\tvar str = \"\";\n\t\tvar x2 = this.acols + this.ax0 - 1;\n\n\t\tfor( var i = x0; i< x2; i++) {\n\t\t\tstr += this.cellel[ this.ay0 + y ][ i ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\t/* Commands and functions to modify the text area buffer */\n\n\n\tsetDefault( fg, bg ) {\n\t\tthis.defaultBG = bg;\n\t\tthis.defaultFG = fg;\n\n\t}\n\n\n\tcolorReset() {\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\t//this.cellel = [];\n\t\tvar fg = this.defaultFG;\n\t\tvar bg = this.defaultBG;\n\n\t\tfor( var ay=0; ay<this.rows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = ay;\n\t\t\tfor( var ax=0; ax<this.cols; ax++) {\n\n\t\t\t\tvar x = ax;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x];\n\n\t\t\t\tcell.fg = fg;\n\t\t\t\tcell.bg = bg;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis._int_flushAll();\n\t}\n\n\treset() {\n\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.pokeFlush = true;\n\t\tthis.clear();\n\n\t}\n\n\ttextArea( w, h, xo, yo ) {\n\t\tvar divx = this.cols - w;\n\t\tvar divy = this.rows - h;\n\n\t\tif( xo < 0 ) {\n\t\t\t\tthis.ax0 = Math.floor(divx / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ax0 = xo;\n\t\t}\n\n\t\tif( yo < 0 ) {\n\t\t\t\tthis.ay0 = Math.floor(divy / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ay0 = yo;\n\t\t}\n\n\t\tthis.acols = w;\n\t\tthis.arows = h;\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\t}\n\n\tclear() {\n\n\t\t//this.cellel = [];\n\t\tfor( var ay=0; ay<this.arows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = this.ay0 + ay;\n\t\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\t\tvar x = this.ax0 + ax;\n\n\t\t\t\tvar cell = {\n\t\t\t\t\ttxt: \" \",\n\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t}\n\t\t\t\tthis.cellel[ y ][ x] = cell;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\n\t\tthis._int_flushAll();\n\t}\n\n\n\tjumpTo( destination ) {\n\t\tif( destination == \"home\" ) {\n\t\t\tthis.y = this.ay0;\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\tif( destination == \"end\" ) {\n\t\t\tthis.y = this.ay0 + this.arows - 1;\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"line-start\" ) {\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\telse if( destination == \"line-end\" ) {\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"text-end\" ) {\n\n\t\t\t/* where is the last char -> maxX */\n\t\t\tvar c = \"DC\";\n\t\t\tvar oldx = this.x;\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\n\t\t\tvar maxX = this.x;\n\t\t\t/*-reset, and jump to end of next text area-*/\n\t\t\tthis.x = oldx;\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x< ((this.ax0 + this.acols)-1) && c != \" \") {\n\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\n\n\t\t\t/*make sure we did not jump past last char*/\n\t\t\tif( this.x > maxX ) {\n\t\t\t\tthis.x = maxX;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-end-all\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-start\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x> this.ax0 && c != \" \") {\n\t\t\t\t\t\tthis.x--;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\t\t}\n\n\t\tthis._int_flush();\n\t}\n\n\tcursorMove( dir ) {\n\t\tif( dir == \"up\" ) {\n\t\t\tif( this.y>this.ay0) {\n\t\t\t\tthis.y--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"down\" ) {\n\t\t\tif( this.y< ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.y++;\n\t\t\t}\n\t\t\telse if( this.y== ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t}\n\t\tif( dir == \"left\" ) {\n\t\t\tif( this.x>this.ax0) {\n\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"right\" ) {\n\t\t\tif( this.x< ((this.ax0 + this.acols)-1)) {\n\t\t\t\tthis.x++;\n\t\t\t}\n\t\t}\n\t\tthis._int_flush();\n\t}\n\n\tbackspace() {\n\t\tif( this.x != this.ax0 ) {\n\t\t\t\tthis.x--;\n\t\t}\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tdelete() {\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tnl() {\n\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\n\t\t\tif( ya >= this.arows ) {\n\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\n\t\t\t\tthis._int_flushAll();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_nl() {\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\t\t\tif( ya >= this.arows ) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\t\t\t\treturn { scroll: true }\n\t\t\t}\n\t\t\treturn { scroll: false }\n\n\t}\n\n\twriteln( str ) {\n\n\t\t\tfor( var i=0; i<str.length; i++) {\n\t\t\t\tvar c = str.substr(i,1);\n\t\t\t\tthis.__int_write_direct_ch( c );\n\t\t\t}\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t\tthis._int_flush();\n\t}\n\n\t_int_write( str, insert ) {\n\t\tfor (const c of str) {\n\t\t\tthis.__int_write_direct_ch( c, insert );\n\t\t}\n\t}\n\n\twrite( str ) {\n\t\t\tthis._int_write( str );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\tinsert( str ) {\n\t\t\tthis._int_write( str, true );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\n\n\t__int_scrollLinesDownFrom( y  ) {\n\n\t\t\tfor( var yy=this.rows-1; yy>y; yy-- ) {\n\t\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\t\tvar cell1 = this.cellel[ yy-1  ][ xx ];\n\t\t\t\t\tvar cell2 = this.cellel[ yy  ]  [ xx];\n\n\t\t\t\t\tcell2.fg = cell1.fg;\n\t\t\t\t\tcell2.bg = cell1.bg;\n\t\t\t\t\tcell2.txt = cell1.txt;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\tvar cell1 = this.cellel[ yy  ][ xx ];\n\n\t\t\t\tcell1.txt = \" \";\n\n\t\t\t}\n\n\t\t\tthis._int_addChangeAll();\n\n\t}\n\n\n\tScrollDownByCurrentLine() {\n\n\t\tif( (this.y ) < (this.rows-1) ) {\n\t\t\tthis.__int_scrollLinesDownFrom( this.y );\n\t\t\tthis._int_flush();\n\t\t}\n\t}\n\n\t__int_scrollLineRightFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x1; i>x0; i--) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i-1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\t}\n\n\t__int_scrollLineLeftFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x0; i<x1; i++) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i +1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\n\n\t}\n\n\t__int_write_direct_ch( ch, insert ) {\n\n\t\tvar code = ch.codePointAt(0);\n\n\t\tif( this.dc && this.dcCmd ) {\n\n\t\t\tthis.dc = false;\n\t\t\tthis.dcCmd = false;\n\t\t\tthis._int_control( this.dcCmdCode, code );\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( this.dc && !this.dcCmd ) {\n\t\t\tthis.dcCmd = true;\n\t\t\tthis.dcCmdCode = code;\n\t\t\treturn;\n\t\t}\n\n\t\tif( code == 17 ) {\n\t\t\t//DC1\n\t\t\tthis.dc = true;\n\t\t\tthis.dcCmd = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar cell = this.cellel[ this.y ][ this.x ];\n\n\t\tif( cell == null ) {\n\t\t\tconsole.log( \"cell at \" + this.x + \",\" + this.y +\" == null \");\n\t\t\treturn;\n\t\t}\n\n\t\tvar area;\n\n\t\tif( insert ) {\n\t\t\tthis.__int_scrollLineRightFrom( this.x, this.y );\n\n\t\t\tarea = this._int_getArea( this.x, this.y, this.ax0 + this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\n\t\t}\n\n\t\tcell.txt = ch;\n\n\t\tif( !this.reverse  ) {\n\t\t\tcell.fg = this.colors.txtColor;\n\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t}\n\t\telse {\n\t\t\tcell.bg = this.colors.txtColor;\n\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t}\n\n\t\tvar oldx = this.x;\n\t\tvar oldy = this.y;\n\n\t\tthis.x++;\n\t\tvar ax = this.x - this.ax0;\n\t\tif( ax > (this.acols-1) ) {\n\t\t\tthis.x = this.ax0;\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tarea = this._int_getArea( oldx, oldy, oldx, oldy );\n\t\tthis._int_addChange( area );\n\t\t//this._int_addChangeAll();\n\n\t}\n\n\twritec( chr ) {\n\n\t\tif( chr == \"\\n\" ) {\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tthis.__int_write_direct_ch( chr );\n\t\tthis._int_flush();\n\t}\n\n\n\tsetFilter( f ) {\n\t\tthis.sys.post( \"gfilter\", { d: f }  );\n\t}\n\n\t_int_control( chr, data ) {\n\n\t\tif( chr == 16 ) {\n\t\t\tthis.colors.txtColor = data;\n\t\t}\n\t\telse if( chr == 17 ) {\n\t\t\tthis.colors.txtBgColor = data;\n\t\t}\n\t\telse if( chr == 18 ) {\n\t\t\tthis.sys.post( \"border\", { d: data }  );\n\t\t}\n\t\telse if( chr == 24 ) {  //CANCEL -> (we map it to) Clear Screen\n\t\t\tthis.clear();\n\t\t}\n\t\telse if( chr == 12 ) {  //FORMFEED -> (we map it to) RESET SCREEN\n\t\t\tthis.reset();\n\t\t}\n\t\telse if( chr == 25 ) {  //End of Medium -> (we map it to) Hide\n\t\t\t//this.hide();   TODO\n\t\t}\n\t\telse if( chr == 64 ) {\n\t\t\tthis.reverse = false;\n\t\t}\n\t\telse if( chr == 65 ) {\n\t\t\tthis.reverse = true;\n\t\t}\n\t\telse {\n\t\t\tthis.__int_write_direct_ch( \"?\" );\n\t\t}\n\t}\n\n\n\tsetPos( x, y ) {\n\n\t\tthis._int_setPos( x,y );\n\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorMode( mode ) {\n\t\tthis.cursorMode = mode;\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorPos( x, y ) {\n\t\tif( x<0 || y<0 ) { throw \"pos(\"+x+\",\"+y+\") < 0\" ; }\n\n\t\tif( x>=this.acols || y>= this.arows ) { throw \"pos(\"+x+\",\"+y+\") > max\" ; }\n\n\t\tif( ! ( x === undefined ) ) { this.x = x + this.ax0; }\n\t\tif( ! ( y === undefined ) ) { this.y = y + this.ay0; }\n\n\n\t\tthis._int_flush();\n\t}\n\n\tgetCursorPos() {\n\t\t\treturn [this.x - this.ax0, this.y - this.ay0 ];\n\t}\n\n\tcontrol( chr, data ) {\n\n\t\tthis._int_control( chr, data );\n\t\tthis._int_flush();\n\n\t}\n\n\n\t_int_setPos( x, y ) {\n\n\t\tif(x >= 0) {\n\t\t\t\tthis.x = x + this.ax0;\n\t\t\t\tif( (this.x - this.ax0) >= this.acols ) { this.x = this.acols-1;}\n\t\t}\n\t\tif(y >= 0) {\n\t\t\t\tthis.y = y + this.ay0;\n\t\t\t\tif( (this.y - this.ay0)>= this.arows ) { this.y = this.arows-1;}\n\t\t}\n\n\t\t\n\t\t\n\t}\n\n\tcenter( str, inhibitNewLine ) {\n\n\t\t\tif( str.length > this.cols ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar l = str.length;\n\t\t\tvar l2 = l/2;\n\n\t\t\tvar wh = [ this.acols, this.arows ];\n\n\t\t\tvar x = Math.floor( (wh[0] / 2)-l2 );\n\t\t\tthis._int_setPos( x, -1 );\n\t\t\tthis._int_write( str );\n\n\t\t\tif( !inhibitNewLine ) {\n\n\t\t\t\tvar stat = this.__int_nl();\n\t\t\t\tif( stat.scroll ) {\n\t\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\t\t\t\n\t\t\tvar area = this._int_getArea( this.ax0, this.y, this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_scrollDown() {\n\n\t\tvar ax0 = this.ax0;\n\t\tvar ay0 = this.ay0;\n\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\t\t\tfor( var ay=0; ay<this.arows-1; ay++) {\n\n\t\t\t\tvar y = ay + ay0;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x ];\n\t\t\t\tvar cellyp1 = this.cellel[ y+1 ][ x ];\n\n\t\t\t\tcell.txt = cellyp1.txt;\n\t\t\t\tcell.fg = cellyp1.fg;\n\t\t\t\tcell.bg = cellyp1.bg;\n\t\t\t}\n\t\t}\n\n\t\t//fill last row\n\t\tvar y2 = ay0 + (this.arows-1);\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\n\t\t\tvar cell = this.cellel[ y2 ][ x ];\n\t\t\tcell.txt = \" \";\n\t\t\tif( !this.reverse  ) {\n\t\t\t\tcell.fg = this.colors.txtColor;\n\t\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t\t\tcell.bg = this.colors.txtColor;\n\t\t\t}\n\t\t}\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/playfields.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/playfields.js\n\nclass Playfields {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\n\t\tthis.current = 0;\n\t\tthis.enabledFlag = false;\n\t\tthis.list = null;\n  \t}\n\n  \tenable( flag )  {\n  \t\tthis.enabledFlag = flag;\n  \t}\n\n  \tset( list )  {\n  \t\tthis.list = list;\n  \t}\n\n  \tenabled() {\n  \t\treturn this.enabledFlag;\n  \t}\n\n  \tsetEnable( pid, ix, flag ) {\n\t\tthis.sys.post( \"pfenable\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tflag: flag\n\t\t\t}  );\t  \t\t\n  \t}\n\n\n\tselect( pid, ix ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfselect\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix\n\t\t\t}  );\t\t\n\n\t\tthis.current = ix;\n\t}\n\n\n\tscrollpos( pid, ix, x, y ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfscrollpos\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t}  );\t\t\n\n\t}\n\t\n\n\tviewdefine( pid, ix, x, y, w, h ) {\n\t\tif( ix >= this.list.length ) {\n\t\t\tthrow \"No such playfield \" + ix;\n\t\t}\n\n\t\tif( this.list[ ix ] == null ) {\n\t\t\tthrow \"Playfield not active\";\n\t\t}\t\n\n\t\tthis.sys.post( \"pfviewsize\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: ix,\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\tw: w,\n\t\t\t\th: h\n\t\t\t}  );\t\t\n\n\t}\n\n\tinit( pid, pfIx, bcwC, brhC ) {\n\n\t\t/* If current we also need to update our \n\t\t\tworker text area buffers when done */\n\n\t\tthis.sys.post( \"pfinit\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: pfIx,\n\t\t\t\tbcwC: bcwC, brhC: brhC,\n\t\t\t\tfgColor: 1, bgColor: 0\n\t\t\t}  );\n\t}\n\n\told_init( pid, pfIx, xo, yo, cwC, rhC, bcwC, brhC ) {\n\n\n\t\t/* If current we also need to update our \n\t\t\tworker text area buffers when done */\n\n\t\tthis.sys.post( \"pfinit\",\n\t\t\t{\n\t\t\t\tprocessId: pid,\n\t\t\t\tix: pfIx,\n\t\t\t\tisCurrentIx: this.current == pfIx,\n\t\t\t\txo: xo, yo: yo,\n\t\t\t\tcC: cwC, rC: rhC,\n\t\t\t\tbcwC: bcwC, brhC: brhC,\n\t\t\t\tfgColor: 1, bgColor: 0\n\t\t\t}  );\n\t}\n\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/bitmap.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n\nclass BitMap {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n    this.lineColor = 1;\n    this.changes = {};\n    this.changes.flag = false;\n    this.changes.pixels = [];\n\n\t\tthis.origin( 0,0,1,1);\n  }\n\n\n\torigin( ox0, oy0, odx, ody ) {\n\t\tthis.ox0 = ox0;\n\t\tthis.oy0 = oy0;\n\t\tthis.odx = odx;\n\t\tthis.ody = ody;\n\n\t\tvar dir = [\"m\",undefined,\"p\"];\n\t\tvar xdir = \"x\" + dir[ odx + 1 ];\n\t\tvar ydir = \"y\" + dir[ ody + 1 ];\n\t\tvar direction = xdir + ydir;\n\n\t\tthis[\"_int_convertxy\"] = this.getConvertFunc( direction );\n\n\t}\n\n\treInit( w, h ) {\n\t\tthis.width = w;\n    this.height = h;\n\t}\n\n  attach( w, h ) {\n\t\tthis.reInit( w, h );\n\t}\n\n  isActive() {\n    return this.width > 0;\n  }\n\n  getDimensions() {\n\t\t\treturn [this.width, this.height ];\n\t}\n\n  triggerFlush() {\n\n\t\tif( !this.changes.flag ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sys.post( \"gfxupdate\",\n\t\t\t{\n\t\t\t\tpixels: this.changes.pixels\n\t\t\t}\n\t\t);\n\n\t\tthis.changes.pixels = [];\n\t\tthis.changes.flag = false;\n\n  }\n\n  _int_flush() {\n\n    if( this.changes.flag ) {\n\n      this.sys.post( \"gfxupdate\",\n        {\n          pixels: this.changes.pixels\n        }\n      );\n\n\t\t\tthis.changes.pixels = [];\n\t\t\tthis.changes.flag = false;\n    }\n\n  }\n\n\tsetLineColor( c ) {\n    this.lineColor = c;\n    this.sys.post( \"nativeout\",{\n      action: \"gcolor\",\n      params: { c: c }\n    });\n  }\n\n\n\tsetFillColor( c ) {\n    this.fillColor = c;\n    this.sys.post( \"nativeout\",{\n      action: \"fcolor\",\n      params: { c: c }\n    });\n  }\n\n\tgetConvertFunc( direction ) {\n\t\tvar __this = this;\n\t\tif( direction == \"xpyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + __this.ox0), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xpym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t}\n\n/*\n\t_int_convertxy_xpyp( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor(y + this.oy0)];\n\t}\n\n\t_int_convertxy_xpym( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y )];\n\t}\n\n\t_int_convertxy_xmyp( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( y + this.oy0)];\n\t}\n\n\t_int_convertxy_xmym( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( this.oy0 - y )];\n\t}\n*/\n\n  plot( x, y ) {\n\t\tvar xy2 = this._int_convertxy( x, y );\n\n    var pixel = { x: xy2[0], y: xy2[1], c:this.lineColor };\n\n    this.changes.pixels.push( pixel );\n    this.changes.flag = true;\n\n  }\n\n\tline( x0,y0, x1, y1 ) {\n\n\t\tvar xy0 = this._int_convertxy( x0, y0 );\n\t\tvar xy1 = this._int_convertxy( x1, y1 );\n\n    this.sys.post( \"nativeout\",{\n      action: \"line\",\n      params: { x0:xy0[0], y0:xy0[1], x1:xy1[0], y1:xy1[1] }\n    });\n  }\n\n  fillRect( x,y, w, h ) {\n\n\t\tvar xy = this._int_convertxy( x, y );\n\n\n    this.sys.post( \"nativeout\",{\n      action: \"fillRect\",\n      params: { x:xy[0], y:xy[1], w:w, h }\n    });\n  }\n\n\tdestroy() {\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/audio.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n\nclass Audio {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.userInput = false;\n  }\n\n\tflagUserInput() {\n\t\tthis.userInput = true;\n\t}\n\n  playBeep( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playBeep\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tplaySound( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playSound\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tvolume( volume ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"setVolume\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: volume\n\t\t}\n\t\t);\n\t}\n\n\treset() {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t\t{\n\t\t\t\t\t\tmethod: \"reset\",\n\t\t\t\t\t\tparCount: 0\n\t\t\t}\n\t\t\t);\n\n\t}\n\n\tattackDecayRelease( channel, attackT, decayT, releaseT ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetAttackDecayRelease\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: attackT,\n\t\t\t\t\tp3: decayT,\n\t\t\t\t\tp4: releaseT\n\t\t}\n\t\t);\n\t}\n\n\tchannelVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelVolume\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\tchannelFrequency( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelFrequency\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\n\tchannelSustainVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetSustainLevel\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\taddEffect( channel,  type , value, time ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"addEffect\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: type,\n\t\t\t\t\tp3: value,\n\t\t\t\t\tp4: time\n\t\t}\n\t\t);\n  }\n\n  clearEffect( channel ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"clearEffect\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: channel\n\t\t}\n\t\t);\n\n  }\n\n\tplayEffect( channel, freq ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"playEffect\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: freq\n\t\t}\n\t\t);\n\n\t}\n\n}\n\n//--EOC \n\n// ## workerbootstrap_static.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/workerbootstrap_static.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/workerbootstrap_static.js\n\nsys.log(\"Starting\");\nstart_sys();\n\n//--EOC \n\n"],"names":["sys","appName","unique","console","post","type","message","postMessage","log","args","Array","prototype","slice","call","arguments","args2","i","length","push","JSON","stringify","logerr","load","rt","path","device","processId","loaddata","label","save","data","delete","dir","setcfg","cfg","this","listfs","postsynchrequest","procId","poststatus","status","setfs","fs","setDisplayMode","m","blinkMode","html","executeFunction","htmlnode","get","wait_for_result","export","code","destination","signalHideMenu","flag","hide","init_sys","BasicArray","constructor","name","indices","defaultValue","buffer","getIndexCount","_check","detail","set","val","ptr","last","undefined","ErrorHandler","newError","clazz","context","lineNr","throwError","fromSimpleExternalError","s","lineNr0","parts","split","err","extCode0","extCode1","fromSerializedError","isSerializedError","substr","e","startsWith","isError","Object","toString","clss","Editor","output","out","keyMode","addRunTime","runTime","keyHandlerForCLE","keyLabel","shiftKey","ScrollDownByCurrentLine","backspace","ctrlKey","cursorMove","jumpTo","clear","insert","write","setCursorMode","key","command","getCurrentLine","writeln","executeInteractiveLine","interactiveKeyHandler","BasicRuntime","editor","debugFlag","listSpeed","bitmap","bout","playfields","pfields","input","audio","setHandler","setInterActive","menuEnable","program","runFlag","isWaitingFlag","isSynchingFlag","waitingTime","immediate","printWaitSynchCounter","waitForMessageFlag","waitForMessageVariable","executeLineFlag","goPlayExampleFlag","inputFlag","inputCommand","listFlag","immersiveFlag","statusChanged","gosubReturn","nullTime","Date","getTime","turboMode","cmdCountPerCycleDefault","cmdCountPerCycleTurbo","cmdCountPerCycle","commands","BasicCommands","extendedcommands","ExtendedCommands","erh","vars","functions","loadedData","default","loadedLabel","kbBuffer","yPos","SHORTLINE","LONGLINESTART","LONGLINEEND","forContext","outputCallBacksAll","lineOverFlow","method","scroll","clearScreen","outputCallBacksClScr","synchClock","exitMode","code2colMap","km","symbolTable","up","down","left","right","black","white","red","cyan","purple","green","blue","yellow","orange","brown","pink","grey1","grey2","grey3","backmap","mapInfo","entries","symbolTableBM","flagStatusChange","clearInputCommand","flagInputCommand","setWaiting","time","clearWaiting","setImmediate","setPokeFlush","synchPrint","enableSynching","printNewLine","nl","synchingTime0","clearSynching","synchingTime","getScopeVars","getFullVarList","scopes","getFullScopes","varList","si","fullscope","scope","names","getOwnPropertyNames","value","descr","ii","endsWith","cpuNeeded","getStatus","runPointer","vlen","getVars","pgmLen","varLen","displayMode","startWaitForMessage","start","autoStartAfterLoad","path0","getProgramAsText","deleteFile","variable","keyInterrupt","_type","_data","interrupt","_ix","interruptFlag0","interruptFlag1","line","useLabel","handlers","interrupt0","interrupt0ParamIsLabel","interrupt1","interrupt1ParamIsLabel","newScope","runPointer2","variables","setVar","toUpperCase","pgm","len","found","labels","receiveMessage","_message","reInit","textW","textH","bitmapW","bitmapH","mode","enable","pfEnabled","cells","printError","reason","pgmData","ok","bootPGM","control","runPGM","stop","insertData","isRunning","list","title","files","fname","enterListMode","currentFs","str","deviceNumberLen","stopAfterMessage","HandleStopped","printReady","runStop","listStop","cxy","getCursorPos","string","getLineFrom","inputStartInputPosX","handleLineInput","x","xy","setCursorPos","toggleMenu","startingProgram","flush","importPGMHandler","content","filename","textLinesToBas","fileName","setProgram","exitProgram","closeWindow","windowId","listPointer","printLine","listFlagBakInteractive","getInterActive","setExitMode","v","nullClock","setHours","setSeconds","setMinutes","setMilliseconds","setTurbo","on","appendProgram","exists","j","sort","a","b","getProgram","getProgramState","setProgramState","pgmState","_setByteBits","bits","byte","_getByteBits","masks","results","upperFirst","supressLine","explicitline","line1","onLineStr","printInfo","printHelp","reverseOn","print","colorReset","colors","setDefault","fg","bg","border","resetConsole","getDimensions","reset","setPos","getMillis","getJiffyTime","millis","Math","floor","hours","minutes","hard","muteReady","writel","clrPGM","compressPGMText","pgmTxt","p","Parser","init","kws","getKeyWordCodes","txt2","kw","replaceAll","toLowerCase","String","fromCharCode","getProgramAsTextNoPETSCII","text","l","prepareLineForExportNoPETSCII","trim","getProgramSize","controlKW","prepareLineForExport","txt0","txt","dst","c","charCodeAt","symdef","charAt","src","str1","str2","rv","indexOf","replace","rebuildNoPETSCIILineString","raw","noPetsciiLine","parseLine","toLower","cc","prevCharIsQuote","nextCharIsQuote","dst2","ResolveStringSymbolToCode","prepareLineForImport","num","parseInt","getProgramLines","padZeros2","evalExpressionPart","parseFloat","PI","varIntName","arr","ai","evalExpression","values","params","par","ecommands","cmds","nFunName","functionName","stc","fName","parValue","restore","functRecord","expr","op","pow","negate","binaryNegate","exitInputState","cycle","cmdCount","lineNumber","isActive","triggerFlush","changeCount","countdown","listCodeLine","bf","runCommands","traceVars","tvi","thisVar","thisValue","oldValue","traceOldValues","traceList","af","executedCount","retreiveRuntimeLine","pi","procIf","cstate","STATE_CLI","STATE_WAITING","STATE_SYNCHING","STATE_INPUT","STATE_RUNNING","doReturn","oldPointers","pop","doInterruptReturn","closeScope","gosub","line0","retLine","retCmd","goto","startAsGoto","isListing","isInput","isReady","getDataBlocks","readData","dataPointer","result","getDataLength","setData","label0","typeParts","parseSimpleDataI_CSV","toArr","data2","parseSimpleDataS_CSV","parseSimpleDataS_LINES","printChar","rawLine","rebuildLineString","nr","removePadding","renumbering","addSmartPadding","shortenKeywords","newString","tokens","getTokens","nopadTokens","foundGoto","foundGotoParIndex","newLine","lineIsData","lineIsRem","lineIsSub","renumberProgram","gap","newLineNr","lineNumbers","newLineNr2","ceil","lRec","PETSCIIreplace","keywordCompress","compressProgram","normalizeProgram","restoreDataPtr","normalizeData","dataRec","bak1","bak2","normalize","k","doForInit","from","to","step","varName","cmdPointer","cmdArrayLen","linePointersLen","ctx","ctxv","doForNext","nextVarName","retreiveLine","parseLineNumber","commandToString","cmd","statementName","var","limit","TERMINATE_W_JUMP","end","cnt","cn","onCommand","onExpr","onLineNrs","jump","nextVar","ix","arrRec","arrayNames","pardefs","mycommands","enabled","varType0","varType","arrayAssignment","expression","getArray","getTraceList","setTraceVar","resetTraceVar","old","oldProgram","new","removePgmLine","linenr","pgm2","pl","padSpaces6","no","padSpaces8","insertPgmLine","insertPgmLineLocal","myProgram","lines","exception","parseErrorLine","startConsoleDataInput","inputVars","inputVarsPointer","isInputCommand","qMark","isNaN","basicCmds","runtime","func","statementList","getStatements","stats","stats2","getFunctions","getAllCategories","categoryIndexes","getCategories","categoryIndexes2","CommandHelp","getCategoriesNormalize","getCategoriesIntermediate","_stat_info_help","_stat_help","pars","catRecord","lst","catLists","hlpctx","lbl","attr","attribs","padLen","pad","description","_if_cls","_stat_info_cls","_stat_cls","_stat_info_reset","_stat_reset","_stat_info_menu","_stat_menu","_stat_info_reverse","_stat_reverse","reverse","_stat_info_beep","_stat_beep","playBeep","_stat_info_sound","_stat_sound","playSound","_stat_info_setadr","_stat_setadr","attackDecayRelease","_stat_info_volume","_stat_volume","volume","_stat_info_chfreq","_stat_chfreq","channelFrequency","_stat_info_chvolume","_stat_chvolume","channelVolume","_stat_info_chsvolume","_stat_chsvolume","channelSustainVolume","_stat_info_addfx","_stat_addfx","addEffect","_stat_info_clearfx","_stat_clearfx","clearEffect","_stat_info_playfx","_stat_playfx","freq","playEffect","_stat_info_textarea","_stat_textarea","cols","round","rows","wh","xo","yo","divx","divy","textArea","_stat_info_gcolor","_stat_gcolor","col","setLineColor","_stat_info_fcolor","_stat_fcolor","setFillColor","_stat_info_origin","_stat_origin","origin","_stat_info_line","_stat_line","_stat_info_box","_stat_box","fillRect","_stat_info_plot","_stat_plot","plot","_if_center","isNumber","isFinite","normalizeIfNumber","_stat_info_center","_stat_center","con","exparts","exparts2","center","_stat_info_gtext","_stat_gtext","gtext","_stat_info_pokeccl","_stat_pokeccl","pokeccl","_stat_info_pokec","_stat_pokec","pokec","_stat_info_pokecl","_stat_pokecl","pokecl","_stat_info_pokebcl","_stat_pokebcl","_int_checkPlayfieldNo","_stat_info_pfinit","_stat_pfinit","_stat_info_playfield","_stat_playfield","select","_stat_info_pfscroll","_stat_pfscroll","scrollpos","_stat_info_pfview","_stat_pfview","viewdefine","_stat_info_pfenable","_stat_pfenable","setEnable","_stat_info_locate","_stat_locate","row","_stat_info_hide","_stat_hide","_if_html","_stat_info_html","_stat_html","handleIx","htmlHandle","htmlValue","htmlAppend","_stat_info_htmlnode","_stat_htmlnode","node","_stat_info_htmlbg","_stat_htmlbg","url","_stat_info_color","_stat_color","bgcol","_stat_info_display","_stat_display","modes","screenModes","_stat_info_gfilter","_stat_gfilter","filter","setFilter","_stat_info_border","_stat_border","bcol","_stat_info_export","_stat_export","_stat_info_copy","_stat_copy","_stat_info_txtcopy","_stat_txtcopy","_fun_info_peekcl","_fun_peekcl","peekcl","_fun_info_peekc","_fun_peekc","peekc","_fun_info_ucbase","_fun_ucbase","baseLabel","_fun_info_uc_DLR_","_fun_uc_DLR_","fromCodePoint","_fun_info_dc_DLR_","_fun_dc_DLR_","_fun_info_html_DLR_","_fun_html_DLR_","_fun_info_width","_fun_width","_fun_info_height","_fun_height","_fun_info_cols","_fun_cols","_fun_info_columns","_fun_columns","_fun_info_rows","_fun_rows","pgmman","addRuntime","keyLabelCodes","randnrs","random","randIndex","randStep","_stat_info_new","_stat_new","_stat_info_list","_stat_list","_if_get","_if_getkey","_if_read","_if_input","_if_list","_if_run","_stat_info_read","_stat_read","p0","_stat_info_get","_stat_get","getKey","_stat_info_getkey","_stat_getkey","_stat_info_input","_stat_input","_stat_info_restore","_stat_restore","_stat_info_waitms","_stat_waitms","_stat_info_rsynch","_stat_rsynch","_stat_info_load","_stat_load","aSync","_stat_info_setdata","_stat_setdata","_stat_info_datablocks","_stat_datablocks","_stat_info_loaddata","_stat_loaddata","_stat_info_dir","_stat_dir","_stat_info_fs","_stat_fs","_stat_info_renumber","_stat_renumber","_stat_info_vars","_stat_vars","_stat_info_tracevar","_stat_tracevar","_stat_info_clrtracevar","_stat_clrtracevar","_stat_info_boot","_stat_boot","_stat_info_save","_stat_save","_stat_info_delete","_stat_delete","_stat_info_run","_stat_run","_if_print","_stat_info_immediate","_stat_immediate","_stat_info_print","_stat_print","_stat_info_clr","_stat_clr","_fun_info_datalen","_fun_datalen","_fun_info_chr_DLR_","_fun_chr_DLR_","_fun_info_str_DLR_","_fun_str_DLR_","number","base","numberStr","_fun_info_abs","_fun_abs","_fun_info_len","_fun_len","_fun_info_asc","_fun_asc","_fun_info_val","_fun_val","_fun_info_hex2dec","_fun_hex2dec","_fun_info_hex_DLR_","_fun_hex_DLR_","_fun_info_exp","_fun_exp","exp","intGetNextRand","intSeedRand","x0","year","day","d","seedModifier","_fun_info_pad_DLR_","_fun_pad_DLR_","ch","dest","toPad","_fun_info_rnd","_fun_rnd","_fun_info_sqr","_fun_sqr","sqrt","_fun_info_log","_fun_log","_fun_info_pos","_fun_pos","getLinePos","_fun_info_left_DLR_","_fun_left_DLR_","_fun_info_right_DLR_","_fun_right_DLR_","_fun_info_mid_DLR_","_fun_mid_DLR_","_fun_info_sin","_fun_sin","sin","_fun_info_tri","_fun_tri","abs","_fun_info_saw","_fun_saw","_fun_info_tan","_fun_tan","tan","_fun_info_atn","_fun_atn","atan","_fun_info_cos","_fun_cos","cos","_fun_info_spc","_fun_spc","_max","_fun_info_int","_fun_int","_fun_info_range","_fun_range","min","max","_fun_info_tab","_fun_tab","_fun_info_sgn","_fun_sgn","_fun_info_millis","_fun_millis","_fun_info_jiffies","_fun_jiffies","ecmds","CTRL_KW","SHORTCUT_KW","KEYWORDS","more","screenCodes2CTRLTable","tab","KWCODES","padArray","missing","clazz2","upperCaseNameTokens","token","tokens2","mergeCompTokens","token2","mergeBrokenUpTokens","splits","p1","p2","p3","whole","r","mergeTokenRange","record","tokens3","parseFunParList","even","endTokens","parseBoolExpression","shift","peekIfNextIsOpenBracket","parseSubExpression","tokensToString","endTokensToString","endTokenArray","et","endToken","isEndToken","endTokenArry","parseSimpleExpression","endLoop","returnValue","pair","endTokens0","first","eList","parseExpression","opData","dbg","dbg2","retExpr","newParts","part","unshift","subEndTokens","isUserDefinedFunctionCall","parameters","subExpression","groupParts","oldExpression","parts0","parts1","parts2","prevPart","subExpr","normalizeStatementName","parseAssignment","preTokens","nameToken","token0","parseArrayAssignment","parseControlStructure","controlToken","expr_fn","nums","onInterrupt","num0","onType","labelFlag","expr_from","expr_to","expr_step","explicit","nextcommand","expr1","block","parseLineCommands","bi","dataArray","parseStatementCall","endCommand","keyword","oken","logTokens","tokensStr","tok","Tokenizer","StringReader","tokenize","lineRest","errContext","lineRecord","toker","merge","noPadding","strIn","index","lineIndex","peek","peek2","unconsume","consume","EOF","reader","keywords","greedy","isOpChar","match","isCompChar","isEqChar","isNameChar","endFound","prev","seq","isNumChar","isPadChar","isCommandSepChar","isSepChar","isAnyChar","isBracket","isStrChar","inString","normalizeToken","tok0","readChars","read","type0","compareF","tokenType","parseRules","tokenFound","rule","categoryIndexesInt","funs","cat","f_attribs","catlabel","rname","processes","STATE_NULL","STATE_LASTSTATE","_this","idlerInterval","runInterval","waitTimeOut","lastState","state","avgIdlerTime","flags","pstate","update","wtime","changeState","newState","killRuntimeInterval","startWaitingTimeOut","killWaitingTimeOut","startRuntimeInterval","idlerFunction","m1","running","stat","m3","runningFunction","waitingFunction","synch","id","startIdlerInterval","setInterval","cpu","iv","clearInterval","t","setTimeout","clearTimeout","getTicks","count","register","obj","newId","getRoot","keyPress","interactive","hc","handlerClazz","inputKeyHandler","cursorOn","y","hidden","dc","dcCmd","defaultFG","defaultBG","txtBgColor","txtColor","initialized","changes","all","pokeFlush","w","h","_int_initMode","_int_setCells","destroy","cellel","_int_addChangeAll","_int_addChange","area","clist","lc","nc","y1","y2","x1","x2","changesTargetArray","cell","_int_flushAll","_int_flush","_int_getArea","cx","cy","cursorMode","areasList","attach","codePointAt","rowArray","srcCells","acols","xi","ax0","ay0","ay","ax","arows","oldx","maxX","__int_scrollDown","__int_scrollLineLeftFrom","__int_nl","__int_write_direct_ch","_int_write","__int_scrollLinesDownFrom","yy","xx","cell1","cell2","__int_scrollLineRightFrom","_int_control","dcCmdCode","oldy","writec","chr","f","_int_setPos","inhibitNewLine","l2","cellyp1","lineColor","pixels","ox0","oy0","odx","ody","direction","getConvertFunc","width","height","action","fillColor","__this","xy2","_int_convertxy","pixel","y0","xy0","xy1","current","enabledFlag","pid","pfIx","bcwC","brhC","fgColor","bgColor","old_init","cwC","rhC","isCurrentIx","cC","rC","userInput","flagUserInput","channel","frequency","parCount","attackT","decayT","releaseT","p4","rootProcId","self","onmessage","messageObject","sub","QPath","windowWidth","windowHeight","blockList"],"sourceRoot":""}