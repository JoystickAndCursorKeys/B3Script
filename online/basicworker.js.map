{"version":3,"file":"basicworker.js","mappings":"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","sources":["webpack://B3/./tmp/basicworker.js"],"sourcesContent":["//src/sys/modules/basic/worker/sys.js\n//src/sys/modules/basic/worker/basicarray.js\n//src/sys/modules/basic/worker/basicerrorhandler.js\n//src/sys/modules/basic/worker/coding/codingeditor.js\n//src/sys/modules/basic/worker/basicruntime.js\n//src/sys/modules/basic/worker/extendedcommands.js\n//src/sys/modules/basic/worker/pgmmanager.js\n//src/sys/modules/basic/worker/basiccommands.js\n//src/sys/modules/basic/worker/basicparser.js\n//src/sys/modules/basic/worker/basictokenizer.js\n//src/sys/modules/basic/worker/input.js\n//src/sys/modules/basic/worker/processes.js\n//src/sys/modules/basic/worker/commandhelp.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//src/sys/modules/basic/worker/workerbootstrap_static.js\n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n\n// ## sys.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/sys.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/sys.js\n\nvar sys = {\n  appName: \"unknown\",\n  unique: 0\n\n};\n\nconsole = sys;\n\n/* LOGGER */\n\nfunction init_sys() {\n\n  function post( type, message ) {\n    postMessage( { type: type, message: message } );\n  }\n\n  sys.post = post;\n\n  sys.log = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      var args2 = [];\n\n      for( var i=0; i<args.length ; i++) {\n        args2.push( JSON.stringify( args[ i ]) );\n      }\n      post(\"syslog\",args2 );\n\n  }\n\n  sys.logerr = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post(\"syserr\",args );\n\n  }\n\n  sys.load = function( rt, path, device ) {\n\n      post(\"load\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n  sys.loaddata = function( rt, path, type, label ) {\n\n      post(\"loaddata\", { processId: rt.processId, path:path, type: type, label: label } );\n\n  }\n\n  sys.save = function( rt, path, device, data ) {\n\n      post(\"save\", { processId: rt.processId, path:path, device: device , data: data } );\n\n  }\n\n  sys.delete = function( rt, path, device ) {\n\n      post(\"delete\", { processId: rt.processId, path:path, device: device  } );\n\n  }\n\n  sys.dir = function( rt, path, device ) {\n\n      post(\"dir\", { processId: rt.processId, path:path, device: device } );\n\n  }\n\n\n  sys.setcfg = function( cfg ) {\n      this.cfg = cfg;\n  }\n\n  sys.listfs = function( rt  ) {\n\n      post(\"listfs\", { processId: rt.processId } );\n\n  }\n\n  sys.poststatus = function( procId, status  ) {\n\n      post(\"status\", { procId: procId, status: status } );\n\n  }\n\n  sys.setfs = function( rt, path  ) {\n\n      this.fs = path;\n      post(\"setfs\", { path: path, processId: rt.processId } );\n\n  }\n\n  sys.setDisplayMode = function( rt, m ){\n    post( \"displaymode\", { processId: rt.processId, m:m } );\n  }\n\n  sys.blinkMode = function( m ){\n    post( \"blinkMode\", { m:m } );\n  }\n\n\n  sys.html = {}\n\n  sys.html.executeFunction = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"htmldofun\",args );\n\n  }\n\n  sys.html.html = function() {\n\n      var args = Array.prototype.slice.call(arguments);\n      post( \"html\",args );\n\n  }\n\n  sys.html.htmlnode = function() {\n\n    var args = Array.prototype.slice.call(arguments);\n    post( \"htmlnode\",args );\n\n  }\n\n\n  sys.html.get = function() {\n\n    post( \"htmlget\", args );\n    return { wait_for_result: true }\n\n  }\n\n  sys.export = function( code, destination ) {\n    post( \"export\", { code: code, destination: destination } );\n  }\n\n  sys.signalHideMenu = function( flag ) {\n    post( \"signalHideMenu\", { hide: flag } );\n  }\n\n}\n\nfunction start_sys() {\n  sys.log(\"Starting wsys\");\n\n  sys.processes = new processes( sys );\n  sys.input = new Input( sys );\n  sys.out = new TextArea( sys );\n  sys.bout = new BitMap( sys );\n  sys.audio = new Audio( sys );\n  sys.rootProcId = -1;\n\n  /* APPLICATION */\n\n  /* HANDLERS */\n  self.onmessage = function( obj ) {\n\n      try {\n        var data = obj.data;\n\n        if( data.type == \"keydown\" ) {\n\n          sys.input.inputKeyHandler( data );\n          sys.audio.flagUserInput();\n\n        }\n        else if( data.type == \"message\") {\n          var id = data.processId;\n          var runtime = sys.processes.get( id );\n\n          runtime.receiveMessage( data.message, data.messageObject );\n\n          //TODO, index of runtime.\n        }\n        else if( data.type == \"interrupt\") {\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.interrupt( 0, data.sub, data.data );\n\n          //TODO, index of runtime.\n        }\n        else if( data.type == \"loadpgm\" ) {\n\n          sys.log(\"Received 'loadpgm' message. Loaded \" + data.pgmData.length + \" bytes..\" );\n\n          var editor = new Editor( sys );\n          var runtime = new BasicRuntime( sys, editor );\n          sys.log(\"Context created, parsing program\");\n\n          var ok = runtime.bootPGM( data.pgmData, data.QPath  );\n          sys.log(\"Parsed program => RUN\");\n\n          if( ok ) {\n            runtime.runPGM();\n            sys.log(\"Program started...\");\n          }\n          else {\n            runtime.stop();\n          }\n\n          var id = sys.processes.register( runtime );\n          sys.log(\"Basic program registered as process \" + id + \".\");\n\n          if( sys.rootProcId == -1 ) {\n            sys.rootProcId = id;\n          }\n          pgmman.addRuntime( runtime );\n\n\n        }\n        else if( data.type == \"inittxtarea\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) )\n\n          sys.out.attach( data.w, data.h );\n\n\n        }\n        else if( data.type == \"initcolors\" ) {\n\n          sys.log( \"init colors with: \" + JSON.stringify( data ) )\n\n          sys.out.setDefault( data.colors.fg, data.colors.bg );\n          sys.out.control( 18, data.colors.border );\n          sys.out.reset();\n\n        }\n        else if( data.type == \"systeminfo\" ) {\n\n          sys.log( \"systeminfo with: \" + JSON.stringify( data ) )\n          sys.screenModes = data.modes;\n          sys.displayMode = data.mode;\n          sys.windowWidth = data.windowWidth;\n          sys.windowHeight = data.windowHeight;\n\n        }\n        else if( data.type == \"setcfg\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n\n          sys.setcfg( data.cfg );\n\n        }\n        else if( data.type == \"initbitmap\" ) {\n\n          sys.log( \"init with: \" + JSON.stringify( data ) );\n          sys.bout.attach( data.w, data.h );\n\n        }\n        else if( data.type == \"clipboardCopy\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"clipboard\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Copied program to clipboard\");\n            runtime.printReady();\n          }\n          sys.log( \"clipboard copy\" )\n\n        }\n        else if( data.type == \"export\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var code = runtime.getProgramAsText();\n\n          sys.export( code, \"disk\" );\n\n          if( runtime.isReady() ) {\n            runtime.printLine(\"(!)Export program to disk\");\n            runtime.printReady();\n          }\n          sys.log( \"Export to disk\" )\n\n        }\n        else if( data.type == \"showList\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = data.list;\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"list\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = [\"LIST\",\"\"];\n          for (const l of runtime.program)\n            {\n\n              var lineNr = parseInt(l[0]);\n\n              list.push( l[2] );\n            }\n\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"renumber\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          runtime.renumberProgram( 10,10 );\n\n          var list = [\"RENUMBER\"];\n          runtime.enterListMode(list);\n\n        }\n        else if( data.type == \"new\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n\n            var output = [\"NEW\", \"\"];\n            runtime.enterListMode( output );\n          }\n        }\n        else if( data.type == \"pastpgm\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( !runtime.isRunning() ) {\n            runtime.new();\n            runtime.resetConsole();\n\n            var result = runtime.textLinesToBas( data.data.split(\"\\n\") );\n            var pgm = result.pgm;\n            runtime.setProgram( pgm );\n\n            if( result.exception ) {\n              throw result.exception;\n            }\n\n          }\n        }\n        else if( data.type == \"vars\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var varList = runtime.getFullVarList();\n          varList.unshift( \"\" );\n          varList.unshift( \"VARS\" );\n\n          runtime.enterListMode( varList );\n\n        }\n        else if( data.type == \"datablocks\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          var list = runtime.getDataBlocks();\n          var blockList = [\"DATABLOCKS\",\"\"];\n\n          for( var i=0;i<list.length;i++) {\n            blockList.push( list[i] );\n          }\n\n          runtime.enterListMode( blockList );\n\n        }\n        else if( data.type == \"stopMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n            runtime.toggleMenu();\n          }\n          else {\n            runtime.toggleMenu();\n          }\n\n        }\n        else if( data.type == \"toggleMenu\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n          runtime.toggleMenu();\n\n        }\n        else if( data.type == \"help\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"HELP\");\n            runtime.printHelp();\n            runtime.printLine(\"\");\n            runtime.printLine(\"For more help type:\");\n            runtime.printLine(\"HELP <option>\");\n            runtime.printLine(\"\");\n            runtime.printReady();\n          }\n\n        }\n        else if( data.type == \"run\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n            runtime.printLine(\"RUN\");\n            runtime.runPGM();\n          }\n        }\n        else if( data.type == \"stop\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isRunning() ) {\n            runtime.stop();\n          }\n        }\n        else if( data.type == \"resetConsole\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.resetConsole();\n          }\n        }\n        else if( data.type == \"colorReset\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.colorReset( data.colors );\n          }\n        }\n        else if( data.type == \"clearScreen\" ) {\n\n          var runtime = sys.processes.get( sys.rootProcId );\n\n          if( runtime.isReady() ) {\n            runtime.clearScreen();\n          }\n        }\n        else {\n          var type = obj.data;\n          if(! type ) {\n            type = \"????\";\n          }\n          else {\n            type=type.type;\n            if(! type ) {\n              type = \"????\";\n            }\n          }\n          sys.logerr( \"Ignored unclassified message type (\"+type+\") for 'APP://\"+sys.appName+\"':  \" + JSON.stringify( obj.data ) );\n          //postMessage( self.onAppMessage( obj ) );\n        }\n      }\n      catch( e ) {\n        if( e.message ) {\n          sys.logerr( e.message + \" at \" + e.fileName + \":\"+ e.lineNumber );\n        }\n        else if ( e.clazz ) {\n          sys.logerr( e.clazz + \": \" + e.detail + \" at \"+ e.lineNr );\n          sys.out.writeln( \"?\" + e.clazz + \" error at \" + e.lineNr );\n        }\n\n        sys.logerr( JSON.stringify( e ) );\n\n      }\n\n    }\n}\n\ninit_sys();\n\n//--EOC \n\n// ## basicarray.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicarray.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicarray.js\n\nclass  BasicArray {\n\n  constructor( name, indices, defaultValue  ) {\n    this.name = name;\n    this.indices = indices;\n    this.buffer = null;\n    this.defaultValue = defaultValue;\n  }\n\n  getIndexCount() {\n    return this.indices.length;\n  }\n\n  _check( indices ) {\n    if( indices.length != this.indices.length ) {\n      throw \"BasicArray:00:index dimension mismatch:For array \" + this.name;\n    }\n    for( var i=0; i<indices.length; i++) {\n      if ( indices[i] > this.indices[ i ]) {\n        var detail = \"\\\"\" + this.name + \"[\" + indices[i] + \"]\"+\"\\\" does not exist\";\n        if( indices.length > 1) {\n          detail = \"\\\"\" + this.name + \"\\\" with index \" + indices[i] + \" does not exist\";\n          detail += \" for index dimension \" + i;\n        }\n        throw \"BasicArray:01:index out of bounds:\" + detail;\n      }\n      else if ( indices[i] < 0) {\n        throw \"BasicArray:02:index smaller then zero:For array \" + this.name;\n      }\n\n    }\n  }\n\n  set( indices, val ) {\n    this._check( indices );\n    if( this.buffer == null ) {\n      this.buffer = [];\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        ptr[ indices[ i ]] = val;\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          ptr[ indices[ i ]] = [];\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n  get( indices ) {\n    this._check( indices );\n\n    if( this.buffer == null ) {\n      return this.defaultValue;\n    }\n    var ptr = this.buffer;\n    var last = indices.length - 1;\n    for( var i=0; i<=last; i++) {\n\n      if( i == last ) {\n        return ptr[ indices[ i ]];\n      }\n      else {\n        if( (ptr [ indices[i] ] === undefined )) {\n          return this.defaultValue;\n        }\n        ptr = ptr[ indices[ i ]];\n      }\n    }\n  }\n\n}\n\n//--EOC \n\n// ## basicerrorhandler.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicerrorhandler.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicerrorhandler.js\n\nclass ErrorHandler {\n\n  newError( clazz, detail, context, lineNr ) {\n    return { context: context, clazz: clazz, detail: detail, lineNr: lineNr };\n  }\n\n  throwError( clazz, detail, context, lineNr ) {\n    throw this.newError( clazz, detail, context, lineNr );\n  }\n\n\n  fromSimpleExternalError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n\n    var parts = s.split(\":\");\n    if( !parts.length == 3) {\n      return undefined;\n    }\n\n    var err = this.newError( parts[2], parts[3], context, lineNr );\n\n    err.extCode0 = parts[0];\n    err.extCode1 = parts[1];\n\n    return err;\n\n  }\n\n  fromSerializedError( s, context, lineNr0 ) {\n\n    var lineNr = lineNr0;\n    if( lineNr === undefined ) {\n      lineNr = -1;\n    }\n    if( ! this.isSerializedError( s ) ) {\n      return this.newError( \"unknown\", null, context, lineNr );\n    }\n    var parts = s.substr(1).split(\"@\");\n    if( parts.length == 1 ) {\n        return this.newError( parts[0], null, context, lineNr );\n    }\n    return this.newError( parts[0], parts[1], context, lineNr );\n\n  }\n\n  isSerializedError( e ) {\n    if( typeof e != \"string\" ) {\n      return false;\n    }\n    return e.startsWith( \"@\" );\n  }\n\n  isError( e ) {\n    if( Object.prototype.toString.call( e ) === '[object Object]' ) {\n      var ctx = e[ \"context\" ];\n      var clss = e[ \"clazz\" ];\n      var dtl = e[ \"detail\" ];\n\n      if( !( clss === undefined ) ) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\n//--EOC \n\n// ## coding/codingeditor.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/coding/codingeditor.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/coding/codingeditor.js\n\nclass Editor {\n\n  constructor( sys ) {\n    this.sys = sys;\n    this.output = sys.out;\n    this.keyMode = \"insert\";\n\n    //this.lineMarkers = [ 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0 ];\n  }\n\n\n  addRunTime( rt ) {\n    this.runTime = rt;\n  }\n\n  keyHandlerForCLE( e ) {\n\n      if( e.keyLabel == \"Enter\"  && !e.shiftKey ) {\n        var command = sys.out.getCurrentLine();\n        this.output.writeln(\"\");\n\n        this.runTime.executeInteractiveLine( command );\n\n      }\n      else if( e.keyLabel == \"Enter\" && e.shiftKey ) {\n\n        this.output.ScrollDownByCurrentLine();\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            this.output.backspace();\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowUp\" && !e.ctrlKey) {\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && !e.ctrlKey) {\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowUp\" && e.ctrlKey ) {\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n        this.output.cursorMove(\"up\");\n      }\n      else if( e.keyLabel == \"ArrowDown\" && e.ctrlKey ) {\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n        this.output.cursorMove(\"down\");\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey ) {\n        this.output.cursorMove(\"left\");\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"line-start\");\n      }\n      else if( e.keyLabel == \"Home\" && e.shiftKey && !e.ctrlKey ) {\n        this.output.clear();\n      }\n      else if( e.keyLabel == \"End\" && !e.ctrlKey ) {\n        this.output.jumpTo(\"line-end\");\n      }\n      else if( e.keyLabel == \"Home\" && e.ctrlKey && !e.shiftKey ) {\n        this.output.jumpTo(\"home\");\n      }\n      else if( e.keyLabel == \"End\" && e.ctrlKey ) {\n        this.output.jumpTo(\"end\");\n      }\n      else if( e.keyLabel == \"Tab\" ) {\n        if( this.keyMode == \"insert\") {\n          this.output.insert(  \"        \" );\n        }\n        else {\n          this.output.write(  \"        \" );\n        }\n\n      }\n      else if( e.keyLabel == \"Insert\" ) {\n\n        if( this.keyMode == \"insert\") {\n          this.keyMode = \"overwrite\";\n        }\n        else {\n          this.keyMode = \"insert\";\n        }\n        this.output.setCursorMode( this.keyMode )\n      }\n      else {\n        if( e.key != null ) {\n          if( this.keyMode == \"insert\") {\n            this.output.insert( e.key );\n          }\n          else {\n            this.output.write( e.key );\n          }\n        }\n      }\n\n  }\n\n\n  interactiveKeyHandler( e ) {\n    this.keyHandlerForCLE( e );\n  }\n}\n\n//--EOC \n\n// ## basicruntime.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicruntime.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicruntime.js\n\nclass BasicRuntime {\n\n  constructor( sys, editor ) {\n\n    this.debugFlag = false;\n    this.sys = sys;\n    this.editor = editor;\n    this.editor.addRunTime( this );\n    this.listSpeed = 15;\n\n    this.output = sys.out;\n    this.bitmap = sys.bout;\n    this.input = sys.input;\n    this.audio = sys.audio;\n    this.input.setHandler( this );\n    this.input.setInterActive( false);\n    this.html = sys.html;\n    this.menuEnable = false;\n\n    this.program = [];\n    this.runFlag = false;\n    this.waitForMessageFlag = false;\n    this.waitForMessageVariable = null;\n    this.executeLineFlag = false;\n    this.goPlayExampleFlag = false;\n    this.breakCycleFlag;\n    this.inputFlag = false;\n    this.listFlag = false;\n    this.immersiveFlag = false;\n    this.statusChanged = false;\n\n    this.gosubReturn = [];\n    this.nullTime = new Date().getTime();\n\n    this.turboMode = false;\n    this.cmdCountPerCycleDefault = 10000;\n    this.cmdCountPerCycleTurbo = 20000;\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n\n    var c = this.output;\n    this.commands = new BasicCommands( this );\n    this.extendedcommands = new ExtendedCommands( this.commands, this );\n\n    this.erh = new ErrorHandler();\n    this.vars = {};\n    this.functions = [];\n    this.data = [];\n    this.loadedData = { default: [] };\n    this.loadedLabel = null;\n\n    this.kbBuffer = [];\n\n    this.yPos = -1;\n\n    this.SHORTLINE = 0;\n    this.LONGLINESTART = 1;\n    this.LONGLINEEND = 2;\n\n    this.forContext = { default:[] }\n\n    this.outputCallBacksAll = {\n        lineOverFlow: { clazz: this, method: \"cbLineOverFlow\" },\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    this.outputCallBacksClScr = {\n        lineOverFlow: undefined,\n        scroll: { clazz: this, method: \"cbScroll\" },\n        clearScreen: { clazz: this, method: \"cbClearScreen\" }\n    }\n\n    //this.setTurbo( true );\n    this.synchClock( );\n    this.exitMode = \"stay\";\n\n    this.code2colMap = [];\n    var km = this.code2colMap;\n\n    km[0x90] = 0;\n    km[0x05] = 1;\n    km[0x1c] = 2;\n    km[0x9f] = 3;\n    km[0x9c] = 4;\n    km[0x1e] = 5;\n    km[0x1f] = 6;\n    km[0x9e] = 7;\n\n    km[0x81] = 8;\n    km[0x95] = 9;\n    km[0x96] = 10;\n    km[0x97] = 11;\n    km[0x98] = 12;\n    km[0x99] = 13;\n    km[0x9a] = 14;\n    km[0x9b] = 15;\n\n    this.symbolTable = {};\n\n    this.symbolTable.up     = 0x91;\n    this.symbolTable.down   = 0x11;\n    this.symbolTable.left   = 157;\n    this.symbolTable.right  = 29;\n    this.symbolTable[\"reverse on\"]  = 0x12;\n    this.symbolTable[\"reverse off\"]  = 0x92;\n    this.symbolTable[\"clear\"]  = 0x93;\n    this.symbolTable[\"home\"]  = 0x13;\n    this.symbolTable.black  = 144;\n    this.symbolTable.white  = 5;\n    this.symbolTable.red  = 28;\n    this.symbolTable.cyan  = 159;\n    this.symbolTable.purple  = 156;\n    this.symbolTable.green  = 30;\n    this.symbolTable.blue  = 31;\n    this.symbolTable.yellow  = 158;\n    this.symbolTable.orange  = 129;\n    this.symbolTable.brown  = 149;\n    this.symbolTable.pink  = 150; // light red\n    this.symbolTable.grey1  = 151;  //dark grey\n    this.symbolTable.grey2  = 152;\n    this.symbolTable[\"light green\"]  = 153;\n    this.symbolTable[\"light blue\"]  = 154;\n    this.symbolTable.grey3  = 155; //light grey\n\n\n    var backmap = []\n    var mapInfo = Object.entries(this.symbolTable);\n    for( var i=0; i<mapInfo.length; i++) {\n      backmap[ mapInfo[i][1]] = mapInfo[i][0];\n    }\n    this.symbolTableBM = backmap;\n\n  }\n\n  flagStatusChange() {\n    this.statusChanged = true;\n  }\n\n\n  getScopeVars( s ) {\n    return s.vars;\n  }\n\n  getFullVarList() {\n    var scopes = this.getFullScopes();\n    var varList = [];\n\n    for( var si = 0; si< scopes.length; si++ ) {\n\n      var fullscope = scopes[si];\n      var vars = this.getScopeVars( fullscope.scope );\n      var names = Object.getOwnPropertyNames( vars );\n\n      for( var i=0;i<names.length;i++) {\n        var name = names[i];\n        var value = vars[ name ];\n        var path = fullscope.path;\n        if( path == \"\" ) { path = \"\"; }\n        else { path += \"/\"; }\n        if( ! name.startsWith( \"@array_\" ) ) {\n            if( name.endsWith(\"$\") ) {\n                varList.push( path + name + \" = \\\"\" + value + \"\\\"\" );\n            }\n            else {\n                varList.push( path + name + \" = \" + value );\n            }\n        }\n        else {\n            var descr = \"\";\n            for( var ii=0; ii<value.indices.length; ii++ ) {\n              if( ii>0 ) { descr += \",\"; }\n              descr += value.indices[  ii ];\n\n            }\n            varList.push( name.substr(7) + \" = array with dim(\" + descr + \")\" );\n        }\n      }\n    }\n\n    return varList;\n  }\n\n  getFullScopes() {\n    var scopes = [];\n    var path = \"\";\n    for( var si = 0 ; si < this.scopes.length; si++ ) {\n      var scope = this.scopes[si].name;\n\n      if( si > 0) {\n        if( path != \"\" ) {\n          path += \"/\";\n        }\n        path += scope;\n      }\n\n      scopes.push( { path: path, scope: this.scopes[si]  } );\n    }\n\n    return scopes;\n  }\n\n  cpuNeeded() {\n    return this.runFlag;\n  }\n\n  getStatus() {\n\n    var status = \"\";\n    var lineNr;\n    if( this.runFlag ) {\n      lineNr = this.program[ this.runPointer ][0];\n      status = \"running[\" + lineNr + \"]\";\n    }\n    else {\n      status = \"stopped\";\n    }\n\n    if( this.runFlag && this.inputFlag ) {\n      status = \"running[\" + lineNr + \"]/input\";\n    }\n    else if( !this.runFlag && this.listFlag ) {\n      status = \"stopped/listing\";\n    }\n\n    var vlen = Object.getOwnPropertyNames( this.getVars() ).length;\n\n\n    this.statusChanged = false;\n\n    return {\n      status: status,\n      pgmLen: this.program.length,\n      varLen: vlen,\n      displayMode: this.sys.displayMode\n    }\n  }\n\n  dir( path, device ) {\n    this.sys.dir( this, path, device );\n    this.startWaitForMessage( \"dir\" )\n  }\n\n  listfs() {\n    this.sys.listfs( this );\n    this.startWaitForMessage( \"listfs\" )\n  }\n\n  setfs( path ) {\n    this.sys.setfs( this, path );\n    this.startWaitForMessage( \"path\" )\n  }\n\n  load( path, start, device ) {\n    this.sys.load( this, path, device );\n    this.startWaitForMessage( \"load\" )\n    this.autoStartAfterLoad = start;\n\n  }\n\n  loaddata( path, type, label ) {\n    this.sys.loaddata( this, path, type, label );\n    this.startWaitForMessage( \"loaddata\" )\n\n  }\n\n  save( path0, device ) {\n\n    var data = this.getProgramAsText();\n    var path = path0;\n    if( path0 == null ) {\n      path = \"default.bas\";\n    }\n    this.sys.save( this, path, device, data );\n    this.startWaitForMessage( \"save\" )\n  }\n\n  deleteFile( path, device ) {\n\n    this.sys.delete( this, path, device );\n    this.startWaitForMessage( \"delete\" )\n  }\n\n\n  startWaitForMessage( variable ) {\n    this.waitForMessageFlag = true;\n    this.waitForMessageVariable = variable;\n  }\n\n\n  keyInterrupt( _type, _data ) {\n    this.interrupt( 0, _type, {} );\n  }\n\n  interrupt( _ix, _type, _data ) {\n\n\n\n    if( _ix == 0 && this.interruptFlag0 ) {\n        return; //allready in an interrupt0\n    }\n\n    if( _ix == 1 && this.interruptFlag1 ) {\n        return; //allready in an interrupt1\n    }\n\n\n    var line, useLabel;\n    if( _ix == 0 ) {\n\n      line = this.handlers.interrupt0;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag0 = true;\n      useLabel = this.handlers.interrupt0ParamIsLabel;\n    }\n    else {\n\n      line = this.handlers.interrupt1;\n      if( line === undefined ) {\n        return;\n      }\n      this.interruptFlag1 = true;\n      useLabel = this.handlers.interrupt1ParamIsLabel;\n    }\n\n\n    this.newScope( \"interrupt\" + _ix,\n      { runPointer: this.runPointer, runPointer2: this.runPointer2 } );\n\n    var variables = Object.entries( _data );\n    this.setVar( \"itr0$\".toUpperCase(), _type.toUpperCase() );\n    for( var i=0; i<variables.length; i++) {\n      this.setVar( variables[i][0].toUpperCase(), variables[i][1] );\n    }\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n\n    if( useLabel ) {\n\n      line = this.labels[line];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n        break;\n      }\n    }\n\n    if(!found ) {\n      throw \"@invalid interrupt handler\";\n    }\n\n  }\n\n  receiveMessage( _message, _data ) {\n\n    this.vars[ this.waitForMessageVariable ] = _message;\n    this.waitForMessageFlag = false;\n\n    if( _message.startsWith( \"displaysize:\" )) {\n        this.output.reInit( _data.textW, _data.textH );\n        this.bitmap.reInit( _data.bitmapW, _data.bitmapH );\n        this.sys.displayMode = _data.mode;\n\n    }\n    else if( _message == \"load:error\" ) {\n\n      if( this.runFlag == false ) {\n          this.printError(\"load\", false, undefined, _data.reason );\n      }\n    }\n    else if( _message == \"load:completed\" ) {\n\n      sys.log(\"Received 'load:completed' message. Loaded \" + _data.pgmData.length + \" bytes..\" );\n\n      var ok = this.bootPGM( _data.pgmData, _data.path  );\n      sys.log(\"Parsed program => RUN\");\n\n      if( ok && this.autoStartAfterLoad ) {\n        this.output.control( 24 )\n        this.runPGM();\n        sys.log(\"Program started...\");\n      }\n      else {\n        this.stop();\n      }\n    }\n    else if( _message == \"loaddata:completed\" ) {\n\n      sys.log(\"Received 'loaddata:completed' message. Loaded \" + _data.data.length + \" bytes..\" );\n\n      this.insertData( _data.data, _data.type, _data.label  );\n\n    }\n    else if( _message == \"loaddata:error\" ) {\n\n      sys.log(\"Received 'loaddata:error' message. Error \" + _data.reason );\n\n      this.printError(\"loaddata\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"delete:completed\" ) {\n\n      sys.log(\"Received 'delete:completed' message.\" );\n\n    }\n    else if( _message == \"delete:error\" ) {\n\n      sys.log(\"Received 'delete:error' message. Error \" + _data.reason );\n\n      this.printError(\"delete\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"save:completed\" ) {\n\n      sys.log(\"Received 'save:completed' message.\" );\n\n      if( !this.isRunning() ) {\n      }\n    }\n    else if( _message == \"save:error\" ) {\n\n      sys.log(\"Received 'save:error' message. Error \" + _data.reason );\n\n      this.printError(\"save\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"dir:completed\" ) {\n\n      sys.log(\"Received 'dir:completed' message.\" );\n\n      var list = [\"\",\"Directory of: \\\"\" + _data.title + \"\\\" on \" + _data.fs, \"\" ];\n\n      for( var i=0; i<_data.files.length; i++) {\n          list.push( _data.files[i].fname );\n      }\n\n      list.push( _data.files.length + \" files\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"dir:error\" ) {\n\n      sys.log(\"Received 'dir:error' message. Error \" + _data.reason );\n\n      this.printError(\"dir\", false, undefined, _data.reason );\n      this.stop();\n    }\n    else if( _message == \"listfs:completed\" ) {\n\n      sys.log(\"Received 'listfs:completed' message.\" );\n\n      var list = [\"\", \"Default Filesystem: \\\"\" + _data.currentFs + \"\\\"\", \"\", \"Devices:\", \"\" ];\n\n      //var fs = fsList[i];\n\n\n      for( var i=0; i<_data.fs.length; i++) {\n\n          var fs = _data.fs[i];\n          var str = \"\\\"\" + fs.name + \"\\\"\";\n          var deviceNumberLen = (fs.device + \"\").length;\n          str = str + \"                  \".substr( 0,(18-str.length-deviceNumberLen) ) + fs.device;\n\n\n          list.push(\"     \" + str );\n      }\n\n      list.push( \"\" );\n      list.push( _data.fs.length + \" Filesystem Devices Found\");\n\n      this.enterListMode( list );\n\n    }\n    else if( _message == \"setfs:completed\" ) {\n\n      if( !this.isRunning() ) {\n        if( _data.status == \"ok\" ) {\n        }\n        else {\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n        }\n\n      }\n      else {\n        if( _data.status != \"ok\" ) {\n\n          this.printError(\"file system\", false, undefined, \"Could not select file system\" );\n          this.stop();\n        }\n      }\n    }\n\n    if( this.stopAfterMessage ) {\n      this.stopAfterMessage = false;\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n    }\n\n    if( !this.isRunning() && this.listFlag == false ) {\n      this.printReady();\n    }\n\n  }\n\n  stop() {\n    if( this.runFlag ) {\n      this.runStop();\n    }\n    if( this.listFlag ) {\n      this.listStop();\n    }\n  }\n\n  interactiveKeyHandler( e ) {\n\n    if( this.runFlag == true ) {\n      if( e.keyLabel == \"Enter\" ) {\n\n        var cxy = this.output.getCursorPos();\n\n        var string = this.output.getLineFrom( this.inputStartInputPosX, cxy[1]);\n        this.output.writeln(\"\");\n\n        this.handleLineInput( string, true );\n\n      }\n      else if( e.keyLabel == \"Backspace\" ||\n              e.keyLabel == \"Delete\"  ) {\n        var x = this.output.getCursorPos()[0];\n\n        if( e.keyLabel == \"Delete\" ) {\n              this.output.delete();\n        }\n        else {\n            if( x > this.inputStartInputPosX ) {\n                this.output.backspace();\n            }\n            else {\n              this.output.delete();\n            }\n        }\n\n      }\n      else if( e.keyLabel == \"ArrowLeft\" && !e.ctrlKey) {\n        var cx = this.output.getCursorPos();\n        if( cx[0] > this.inputStartInputPosX ) {\n          this.output.cursorMove(\"left\");\n        }\n      }\n      else if( e.keyLabel == \"ArrowRight\" && !e.ctrlKey) {\n        this.output.cursorMove(\"right\");\n      }\n      else if( e.keyLabel == \"Home\" && !e.ctrlKey ) {\n        var xy = this.output.getCursorPos();\n\n        this.output.setCursorPos( this.inputStartInputPosX, xy[1]);\n      }\n      else if( (e.keyLabel == \"ArrowRight\" && e.ctrlKey)) {\n        this.output.jumpTo(\"text-end\");\n      }\n      else if( e.keyLabel == \"End\" ) {\n        this.output.jumpTo(\"text-end-all\");\n      }\n      else if( (e.keyLabel == \"ArrowLeft\" && e.ctrlKey) ) {\n        this.output.jumpTo(\"text-start\");\n        var xy = this.output.getCursorPos();\n        if( xy[0]< this.inputStartInputPosX ) {\n          this.output.setCursorPos( this.inputStartInputPosX, xy[1] );\n        }\n      }\n      else {\n        if( e.key != null ) {\n          this.output.write( e.key );\n        }\n      }\n    }\n    else {\n      this.editor.interactiveKeyHandler( e );\n    }\n  }\n\n  toggleMenu()  {\n    this.menuEnable = !this.menuEnable;\n\n    if( this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n    else {\n      this.sys.signalHideMenu( true );\n    }\n  }\n\n  HandleStopped( startingProgram ) {\n\n    this.input.setInterActive( true);\n    this.input.flush();\n    if( !startingProgram && this.menuEnable ) {\n      this.sys.signalHideMenu( false );\n    }\n\n    this.flagStatusChange();\n  }\n\n  importPGMHandler( content, filename ) {\n    var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n    this.fileName = filename;\n\n    this.program = pgm;\n    this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n  }\n\n  bootPGM( content, filename ) {\n    try {\n      var pgm = this.textLinesToBas( content.split(\"\\n\") ).pgm;\n      this.fileName = filename;\n\n      this.program = pgm;\n      this.setProgram( pgm );\n\n      this.sys.log( \"imported program \" + filename +\" with \" + content.length + \" bytes \");\n      return true;\n    }\n    catch ( e ) {\n      var tmp = 1;\n\n      var pgm = this.textLinesToBas( \"\" ).pgm;\n      this.program = pgm;\n      this.HandleStopped( false );\n      this.printError(\"parsing syntax\", false, e.lineNr, e.detail );\n      this.printReady();\n      return false;\n\n    }\n  }\n\n\n/*  exportPGM() {\n    var exportName = \"program.bas\";\n    if( this.fileName ) {\n      exportName = this.fileName;\n    }\n\n    var text = this.getProgramAsText();\n    this.DESKTOP.requestDownload( text, exportName );\n  }\n*/\n\n  exitProgram() {\n    this.closeWindow( this.windowId );\n  }\n\n\n  enterListMode( list ) {\n    this.listFlag = true;\n    this.list = list;\n    this.listPointer = 0;\n    this.printLine(\"\");\n    this.listFlagBakInteractive = this.input.getInterActive();\n    this.input.setInterActive( false );\n    this.flagStatusChange();\n  }\n\n  setExitMode( v ) {\n    this.exitMode = v;\n  }\n\n  synchClock() {\n\n    //var clock = new Date().getTime();\n    var nullClock = new Date();\n    nullClock.setHours(0);\n    nullClock.setSeconds(0);\n    nullClock.setMinutes(0);\n    nullClock.setMilliseconds(0);\n\n    this.nullTime = nullClock;\n\n  }\n\n  setTurbo( on ) {\n    if( on ) {\n      this.cmdCountPerCycle = this.cmdCountPerCycleTurbo ;\n      this.turboMode = true;\n      return;\n    }\n    this.cmdCountPerCycle = this.cmdCountPerCycleDefault ;\n    this.turboMode = false;\n  }\n\n  setProgram( pgm ) {\n    this.program = pgm;\n    this.runFlag = false;\n    this.HandleStopped( true );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n\n    this.flagStatusChange();\n\n  }\n\n  appendProgram( pgm ) {\n\n    for(var i=0; i<pgm.length; i++) {\n      var exists = -1;\n\n      for(var j=0; j<this.program.length; j++) {\n        if( this.program[j][0] == pgm[i][0] ) {\n          exists = j;\n        }\n      }\n\n      if( exists>-1 ) {\n        this.program[ exists ] = pgm[ i ];\n      }\n      else {\n        this.program.push( pgm[ i ] );\n      }\n    }\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    this.program.sort( sortF );\n\n    this.runFlag = false;\n    this.HandleStopped( false );\n\n    this.inputFlag = false;\n    this.listFlag = false;\n    //this.output.clearCursor();\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  getProgramState() {\n    return {\n      runFlag: this.runFlag,\n      inputFlag: this.inputFlag,\n      vars: this.vars,\n      functions: this.functions,\n      forContext: this.forContext,\n      runPointer: this.runPointer,\n      runPointer2: this.runPointer2\n    }\n  }\n\n  setProgramState( pgmState ) {\n      this.runFlag = pgmState.runFlag;\n      this.HandleStopped( false );\n      this.inputFlag = pgmState.inputFlag;\n      this.vars = pgmState.vars;\n      this.functions = pgmState.functions;\n      this.forContext = pgmState.forContext;\n      this.runPointer = pgmState.runPointer;\n      this.runPointer2 = pgmState.runPointer2;\n  }\n\n  _setByteBits( bits ) {\n\n   var byte = 0b00000000;\n\n   for( var i=0; i<8; i++) {\n     if(i>0) {\n       byte = byte >> 1;\n     }\n     if( bits[i]) {\n       byte = byte | 128;\n     }\n   }\n   return byte;\n  }\n\n  _getByteBits( byte ) {\n    var masks = [\n      0b00000001,0b00000010,0b00000100,0b00001000,\n      0b00010000,0b00100000,0b01000000,0b10000000\n    ];\n\n   var results = [ false, false, false, false, false, false, false, false ];\n\n   for( var i=0; i<8; i++) {\n\n     results[ i ] = (byte & masks[i]) > 0;\n\n   }\n\n   return results;\n  }\n\n  upperFirst( s ) {\n    if( s ) {\n      if ( s.length > 1 ) {\n          return s.substr(0,1).toUpperCase() + s.substr( 1 );\n      }\n    }\n    return s;\n  }\n\n  printError( s, supressLine, explicitline, detail ) {\n\n    var line1 = (\"?\" + this.upperFirst( s ) + \" error\" + this.onLineStr());\n\n    if( explicitline ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error in \" + explicitline ) );\n    }\n    if( supressLine ) {\n        line1 = ( (\"?\" + this.upperFirst( s ) + \" error\") );\n    }\n\n    this.output.writeln(  line1 );\n    if( detail ) {\n      this.output.writeln(  \">> \" + detail );\n    }\n\n  }\n\n  printInfo( s ) {\n\n    this.sys.log(  ( s + this.onLineStr()).toUpperCase() );\n\n  }\n\n  printHelp() {\n    this.extendedcommands[\"_stat_help\"]([]);\n  }\n\n  printLine( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n  print( s ) {\n    this.output.writeln(s);\n    this.reverseOn = false;\n  }\n\n\n//{ fg: 5, bg:1, border: 7 }\n  colorReset( colors ) {\n    this.output.setDefault( colors.fg, colors.bg );\n    this.output.control( 18, colors.border );\n    this.output.colorReset();\n  }\n\n  resetConsole() {\n    var wh = this.output.getDimensions();\n\n    //this.output.textArea(  wh[0], wh[1], -1, -1 );\n\n    this.output.reset();\n    //this.output.setPos(0,0);\n  }\n\n  clearScreen() {\n    this.output.clear();\n    this.output.setPos(0,0);\n  }\n\n  getMillis() {\n    var millis=new Date().getTime() - this.nullTime;\n    return millis;\n  }\n\n  getJiffyTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    var jiffis = Math.floor(millis / (1000 / 60));\n\n    return jiffis % 5184000;\n  }\n\n  getTime() {\n    var millis=new Date().getTime() - this.nullTime;\n    millis = millis % 86400000;\n\n    var hours = Math.floor(millis / 3600000);\n    millis = millis - (hours * 3600000 );\n    var minutes = Math.floor(millis / 60000);\n    millis = millis - (minutes * 60000 );\n    var seconds = Math.floor(millis / 1000);\n    //millis = millis - (seconds * 1000 );\n    return [hours,minutes,seconds];\n  }\n\n  reset( hard, muteReady ) {\n    this.output.clearScreen();\n    this.output.writel(\"Ready.\");\n\n    this.inputFlag = false;\n    this.runFlag = false;\n    this.listFlag = false;\n\n    this.clrPGM();\n    this.setTurbo( false );\n  }\n\n  compressPGMText( pgmTxt ) {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var kws = p.getKeyWordCodes();\n    var txt2 = pgmTxt;\n\n    for( var i=0; i<kws.length; i++) {\n      var kw = kws[i];\n      if( !(kw===undefined || kw === null )) {\n          txt2 = txt2.replaceAll( kw.toLowerCase() , String.fromCharCode(i));\n      }\n    }\n\n    return txt2;\n  }\n\n\n  getProgramAsTextNoPETSCII() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        text +=  this.prepareLineForExportNoPETSCII( l[2].trim(), true );\n      }\n    return text;\n  }\n\n  getProgramSize() {\n    return this.program.length;\n  }\n\n  getProgramAsText() {\n    var text = \"\";\n    for (const l of this.program)\n      {\n        if( text != \"\") {\n          text += \"\\n\";\n        }\n        //text +=  this.prepareLineForExport( l[2].trim() );\n        if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n            text += \"\\n\";\n        }\n        text += l[2].trim();\n      }\n    return text;\n  }\n\n  prepareLineForExport( txt0 ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      if( c<31 || c==92 || c>=126 ) {\n        var symdef = this.symbolTableBM[ c ];\n        if( ! ( symdef === undefined ) ) {\n            dst += \"{\" + symdef + \"}\";\n        }\n        else {\n            dst += \"{\"+c+\"}\"\n        }\n\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n    }\n    return dst.toLowerCase();\n  }\n\n  replaceAll( src, str1, str2 ) {\n\n    var rv = src;\n    while( rv.indexOf( str1 ) > -1 ) {\n      rv = rv.replace( str1, str2 );\n    }\n    return rv;\n  }\n\n\n  rebuildNoPETSCIILineString( raw )\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    var noPetsciiLine = this.prepareLineForExportNoPETSCII( raw, false );\n    var rec = p.parseLine( noPetsciiLine );\n    return rec;\n  }\n\n\n  prepareLineForExportNoPETSCII( txt0, toLower ) {\n    var txt;\n    txt = txt0.trim();\n    var dst = \"\";\n    var last= \"\";\n\n    for( var i=0; i<txt.length; i++) {\n      var c = txt.charCodeAt( i );\n      var cc = txt.charAt( i );\n      if( c<31 || c==92 || c>=94 ) {\n\n        var prevCharIsQuote = false, nextCharIsQuote=false;\n        if( (i+1)<txt.length) {\n          var cc2 = txt.charAt( i+1 );\n          if( cc2 == \"\\\"\" ) {\n            nextCharIsQuote = true;\n          }\n        }\n        if( last == \"\\\"\" ) {\n            prevCharIsQuote = true;\n          }\n\n        if( prevCharIsQuote && !nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\");\\\"\";\n        }\n        else if( prevCharIsQuote && nextCharIsQuote ) {\n            dst = dst.substr( 0, dst.length-1 );\n            dst += \"CHR$(\"+c+\")\";\n            i++;\n        }\n        else if( !prevCharIsQuote && nextCharIsQuote ) {\n            dst += \"\\\";CHR$(\"+c+\")\";\n            i++;\n        }\n\n        else {\n            dst += \"\\\";CHR$(\"+c+\");\\\"\";\n        }\n      }\n      else {\n        dst += txt.charAt( i );\n      }\n      last = cc;\n    }\n\n    var dst2= this.replaceAll( dst, \";\\\"\\\";\",\";\");\n\n    if( toLower ) { return dst2.toLowerCase(); }\n    return dst2;\n  }\n\n  ResolveStringSymbolToCode( x ) {\n\n    if(this.symbolTable[x]) {\n      return this.symbolTable[x];\n    }\n\n    return x;\n  }\n\n  prepareLineForImport( txt0 ) {\n    var txt;\n    txt = txt0.trim(); //.toUpperCase();\n    var dst = \"\";\n\n    var i=0; while( i<txt.length ) {\n      var c = txt.charCodeAt( i );\n      if( c == 123 ) {\n        i++;\n        var num = \"\";\n        while( i < txt.length ) {\n            c = txt.charCodeAt( i );\n            if( c == 125 ) {\n              i++;\n              break;\n            }\n            num += String.fromCharCode( c );\n\n            if( this.debugFlag ) {\n              console.log(\"found ESC seq char \" + String.fromCharCode( c ) );\n              console.log(\"found ESC seq char code \" + c);\n            }\n            i++;\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"found ESC seq \" + num);\n        }\n\n        num = this.ResolveStringSymbolToCode(num.toLowerCase());\n\n        if( this.debugFlag ) {\n          console.log(\"found resolved ESC seq \" + num);\n        }\n\n        dst += String.fromCharCode( parseInt( num, 10) );\n      }\n      else if( c == 8221 || c == 8220) { //looks like a double quote\n        dst += \"\\\"\";\n        i++;\n      }\n      else {\n        dst += txt.charAt( i );\n        i++;\n      }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"dst:\" + dst);\n    }\n\n    return dst;\n  }\n\n  getProgramLines() {\n\n    return this.program;\n  }\n\n  padZeros2( x ) {\n    var s = x + \"\";\n    for(var i=s.length; i<2; i++) {\n      s=\"0\"+s;\n    }\n    return s;\n  }\n\n  evalExpressionPart( p ) {\n    var val=0;\n\n    if( p.type==\"num\" ) {\n      if( p.data == \".\" ) {\n        val = 0;\n      }\n      else if((\"\"+p.data).indexOf(\".\") >= 0) {\n        val = parseFloat(p.data);\n      }\n      else {\n        val = parseInt(p.data);\n      }\n    }\n    else if( p.type==\"str\" ) {\n      val = p.data;\n    }\n    else if( p.type==\"var\" ) {\n      if(p.data.startsWith(\"TI\")) {\n        val = this.getMillis();\n        if(p.data.endsWith(\"$\")) {\n          val = this.getTime();\n          val = \"\" +\n            this.padZeros2(val[0]) +\n            this.padZeros2(val[1]) +\n            this.padZeros2(val[2]);\n        }\n      }\n      else if(p.data == \"CURRENTLINE\") {\n        val = this.runPointer;\n        if( val != -1 ) {\n          val = parseInt( this.program[ val ][0] );\n        }\n      }\n      else if(p.data == \"PI\") {\n        val = Math.PI;\n      }\n      else {\n        val = this.vars[ p.data ];\n      }\n      if( val == undefined ) {\n        val = 0;\n        if( this.scopes[0].vars[ p.data ] ) {\n          val = this.scopes[0].vars[ p.data ];\n        }\n      }\n    }\n    else if( p.type==\"array\" ) {\n      var varIntName = \"@array_\" + p.data;\n      var arr = this.vars[ varIntName ];\n\n      if( arr === undefined ) {\n        if( this.scopes[0].vars[ varIntName ] ) {\n          arr = this.scopes[0].vars[ varIntName ];\n        }\n        if( arr === undefined ) {\n          throw \"@no such array@Array '\"+ varIntName+\"' does not exist\";\n        }\n      }\n\n      if( arr.getIndexCount() != p.indices.length ) {\n          throw \"@bad subscript@Array index dimensions do not match\";\n      }\n\n      var indices = [];\n      for( var ai=0; ai<p.indices.length; ai++) {\n        indices[ai] = this.evalExpression( p.indices[ ai ] );\n      }\n\n      val = arr.get( indices );\n      if( val === undefined ) {\n        val = 0;\n      }\n\n    }\n    else if( p.type==\"expr\" ) {\n      val = this.evalExpression( p );\n    }\n    else if( p.type==\"funCall\" ) {\n\n      var values = [];\n      for( var j=0; j<p.params.length; j++) {\n        var par = this.evalExpression( p.params[j] );;\n        values.push( {value: par} );\n      }\n      try {\n        var commands = this.commands;\n        var ecommands = this.extendedcommands;\n        var cmds = this.commands;\n\n        var nFunName = \"_fun_\" + p.functionName.toLowerCase().replace(\"$\",\"_DLR_\");\n\n        var stc = commands[ nFunName ];\n        if( stc === undefined ) {\n\n          stc = ecommands[ nFunName ];\n\n          if( stc === undefined ) {\n\n            stc = ecommands[ nFunName ];\n\n            this.printError(\"no such function: \" + p.functionName);\n            console.log(\"Cannot find functionName \" + nFunName );\n\n            throw \"@no such function \" + p.functionName;\n\n          }\n          else {\n            cmds = ecommands;\n          }\n        }\n\n        val = cmds[ nFunName ]( values );\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n    else if( p.type==\"defFnCall\" ) {\n\n      try {\n        var fName = p.functionName;\n        var parValue = this.evalExpression( p.params[0] );\n        var restore = null;\n\n        if( this.functions[ fName ] === undefined ) {\n          throw \"@undef'd function\";\n        }\n        var functRecord = this.functions[ fName ];\n\n        if(!(  this.vars[ functRecord.par ] === undefined )) {\n          restore= this.vars[ functRecord.par ];\n        }\n\n        this.vars[ functRecord.par ] = parValue;\n        val  = this.evalExpression( functRecord.expr );\n\n        if( restore != null ) {\n          this.vars[ restore.name ] = restore;\n        }\n        else {\n          this.vars[ functRecord.par ] = 0; //TODO, actually should delete it\n        }\n\n      }\n      catch ( e ) {\n        throw e;\n      }\n    }\n\n    return val;\n  }\n\n  evalExpression( expr ) {\n\n    if( expr == null ) {\n      return null;\n    }\n\n    if( expr.parts.length == 0 ) {\n      return null;\n    }\n\n    var val = this.evalExpressionPart( expr.parts[ 0 ] );\n\n    for( var i=1; i<expr.parts.length; i++) {\n      var p = expr.parts[ i ];\n      if( p.op == \"+\" ) {\n        val += this.evalExpressionPart( p );\n      }\n      else if( p.op == \"^\" ) {\n        val = Math.pow( val, this.evalExpressionPart( p ) );\n      }\n      else if( p.op == \"-\" ) {\n        val -= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"*\" ) {\n        val *= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"/\" ) {\n        if( this.evalExpressionPart( p ) == 0) {\n          throw \"@division by zero\";\n        }\n        val /= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"%\" ) {\n        val %= this.evalExpressionPart( p );\n      }\n      else if( p.op == \";\" ) {\n        val += (\"\" + this.evalExpressionPart( p ));\n      }\n      else if( p.op == \"OR\"  ) {\n          val |= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"AND\"  ) {\n          val &= this.evalExpressionPart( p );\n      }\n      else if( p.op == \"<\" ) {\n        if( val < (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">\" ) {\n        if( val > (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"=\" ) {\n        if( val == (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<>\" ) {\n        if( val != (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \"<=\" ) {\n        if( val <= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n      else if( p.op == \">=\" ) {\n        if( val >= (this.evalExpressionPart( p ) ) ) {\n          val = -1;\n        } else {\n          val = 0;\n        }\n      }\n\n      else {\n        throw \"@syntax@unknown operator '\"+p.op+\"'\";\n      }\n    }\n\n    if( expr.negate ) {\n      return -val;\n    }\n    if( expr.binaryNegate ) {\n      if( val == 0 ) {\n        return -1;\n      }\n      return 0;\n    }\n    return val;\n  }\n\n  exitInputState() {\n    var con = this.output;\n    var p = this.program;\n\n    this.inputFlag = false;\n\n\n    var l = this.program[ this.runPointer ];\n    var cmds = l[1];\n\n    this.input.setInterActive( false);\n\n    this.runPointer2++;\n\n    if( this.runPointer2 >=  cmds.length ) {\n\n      this.runPointer2 = 0;\n      this.runPointer++;\n\n      if( this.runPointer >=  p.length ) {\n\n        this.runFlag = false;\n\n        this.HandleStopped( false );\n\n        this.printLine(\"\");\n        this.printReady();\n\n      }\n\n    }\n\n\n  }\n\n  breakCycle() {\n    this.breakCycleFlag = true;\n  }\n\n\n\n  cycle() {\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n\n    var c = this.output;\n\n    var cmdCount = this.cmdCountPerCycle;\n    var lineNumber = -1;\n    try {\n\n      if( this.bitmap.isActive() ) {\n        this.bitmap.triggerFlush();\n      }\n      if( this.output.isActive() && this.output.changeCount() > 0) {\n        this.output.triggerFlush();\n      }\n\n      if( !this.runFlag ||\n            this.inputFlag ||\n            this.listFlag\n             ) {\n\n        if( this.listFlag ) {\n           var countdown = this.listSpeed;\n           while( this.listPointer < this.list.length && countdown-- > 0 ) {\n               this.listCodeLine( this.list[ this.listPointer ] );\n               this.listPointer++;\n           }\n           if (  this.listPointer >= this.list.length ){\n             this.listStop();\n             this.flagStatusChange();\n           }\n\n        }\n      }\n      else {\n\n        if(this.debugFlag) console.log(\"START CYCLE------------------------------\" );\n\n        var p = this.program;\n\n        while (true) {\n\n\n          if( this.waitForMessageFlag ) {\n              return this.statusChanged;\n          }\n\n          if( this.breakCycleFlag ) {\n            this.breakCycleFlag = false;\n            break;\n          }\n\n          if(this.debugFlag) console.log(\"START CYCLE LOOP-------------\" );\n          var l = p[ this.runPointer ];\n          lineNumber = l[0];\n\n          if( l === undefined ) {\n            var t=1;\n          }\n          var bf = this.runPointer2;\n          if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n          if(this.debugFlag) console.log(\" cmdCount = \" + cmdCount);\n          var rv = this.runCommands( l[1], cmdCount );\n\n          if(! ( this.traceVars === undefined )) {\n              for( var tvi=0; tvi<this.traceVars.length; tvi++) {\n                var thisVar = this.traceVars[ tvi ];\n                var thisValue = this.vars[ thisVar ];\n                var oldValue = this.traceOldValues[ thisVar ];\n\n                if( ! ( thisValue === undefined )) {\n                  if( oldValue != thisValue ) {\n                    this.traceList.push(\n                      \"TRC(\" + lineNumber + \") \" + thisVar + \"=\" + thisValue\n                    );\n\n                    this.traceOldValues[ thisVar ] = thisValue;\n                  }\n\n                }\n              }\n          }\n\n          //console.log(\" rv = \", rv);\n          var af = rv[ 1 ];\n\n          if( rv[0] == MIDLINE_INTERUPT) {\n            this.runPointer2 = af;\n          }\n\n          var executedCount = rv[2];\n\n          if(this.debugFlag) console.log(\" bf = \" + bf, \" af = \" + af);\n          if(this.debugFlag) console.log(\" executedCount = \" + executedCount);\n          if(this.debugFlag) console.log(\" rv = \" + rv);\n\n          cmdCount = cmdCount - executedCount;\n\n          if( rv[0]<=0 ) {\n            if(this.debugFlag) console.log(\" PGM END!!!!\" );\n            this.runFlag = false;\n            var e = null;\n            if( rv.length >= 4 ) {\n              e = rv[3];\n            }\n            this.printLine(\"\");\n            this.printReady();\n            this.HandleStopped( false );\n            if( rv[0] == END_W_ERROR ) {\n\n              this.setVar(\"LINE\", lineNumber );\n              console.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n              console.log(\"PARAMETER DUMP:\", this.vars );\n              console.log(\"FUNCTION DUMP:\", this.functions );\n            }\n            if(this.debugFlag) console.log(\"CYCLE RETURN END\");\n            return this.statusChanged;\n          }\n          else if( rv[0] == LINE_FINISHED ) {\n            this.runPointer ++;\n            this.runPointer2 = 0;\n            if(this.debugFlag) console.log(\" new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n            if( this.runPointer >=  p.length ) {\n              if(this.debugFlag) console.log( \"end program\");\n\n              this.setVar(\"LINE\", lineNumber );\n\n              if( !this.waitForMessageFlag ) {\n                this.runFlag = false;\n                this.HandleStopped( false );\n                this.printReady();\n              }\n              else {\n                this.stopAfterMessage = true;\n              }\n              break;\n            }\n          }\n          else if( rv[0] == TERMINATE_W_JUMP ) {\n\n            if(this.debugFlag) console.log(\" jump to new this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n          }\n          else if( rv[0] == PAUSE_F_INPUT ) {\n\n            this.runPointer2 = af;\n            if(this.debugFlag) console.log(\"CYCLE PAUSE 4 INPUT\" + this.runPointer + \",\" + this.runPointer2);\n            break;\n\n          }\n\n          if( cmdCount<=0 ) {\n            if(this.debugFlag) console.log(\"Breaking cmdCount=\" + cmdCount)\n            break;\n          }\n\n        }\n\n        if(this.debugFlag) console.log(\" this.runPointer = \" + this.runPointer, \" this.runPointer2 = \" + this.runPointer2 );\n\n      }\n\n    }\n    catch (e) {\n      //c.clearCursor();\n\n      sys.log(\"DEBUG: \", typeof e );\n\n      this.setVar(\"LINE\", lineNumber );\n\n\n      if( this.erh.isError( e ) ) {\n        var err = e;\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else if( this.erh.isSerializedError( e ) ) {\n        var err = this.erh.fromSerializedError( e );\n\n        this.setVar(\"ERR\", err.clazz );\n        this.setVar(\"ERRDETAIL\", err.detail  );\n\n        this.printError( err.clazz, undefined, undefined, err.detail );\n      }\n      else {\n        var err = this.erh.fromSimpleExternalError( e, undefined, undefined );\n\n        if( err ) {\n\n            this.setVar(\"ERR\", err.clazz );\n            this.setVar(\"ERRDETAIL\", err.detail  );\n            this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else {\n\n            this.setVar(\"ERR\", \"unexpected\" );\n            this.setVar(\"ERRDETAIL\", \"unexpected\"  );\n            this.printError( \"unexpected\", undefined, undefined, e );\n        }\n\n      }\n\n      this.printReady();\n      this.runFlag = false;\n      this.HandleStopped( false );\n\n      sys.log(\"ERROR: \", e, \" LINE \", this.retreiveRuntimeLine() );\n      sys.log(\"PARAMETER DUMP:\", this.vars );\n      sys.log(\"FUNCTION DUMP:\", this.functions );\n\n    }\n\n    return this.statusChanged;\n  }\n\n  doReturn() {\n\n    var oldPointers = this.gosubReturn.pop();\n    if( oldPointers === undefined ) {\n      throw \"@return without gosub\";\n    }\n\n    this.runPointer2 = oldPointers[ 1 ];\n    this.runPointer = oldPointers[ 0 ];\n\n    //this.goto( oldLine );\n  }\n\n\n  doInterruptReturn() {\n\n    if( this.scope.name == \"interrupt0\" ) {\n      this.interruptFlag0 = false; // TODO interrupt, take from scope which flag\n    }\n    else {\n      this.interruptFlag1 = false; // TODO interrupt, take from scope which flag\n    }\n\n    this.runPointer = this.scope.data.runPointer;\n    this.runPointer2 = this.scope.data.runPointer2;\n\n    this.closeScope();\n\n  }\n\n\n\n\n  gosub( line0, runPointer2 ) {\n\n\n    var pgm = this.program;\n    var len=this.program.length;\n    var retLine = null;\n    var retCmd = null;\n\n    var line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    this.runPointer2 = runPointer2;\n\n    if( ( this.runPointer2 + 1) < this.program[ this.runPointer ][1].length ) {\n      retCmd = this.runPointer2 + 1;\n      retLine = this.runPointer;\n    }\n    else {\n      if( (this.runPointer+1) < len ) {\n        retCmd=0;\n        retLine = this.runPointer+1 ;\n      }\n      else {\n        retCmd=9999;\n        retLine = this.runPointer;\n      }\n    }\n\n    this.gosubReturn.push( [ retLine, retCmd ] );\n    this.goto( line );\n  }\n\n  goto( line0 ) {\n\n    //console.log( \"goto line \" + line)\n    var pgm = this.program;\n    var len=this.program.length;\n    var found = false;\n    var line;\n\n    line = line0;\n    if( (typeof line0).toLowerCase() == \"string\" ) {\n      line = this.labels[line0];\n      if( line == undefined ) {\n        throw \"@undef'd label\";\n      }\n    }\n\n    for( var i=0; i<len; i++) {\n      var l = pgm[i];\n\n      if( l[0] == line ) {\n        this.runPointer = i;\n        this.runPointer2 = 0;\n        found = true;\n      }\n    }\n\n    if(!found ) {\n      throw \"@undef'd statement\";\n    }\n\n    if(!this.runFlag ) {\n      this.startAsGoto = true;\n      this.runPGM();\n    }\n  }\n\n  listStop() {\n    if( this.listFlag ) {\n      if( this.runFlag ) {\n        this.listFlag = false;\n        this.input.setInterActive( this.listFlagBakInteractive );\n      }\n      else {\n        var c = this.output;\n        this.listFlag = false;\n        this.HandleStopped( false );\n        this.printLine( \"\" );\n        this.printReady();\n      }\n    }\n  }\n\n\n  runStop() {\n    if( this.runFlag ) {\n      var c = this.output;\n      this.runFlag = false;\n      this.handlers.interrupt0 = undefined;\n      this.handlers.interrupt1 = undefined;\n\n      this.HandleStopped( false );\n\n      console.log( \"break in \" + this.program[ this.runPointer ][0] );\n\n      this.setVar( \"LINE\", this.program[ this.runPointer ][0] );\n      this.setVar(\"ERR\", \"BREAK\" );\n\n      this.printLine(\"\");\n      this.printLine( \"break in \" + this.program[ this.runPointer ][0]);\n      this.printReady();\n    }\n  }\n\n  isRunning() {\n    return this.runFlag;\n  }\n\n  isListing() {\n    return this.listFlag;\n  }\n\n  isInput() {\n    return this.inputFlag;\n  }\n\n  isReady() {\n    return !this.runFlag && !this.listFlag && ! this.executeLineFlag;\n  }\n\n\n  getDataBlocks() {\n    var list = [];\n\n    var mapInfo = Object.entries( this.loadedData );\n    for( var i=0; i<mapInfo.length; i++) {\n      if( mapInfo[i][1].length > 0) {\n        list.push( mapInfo[i][0] + \": \" + mapInfo[i][1].length  );\n      }\n\n    }\n\n    return list;\n\n  }\n\n  readData() {\n\n    if( this.dataPointer >= this.data.length ) {\n      return undefined;\n    }\n\n    var result = this.data[ this.dataPointer ];\n    this.dataPointer++;\n\n    return result;\n  }\n\n\n  getDataLength() {\n\n    return this.data.length;\n\n  }\n\n  setData( label0 ) {\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n\n    this.data = this.loadedData[ label ];\n    this.dataPointer = 0;\n\n  }\n\n  insertData( data, type, label0 ) {\n\n    //this.loadedData = { default: [] };\n    var label = label0;\n    if( ! label ) {\n      label = \"default\";\n    }\n    this.loadedLabel = label;\n    this.dataPointer = 0;\n\n    var arr = [];\n    this.loadedData[label ] = arr;\n\n    var typeParts = type.split(\":\");\n    var typeData = typeParts[0].toUpperCase();\n    var dataSyntax = typeParts[1].toUpperCase();\n\n    this[\"parseSimpleData\" + typeData + \"_\" + dataSyntax]( data, arr );\n\n    this.data = arr;\n  }\n\n\n  parseSimpleDataI_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n\n  parseSimpleDataS_CSV( data, toArr ) {\n    var data2 = data.replaceAll(\" \",\"\").replaceAll(\"\\t\",\"\").replaceAll(\"\\r\",\"\").replaceAll(\"\\n\",\"\");\n    data2 = data2.split(\",\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  parseSimpleDataS_LINES( data, toArr ) {\n    var data2;\n    data2 = data.split(\"\\n\");\n    for( var i=0; i<data2.length; i++) {\n      toArr.push( data2[ i ] );\n    }\n\n  }\n\n  printChar( c  ) {\n    this.output.write( c );\n  }\n\n  listCodeLine( rawLine ) {\n    if( rawLine === undefined ) {\n        this.printLine( \"???\" );\n        return;\n    }\n\n    this.printLine( rawLine );\n\n  }\n\n  rebuildLineString( nr, raw,\n      removePadding,\n      renumbering,\n      addSmartPadding,\n      shortenKeywords)\n  {\n\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n\n    var tokens = p.getTokens( raw, false, false );\n\n    if( ! ( renumbering === undefined )) {\n\n\n\n      var nopadTokens = [];\n      for( i = 0; i<tokens.length; i++) {\n        if( tokens[i].type != \"pad\") {\n          nopadTokens.push( tokens[ i ] );\n        }\n      }\n\n      var foundGoto = false;\n      var foundGotoParIndex = -1;\n\n      for( i = 0; i<nopadTokens.length; i++) {\n\n          if( i>1 ) {\n            if( nopadTokens[i].type == \"num\" &&\n                nopadTokens[i-1].type == \"name\" && nopadTokens[i-1].data == \"THEN\" ) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n            else if( nopadTokens[i].type == \"num\" &&\n                  nopadTokens[i-1].type == \"name\" &&\n                  ( nopadTokens[i-1].data == \"GOTO\" || nopadTokens[i-1].data == \"GOSUB\" )) {\n              foundGoto = true;\n              foundGotoParIndex = i;\n            }\n        }\n\n        if( nopadTokens[i].type == \"num\" && foundGoto &&  i == foundGotoParIndex ) {\n          var newLine = renumbering[ \"old_\" + nopadTokens[i].data ];\n          if( newLine == undefined ) { newLine = 99999;}\n          nopadTokens[i].data =newLine;\n          foundGoto = false;\n        }\n      }\n    }\n    tokens[0].data = nr;\n    var newString;\n\n    newString = nr;\n    if( removePadding ) {\n      newString = nr + \" \" ;\n    }\n    for( var i = 1 ; i< tokens.length; i++) {\n      if( removePadding ) {\n         if( tokens[i].type == \"pad\" ) {\n           continue;\n         }\n       }\n\n       if( shortenKeywords ) {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"PRINT\" ) {\n           tokens[i].data = \"?\";\n         }\n       }\n       else {\n         if( tokens[i].type == \"name\" && tokens[i].data == \"?\" ) {\n           tokens[i].data = \"PRINT\";\n         }\n      }\n\n      if( tokens[i].type == \"str\" ) {\n        newString += \"\\\"\" + tokens[i].data + \"\\\"\";\n      }\n      else if( tokens[i].type == \"name\" && addSmartPadding == true) {\n        newString += tokens[i].data + \" \";\n      }\n      else if( tokens[i].type == \"num\" && addSmartPadding == true) {\n        if( tokens[i].data.length == 1 ) {\n            newString += \" \" + tokens[i].data;\n        }\n        else {\n            newString += tokens[i].data;\n        }\n      }\n      else {\n        newString += tokens[i].data;\n      }\n\n    }\n\n    var rec = p.parseLine( newString );\n\n    return rec;\n  }\n\n  lineIsData( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"DATA\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsRem( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"REM\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lineIsSub( line ) {\n    console.log( line );\n    if( line[1].length == 1 ) {\n      if( ! ( line[1][0].controlKW === undefined) ) {\n        if( line[1][0].controlKW.toUpperCase() == \"SUB\" ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  renumberProgram( start, gap ) {\n\n    var p = this.program;\n\n    var newLineNr = start;\n    var renumbering = {};\n    var lineNumbers = [];\n\n    var method = \"sub\";\n\n    if( method  == \"plain\" ) {\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n      }\n    }\n    else if( method  == \"data\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n      //data\n      var kNumber = Math.ceil( newLineNr / 1000 );\n      var newLineNr2 = 1000 * ( kNumber  );\n      if( newLineNr2 - newLineNr  < 100 ) {\n        newLineNr2+=1000;\n      }\n      newLineNr = newLineNr2;\n\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var data = this.lineIsData( line );\n\n          if( !data ) {\n            continue;\n          }\n          else {\n            renumbering[\"old_\" + line[0]] = newLineNr;\n            lineNumbers.push( newLineNr );\n            newLineNr += gap;\n          }\n      }\n\n    }\n    else if( method  == \"rem\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsRem( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    else if( method  == \"sub\" ) {\n      // non data\n      for( var i=0; i<p.length; i++) {\n          var line = p[ i ];\n          var rem = this.lineIsSub( line );\n\n          if( rem ) {\n            var kNumber = Math.ceil( newLineNr / 1000 );\n            var newLineNr2 = 1000 * ( kNumber  );\n            if( newLineNr2 - newLineNr  < 100 ) {\n              newLineNr2+=1000;\n            }\n            newLineNr = newLineNr2;\n          }\n          renumbering[\"old_\" + line[0]] = newLineNr;\n          lineNumbers.push( newLineNr );\n          newLineNr += gap;\n\n      }\n\n    }\n    //newLineNr = start;\n    for( var i=0; i<p.length; i++) {\n        newLineNr = lineNumbers[ i ]\n        var line = p[ i ];\n        var lRec = this.rebuildLineString( newLineNr, line[2], true, renumbering, true );\n\n        line[0] = newLineNr;\n        line[1] = lRec.commands;\n        line[2] = lRec.raw.trim();\n\n        //newLineNr += gap;\n    }\n  }\n\n  PETSCIIreplace( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildNoPETSCIILineString( line[2] );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  compressProgram( keywordCompress ) {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n       var lRec = this.rebuildLineString( line[0], line[2], true, undefined, false, keywordCompress );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  normalizeProgram() {\n    var p = this.program;\n\n    for( var i=0; i<p.length; i++) {\n        var line = p[ i ];\n\n        var lRec = this.rebuildLineString( line[0], line[2], true, undefined, true );\n\n        line[1] = lRec.commands;\n        line[2] = lRec.raw;\n\n    }\n  }\n\n  clrPGM() {\n    this.vars = {};\n    this.functions = [];\n    this.restoreDataPtr();\n  }\n\n  restoreDataPtr() {\n    this.dataPointer = 0;\n    this.data = this.loadedData[ \"default\" ];\n  }\n\n  normalizeData( dataRec ) {\n    var data = dataRec.data;\n\n    if( dataRec.type == \"num\" ) {\n      if( (typeof data).toLowerCase() == \"string\" ) {\n        data = parseInt( data );\n      }\n    }\n    else {\n      if( (typeof data).toLowerCase() == \"number\" ) {\n        data = \"\" + data ;\n      }\n    }\n\n    return data;\n  }\n\n  runPGM() {\n\n    this.executeLineFlag = false;\n    this.stopAfterMessage = false;\n\n    if( this.startAsGoto ) {\n        this.startAsGoto = false;\n\n        var bak1 = this.runPointer;\n        var bak2 = this.runPointer2;\n\n        this.runPGM();\n\n        this.runPointer = bak1;\n        this.runPointer2 = bak2;\n\n\n        return;\n    }\n\n    this.input.setInterActive( false);\n    this.input.flush();\n\n    var c = this.output;\n    var p = this.program;\n\n    this.loadedData[ \"default\" ] = [];\n    this.restoreDataPtr();\n\n    this.gosubReturn = [];\n    this.scopes = [];\n    this.newScope( \"global\", {} );\n    this.functions = [];\n    this.handlers = {}\n    this.labels = {};\n    this.traceList = [];\n    this.traceOldValues = {};\n\n    var normalize = this.normalizeData;\n\n    for( var i=0; i<p.length; i++) {\n\n        var line = p[ i ];\n        var commands = line[1];\n\n        for( var j=0; j<commands.length; j++) {\n\n          var command = commands[j];\n\n          if( command.type  == \"control\" && command.controlKW == \"data\") {\n            for( var k=0; k<command.params.length; k++) {\n              this.loadedData[ \"default\" ].push( normalize( command.params[k] ) );\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"on\") {\n            if( command.params[0] == \"interrupt1\") {\n              this.handlers.interrupt1 = command.params[1];\n              this.handlers.interrupt1ParamIsLabel = command.label;\n            }\n            else if( command.params[0] == \"interrupt0\") {\n              this.handlers.interrupt0 = command.params[1];\n              this.handlers.interrupt0ParamIsLabel = command.label;\n            }\n          }\n          else if( command.type  == \"control\" && command.controlKW == \"sub\") {\n            var label = command.label;\n            this.labels[ label ] = parseInt(line[0]);\n          }\n        }\n    }\n\n    if( this.debugFlag ) {\n      console.log(\"data dump:\",this.data);\n    }\n\n\n    if( this.program.length > 0) {\n      this.runFlag = true;\n      this.inputFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n\n    }\n    else {\n      this.runFlag = false;\n      this.inputFlag = false;\n      this.runPointer = 0;\n      this.runPointer2 = 0;\n      this.waitForMessageFlag = false;\n      this.interruptFlag0 = false;\n      this.interruptFlag1 = false;\n      this.input.setInterActive( true);\n    }\n\n    this.flagStatusChange();\n  }\n\n  getVars() {\n    return this.vars;\n  }\n\n\n\n\n  doForInit( from, to, step, varName, cmdPointer, cmdArrayLen, linePointersLen ) {\n\n    var ctx = this.forContext;\n\n    if( this.vars[ varName ] === undefined ) {\n      this.vars[ varName ] = 0;\n    }\n    this.vars[ varName ] = this.evalExpression( from );\n\n    ctx.default.push( varName );\n    ctx[varName] = {};\n\n    var ctxv = ctx[varName];\n    ctxv.to = this.evalExpression( to );\n\n    if( step == null ) {\n        ctxv.step = 1;\n    }\n    else {\n      ctxv.step = this.evalExpression( step );\n    }\n\n    ctxv.jumpTo =\n      { line: this.runPointer,\n        cmdPointer: cmdPointer+1 }\n    if( ctxv.jumpTo.cmdPointer >= cmdArrayLen )  {\n\n      if( this.runPointer == -1) {\n        throw \"@syntax@Can't find command after 'FOR'\";\n      }\n      else {\n        if( ( this.runPointer + 1) >= linePointersLen ) {\n          throw \"@syntax@Can't find command after 'FOR', on next line\";\n        }\n        ctxv.jumpTo.line++;\n        ctxv.jumpTo.cmdPointer = 0;\n      }\n    }\n\n  }\n\n  doForNext( nextVarName ) {\n    var ctx = this.forContext;\n    if( ctx.default.length == 0 ) {\n      throw \"@syntax@Next without for\";\n    }\n    var varName = ctx.default[ctx.default.length-1];\n    if( nextVarName  != null ) {\n      varName = nextVarName;\n    }\n\n    var ctxv = ctx[varName];\n\n    this.vars[ varName ] += ctxv.step;\n    if( ctxv.step > 0) {\n      if(this.vars[ varName ]<=ctxv.to) {\n\n        return ctxv.jumpTo;\n      }\n    }\n    else if( ctxv.step == 0) {\n      return ctxv.jumpTo;\n    }\n    else {\n      if(this.vars[ varName ]>=ctxv.to) {\n        return ctxv.jumpTo;\n      }\n    }\n\n    ctx.default.pop();\n    return -1;\n  }\n\n  onLineStr() {\n\n    var line = this.retreiveLine();\n    if( line == -1 || line == \"\") { return \"\"; }\n\n    return \" in \" + line;\n\n  }\n\n  retreiveRuntimeLine() {\n    if( this.runPointer > -1 ) {\n      var line = this.program[this.runPointer];\n      return line[0];\n    }\n    return -1;\n  }\n\n\n  retreiveLine() {\n    if( this.runFlag ) {\n      return this.retreiveRuntimeLine();\n    }\n    else {\n      if( this[\"parseLineNumber\"] === undefined ) {\n        return -1;\n      }\n      if( this.parseLineNumber == -1) { return \"\"; }\n      return this.parseLineNumber;\n    }\n    return -1;\n  }\n\n\n  commandToString( cmd ) {\n    if( cmd.type == \"control\" )  {\n      return cmd.controlKW.toUpperCase();\n    }\n    else if( cmd.type == \"call\" ) {\n      return cmd.statementName;\n    }\n    else if( cmd.type == \"assignment\" )  {\n      return \"assign ->\" + cmd.var;\n    }\n    return \"????\";\n  }\n\n  runCommands( cmds, limit ) {\n    /* return values\n      false -> error or end program\n      true  -> executed ok\n\n      should return\n      end_w_error\n      terminate_program\n      line_finished\n      goto_gosub\n    */\n\n    var commands = this.commands;\n    var ecommands = this.extendedcommands;\n    var EXPR = 0, PAR = 1;\n\n    /*return values*/\n    var END_W_ERROR = 0;\n    var TERMINATE_PROGRAM = -1;\n    var LINE_FINISHED = 10;\n    var MIDLINE_INTERUPT = 20;\n    var TERMINATE_W_JUMP = 30;\n    var PAUSE_F_INPUT = 40;\n\n    var end = cmds.length;\n    var i=this.runPointer2;\n    var cnt=0;\n\n    if(!(limit == undefined )) {\n      //nothing\n    }\n    else {\n      limit = 9999; //reaching to infinite (max on line maybe  40)\n    }\n\n\n\n    while( i<end && cnt<limit ) {\n\n\n      if( this.breakCycleFlag ) {\n        if(!(limit == undefined )) {\n          this.breakCycleFlag = false;\n          break;\n        }\n      }\n\n      var cmd=cmds[i];\n\n      var l=this.program[this.runPointer];\n      if( l ) {\n        //console.log( l[0] );\n        if(parseInt(l[0]) == 3155 ) {\n          console.log(\"bump\");\n        }\n      }\n      //if( this.runPointer > -1 ) {\n      //  console.log( l[0] + \"(\" + this.runPointer + \":\" + i +\")\" + this.commandToString( cmd ) );\n      //}\n      //console.log( cmd.lineNumber + \":\" + cmd.type + \":\" + (cmd.controlKW ? cmd.controlKW : cmd.statementName ));\n\n      if( cmd.type == \"control\" )  {\n        var cn = cmd.controlKW;\n        if( cn == \"goto\" ) {\n          this.goto( cmd.params[0] );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"end\" ) {\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"stop\" ) {\n          this.printInfo(\"break\");\n          return [TERMINATE_PROGRAM,i+1,cnt+1];\n        }\n        else if( cn == \"gosub\" ) {\n          this.gosub( cmd.params[0], i );\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"on\" ) {\n          var onCommand = cmd.params[ 0 ];\n\n          if( onCommand != \"interrupt0\"  && onCommand != \"interrupt1\" ) {\n            var onExpr = cmd.params[ 1 ];\n            var onLineNrs = cmd.params[ 2 ];\n\n            var value = this.evalExpression( onExpr );\n            if( (value-1)>=0 && (value-1)<onLineNrs.length ) {\n              if( onCommand == \"goto\" ) {\n                this.goto( onLineNrs[ (value-1) ] );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n              else if( onCommand == \"gosub\" ) {\n                this.gosub( onLineNrs[ (value-1) ], i );\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n              }\n            }\n          }\n\n          //if not jumping, do nothing\n        }\n        else if( cn == \"return\" ) {\n\n          if( this.interruptFlag0 || this.interruptFlag1) {\n\n            this.doInterruptReturn();\n\n          }\n          else {\n            this.doReturn();\n          }\n\n          return [TERMINATE_W_JUMP,i+1,cnt+1];\n        }\n        else if( cn == \"if\" ) {\n          var IF_ERROR = -1;\n          var IF_TRUE = 1;\n          var IF_FALSE = 0;\n\n          var ifresult = this.evalExpression( cmd.params[0] );\n          if( ifresult != IF_FALSE ) {\n             //return [MIDLINE_INTERUPT,i+1];\n          }\n          else  {\n             return [LINE_FINISHED,i+1,cnt+1];\n          }\n        }\n        else if( cn == \"data\" ) {\n          //Nothing\n        }\n        else if( cn == \"rem\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"sub\" ) {\n          return [LINE_FINISHED,i+1,cnt+1];\n        }\n        else if( cn == \"for:init\" ) {\n          this.doForInit( cmd.params[0], cmd.params[1], cmd.params[2], cmd.variable, i, cmds.length );\n        }\n        else if( cn == \"for:next\" ) {\n\n          var jump = this.doForNext( cmd.nextVar );\n\n          if( !(jump === -1 ) ) {\n\n            if( jump.line != -1 ) {\n                if( this.runPointer == jump.line ) {\n                  i = jump.cmdPointer;\n                  cnt++;\n                  continue;\n                }\n                else {\n                  this.runPointer = jump.line;\n                  this.runPointer2 = jump.cmdPointer;\n                }\n                return [TERMINATE_W_JUMP,i+1,cnt+1];\n            }\n            else {\n              i = jump.cmdPointer;\n              cnt++;\n              continue;\n            }\n          }\n        }\n        else if( cn == \"dim\" ) {\n          var vars = this.vars;\n\n          for( var ix=0; ix<cmd.params.length; ix++) {\n\n            var indices = [];\n            for( var ai=0;ai<cmd.params[ix].length;ai++){\n              indices[ai] = this.evalExpression( cmd.params[ix][ai] );\n            }\n\n            var arrRec = new BasicArray( cmd.arrayNames[ix], indices, 0 );\n\n            var varIntName = \"@array_\" + cmd.arrayNames[ix];\n\n            if( ! ( this.vars[ varIntName ] === undefined )) {\n              this.printError( \"redim'd array\" );\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ varIntName ] = arrRec;\n          }\n\n        }\n        else if( cn == \"def\" ) {\n          this.functions[ cmd.params[0] ] = {\n            par: cmd.params[1],\n            expr: cmd.params[2]\n          };\n        }\n        else {\n          this.printError( \"illegal ctrl token '\" + cn  +\"'\");\n          return [END_W_ERROR,i+1,cnt+1];\n        }\n      }\n      else if( cmd.type == \"call\" )  {\n        var values = [];\n        var pardefs = [];\n        var mycommands = commands;\n        var stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n        if( stc === undefined ) {\n          //cmd.statementName.toLowerCase().startsWith(\"x\") )\n          mycommands = ecommands;\n\n          stc = mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()];\n\n          if( stc === undefined ) { }\n          else {\n            if( mycommands.enabled == false &&\n              cmd.statementName.toLowerCase() != \"xon\") {\n                  this.printError( \"extended not enabled\" );\n                  return [END_W_ERROR,i+1,cnt+1];\n            }\n          }\n        }\n\n        var intf = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()];\n        if( !( intf === undefined ) ) {\n            pardefs = mycommands[ \"_if_\" + cmd.statementName.toLowerCase()]();\n        }\n        else {\n          for( var j=0; j<cmd.params.length; j++) {\n            pardefs[j] = EXPR;\n          }\n        }\n\n        for( var j=0; j<cmd.params.length; j++) {\n          if( pardefs[j] == EXPR ) {\n\n            var p = this.evalExpression( cmd.params[j] );  //NOTE this one gets the trailing ;, from a \"PRINT ;\" command\n\n            if( p != null ) {\n              values.push( { type: \"value\", value: p } );\n            }\n          }\n          else if( pardefs[j] == PAR ) {\n            var varName = cmd.params[j].parts[0].data;\n            var varType0 = cmd.params[j].parts[0].type;\n\n            if( varType0 == \"array\" ) {\n\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType0 + \":\" + varType } );\n\n\n            }\n            else {\n              var varType = \"num\";\n              if( varName.indexOf(\"$\") > -1) {\n                varType = \"str\";\n              }\n\n              values.push( { type: \"var\", value: varName, varType: varType } );\n\n            }\n\n          }\n          else { /*RAW*/\n            //values.push( cmd.params[j].parts );\n            values.push( cmd.params[j] );\n\n          }\n        }\n        try {\n          //var stc = ;\n          if( stc === undefined ) {\n            this.printError(\"syntax\");\n            return [END_W_ERROR,i+1,cnt+1];\n          }\n          else {\n              mycommands[ \"_stat_\" + cmd.statementName.toLowerCase()]( values );\n              if( this.inputFlag ) {\n                return [PAUSE_F_INPUT,i+1,cnt+1];\n              }\n          }\n\n        }\n        catch ( e ) {\n          console.log(e);\n\n          if( this.erh.isSerializedError( e ) ) {\n            var err = this.erh.fromSerializedError( e );\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else if( this.erh.isError( e ) ) {\n            var err = e;\n            this.printError( err.clazz, false, false, err.detail );\n          }\n          else {\n            this.printError(\"unexpected \" + e );\n          }\n\n          return [END_W_ERROR,i+1,cnt];\n        }\n      }\n      else if( cmd.type == \"assignment\" )  {\n        if( cmd.arrayAssignment ) {\n          var varIntName = \"@array_\" + cmd.var;\n          if( this.vars[ varIntName ] === undefined ) {\n            this.printError(\"bad subscript\");\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var arr = this.vars[ varIntName ];\n          if( cmd.indices.length != arr.getIndexCount() ) {\n            this.printError(\"bad subscript\");\n            return [END_W_ERROR,i+1,cnt];\n          }\n\n          var indices = [];\n          for( var ai=0;ai<cmd.indices.length;ai++){\n            indices[ai] = this.evalExpression( cmd.indices[ai] );\n          }\n\n          if( cmd.var.endsWith(\"%\") ) {\n              arr.set( indices, Math.floor( this.evalExpression( cmd.expression ) ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n          else {\n              arr.set( indices, this.evalExpression( cmd.expression ) );\n          }\n\n        }\n        else { //single var (not an array)\n          if( this.vars[ cmd.var ] === undefined ) {\n            if(cmd.var.startsWith(\"TI\")) {\n              this.printError(\"syntax\");\n              return [END_W_ERROR,i+1,cnt+1];\n            }\n            this.vars[ cmd.var ] = 0;\n          }\n          if(cmd.var.endsWith(\"%\")) {\n            this.vars[ cmd.var ] = Math.floor( this.evalExpression( cmd.expression ) );\n          }\n          else if( ! cmd.var.endsWith(\"$\") ) {\n              var v = this.evalExpression( cmd.expression );\n              if( ! (typeof v == \"number\") ) {\n                this.printError(\"type mismatch\", undefined, undefined, \"value not a number\");\n                return [END_W_ERROR,i+1,cnt];\n              }\n              this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n          else {\n            this.vars[ cmd.var ] = this.evalExpression( cmd.expression );\n          }\n        }\n      }\n      //cnt++;\n      i++;\n      cnt++;\n    }\n\n    if( i== cmds.length ) {\n      return [LINE_FINISHED,i,cnt];\n    }\n\n    return [MIDLINE_INTERUPT,i,cnt];\n\n  }\n\n  newScope( name, data ) {\n    var scope = { name: name, vars: {}, data: data };\n    this.scopes.push( scope );\n    this.vars = scope.vars;\n    this.scope = scope;\n  }\n\n  closeScope() {\n    this.scopes.pop();\n    this.vars = this.scopes[ this.scopes.length - 1 ].vars;\n  }\n\n\n  getArray( a ) {\n   return this.vars[  \"@array_\" + a ];\n  }\n\n  setVar( a, b ) {\n    this.vars[ a ] = b;\n  }\n\n  getTraceList() {\n    if( this.traceList === undefined ) {\n      return [];\n    }\n\n    return this.traceList;\n  }\n\n  setTraceVar( v ) {\n    if( this.traceVars === undefined ) {\n        this.traceVars = [];\n    }\n    this.traceVars.push( v.toUpperCase() );\n\n  }\n\n  resetTraceVar( v ) {\n    this.traceVars = undefined;\n  }\n\n\n  old( ) {\n    this.program = this.oldProgram;\n  }\n\n  new( ) {\n    this.oldProgram = this.program ;\n    this.program = [];\n  }\n\n  removePgmLine( linenr ) {\n\n    var pgm2 = [];\n\n    for( var i=0; i<this.program.length; i++) {\n      var pl=this.program[i];\n      if( pl[0] != linenr ) {\n        pgm2.push(pl);\n      }\n    }\n    this.program = pgm2;\n\n  }\n\n\n  padSpaces6( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<6; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n  padSpaces8( no ) {\n    var s = no + \"\";\n    for(var i=s.length; i<8; i++) {\n      s+=\" \";\n    }\n    return s;\n  }\n\n\n  insertPgmLine( linenr, commands, handlers, raw ) {\n\n    this.insertPgmLineLocal( linenr, commands, handlers, raw, this.program );\n  }\n\n  insertPgmLineLocal( linenr, commands, handlers, raw, myProgram ) {\n\n    for( var i=0; i<myProgram.length; i++) {\n      var pl=myProgram[i];\n      if( pl[0] == linenr ) {\n        myProgram[i] = [linenr, commands, raw.trim() ];\n        return;\n      }\n    }\n\n    myProgram.push( [linenr, commands, raw.trim(), handlers ]);\n\n    var sortF = function compare( a, b ) {\n      return a[0] - b[0];\n    }\n\n    myProgram.sort( sortF );\n\n  }\n\n  textLinesToBas( lines ) {\n\n    var myProgram = [];\n    var exception = undefined;\n\n    if( this.debugFlag ) {\n      console.log( \"textLinesToBas\" );\n    }\n    for( var i = 0; i<lines.length; i++ ) {\n\n      var line = this.prepareLineForImport( lines[ i ] );\n      var p = new Parser( this.commands, this.extendedcommands );\n      p.init();\n\n      var l = null;\n\n      try {\n          l = p.parseLine( line );\n      }\n      catch ( e ) {\n        if( exception === undefined ) {\n            exception = e;\n        }\n\n        try {\n          l = p.parseErrorLine( line );\n        }\n        catch ( e ) {\n            this.printError( \"unexpected text (at \"+i+\")\", true );\n            console.log(\"Illegal Line: \", line );\n        }\n      }\n\n      if( l == null ) {\n        continue;\n      }\n      if( l.lineNumber != -1 ) {\n        if( l.commands.length > 0) {\n          this.insertPgmLineLocal( l.lineNumber, l.commands, l.handlers, l.raw,  myProgram);\n          //this.program[ l.lineNumber ] = [l.commands,l.raw];\n        }\n        else {\n          throw \"Error, no commands on line \" + l.lineNumber;\n        }\n      }\n      else {\n        throw \"Error, command must start with number to be part of program\";\n      }\n\n      if( this.debugFlag ) {\n        console.log(\"program:\",myProgram);\n        console.log(\"Line: \", l );\n      }\n    }\n    return { pgm: myProgram, exception: exception };\n  }\n\n  printReady() {\n    this.printLine(\"Ready.\");\n  }\n\n\n  startConsoleDataInput( vars ) {\n\n    if( this.debugFlag ) {\n      console.log(\"inputvars=\",vars);\n    }\n    this.inputFlag = true;\n    this.inputVars = vars;\n    this.input.setInterActive( true);\n    this.inputVarsPointer = 0;\n    this.output.write( \"? \");\n    this.inputStartInputPosX = this.output.getCursorPos()[0];\n\n    this.flagStatusChange();\n\n  }\n\n  executeInteractiveLine( str ) {\n    this.handleLineInput( str, false );\n  }\n\n  handleLineInput( str, isInputCommand ) {\n\n    if( this.debugFlag ) {\n      console.log(\"handleLineInput: start debug / isInputCommand=\" + isInputCommand + \" -------------\");\n    }\n\n    if( isInputCommand ) {\n\n        var input=str;\n        var qMark = input.indexOf(\"?\");\n        while( qMark > -1 ) {\n          input = input.substr(qMark+2);\n          qMark = input.indexOf(\"?\");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: start debug / input, name -------------\");\n          console.log( \"InputVarsPointer:\" , this.inputVarsPointer );\n          console.log( \"InputVars:\" , this.inputVars );\n\n          console.log( \"Input String:\" ,input );\n          console.log( \"Input Vars[current]:\" ,this.inputVars[ this.inputVarsPointer ] );\n        }\n\n\n        var vName = this.inputVars[ this.inputVarsPointer ];\n        if( vName.indexOf(\"$\") >-1 ) {\n            this.setVar( this.inputVars[ this.inputVarsPointer ], input.trim() );\n        }\n        else {\n          var num = parseFloat( input.trim() );\n\n          if( isNaN( num ) ) {\n            this.printLine(\"?redo from start\");\n            this.printChar( \"? \");\n            return;\n          }\n          this.setVar( this.inputVars[ this.inputVarsPointer ], num );\n        }\n\n        this.inputVarsPointer++;\n        if( this.inputVarsPointer >= this.inputVars.length ) {\n\n          this.exitInputState();\n        }\n        else {\n          this.printChar( \"?? \");\n        }\n\n        if( this.debugFlag ) {\n          console.log(\"handleLineInput: end debug -------------\");\n        }\n        return;\n    }\n\n    this.executeLineFlag = true;\n\n    if( this.debugFlag ) {\n      console.log( str );\n    }\n    var p = new Parser( this.commands, this.extendedcommands );\n    p.init();\n    try {\n      var l = p.parseLine( str );\n    }\n    catch( e ) {\n\n      this.parseLineNumber = -1;\n      if( this.erh.isError( e ) ) {\n        this.parseLineNumber = e.lineNr;\n        this.printError( e.clazz, true, undefined, e.detail );\n      }\n      else {\n        this.printError( \"syntax\", true );\n      }\n      this.printReady();\n    }\n    if( l == null ) {\n      if( this.debugFlag ) {\n        console.log(\"handleLineInput: end debug -------------\");\n      }\n\n      this.executeLineFlag = false;\n      return;\n    }\n\n    if( l.lineNumber != -1 ) {\n      if( l.commands.length > 0) {\n        this.insertPgmLine( l.lineNumber, l.commands, l.handlers, l.raw);\n      }\n      else {\n        this.removePgmLine( l.lineNumber  );\n      }\n    }\n    else {\n      this.runPointer = -1;\n      this.runPointer2 = 0;\n\n      try {\n        this.runCommands( l.commands );\n      }\n      catch( e ) {\n\n        this.parseLineNumber = -1;\n\n        if( this.erh.isSerializedError( e ) ) {\n          var err = this.erh.fromSerializedError( e );\n          this.parseLineNumber = err.lineNr;\n          this.printError( err.clazz, undefined, undefined, err.detail );\n        }\n        else if( this.erh.isError( e ) ) {\n          var err = e;\n          this.printError( err.clazz );\n          this.parseLineNumber = err.lineNr;\n        }\n        else {\n          this.printError(\"unexpected \" + e );\n        }\n\n        this.runFlag = false;\n      }\n\n      if( ! this.runFlag && ! this.listFlag && !this.waitForMessageFlag) {\n        this.printReady();\n      }\n\n    }\n\n    this.executeLineFlag = false;\n\n    if( this.debugFlag ) {\n      console.log(\"program:\",this.program);\n      console.log(\"Line: \", l );\n\n      console.log(\"handleLineInput: end debug -------------\");\n    }\n  }\n\n}\n\n//--EOC \n\n// ## extendedcommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/extendedcommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/extendedcommands.js\n\nclass ExtendedCommands {\n\n  constructor( basicCmds, runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.audio = runtime.audio;\n    this.html = runtime.html;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n    this.basicCmds = basicCmds;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( ExtendedCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n\n  getAllCategories() {\n    var categoryIndexes = this.basicCmds.getCategories();\n    var categoryIndexes2 = this.getCategories( categoryIndexes );\n\n    return new CommandHelp().getCategoriesNormalize( categoryIndexes2 );\n  }\n\n  getCategories( categoryIndexes ) {\n\n    return new CommandHelp().getCategoriesIntermediate( categoryIndexes, this );\n\n  }\n\n\n\n  /************************ commands ************************/\n\n\n  _stat_info_help() { return \"general:Show help on commands:[<Help Category Index>]\"; }\n\n  _stat_help( pars ) {\n\n  this.output.writeln(\"\");\n  var catRecord = this.getAllCategories();\n  var lst = catRecord[0];\n  var catLists = catRecord[1];\n  var hlpctx = 1000;\n\n  if( pars.length == 1 ) {\n    hlpctx = pars[0].value;\n  }\n\n  if( hlpctx == 1000 ) {\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help Categories:\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      this.output.writeln( i + \" \" + lst[i].toUpperCase() );\n    }\n  }\n  else {\n\n    var lbl = lst[ hlpctx ];\n    lst = catLists[ lbl ];\n    if(lst === undefined ) {\n      this.erh.throwError( \"invalid help index\" );\n    }\n    this.output.writeln(\"------------------------------\");\n    this.output.writeln(\" Help on Category: \\\"\" + lbl.toUpperCase() + \"\\\"\");\n    this.output.writeln(\"------------------------------\");\n    for( var i=0; i<lst.length; i++) {\n      //this.context.printLine( ((hlpctx * 100) + i) + \" \" + lst[i] );\n      var attr = lst[i].attribs;\n      var padLen = 11-lst[i].name.length;\n      var pad = \"               \".substr(0,padLen );\n\n\n      if( attr.description ) {\n          this.output.writeln( \" \" + lst[i].name  + pad + \" ; \" + attr.description );\n      }\n      else {\n          this.output.writeln( \" \" + lst[i].name  );\n      }\n      if( attr.input ) {\n        var lines = attr.input.split(\"\\n\");\n\n        this.output.writeln( \"               input : \" + lines[0] );\n        for( var l=1; l<lines.length; l++) {\n            var line = lines[ l ];\n\n            this.output.writeln( \"                       \" + line );\n          }\n          this.output.writeln( \"\" );\n        }\n\n        if( attr.output ) {\n          var lines = attr.output.split(\"\\n\");\n\n          this.output.writeln( \"               output : \" + lines[0] );\n          for( var l=1; l<lines.length; l++) {\n              var line = lines[ l ];\n\n              this.output.writeln( \"                       \" + line );\n            }\n            this.output.writeln( \"\" );\n        }\n      }\n    }\n  this.output.writeln(\"\");\n\n  }\n\n  _if_cls() {\n    var EXPR = 0, PAR = 1, RAW=2;\n    return [RAW];\n  }\n\n  _stat_info_cls() { return \"general:Clears the screen:[<ResetScreenFlag>]\"; }\n\n  _stat_cls( pars ) {\n    var reset = false;\n\n    if( pars.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length > 1 ) {\n      throw \"parameters\";\n    }\n    if( pars.length == 1 && pars[0].parts.length == 1 ) {\n      if( pars[0].parts[0].data.toUpperCase() == \"RESET\" ) {\n          reset = true;\n      }\n      else {\n        throw \"parameters\";\n      }\n    }\n\n    if( reset ) {\n      this.output.control( 12 );\n    }\n    else {\n      this.output.control( 24 );\n    }\n  }\n\n  _stat_info_reset() { return \"general:Resets the audio and the terminal:[ <Mode> (0=screen, 1=audio, 2=all) ]\"; }\n  _stat_reset( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.reset();\n      this.audio.reset();\n      this.runtime.resetTraceVar();\n      return;\n    }\n\n    var mode = pars[0].value;\n\n    if( mode != 0 && mode != 1 && mode != 2 ) {\n      this.erh.throwError( \"mode\", \"only 0, 1, 2 supported\" );\n      return\n    }\n\n    if( mode == 0) {\n      this.output.reset();\n    }\n    if( mode == 1) {\n      this.audio.reset();\n    }\n    else  {\n      this.output.reset();\n      this.audio.reset();\n    }\n\n  }\n\n\n  _stat_info_menu() { return \"general:Enable the programmers menu\"; }\n  _stat_menu( pars ) {\n\n    if( pars.length == 0 ) {\n      this.runtime.toggleMenu();\n      return;\n    }\n\n  }\n\n  _stat_info_reverse() { return \"print:Reverse the print output:<ReverseFlag>\"; }\n\n  _stat_reverse( pars ) {\n\n    if( pars.length == 0 ) {\n      this.output.control( 65 );\n      return;\n    }\n\n    var reverse = pars[0].value;\n    if( reverse <0 || reverse >1 ) {\n      return;\n    }\n\n    this.output.control( 64 + reverse );\n  }\n\n  _stat_info_beep() { return \"sound:Make a short sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_beep( pars ) {\n\n\n    if( pars.length == 0 ) {\n      this.audio.playBeep( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playBeep( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n\n  _stat_info_sound() { return \"sound:Make a pre defined sound:<Channel>,<Frequency>,<Length>\"; }\n  _stat_sound( pars ) {\n\n    if( pars.length == 0 ) {\n      this.audio.playSound( 0, 440, 100 );\n\n      return\n    }\n\n    if( pars.length != 3) {\n      this.erh.throwError( \"parameter count\", \"expected channel, freq, time\" );\n      return\n    }\n\n    this.audio.playSound( pars[0].value, pars[1].value, pars[2].value );\n\n  }\n\n\n  _stat_info_setadr() { return \"sound:Define Attach,Decay and Release:<Channel>, <AttackT>, <decayT>, <releaseT>\"; }\n  _stat_setadr( pars ) {\n\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, attackT, decayT, releaseT\" );\n      return\n    }\n\n    this.audio.attackDecayRelease(\n       pars[0].value,\n       pars[1].value,\n       pars[2].value,\n       pars[3].value\n      );\n\n  }\n\n  _stat_info_volume() { return \"sound:Change the audio volume:<Volume>\"; }\n  _stat_volume( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected volume\" );\n      return\n    }\n\n    this.audio.volume( pars[0].value );\n\n  }\n\n  _stat_info_chfreq() { return \"sound:Change the channel audio frequency:<Channel, Frequency>\"; }\n  _stat_chfreq( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, frequency\" );\n      return\n    }\n\n    this.audio.channelFrequency( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chvolume() { return \"sound:Change the channel audio volume:<Channel>, <Volume>\"; }\n  _stat_chvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_chsvolume() { return \"sound:Change the channel sustain volume:<Channel>, <Volume>\"; }\n  _stat_chsvolume( pars ) {\n\n    if( pars.length != 2) {\n      this.erh.throwError( \"parameter count\", \"expected channel, volume\" );\n      return\n    }\n\n    this.audio.channelSustainVolume( pars[0].value, pars[1].value );\n\n  }\n\n  _stat_info_addfx() { return \"sound:Add a Sound FX part to the channel:<Channel>, <Type>, <Value>, <Time>\"; }\n  _stat_addfx( pars ) {\n\n    if( pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected channel, type, value and time(ms)\" );\n      return\n    }\n\n    this.audio.addEffect(\n        pars[0].value,\n        pars[1].value,\n        pars[2].value,\n        pars[3].value\n       );\n\n  }\n\n  _stat_info_clearfx() { return \"sound:Clear a sound effect:<Channel>\"; }\n  _stat_clearfx( pars ) {\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected channel\" );\n      return\n    }\n\n    this.audio.clearEffect( pars[0].value  );\n\n  }\n\n  _stat_info_playfx() { return \"sound:Change the channel sustain volume:<Channel> [,<Frequency> ]\"; }\n  _stat_playfx( pars ) {\n\n    if( pars.length < 1 || pars.length >2 ) {\n      this.erh.throwError( \"parameter count\", \"expected <Channel> [,<Frequency> ]\" );\n      return\n    }\n\n    var freq = 0;\n    if( pars.length >1 ) {\n      freq = pars[1].value;\n    }\n\n    this.audio.playEffect( pars[0].value, freq );\n\n  }\n\n\n  _stat_info_textarea() { return \"print:Limit text to certain area: <CollSize>,<RowSize>\\n [,<xOffset>,<yOffset>]\"; }\n  _stat_textarea( pars ) {\n\n    var result;\n\n    if( pars.length != 2 && pars.length != 4) {\n      this.erh.throwError( \"parameter count\", \"expected cols, rows [, xoffset, yoffset ]\" );\n      return\n    }\n\n    var cols = Math.round( pars[0].value );\n    var rows = Math.round( pars[1].value );\n\n    var wh = this.output.getDimensions();\n\n    var xo, yo;\n    xo = -1, yo = -1;\n    if( pars.length == 4) {\n      var xo = Math.round( pars[2].value );\n      var yo = Math.round( pars[3].value );\n    }\n\n    if( cols > 0 && rows > 0  && cols <= wh[0] && rows <= wh[1] ) {\n\n        var divx = wh[0] - cols;\n        var divy = wh[1] - rows;\n\n        if( xo > 0 && xo > divx ) {\n          this.erh.throwError( \"parameter\", \"xo to big\");\n        }\n        if( yo > 0 && yo > divy ) {\n          this.erh.throwError( \"parameter\", \"yo to big\");\n        }\n\n        this.output.textArea(  cols, rows, xo, yo );\n\n        return\n    }\n\n  }\n\n  _stat_info_gcolor() { return \"graphics:Set graphics pen color index:<Color Index>\"; }\n  _stat_gcolor( pars ) {\n\n    var result;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameter count\", \"expected color\" );\n      return\n    }\n\n    if( pars.length == 1) {\n        var col = Math.round( pars[0].value );\n        if( col > 0 && col < 16) {\n            this.bitmap.setLineColor(  col );\n        }\n        return\n    }\n\n  }\n\n\n\n  _stat_info_origin() { return \"graphics:Specify origin of graphics console:<X0>,<Y0>,<Dx>,<Dy>\"; }\n  _stat_origin( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 4 (x0,y0,dx,dy), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    if( pars[2].value != 1 && pars[2].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dx must be 1 or -1\" );\n      return;\n    }\n\n    if( pars[3].value != 1 && pars[3].value != -1 ) {\n      this.erh.throwError( \"parameter\", \"dy must be 1 or -1\" );\n      return;\n    }\n\n    this.bitmap.origin(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_line() { return \"graphics:Draw a line:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_line( pars ) {\n    if( pars.length != 4 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 (x0,y0,y1,y1), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.line(\n      pars[0].value,\n      pars[1].value,\n      pars[2].value,\n      pars[3].value\n\n    );\n  }\n\n  _stat_info_plot() { return \"graphics:Plot a pixel:<X0>,<Y0>,<X1>,<Y1>\"; }\n  _stat_plot( pars ) {\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameter count\", \"expected 2 (x,y), not \" + pars.length );\n      return;\n    }\n\n    if( !this.bitmap.isActive() ) {\n      this.erh.throwError( \"invalid display mode\", \"current mode cannot show graphics\" );\n      return;\n    }\n\n    this.bitmap.plot( pars[0].value, pars[1].value );\n  }\n\n  _stat_info_center() { return \"print:Print horizontal center:<StringToPrint>\"; }\n  _stat_center( pars ) {\n\n    var string;\n\n    if( pars.length > 1 ) {\n      this.erh.throwError( \"too many parameters\", \"expected max 2, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    string = pars[0].value;\n\n    this.output.center( string );\n  }\n\n\n  _stat_info_gtext() { return \"experimental:Write text at position x,y:<X>,<Y>,<Text>\"; }\n  _stat_gtext( pars ) {\n\n    var string;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected x,y and text parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.gtext( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n\n  _stat_info_immediate() { return \"poke:Set flag to flush the render pipeline after each poke:<RenderImmediateFlag>\"; }\n  _stat_immediate( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 1) {\n      this.erh.throwError( \"parameters\", \"expected 1 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.setPokeFlush( pars[0].value != 0 );\n  }\n\n\n  _stat_info_pokeccl() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>,<FGColor>,<BGColor>\"; }\n  _stat_pokeccl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length < 3 ) {\n      this.erh.throwError( \"parameters\", \"expected at least 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    var fg = undefined;\n    var bg = undefined;\n\n    if( pars.length >= 4 ) { fg = pars[3].value; }\n    if( pars.length >= 5 ) { bg = pars[4].value; }\n    this.output.pokeccl( pars[0].value, pars[1].value, pars[2].value, fg, bg );\n  }\n\n  _stat_info_pokec() { return \"poke:Put a character directly into the screen buffer:<Y>,<X>,<Code>\"; }\n  _stat_pokec( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokec( pars[0].value, pars[1].value, pars[2].value );\n  }\n\n  _stat_info_pokecl() { return \"poke:Put color directly into the screen buffer:<X>,<Y>,<FGColor>[,<BGColor>]\"; }\n  _stat_pokecl( pars ) {\n\n    var row = -1, col = -1;\n    var bg = undefined;\n\n    if( pars.length != 3 &&  pars.length != 4 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 or 4 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 4 ) {\n      bg = pars[3].value;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, pars[2].value, bg );\n  }\n\n  _stat_info_pokebcl() { return \"poke:Put background color directly into the screen buffer:<Y>,<X>,<BGColor>\"; }\n  _stat_pokebcl( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"expected 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    this.output.pokecl( pars[0].value, pars[1].value, undefined, pars[2].value );\n  }\n\n  _stat_info_locate() { return \"print:Set the cursor position:<Y>,<X>\"; }\n  _stat_locate( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length > 2 ) {\n      this.erh.throwError( \"too many parameters\", \"expected max 2, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    if( pars.length >= 1 ) {\n      row = pars[0].value;\n    }\n\n    if( pars.length >= 2 ) {\n      col = pars[1].value;\n    }\n\n    this.output.setCursorPos( col, row );\n  }\n\n  _stat_info_hide() { return \"general:Hide the terminal\"; }\n  _stat_hide( pars ) {\n    this.output.control( 25 );\n  }\n\n\n  _if_html() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_html() { return \"html:Unsupported command\"; }\n  _stat_html( pars ) {\n    var html = this.html;\n\n    if( pars.length == 0 ) {\n      return;\n    }\n\n    var newLine = true;\n    var value;\n    var contentIx = 0;\n    var handleIx = -1;\n    var htmlHandle = null;\n    var htmlValue = \"\";\n    var htmlAppend = false;\n\n    if( pars.length == 2) {\n      contentIx = 1;\n      handleIx = 0;\n    }\n\n    for( var i=0; i<pars.length && i<2; i++) {\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \"+\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              htmlAppend = true;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n      value = this.runtime.evalExpression( exparts2 );\n\n      if( i == handleIx ) {\n        htmlHandle =  value;\n      }\n      else {\n        htmlValue = value;\n      }\n    }\n\n    this.html.html(\n        {\n          htmlHandle: htmlHandle,\n          htmlValue: htmlValue,\n          htmlAppend: htmlAppend\n        }\n      );\n  }\n\n  _stat_info_htmlnode() { return \"html:Unsupported command\"; }\n  _stat_htmlnode( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var node = pars[0];\n\n    this.html.htmlnode( node );\n\n  }\n\n\n  _stat_info_htmlbg() { return \"html:Unsupported command\"; }\n  _stat_htmlbg( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    var url = pars[0].value;\n\n    this.html.executeFunction( \"body.style.backgroundImage\", url );\n\n  }\n\n  _stat_info_color() { return \"print:Sets the console color index:<PenColor>[, <PaperColor>\\n[, <BorderColor>]]\"; }\n  _stat_color( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length == 1) {\n        var col = pars[0].value;\n        this.output.control( 16, col );\n        return\n    }\n\n    var bgcol = pars[1].value;\n    var col = pars[0].value;\n    this.output.control( 16, col   );\n    this.output.control( 17, bgcol );\n\n    if( pars.length == 3) {\n        var border = pars[2].value;\n        this.output.control( 18, border );\n        return\n    }\n\n  }\n\n  _stat_info_display() { return \"general:Set the console display mode:<DisplayModeNumber>\"; }\n  _stat_display( pars ) {\n\n    var result;\n    var modes = this.sys.screenModes;\n\n    if( pars.length == 0) {\n\n        var list = [ ];\n\n\n        for( var i=0 ; i<modes.length ; i++) {\n          if( modes[ i] ) {\n            list.push( i + \":   \" + modes[i]);\n          }\n        }\n        //list.push( \"Current Mode: \" + this.sys.displayMode );\n\n        this.runtime.enterListMode( list );\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many variables\", \"expected one parameter only\" );\n    }\n\n    var mode = pars[0].value;\n    if( modes[mode] === undefined ) {\n      this.erh.throwError( \"Invalid mode\", \"No such display mode\" );\n    }\n    this.sys.setDisplayMode( this.runtime, mode );\n    this.sys.blinkMode( !this.runtime.isRunning() );\n    this.runtime.flagStatusChange();\n    this.runtime.startWaitForMessage( \"displaysize\" )\n\n\n  }\n\n  _stat_info_border() { return \"general:Changes the border color:<ColorIndex>\"; }\n  _stat_border( pars ) {\n\n    var result;\n\n    if( pars.length == 0) {\n        return\n    }\n\n    if( pars.length > 1) {\n        this.erh.throwError( \"too many parameters\", \"expected one parameter only\" );\n    }\n\n    var bcol = pars[0].value;\n    this.output.control( 18, bcol );\n\n  }\n\n  _stat_info_export() { return \"program:Export program for download\"; }\n  _stat_export( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"export needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"disk\" );\n  }\n\n  _stat_info_copy() { return \"program:Copy program to clipboard\"; }\n  _stat_copy( pars ) {\n    if( pars.length > 0) {\n        this.erh.throwError( \"too many parameters\", \"copy needs no parameters\" );\n    }\n\n    var code = this.runtime.getProgramAsText();\n    this.sys.export( code, \"clipboard\" );\n    this.runtime.printLine(\"Copied \" + this.runtime.getProgramSize() + \" program lines to the clipboard\" );\n  }\n\n\n  _stat_info_txtcopy() { return \"experimental:Copy data to clipboard:<StringData$>\"; }\n  _stat_txtcopy( pars ) {\n    if( pars.length != 1) {\n        this.erh.throwError( \"parameter count\", \"dcopy needs 1 parameter\" );\n    }\n\n    this.sys.export( pars[0].value + \"\", \"clipboard\" );\n\n  }\n\n\n\n  _fun_info_peekcl() { return \"poke:Get color information directly from from screen buffer:<Y>,<X>[,<Mode]\"; }\n  _fun_peekcl( pars ) {\n\n    var row = -1, col = -1;\n    var mode = 0;\n\n    if( pars.length != 3  && pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 or 3 parameters, not \" + pars.length );\n      return;\n    }\n\n    if( pars.length == 3 ) {\n      mode = pars[2].value;\n    }\n    return this.output.peekcl( pars[0].value, pars[1].value, mode );\n  }\n\n\n  _fun_info_peekc() { return \"poke:Get a character directly into from screen buffer:<Y>,<X>\"; }\n  _fun_peekc( pars ) {\n\n    var row = -1, col = -1;\n\n    if( pars.length != 2 ) {\n      this.erh.throwError( \"parameters\", \"expected 2 parameters, not \" + pars.length );\n      return;\n    }\n\n    return this.output.peekc( pars[0].value, pars[1].value );\n  }\n\n\n  _fun_info_ucbase() { return \"string:Return unicode-set base character code:<SetName$>\"; }\n  _fun_ucbase( pars ) {\n\n    if( pars.length != 1 ) {\n      this.erh.throwError( \"parameters\", \"UCBASE() needs one parameter\" );\n    }\n\n    var baseLabel = pars[0].value;\n\n    if( baseLabel.toLowerCase() == \"box\" ) {\n      return parseInt( \"2500\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"blocks\" ) {\n      return parseInt( \"2580\", 16 );\n    }\n    else if( baseLabel.toLowerCase() == \"symbol\" ) {\n      return parseInt( \"2b00\", 16 ); //can be too wide\n    }\n    else if( baseLabel.toLowerCase() == \"legacy\" ) {\n      return parseInt( \"1fb00\", 16 );\n    }\n    return 0;\n  }\n\n  _fun_info_uc_DLR_() { return \"string:Create unicode character:<UnicodeHexCode$>\"; }\n  _fun_uc_DLR_( pars ) {\n\n    if( pars[0].value ) {\n      if( typeof pars[0].value == \"string\" ) {\n          return String.fromCodePoint( parseInt( pars[0].value, 16 ) );\n      }\n      return String.fromCodePoint( pars[0].value);\n    }\n    return \"?\";\n  }\n\n  _fun_info_dc_DLR_() { return \"print:Return device control char. sequence:<Parameter1>, <Parameter2>\"; }\n  _fun_dc_DLR_( pars ) {\n\n    var val = \"\";\n\n    val = String.fromCodePoint( 17 ) + String.fromCodePoint( pars[0].value) + String.fromCodePoint( pars[1].value);\n\n    return val;\n  }\n\n  _fun_info_html_DLR_() { return \"html:Unsupported function\"; }\n  _fun_html_DLR_( pars ) {\n    return\n      this.html.get();\n  }\n\n\n  _fun_info_width() { return \"general:Return the console width in pixels\"; }\n  _fun_width( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_height() { return \"general:Return the console height in pixels\"; }\n  _fun_height( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"width() has no parameters\" );\n    }\n\n    var wh = this.bitmap.getDimensions();\n    return wh[1];\n  }\n\n  _fun_info_cols()  { return \"print:Return the console width in columns\"; }\n  _fun_cols( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"cols() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_columns() { return \"print:Return the console width in columns\"; }\n  _fun_columns( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"columns() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[0];\n  }\n\n  _fun_info_rows() { return \"print:Return the console height in rows\"; }\n  _fun_rows( pars ) {\n\n    if( pars.length != 0 ) {\n        this.erh.throwError( \"too many parameters\", \"rows() has no parameters\" );\n    }\n\n    var wh = this.output.getDimensions();\n    return wh[1];\n  }\n\n}\n\n//--EOC \n\n// ## pgmmanager.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/pgmmanager.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/pgmmanager.js\n\nclass BasicProgramManager {\n\n  constructor() {\n    this.rt = [];\n  }\n\n  addRuntime = function( ctx ) {\n\n    this.rt.push( ctx );\n\n  }\n\n}\n\nvar pgmman = new BasicProgramManager();\n\n//--EOC \n\n// ## basiccommands.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basiccommands.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basiccommands.js\n\nclass BasicCommands {\n\n  constructor( runtime ) {\n    this.output = runtime.output;\n    this.bitmap = runtime.bitmap;\n    this.input = runtime.input;\n    this.runtime = runtime;\n    this.sys = runtime.sys;\n    this.cmds = {};\n    this.func = {};\n    this.statementList = null;\n    this.erh = new ErrorHandler();\n\n    this.keyLabelCodes = {};\n\n    this.randnrs = [];\n    for(var i=0; i<10000;i++) {\n      this.randnrs.push( Math.random() );\n    }\n    this.randIndex = 0;\n    this.randStep = 1;\n\n  }\n\n  getStatements( raw ) {\n\n    //TODO, why is it called so often?\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_stat_\")) {\n        if( stats[i].startsWith(\"_stat_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(6 ).toUpperCase();\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getFunctions( raw ) {\n    var stats = Object.getOwnPropertyNames( BasicCommands.prototype );\n\n    var stats2 = [];\n\n    for( var i=0;i<stats.length;i++) {\n      if( stats[i].startsWith(\"_fun_\")) {\n        if( stats[i].startsWith(\"_fun_info_\")) { continue; }\n\n        var name = stats[i];\n\n        if( ! raw ) {\n            name = name.substr(5 ).toUpperCase().replace(\"_DLR_\",\"$\");\n        }\n\n        stats2.push( name );\n      }\n    }\n\n    return stats2;\n  }\n\n  getCategories() {\n\n    return new CommandHelp().getCategoriesIntermediate( [{},{}], this );\n\n  }\n\n\n  /************************ commands ************************/\n\n  _stat_info_new() { return \"program:Delete the current program from memory:\"; }\n  _stat_new( pars ) {\n\n    this.runtime.new();\n  }\n\n  _stat_info_list() { return \"program:List the basic program\"; }\n  _stat_list( pars ) {\n\n    var start = 0;\n    var end   = 999999;\n    var parts = [];\n\n    var mode = \"noparam\";\n\n    if( pars.length==1 ) {\n      parts = pars[0].parts;\n    }\n\n    if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data >=0 ) {\n      start = parts[0].data;\n      end = parts[0].data;\n    }\n    else if( parts.length == 1 && parts[0].type == \"num\" && parts[0].data <0 ) {\n      /*NOTE, this will stop working if RAW changes to return uniop + posnum */\n      end = -parts[0].data;\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"num\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n      end = parts[1].data;\n\n    }\n    else if( parts.length == 2\n        && parts[0].type == \"num\"\n        && parts[1].type == \"uniop\"\n        && parts[1].op == \"-\"\n          ) {\n      start = parts[0].data;\n    }\n\n    var runtime = this.runtime;\n    var list = [];\n    for (const l of runtime.program)\n      {\n\n        var lineNr = parseInt(l[0]);\n        if(  l[0] == null || (lineNr>= start && lineNr<= end) ) {\n          if( l[1][0].type == \"control\" && l[1][0].controlKW == \"sub\" ) {\n              list.push( \"\" );\n          }\n          list.push( l[2] );\n        }\n      }\n\n      this.runtime.enterListMode( list );\n  }\n\n\n  _if_get() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_getkey() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_read() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [PAR];\n  }\n\n  _if_input() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW, RAW];\n  }\n\n  _if_list() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _if_run() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  _stat_info_read() { return \"io:Read a value from the data::<Data$ or Data>\"; }\n  _stat_read( pars ) {\n    var p0 = pars[ 0 ];\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var data = this.runtime.readData();\n    if( data === undefined ) { this.erh.throwError( \"out of data\" ); }\n\n    if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"string\" ) {\n          this.runtime.setVar(\n            p0.value,  data  );\n    }\n    else if( p0.varType == \"num\" && (typeof data).toLowerCase() == \"string\" ) {\n\n          data = parseInt ( data );\n\n          if( isNaN( data ) ) {\n            this.erh.throwError( \"expected number\" );\n          }\n          this.runtime.setVar(\n            p0.value, data );\n    }\n    else if( p0.varType == \"str\" && (typeof data).toLowerCase() == \"number\" ) {\n          this.runtime.setVar(\n            p0.value,  \"\" + data  );\n    }\n\n  }\n\n  _stat_info_get() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_get( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\"); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, \"???\" );\n      }\n    }\n  }\n\n  _stat_info_getkey() { return \"io:Retrieve the last key pressed::<Key$>\"; }\n  _stat_getkey( pars ) {\n    var p0 = pars[ 0 ];\n\n    if( p0.type != \"var\" ) {\n      this.erh.throwError( \"not a var\", \"parameter 0\" );\n    }\n\n    var k = this.input.getKey();\n    if( k == null ) { this.runtime.setVar(p0.value, \"\" ); }\n    else {\n      if( k.key != null ) {\n        this.runtime.setVar(p0.value, k.key );\n      }\n      else {\n        this.runtime.setVar(p0.value, k.keyLabel );\n      }\n    }\n  }\n\n  _stat_info_input() { return \"io:Waits for the user to type in a value::<Value>\"; }\n  _stat_input( pars ) {\n\n    var vars = [];\n    var con = this.output;\n\n    for( var i=0; i<pars.length; i++) {\n      if( i == 0 ) {\n        var par = pars[0];\n\n        if( par.parts.length == 2 ) {\n          if( par.parts[0].type == \"str\" ) {\n            con.write( par.parts[0].data );\n            if( par.parts[1].type == \"var\" && par.parts[1].op == \";\" ) {\n              vars.push( par.parts[1].data );\n            }\n          }\n        }\n        else if( par.parts.length == 1 ) {\n          vars.push( par.parts[0].data );\n        }\n\n      }\n      else {\n        sys.log( \"PARS[\"+i+\"]\", pars[i] );\n        if( pars[i].parts[0].type != \"var\" ) {\n\n          this.erh.throwError( \"not a var\", \"parameter \" + i);\n        }\n        vars.push( pars[i].parts[0].data );\n      }\n    }\n\n    this.runtime.startConsoleDataInput( vars );\n\n  }\n\n  _stat_info_restore() { return \"io:Set the READ-pointer, to the beginning:\"; }\n  _stat_restore( pars ) {\n    this.runtime.restoreDataPtr();\n  }\n\n  _stat_info_load() { return \"program:Load a program in memory:<Filename>\"; }\n  _stat_load( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \\\"\" + pars[0].value + \"\\\"\" );\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", false, -1 );\n    }\n    else {\n      if( pars.length == 1) {\n        result = runtime.load( pars[0].value, false, -1 );\n      }\n      else if( pars.length == 2) {\n        result = runtime.load( pars[0].value, false, pars[1].value );\n      }\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_setdata() { return \"experimental:Set data pointer:[<Label>]\"; }\n  _stat_setdata( pars ) {\n\n    var runtime = this.runtime;\n    var label = null;\n\n    if( pars.length > 1  ) {\n      this.erh.throwError( \"parameters\", \"Setdata takes one optional parameter\" );\n    }\n\n    if( pars.length == 1 ) {\n      label = pars[0].value ;\n    }\n\n    var list = runtime.setData( label );\n\n  }\n\n  _stat_info_datablocks() { return \"experimental:Dump data blocks in memory\"; }\n  _stat_datablocks( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n\n    if( pars.length != 0 ) {\n      this.erh.throwError( \"parameters\", \"Listdata takes no parameterss\" );\n    }\n\n    var list = runtime.getDataBlocks();\n    runtime.enterListMode( list );\n\n  }\n\n  _stat_info_loaddata() { return \"experimental:Load data in memory:<Filename> [, <Type>, <Label>]\"; }\n  _stat_loaddata( pars ) {\n\n    var runtime = this.runtime;\n    var result;\n    var label = null;\n    var type = \"I:CSV\";\n    runtime.printLine(\"\");\n\n    if( pars.length != 1 && pars.length != 2 && pars.length != 3 ) {\n      this.erh.throwError( \"parameters\", \"loaddata takes one mandatory and two optional parameters\" );\n    }\n\n    if( pars.length >= 2 ) {\n      type = pars[1].value ;\n    }\n\n    if( type.indexOf(\":\") < 0) {\n      this.erh.throwError( \"invalid type specification\", \"Expected <Type>:<FileSyntax>. Example: \\\"I:CSV\\\"\" );\n    }\n\n    if( pars.length == 3 ) {\n      label = pars[2].value ;\n    }\n\n    result = runtime.loaddata( pars[0].value, type, label );\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_dir() { return \"program:List a files on the current file system:[<Path> [,<Device>]]\"; }\n  _stat_dir( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.dir( \"\" );\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.dir( pars[0].value, -1 );\n      return;\n    }\n    else if( pars.length == 2) {\n      runtime.dir( pars[0].value, pars[1].value );\n      return;\n    }\n\n    this.erh.throwError( \"parameter\", \"dir takes 0,1 or 2 parameter(s)\"  );\n\n    this.aSync = true;\n\n  }\n\n  _stat_info_fs() { return \"program:Set or List (the) filesystem(s):[<FileSystem$>]\"; }\n  _stat_fs( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      runtime.listfs();\n    }\n    else if( pars.length == 1) {\n      runtime.setfs( pars[0].value );\n    }\n\n\n    this.aSync = true;\n\n  }\n\n\n  _stat_info_renumber() { return \"program:Renumber the current program\"; }\n  _stat_renumber( pars ) {\n\n    var runtime = this.runtime;\n    runtime.renumberProgram( 10,10 );\n\n  }\n\n  _stat_info_vars() { return \"program:List all variables to the screen\"; }\n  _stat_vars( pars ) {\n\n\n    var runtime = this.runtime;\n\n    var varList = runtime.getFullVarList();\n    this.runtime.enterListMode( varList );\n\n  }\n\n\n  _stat_info_tracevar() { return \"program:Trace variable changes:[<VariableName$>]\"; }\n  _stat_tracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.getTraceList();\n      this.runtime.enterListMode( traceList );\n\n      return;\n    }\n\n    if( pars.length == 1) {\n      runtime.setTraceVar( pars[0].value );\n      return;\n    }\n\n  }\n\n  _stat_info_clrtracevar() { return \"program:Stop tracing variables\"; }\n  _stat_clrtracevar( pars ) {\n\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n      var traceList = runtime.resetTraceVar();\n    }\n  }\n\n\n  _stat_info_boot() { return \"program:Load and run a program:<FileName>\"; }\n  _stat_boot( pars ) {\n    var runtime = this.runtime;\n    var result;\n\n    runtime.printLine(\"\");\n\n    if( pars.length == 0) {\n      runtime.printLine(\"searching\");\n    }\n    else {\n      runtime.printLine(\"searching for \" + pars[0].value);\n    }\n\n    if( pars.length == 0) {\n        result = runtime.load( \"*\", true, -1 );\n    }\n    else {\n      result = runtime.load( pars[0].value, true, -1 );\n    }\n    this.aSync = true;\n\n  }\n\n  _stat_info_save() { return \"program:Save the current program:<FileName>\"; }\n  _stat_save( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length == 0) {\n        runtime.save( null );\n    }\n    else if ( pars.length == 1 ){\n      runtime.save( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.save( pars[0].value, pars[1].value );\n    }\n  }\n\n  _stat_info_delete() { return \"program:Delete a file:<FileName>\"; }\n  _stat_delete( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length != 1 && pars.length != 2) {\n        this.erh.throwError( \"parameter\", \"delete without filename\" );\n    }\n    else if ( pars.length == 1 ){\n      runtime.deleteFile( pars[0].value, -1 );\n    }\n    else if( pars.length == 2) {\n      runtime.deleteFile( pars[0].value, pars[1].value );\n    }\n  }\n\n\n\n\n  _stat_info_run() { return \"program:Run the current program\"; }\n  _stat_run( pars ) {\n    var runtime = this.runtime;\n\n    runtime.runPGM();\n  }\n\n\n  _if_print() {\n      var EXPR = 0, PAR = 1, RAW=2;\n      return [RAW];\n  }\n\n  isNumber(value) {\n    return typeof value === 'number' && isFinite(value);\n  }\n\n  normalizeIfNumber( x )  {\n    if( this.isNumber( x ) ) {\n      if ( x >= 0 ) {\n        return \" \" + x;\n      }\n    }\n    return \"\" + x;\n  }\n\n  _stat_info_print() { return \"print:Print text or values to the console:<Value>[<Value>;][;]\"; }\n  _stat_print( pars ) {\n\n    var runtime = this.runtime;\n    var con= this.output;\n\n    if( pars.length == 0 ) {\n      con.nl();\n      return;\n    }\n    else if( pars.length == 1 ) {\n      if( pars[0].parts.length == 0 ) {\n        con.nl();\n        return;\n      }\n    }\n\n    var newLine = true;\n    var value;\n    for( var i=0; i<pars.length; i++) {\n\n      newLine = true;\n      if( i<(pars.length-1)) {\n        newLine = false;\n      }\n\n      if( i>0) {\n        con.write( \"         \" );\n      }\n\n      var exparts = pars[i];\n      var exparts2=\n        { parts: [],\n          binaryNegate: exparts.binaryNegate,\n          negate: exparts.negate  };\n\n      for( var j=0; j<exparts.parts.length; j++) {\n        if( exparts.parts[j].type == \"uniop\" &&\n            exparts.parts[j].op == \";\" && j==(exparts.parts.length-1)\n            && (i == pars.length-1)) {\n              //console.log( \"i=\"+i+\" newline: set to false\");\n          newLine = false;\n        }\n        else {\n          exparts2.parts.push( exparts.parts[j] );\n        }\n      }\n\n      value = runtime.evalExpression( exparts2 );\n\n      if( i == 0) {\n        con.write( this.normalizeIfNumber( value ) );\n      }\n      else {\n        con.write( \"\" + value );\n      }\n      if( newLine ) { con.nl(); }\n\n    }\n\n  }\n\n  _stat_info_clr() { return \"program:Clear all variables\"; }\n  _stat_clr( pars ) {\n    return this.runtime.clrPGM();\n  }\n\n  /************************ functions ************************/\n\n  _fun_info_datalen() { return \"experimental:Return length of current datablock\"; }\n  _fun_datalen( pars ) {\n    var runtime = this.runtime;\n    return runtime.getDataLength();\n  }\n\n  _fun_info_chr_DLR_() { return \"string:Return ascii character:<Ascii Code>\"; }\n  _fun_chr_DLR_( pars ) {\n    return String.fromCharCode( pars[0].value );\n  }\n\n  _fun_info_str_DLR_() { return \"string:Converts number to string: <Number>[,<Base>[,<Trim>]]\"; }\n  _fun_str_DLR_( pars ) {\n\n    if( pars.length <1 || pars.length >3  ) {\n      this.erh.throwError( \"parameter\", \"str$() takes 1,2 or 3 parameters\"  );\n    }\n\n    var number = pars[0].value;\n    var base = 10;\n    var trim = false;\n\n    if( pars.length>=2  ) {\n      base = pars[1].value;\n    }\n\n    if( pars.length==3  ) {\n      trim = ( pars[1].value > 0);\n    }\n\n    var numberStr = number.toString(base);\n\n    if( number >=0 && !trim) {\n      return \" \" +  numberStr;\n    }\n\n    return numberStr;\n  }\n\n  _fun_info_abs() { return \"math:Absolute value\"; }\n  _fun_abs( pars ) {\n    if( pars[0].value < 0 ) {\n      return -pars[0].value;\n    }\n    return pars[0].value;\n  }\n\n  _fun_info_len() { return \"string:Length of a string\"; }\n  _fun_len( pars ) {\n    return pars[0].value.length;\n  }\n\n  _fun_info_asc() { return \"string:ASCII value of a character\"; }\n  _fun_asc( pars ) {\n    if( (typeof pars[0].value).toUpperCase() == \"STRING\" ) {\n\n      if ( pars[0].value.length > 0) {\n          return pars[0].value.charCodeAt(0);\n      }\n    }\n    return 0;\n  }\n\n  _fun_info_val() { return \"string:Retrieve number from string\"; }\n  _fun_val( pars ) {\n    var base = 10;\n\n    if( pars.length==2  ) {\n      base = pars[1].value;\n    }\n\n    if(base < 2 || base > 16) {\n      this.erh.throwError( \"base\", \"base should be inbetween 2 and 16\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n  _fun_info_hex2dec() { return \"string:Retrieve number from hexadecimal string\"; }\n  _fun_hex2dec( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX2DEC() needs one parameter\" );\n    }\n\n    var val = parseInt( pars[0].value, base );\n\n    if( isNaN( val ) ) {\n      this.erh.throwError( \"invalid number syntax\", \"Could not parse \" + pars[0].value+ \" with base\" + base  );\n    }\n\n    return val;\n  }\n\n\n  _fun_info_hex_DLR_() { return \"string:Format a number as a hexadecimal string\"; }\n  _fun_hex_DLR_( pars ) {\n    var base = 16;\n\n    if( pars.length != 1  ) {\n      this.erh.throwError( \"parameter\", \"HEX$() needs one parameter\" );\n    }\n\n    var hexString = (pars[0].value * 1).toString(16);\n\n    return hexString;\n }\n\n\n\n\n  _fun_info_exp() { return \"math:Exponent\"; }\n  _fun_exp( pars ) {\n    return Math.exp( pars[0].value );\n  }\n\n  intGetNextRand() {\n    this.randIndex = (this.randIndex + this.randStep) % this.randnrs.length;\n    return this.randnrs[ this.randIndex ];\n  }\n\n  intSeedRand( x0 ) {\n\n    if( x0 < 0) {\n      var x = -x0;\n      var base = Math.floor( x * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n    else {\n\n      const minute = 1000 * 60;\n      const hour = minute * 60;\n      const day = hour * 24;\n      const year = day * 365;\n\n      const d = new Date();\n      let seedModifier = Math.round(d.getTime() / year);\n\n      x = -x;\n      var base = Math.floor( seedModifier * 11 );\n      this.randIndex= base % this.randnrs.length;\n      this.randStep = 1+(base % 7);\n\n      /* Also reseed random buffer */\n      this.randnrs = [];\n      for(var i=0; i<10000;i++) {\n        this.randnrs.push( Math.random() );\n      }\n    }\n\n  }\n\n\n  _fun_info_pad_DLR_() { return \"string:Add string padding:<String>, <padChar>,<Length>[,<PadLeft>]\"; }\n  _fun_pad_DLR_( pars ) {\n\n    if( pars.length < 3 || pars.length >4 ) {\n      this.erh.throwError( \"syntax\", \"pad$() takes 3 or 4 parameters\" );\n    }\n\n    var str = pars[0].value;\n    var ch = pars[1].value;\n    var len = pars[2].value;\n    var left = true;\n\n    if( pars.length == 4 ) {\n      left= pars[3].value;\n\n      if( left !== 0 ) {\n        left = true;\n      }\n      else { left = false; }\n    }\n\n    var dest = \"\";\n\n    var strLen = str.length;\n    var toPad = len-strLen;\n    for( var i = 0; i<toPad ; i++) {\n      dest += ch;\n    }\n\n    if( left ) {\n      dest = dest + str;\n    }\n    else {\n      dest = str + dest;\n    }\n\n    return dest;\n  }\n\n\n  _fun_info_rnd() { return \"math:Random number between 0 and 1:<SeedOrMode> (0=JS, 1=Seed, NoValue=Default)\"; }\n  _fun_rnd( pars ) {\n\n    if( pars.length >1) {\n      this.erh.throwError( \"syntax\", \"rnd takes one parameter\" );\n    }\n\n    if( pars.length == 1) {\n\n      if( pars[0].value == 0 ) {\n        return Math.random();\n      }\n      this.intSeedRand( pars[0].value );\n    }\n\n    return this.intGetNextRand();\n  }\n\n  _fun_info_sqr() { return \"math:Square Root\"; }\n  _fun_sqr( pars ) {\n    return Math.sqrt( pars[0].value);\n  }\n\n  _fun_info_log() { return \"math:Logaritm\"; }\n  _fun_log( pars ) {\n    return Math.log( pars[0].value);\n  }\n\n  _fun_info_pos() { return \"print:Position\"; }\n  _fun_pos( pars ) {\n    return this.runtime.getLinePos();\n  }\n\n  _fun_info_left_DLR_() { return \"string:Left part of the string\"; }\n  _fun_left_DLR_( pars ) {\n      //? LEFT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr(0,pars[1].value);\n  }\n\n  _fun_info_right_DLR_() { return \"string:Right part of the string\"; }\n  _fun_right_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      return s.substr( s.length - pars[1].value );\n  }\n\n  _fun_info_mid_DLR_() { return \"string:A substring\"; }\n  _fun_mid_DLR_( pars ) {\n      //? RIGHT$(A$,8)\n      var s = pars[0].value;\n\n      if( (typeof s) != \"string\") {\n        throw \"@type mismatch\";\n      }\n      if( pars.length == 3) {\n        return s.substr( pars[1].value-1, pars[2].value );\n      }\n      else if( pars.length == 2) {\n        return s.substr( pars[1].value-1 );\n      }\n  }\n\n  _fun_info_sin() { return \"math:Sinus\"; }\n  _fun_sin( pars ) {\n    return Math.sin( pars[0].value);\n  }\n\n  _fun_info_tri() { return \"math+:Triangle\"; }\n  _fun_tri( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    if( v<=0.5 ) {\n        return v*2;\n    }\n    else if( v<=1 ) {\n        return 1-((v-0.5) * 2);\n    }\n  }\n\n  _fun_info_saw() { return \"math+:Saw Tooth\"; }\n  _fun_saw( pars ) {\n    var v = Math.abs( pars[0].value) % 1;\n\n    return v;\n\n  }\n\n  _fun_info_tan() { return \"math:Tangent\"; }\n  _fun_tan( pars ) {\n    return Math.tan( pars[0].value);\n  }\n\n  _fun_info_atn() { return \"math:ATan function\"; }\n  _fun_atn( pars ) {\n    return Math.atan( pars[0].value);\n  }\n\n  _fun_info_cos() { return \"math:Cosinus\"; }\n  _fun_cos( pars ) {\n    return Math.cos( pars[0].value);\n  }\n\n  _fun_info_spc() { return \"string:Spaces for padding:<SizeOfPadding>\"; }\n  _fun_spc( pars ) {\n    var out=\"\";\n    for( var i=0; i<pars[0].value; i++) {\n      out+=\" \";\n    }\n    return out;\n  }\n\n  _max(x,m) {\n    if( x<m ) {  return x; }\n    return m;\n  }\n\n\n\n  _fun_info_int() { return \"math:Convert to Integer\"; }\n  _fun_int( pars ) {\n    return Math.floor( pars[0].value );\n  }\n\n  _fun_info_range() { return \"math+:Keep in range:<V>,<MIN>,<MAX>\"; }\n  _fun_range( pars ) {\n\n    if( pars.length <3) {\n      this.erh.throwError( \"parameter\", \"expected 3 parameters\" );\n    }\n    var v = pars[0].value ;\n    var min = pars[1].value ;\n    var max = pars[2].value ;\n\n    if( v<min ) { return min; }\n    if( v>max ) { return max; }\n    return v;\n  }\n\n\n  _fun_info_tab() { return \"print:Tab cursor Xpos to the right:<NumberOfTabs>\"; }\n  _fun_tab( pars ) {\n    var runtime = this.runtime;\n\n    if( pars.length <1) {\n      this.erh.throwError( \"syntax\", \"missing parameter 0\" );\n    }\n    var p = pars[0].value;\n    if( p<0 || p > 255 ) {\n      this.erh.throwError( \"illegal quantity\", \"value must be in-between 0 and 255\" );\n    }\n\n    for( var i=0; i<pars[0].value ; i++) {\n        this.output.write( \" \" );\n    }\n\n    return \"\";\n  }\n\n  _fun_info_sgn() { return \"math:Sign of number\"; }\n  _fun_sgn( pars ) {\n    var x = pars[0].value;\n\n    if( x<0 ) { return -1; }\n    else if( x>0 ) { return 1; }\n    return 0;\n  }\n\n  _fun_info_millis() { return \"time:Current time in milliseconds\"; }\n  _fun_millis( pars ) {\n    return this.runtime.getMillis( );\n  }\n\n  _fun_info_jiffies() { return \"time:Current time in 'jiffies'\"; }\n  _fun_jiffies( pars ) {\n    return this.runtime.getJiffyTime( );\n  }\n}\n\n//--EOC \n\n// ## basicparser.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basicparser.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basicparser.js\n\nclass Parser {\n\n  constructor( cmds, ecmds ) {\n    this.commands = cmds;\n    this.extendedcommands = ecmds;\n    this.erh = new ErrorHandler();\n    this.debugFlag = false;\n  }\n\n  init() {\n\n\t  this.CTRL_KW = [\"IF\",\"THEN\",\"GOTO\",\"AND\", \"NOT\", \"OR\",  \"GOSUB\", \"RETURN\", \"FOR\", \"TO\", \"NEXT\", \"STEP\", \"DATA\", \"REM\", \"GOSUB\", \"DIM\", \"END\", \"LET\", \"STOP\", \"DEF\", \"FN\", \"ON\", \"SUB\", \"INTERRUPT0\", \"INTERRUPT1\" ];\n    this.SHORTCUT_KW = [\"?\"];\n\n    this.KEYWORDS = this.commands.getStatements();\n\n    var more = this.extendedcommands.getStatements();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.commands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n    more = this.extendedcommands.getFunctions();\n    for( var i=0; i<more.length; i++) {\n      this.KEYWORDS.push( more[ i ] );\n    }\n\n     for( var i=0; i<this.CTRL_KW.length; i++) {\n       this.KEYWORDS.push( this.CTRL_KW[ i ] );\n     }\n\n     for( var i=0; i<this.SHORTCUT_KW.length; i++) {\n       this.KEYWORDS.push( this.SHORTCUT_KW[ i ] );\n     }\n     //this.padArray( this.KWCODES, 256 );\n\n     if( this.debugFlag ) { console.log(\"KEYWORDS:\" , this.KEYWORDS ); }\n\n     this.screenCodes2CTRLTable = [];\n     var tab = this.screenCodes2CTRLTable;\n\n     tab['\\x93'] = '\\x13';\n     tab['\\xd3'] = '\\x93';\n  }\n\n  getKeyWordCodes() {\n\n    this.throwError( null, \"(Extended) Keywords not yet supported\", \"extended disabled\" );\n    return this.KWCODES;\n  }\n\n  padArray( arr, nr ) {\n    var missing = nr - arr.length;\n    while( missing > 0) {\n      arr.push( null );\n      missing--;\n    }\n  }\n\n  throwError( ctx, detail, clazz ) {\n\n    var clazz2 = clazz;\n    if( clazz2 === undefined ) {\n      clazz2 = \"syntax\";\n    }\n\n    if( ctx ) {\n      console.log(\" Exception \" + clazz + \" at line \" + ctx.lineNumber+ \" \" + detail );\n    }\n\n    if( ctx ) {\n      if( ! ( ctx.lineNumber == undefined ) ) {\n        this.erh.throwError( clazz2, detail, ctx, ctx.lineNumber );\n      }\n    }\n\n    this.erh.throwError( clazz2, detail, undefined, -1 );\n\n  }\n\n  upperCaseNameTokens( tokens ) {\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type == \"name\" ) {\n\t\t\t\t\ttoken.data = token.data.toUpperCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens;\n\t}\n\n\tremovePadding( tokens ) {\n\t\tvar tokens2 = [];\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( token ) {\n\t\t\t\tif( token.type != \"pad\" ) {\n\t\t\t\t\ttokens2.push( token );\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn tokens2;\n\t}\n\n  mergeCompTokens( tokens ) {\n\t\tvar tokens2 = [];\n\n    /* Convert token sequences like (\"<\",\"=\")\n       into single token \"<=\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n\t\t\tvar token = tokens[i];\n\n\t\t\tif( i>0 ) {\n        var token2 = tokens[i-1];\n\t\t\t\tif( ( token.type == \"comp\" || token.type == \"eq\" ) &&\n            ( token2.type == \"comp\" || token2.type == \"eq\" ) ) {\n\t\t\t\t\ttoken2.type = \"@@removeme\";\n          token.data = token2.data + token.data;\n          token.type = \"comp\";\n          if( token.data == \"><\" ) {\n            token.data = \"<>\";\n          }\n          else if( token.data == \"=<\" ) {\n            token.data = \"<=\";\n          }\n          else if( token.data == \"=>\" ) {\n            token.data = \">=\";\n          }\n\n  \t\t\t}\n\t\t\t}\n\n      if( ( token.type == \"name\"  && token.data == \"OR\" ) ||\n        ( token.type == \"name\"  && token.data == \"AND\" ) ||\n        ( token.type == \"name\"  && token.data == \"NOT\" )) {\n          token.type = \"bop\";\n        }\n\n\t\t}\n\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens[i].type!=\"@@removeme\") {\n        tokens2.push( tokens[i] );\n      }\n    }\n\n\t\treturn tokens2;\n\t}\n\n\n\n  mergeBrokenUpTokens( tokens ) {\n\n    var splits = [];\n\n    //console.log(\"tokens\",tokens)\n    //standard\n    splits.push( { p1: \"REST\", p2: \"OR\", p3: \"E\", whole: \"RESTORE\" } );\n    splits.push( { p1: \"S\", p2: \"TO\", p3: \"P\", whole: \"STOP\" } );\n\n\n    //extended\n//    splits.push( { p1: \"Dsk\", p2: \"OR\", p3: \"T\", whole: \"DXPORT\" } );\n//    splits.push( { p1: \"LXP\", p2: \"OR\", p3: \"T\", whole: \"LXPORT\" } );\n    splits.push( { p1: \"IMP\", p2: \"OR\", p3: \"T\", whole: \"IMPORT\" } );\n    splits.push( { p1: \"EXP\", p2: \"OR\", p3: \"T\", whole: \"EXPORT\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"URL\", whole: \"LGETURL\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"NAME\", whole: \"LGETNAME\" } );\n    splits.push( { p1: \"L\", p2: \"GET\", p3: \"ID\", whole: \"LGETID\" } );\n    splits.push( { p1: \"GO\", p2: \"TO\", p3: null, whole: \"GOTO\" } );\n    splits.push( { p1: \"GO\", p2: \"SUB\", p3: null, whole: \"GOSUB\" } );\n\n    splits.push( { p1: \"GO\", p2: \"LINK\", p3: null, whole: \"GOLINK\" } );\n    splits.push( { p1: \"WINDOW\", p2: \"S\", p3: null, whole: \"WINDOWS\" } );\n    splits.push( { p1: \"UN\", p2: \"TAG\", p3: null, whole: \"UNTAG\" } );\n    splits.push( { p1: \"LINK\", p2: \"S\", p3: null, whole: \"LINKS\" } );\n    splits.push( { p1: \"DE\", p2: \"LET\", p3: \"E\", whole: \"DELETE\" } );\n    splits.push( { p1: \"LDE\", p2: \"LET\", p3: \"E\", whole: \"LDELETE\" } );\n    splits.push( { p1: \"TDE\", p2: \"LET\", p3: \"E\", whole: \"TDELETE\" } );\n    splits.push( { p1: \"B\", p2: \"OR\", p3: \"DER\", whole: \"BORDER\" } );\n    splits.push( { p1: \"G\", p2: \"COLOR\", p3: \"S\", whole: \"GCOLORS\" } );\n    splits.push( { p1: \"CHAR\", p2: \"COL\", p3: null, whole: \"CHARCOL\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"CP\", p3: null, whole: \"SFRAMECP\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPX\", p3: null, whole: \"SFRAMEFLIPX\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FLIPY\", p3: null, whole: \"SFRAMEFLIPY\" } );\n    splits.push( { p1: \"SFRAME\", p2: \"FX\", p3: null, whole: \"SFRAMEFX\" } );\n    splits.push( { p1: \"TAG\", p2: \"S\", p3: null, whole: \"TAGS\" } );\n    splits.push( { p1: \"X\", p2: \"ON\", p3: null, whole: \"XON\" } );\n    splits.push( { p1: \"S\", p2: \"POS\", p3: null, whole: \"SPOS\" } );\n    splits.push( { p1: \"S\", p2: \"POKE\", p3: null, whole: \"SPOKE\" } );\n    splits.push( { p1: \"WJ\", p2: \"IF\", p3: \"FY\", whole: \"WJIFFY\" } );\n    splits.push( { p1: \"REF\", p2: \"OR\", p3: \"MAT\", whole: \"REFORMAT\" } );\n\n\n    var tokens2 = []; //tokens;\n\n    for( var i=0; i<tokens.length; i++) {\n      tokens2.push( tokens[ i ]);\n    }\n\n    for( var i=0; i<splits.length; i++) {\n      var r=splits[i];\n      tokens2 = this.mergeTokenRange( tokens2, r );\n    }\n\n    if( this.debugFlag ) {  console.log( tokens2 ); }\n    return tokens2;\n  }\n\n\n  mergeTokenRange( tokens, record ) {\n\t\tvar tokens2 = [];\n    var tokens3 = [];\n\n    /* Convert \"S\",\"TO\",\"P\" into \"STOP\" */\n\n\t\tfor( \tvar i=0;\n\t\t\t\t\ti<tokens.length;\n\t\t\t\t\ti++)\n\t\t{\n      tokens2[i] = tokens[i];\n\t\t}\n\n    for( \tvar i=1;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( record.p3 == null ) {\n        if(\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n             if(\n                tokens2[i-1].data == record.p1 &&\n                tokens2[i-0].data == record.p2 ) {\n                  tokens2[i-1].data = record.whole;\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n      else {\n        if(i<2) {\n          continue;\n        }\n        if(\n          ( tokens2[i-2].type == \"name\" || tokens2[i-2].type == \"bop\" ) &&\n           ( tokens2[i-1].type == \"name\" || tokens2[i-1].type == \"bop\" ) &&\n           ( tokens2[i-0].type == \"name\" || tokens2[i-0].type == \"bop\" ) ) {\n\n             if( tokens2[i-2].data == record.p1 &&\n                tokens2[i-1].data == record.p2 &&\n                tokens2[i-0].data == record.p3 ) {\n                  tokens2[i-2].data = record.whole;\n                  tokens2[i-1].type = \"removeme\";\n                  tokens2[i-0].type = \"removeme\";\n                }\n           }\n      }\n\t\t}\n\n    var j=0;\n    for( \tvar i=0;\n\t\t\t\t\ti<tokens2.length;\n\t\t\t\t\ti++)\n\t\t{\n      if( tokens2[i].type != \"removeme\" ) {\n          tokens3[j] = tokens2[i];\n          j++;\n      }\n\t\t}\n\n\t\treturn tokens3;\n\t}\n\n\tparseFunParList( context ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar params = [];\n\t\tvar even = true;\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"sep\", data: \"@@@all\" });\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tendTokens.push();\n\n\t\twhile( true ) {\n\n\t\t\tvar token;\n\n      if( tokens.length > 0) {\n        if( tokens[0].type==\"bracket\" && tokens[0].data==\")\") {\n          break;\n        }\n      }\n\n\t\t\tif( even ) {\n        var expr = this.parseBoolExpression( context, endTokens );\n        expr.type = \"expr\";\n\t\t\t\tparams.push( expr );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoken = tokens.shift();\n\n\t\t\t\tif( token.type==\"sep\" ) {\n\t\t\t\t\t//all ok, next par\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected ',' or ')', got '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tpeekIfNextIsOpenBracket( context ) {\n\n\t\tvar tokens = context.tokens;\n\n\t\tif( tokens.length > 0 ) {\n\t\t\tif( tokens[0].type == \"bracket\" && tokens[0].data == \"(\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tparseSubExpression( context ) {\n\n\t\tvar token = context.tokens.shift();\n\n\t\tif( !(token.type == \"bracket\" && token.data == \"(\")) {\n\t\t\tthis.throwError( context, \"parsing subexpression, expected \\\"bracket\\\", not '\" + token.data + \"'\");\n\t\t}\n\n\t\tvar endTokens = [];\n\t\tendTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\tvar expr = this.parseBoolExpression( context, endTokens );\n\t\tcontext.tokens.shift();\n\n\t\texpr.type = \"expr\";\n\t\treturn expr;\n\t}\n\n\n  tokensToString( token )  {\n    var str = \"\";\n\n    if(token.data == \"@@@all\") {\n        str = str + \"'\" + token.type + \"'\";\n    }\n    else {\n      //str = str + \"'\" + token.type + \"/\" + token.data + \"'\";\n      str = str + \"'\" + token.data + \"'\";\n    }\n\n    return str;\n  }\n\n  endTokensToString( endTokenArray )  {\n    var str = \"\";\n\n    for( var et=0; et<endTokenArray.length; et++) {\n      var endToken = endTokenArray[et];\n\n      if( str != \"\") { str+= \" \";}\n      str += this.tokensToString( endToken );\n    }\n    return str;\n  }\n\n  isEndToken( token, endTokenArry ) {\n\n    for( var et=0; et<endTokenArry.length; et++) {\n      var endToken = endTokenArry[et];\n\n      if( token.type == endToken.type && token.data == endToken.data ) {\n        return true;\n      }\n      else if( token.type == endToken.type && endToken.data == \"@@@all\" ) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n\n  parseSimpleExpression( context, endTokens ) {\n\n    var endLoop;\n\t\tvar tokens = context.tokens;\n\n    if( tokens.length == 0) {\n      return undefined;\n    }\n\n\t\tvar token, returnValue=undefined;\n\t\ttoken = tokens.shift();\n\n\t\tif( !token ) {\n\t\t\tthis.throwError( context, \"empty simple expression\");\n\t\t}\n\n    endLoop = this.isEndToken( token, endTokens );\n    if( endLoop ) {\n      this.throwError( context, \"empty simple expression\");\n    }\n\n\n    if( token.type == \"op\" && token.data == \"-\" ) {\n\t\t\t\tvar pair = this.parseSimpleExpression( context, endTokens );\n        pair[0].data = -pair[0].data;\n        return pair;\n\t\t}\n\n\t\tif( token.type == \"num\" ) {\n        returnValue= { type: \"num\", data: token.data };\n\t\t}\n\t\telse if( token.type == \"str\" ) {\n\t\t\t\treturnValue= { type: \"str\", data: token.data };\n\t\t}\n\n\n    token = tokens.shift();\n    if( token ) {\n      endLoop = this.isEndToken( token, endTokens );\n      if( ! endLoop ) {\n        endLoop = context.tokens.length == 0;\n      }\n      if( !endLoop ) {\n        this.throwError( context, \"Empty simple expression end expected\");\n      }\n    }\n\n\t\treturn [returnValue, token];\n\t}\n\n\n  parseBoolExpression( context, endTokens0 ) {\n\n    var endTokens = [];\n    var tokens = context.tokens;\n\n    for( var i=0; i < endTokens0.length; i++ ) {\n      endTokens.push( endTokens0[ i ] );\n    }\n\n    endTokens.push( { type: \"bop\", data: \"OR\" });\n    endTokens.push( { type: \"bop\", data: \"AND\" });\n\n    var first = true;\n    var eList = [];\n    var op = null;\n    while( true ) {\n\n      var expr = this.parseExpression( context, endTokens );\n      if( first && tokens.length == 0) {\n        return expr;\n      }\n      first = false;\n\n      var opData = null;\n      if( op != null ) {\n          opData = op.data;\n      }\n\n      //if( expr.parts.length == 1) {\n      //    expr.parts[0].op = opData;\n      //    expr.parts[0].dbg = \"1\";\n      //    eList.push(  expr.parts[0] );\n      //}\n      //else {\n          expr.op = opData;\n          expr.type = \"expr\";\n          expr.dbg = \"1\";\n          eList.push(  expr );\n      //}\n\n      if( tokens.length > 0) {\n        if( tokens[0].type == \"bop\" ) {\n          var op = tokens.shift();\n          continue;\n        }\n      }\n      break;\n    }\n\n    if( eList.length == 1 ) {\n        eList[0].dbg2 = \"len=1\";\n        return eList[0];\n    }\n\n\n    var retExpr = {\n      negate: false,\n      binaryNegate: false,\n      type: \"expr\",\n      parts: [],\n      op: null\n    };\n\n    for( i=0; i<eList.length; i++) {\n      retExpr.parts.push( eList[ i ] );\n    }\n\n    return retExpr;\n\n  }\n\n\tparseExpression( context, endTokens ) {\n\n\t\tvar tokens = context.tokens;\n    if( tokens.length == 0) {\n      return null;\n    }\n\n\t\tvar expression = {\n\t\t\t\t\tparts: [],\n          negate: false,\n          binaryNegate: false\n\t\t};\n\n\t\tvar index = 0;\n\t\tvar even = true;\n\t\tvar op = null;\n\t\tvar parts = expression.parts;\n    var first = true;\n    var negate = false;\n\n    var binaryNegate = false;\n\n\n\t\twhile( true ) {\n\t\t\tvar token, part;\n\t\t\ttoken = tokens.shift();\n\n\t\t\tif( !token ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n      var endLoop = this.isEndToken( token, endTokens );\n      if( endLoop ) {\n\n        tokens.unshift( token );\n        break;\n      }\n\n\t\t\tif( even ) {\n\n\t\t\t\tif( token.type == \"num\" ) {\n\t\t\t\t\tpart = { type: \"num\", data: token.data, op: op };\n          if( negate ) {\n            part.data = -part.data;\n          }\n\t\t\t\t\tparts.push( part );\n          first = false;\n          negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type == \"str\" ) {\n\t\t\t\t\tpart = { type: \"str\", data: token.data, op: op };\n\t\t\t\t\tparts.push( part );\n          if( negate ) {\n            this.throwError( context, \"found negation on a string\", \"type mismatch\");\n          }\n          first = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"bracket\" && token.data==\"(\") {\n\t\t\t\t\t\ttokens.unshift( token );\n\n            var subEndTokens = [];\n            subEndTokens.push( { type: \"bracket\", data: \")\" });\n\n\t\t\t\t\t\tvar expr = this.parseSubExpression( context, subEndTokens );\n            expr.op = op;\n            expr.negate = negate;\n            expr.binaryNegate = binaryNegate;\n\t\t\t\t\t\tparts.push ( expr );\n            first = false;\n            negate = false;\n\t\t\t\t}\n\t\t\t\telse if( token.type==\"name\" ) {\n\n\t\t\t\t\t\tvar name = token.data;\n\t\t\t\t\t\tvar isFunctionCallOrArray = this.peekIfNextIsOpenBracket( context );\n            var isUserDefinedFunctionCall = (name == \"FN\");\n\n\t\t\t\t\t\tif( isFunctionCallOrArray ) { /*We have a function or an Array */\n\n\t\t\t\t\t\t\ttoken = tokens.shift();\n\t\t\t\t\t\t\tvar parameters = this.parseFunParList( context );\n              tokens.shift();\n\n              part = { type: \"funCall\", params: parameters, op: op, functionName: name };\n\n              if( this.KEYWORDS.indexOf( name ) == -1 ) {\n                //isArray  example: x=a(5)\n                part = { type: \"array\", data: name, op: op, indices: parameters };\n\n              }\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            else if( isUserDefinedFunctionCall ) {\n\n              token = tokens.shift();\n              name = token.data;\n\n              token = tokens.shift();\n              var parameters = this.parseFunParList( context ); //TODO limit to 1 par\n              tokens.shift();\n\n              part = { type: \"defFnCall\", params: parameters, op: op, functionName: name };\n\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n\t\t\t\t\t\t\telse {\n                parts.push ( part );\n              }\n\n            }\n\t\t\t\t\t\telse { /* we have an variable*/\n\n\t\t\t\t\t\t\tpart = { type: \"var\", data: token.data, op: op };\n              if( op == null && negate ) {\n                var subExpression = {\n                      parts: [part],\n                      negate: true,\n                      binaryNegate: false,\n                      type: \"expr\"\n                };\n                parts.push ( subExpression );\n              }\n              else {\n                parts.push ( part );\n              }\n\n\t\t\t\t\t\t}\n            negate = false;\n            first = false;\n\t\t\t\t}\n        else if( token.type==\"op\" && token.data==\"-\" ) {\n          negate = ! negate;\n          continue;\n        }\n        else if( token.type==\"bop\" && token.data==\"NOT\" && first ) {\n          binaryNegate = ! binaryNegate;\n          expression.binaryNegate = binaryNegate;\n          if( this.debugFlag ) {\n            console.log(\"NOT\")\n          }\n          continue;\n        }\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"number\\\", \\\"string\\\", \\\"symbol\\\" or \\\"bracket\\\", not \" + token.data);\n\t\t\t\t}\n        op = null;\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\tif( token.type == \"op\" || token.type == \"comp\" || token.type == \"eq\" || token.type == \"bop\" ) {\n\t\t\t\t\top = token.data;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.throwError( context, \"Expected \\\"operator\\\" or one of (\"+\n          this.endTokensToString(endTokens)+\n          \"), not '\" + token.data + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\teven = !even;\n\n\t\t}\n\n    if( op != null ) {\n      part = { type: \"uniop\", data: null, op: op };\n      parts.push ( part );\n    }\n\n\t\tif( expression.parts == null ) {\n\t\t\treturn null;\n\t\t}\n\n    var newParts;\n    newParts = this.groupParts( expression.parts, \"^\" );\n    newParts = this.groupParts( newParts, \"/\" );\n    newParts = this.groupParts( newParts, \"*\" );\n\n    var oldExpression = expression;\n    expression = {\n          parts: newParts,\n          negate: oldExpression.negate,\n          binaryNegate: oldExpression.binaryNegate\n    };\n\n\t\treturn expression;\n\t}\n\n\n  groupParts( parts0 , op ) {\n\n    var parts1=[], parts2=[];\n\n    for( var i=0; i<parts0.length; i++ ) {\n      parts1.push( parts0[ i ] );\n    }\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( i>0 && part.op == op ) {\n        var prevPart = parts1[ i-1 ];\n\n        var subExpr = {\n          negate: false,\n          binaryNegate: false,\n          type: \"expr\",\n          parts: [],\n          op: prevPart.op\n        };\n\n        subExpr.parts[ 0 ] = prevPart;\n        subExpr.parts[ 0 ].op = null;\n        subExpr.parts[ 1 ] = part;\n\n        parts1[i-1] = null;\n        parts1[ i ] = subExpr;\n\n      }\n    }\n\n\n    for( var i=0; i<parts1.length; i++ ) {\n\n      var part = parts1[ i ];\n      if( part != null ) {\n        parts2.push( part );\n      }\n    }\n\n    return parts2;\n  }\n\n  normalizeStatementName( x ) {\n    if(x == \"?\") {\n      return \"print\";\n    }\n    return x;\n  }\n\n  parseAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = false;\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n  }\n\n  parseArrayAssignment( context, preTokens, commands, command, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.type = \"assignment\";\n    command.var = nameToken;\n    command.arrayAssignment = true;\n\n    //token = tokens.shift();\n    var indices = this.parseFunParList( context );\n    command.indices = indices;\n\n    tokens.shift();\n    if( this.debugFlag ) {\n      console.log(\"tokens after:\",tokens)\n    }\n\n    token = tokens.shift();\n    if( token === undefined ) {\n      token = { type: \"@@@notoken\" };\n    }\n\n    if( token.type != \"eq\") {\n      this.throwError( context, \"Expected =\");\n    }\n\n    var endTokens = [];\n    endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n    command.expression = this.parseBoolExpression( context, endTokens );\n    commands.push( command );\n\n  }\n\n  parseControlStructure(  context, preTokens, commands, command, handlers, nameToken, token0  ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    if( true ) {\n\n      command.type = \"control\";\n      var controlToken = nameToken;\n      command.controlKW = nameToken.toLowerCase();\n      if( token.type != \"@@@notoken\") {\n        tokens.unshift( token );\n      }\n\n      if( controlToken == \"LET\") {\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"LET expects var name\");\n        }\n        nameToken = token.data;\n\n        token = tokens.shift();\n        if( token === undefined ) {\n          token = { type: \"@@@notoken\" };\n        }\n\n/*        if( token.type != \"bracket\") { #TODO array assignments, ex: LET a(8) = 2\n          this.throwError( context, \"LET expects =\");\n        }\n*/\n\n        if( token.type == \"eq\") {\n\n          this.parseAssignment( context, preTokens, commands, command, nameToken, token );\n        }\n        else if( token.type == \"bracket\" && token.data==\"(\" ) {\n\n          this.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n        }\n        else {\n          this.throwError( context, \"Unexpected data after 'LET': '\" + token.data + \"'\" );\n        }\n\n      }\n      else if( controlToken == \"DIM\") {\n\n        var first = true;\n        command.params = [];\n        command.arrayNames = [];\n\n        while( true ) {\n\n          token = tokens.shift();\n          if(!first ) {\n            if( token === undefined ) {\n              break;\n            }\n            if( ! ( token.type == \"sep\" && token.data == \",\" )) {\n              tokens.unshift( token );\n              break;\n            }\n            token = tokens.shift();\n          }\n\n          if( token.type != \"name\" ) {\n            this.throwError( context, \"DIM expects var name\");\n          }\n\n          nameToken = token.data;\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\"(\") ) {\n            this.throwError( context, \"DIM expects (\");\n          }\n\n          var indices = this.parseFunParList( context );\n\n          token = tokens.shift();\n          if( token === undefined ) {\n            token = { type: \"@@@notoken\" };\n          }\n\n          if( !(token.type==\"bracket\" && token.data==\")\") ) {\n            this.throwError( context, \"DIM expects )\");\n          }\n\n          command.params.push( indices );\n          command.arrayNames.push( nameToken );\n\n          first = false;\n        }\n\n        commands.push( command );\n      }\n      else if( controlToken == \"DEF\") {\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"FN\" ) ) {\n          this.throwError( context, \"DEF expects FN\");\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"DEF FN expects function name\");\n        }\n        var fName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \"(\" )) {\n          this.throwError( context, \"DEF FN expects function name and ->( varname )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"name\"  )) {\n          this.throwError( context, \"DEF FN expects function name and ( ->varname )\");\n        }\n        var varName = token.data;\n\n        token = tokens.shift();\n        if(! ( token.type == \"bracket\" && token.data == \")\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname -> )\");\n        }\n\n        token = tokens.shift();\n        if(! ( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context, \"DEF FN expects function name and ( varname ) -> =\");\n        }\n\n\n        endTokens = [];\n        var expr_fn = this.parseBoolExpression( context, endTokens );\n\n        if( this.debugFlag ) {\n          console.log(\"expr = \" + expr_fn );\n        }\n\n        command.params=[];\n        command.params[0] = fName;\n        command.params[1] = varName;\n        command.params[2] = expr_fn;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"GOTO\" || controlToken == \"GOSUB\") {\n        var num = -1;\n\n        token = tokens.shift();\n\n        if( token === undefined ) {\n          this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n        }\n\n        if( token.type != \"num\") {\n          //this.throwError( context, \"GOTO/GOSUB expects number\", \"undef'd statement\");\n\n          if( token.type != \"name\") {\n              this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n          }\n\n          var label = token.data;\n\n          token = tokens.shift();\n          if( token !== undefined ) {\n            if( token.type != \"cmdsep\") {\n              this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n            }\n          }\n\n          command.params=[];\n          command.params[0] = label;\n          command.label = true;\n          commands.push( command );\n          return;\n\n        }\n        num = parseInt(token.data);\n        token = tokens.shift();\n        if( token !== undefined ) {\n          if( token.type != \"cmdsep\") {\n            this.throwError( context, \"Expected \\\"command separator\\\", instead of '\"+token.data+\"'\");\n          }\n        }\n\n        command.params=[];\n        command.params[0] = num;\n        command.label = false;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"ON\" ) {\n        var nums = [];\n        var onInterrupt = false;\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        endTokens.push( { type: \"name\", data: \"GOSUB\" });\n\n        token = tokens.shift();\n        var onExpr = null;\n\n        if( token.type == \"name\" && (token.data == \"INTERRUPT0\" || token.data == \"INTERRUPT1\")) {\n          onInterrupt = true;\n          onExpr = {\n            type: \"control\",\n            data: token.data\n          }\n        }\n        else {\n          tokens.unshift( token );\n          onExpr = this.parseBoolExpression( context, endTokens );\n        }\n\n        token = tokens.shift();\n        if( token.type != \"name\") {\n          this.throwError( context, \"ON expects GOTO/GOSUB\");\n        }\n\n        if( !onInterrupt ) {\n          if( !( token.data == \"GOTO\" || token.data == \"GOSUB\" )) {\n            this.throwError( context, \"ON expects GOTO/GOSUB\");\n          }\n        }\n        else {\n          if( !( token.data == \"GOTO\" )) {\n            this.throwError( context, \"ON INTERRUPT expects GOTO\");\n          }\n        }\n\n        var onType = token.data;\n\n        token = tokens.shift();\n\n        var labelFlag = false;\n        var label = \"\";\n        var num0;\n\n        if( token.type != \"num\") {\n\n            if( token.type != \"name\") {\n                this.throwError( context, \"GOTO/GOSUB expects linenumber or label\", \"undef'd statement\");\n            }\n\n            labelFlag = true;\n            label = token.data;\n\n        }\n        else {\n          num0  = parseInt(token.data);\n        }\n\n        nums.push( num0 );\n\n        if( !onInterrupt ) {\n          while ( true ) {\n\n            token = tokens.shift();\n            if( token == undefined ) { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( token.type == \"cmdsep\") { break; }\n            if( !( token.type == \"sep\" && token.data == \",\" )) {\n              this.throwError( context, \"ON GOTO/GOSUB expects numberlist\");\n            }\n\n            token = tokens.shift();\n            if( token.type != \"num\") {\n              this.throwError( context, \"GOTO/GOSUB expects number\");\n            }\n            nums.push(  parseInt(token.data) );\n          }\n\n          if( nums.length > 1 ) {\n            this.throwError( context, \"ON INTERUPT GOTO expects only a single line number\");\n          }\n\n          command.params=[];\n          command.params[0] = onType.toLowerCase();\n          command.params[1] = onExpr;\n          command.params[2] = nums;\n          commands.push( command );\n        }\n        else {\n\n          command.params=[];\n          command.params[0] = onExpr.data.toLowerCase();\n          if ( labelFlag ) {\n              command.params[1] = label;\n          }\n          else {\n              command.params[1] = num0;\n          }\n          command.label = labelFlag;\n\n          commands.push( command );\n\n        }\n\n      }\n      else if( controlToken == \"RETURN\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"END\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"STOP\") {\n        var num = -1;\n\n        command.params=[];\n        commands.push( command );\n\n      }\n      else if( controlToken == \"FOR\") {\n\n        var variable, expr_from, expr_to, expr_step;\n        var endTokens = [];\n\n        token = tokens.shift();\n        if( token.type != \"name\" ) {\n          this.throwError( context,\n                \"For expects variable, no var found, found \" + token.type+\"/\"+token.data);\n        }\n\n        variable = token.data;\n\n        token = tokens.shift();\n        if( !( token.type == \"eq\" && token.data == \"=\" )) {\n          this.throwError( context,\n                \"For expects '=', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"TO\" });\n\n        expr_from = this.parseBoolExpression( context, endTokens );\n\n        token = tokens.shift();\n        if( !( token.type == \"name\" && token.data == \"TO\" ) ) {\n          this.throwError( context, \"For expects 'to', not found, found \" + token.type+\"/\"+token.data);\n        }\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"name\", data: \"STEP\" });\n\n        expr_to = this.parseBoolExpression( context, endTokens );\n        expr_step = { parts: [ { data: \"1\", op: null, type: \"num\"} ] };\n\n        token = tokens.shift();\n        if( !( token === undefined ) ) {\n          if( token.type == \"name\" && token.data == \"STEP\") {\n\n              endTokens = [];\n              endTokens.push( { type: \"cmdsep\", data: \":\" });\n              expr_step = this.parseBoolExpression( context, endTokens );\n          }\n          else {\n            if(! ( token.type == \"cmdsep\" && token.data == \":\")) {\n              throw \"FOR: unexpected token '\" + token.data +\"'\";\n            }\n          }\n        }\n\n        command.controlKW = \"for:init\";\n        command.params=[];\n        command.params[0] = expr_from;\n        command.params[1] = expr_to;\n        command.params[2] = expr_step;\n        command.variable = variable;\n        commands.push( command );\n        if( this.debugFlag ) {\n          console.log(\"command=\", command);\n        }\n\n      }\n      else if( controlToken == \"NEXT\") {\n\n        var variable;\n\n        var explicit = false;\n        while( true ) {\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n\n          if( token.type != \"name\" ) {\n            throw \"Next expected variable, not '\" +token.data+ \"'\";\n          }\n\n          var nextcommand = {\n            controlKW: \"for:next\",\n            nextVar: token.data,\n            lineNumber: command.lineNumber,\n            type: command.type\n          };\n\n          commands.push( nextcommand );\n          explicit = true;\n\n          var token = tokens.shift();\n          if( ! token ) {\n            break;\n          }\n          if( token.type == \"cmdsep\" ) {\n            break;\n          }\n          if( !( token.type == \"sep\" && token.data == \",\" )) {\n            throw \"Expected comma, found '\" + token.data + \"'\";\n          }\n        }\n\n        if( ! explicit ) {\n          command.controlKW = \"for:next\";\n          command.nextVar = null;\n          commands.push( command );\n        }\n\n      }\n      else if( controlToken == \"IF\") {\n\n        var expr1, expr2, comp;\n        endTokens = [];\n        endTokens.push( { type: \"name\", data: \"THEN\" });\n        endTokens.push( { type: \"name\", data: \"GOTO\" });\n        var expr1 = this.parseBoolExpression( context, endTokens );\n        command.params= [ expr1 ];\n\n        token = tokens.shift();\n\n        if( token.type == \"name\" && token.data == \"GOTO\") {\n          var insert = {};\n          insert.data = \"GOTO\";\n          insert.type = \"name\";\n          tokens.unshift( insert );\n        } else {\n          if( tokens.length > 0 ) {\n            if( tokens[0].type == \"num\" ) {\n              var insert = {};\n              insert.data = \"GOTO\";\n              insert.type = \"name\";\n              tokens.unshift( insert );\n            }\n          }\n        }\n\n        //var block = this.parseLineCommands( context );\n        var result = this.parseLineCommands( context );\n        var block = result.commands;\n\n        if( this.debugFlag ) {\n          console.log( block );\n        }\n\n        commands.push( command );\n\n        for( var bi=0; bi<block.length; bi++) {\n          commands.push( block[bi] );\n        }\n\n      }\n      else if( controlToken == \"DATA\") {\n\n        var dataArray = [];\n        var endTokens;\n\n        endTokens = [];\n        endTokens.push( { type: \"cmdsep\", data: \":\" });\n        endTokens.push( { type: \"sep\", data: \",\" });\n\n        while ( true ) {\n            var pair = this.parseSimpleExpression( context, endTokens );\n\n            var expr1 = pair[0];\n\n\n            if( expr1 === undefined ) {\n              throw \"DATA: expected data\";\n            }\n\n            dataArray.push( expr1 );\n\n            token = pair[1];\n            if( token === undefined ) {\n              break;\n            }\n            if( token.type == \"cmdsep\" && token.data == \":\" ) {\n              break;\n            }\n            else if( token.type == \"sep\" && token.data ==\",\") {\n              continue;\n            }\n            else {\n              this.throwError( context, \"data unknown token found \" + token.type+\"/\"+token.data);\n            }\n        }\n\n        command.params=dataArray;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"SUB\") {\n\n        var label = \"\";\n        token = tokens.shift();\n        if( token == null ) { throw \"SUB expected label\"; }\n\n        if( token.type != \"name\" ) {\n          throw \"SUB expected label not '\" +token.data+ \"'\";\n        }\n\n        label = token.data.toUpperCase();\n\n        token = tokens.shift();\n        if( token != null ) { throw \"SUB unexpected data after label\"; }\n\n        command.label = label;\n        commands.push( command );\n\n      }\n      else if( controlToken == \"REM\" ) {\n\n        while( true ) {\n\n            token = tokens.shift();\n            if( token == null ) { break ; }\n        }\n\n        commands.push( command );\n\n      }\n      else {\n        this.throwError( context, command.controlKW + \" not implemented\");\n      }\n    }\n  }\n\n  parseStatementCall(  context, preTokens, commands, command, nameToken, token0 ) {\n\n    var token = token0;\n\t\tvar tokens = context.tokens;\n\n    command.statementName = this.normalizeStatementName( nameToken );\n    command.type = \"call\";\n\n\n    if( token.type != \"@@@notoken\") {\n      tokens.unshift( token );\n    }\n\n    command.params = [];\n\n    while ( true ) {\n\n      var endCommand = false;\n      var endTokens = [];\n      endTokens.push( { type: \"sep\", data: \"@@@all\" });\n      endTokens.push( { type: \"cmdsep\", data: \"@@@all\" });\n\n      var expression = this.parseBoolExpression( context, endTokens );\n      if( this.debugFlag ) {\n        console.log( expression );\n      }\n\n      if( expression != null ) {\n        command.params.push( expression );\n\n        token = tokens.shift();\n        if( token != undefined ) {\n          if( token === undefined ) {\n            endCommand = true;\n          }\n          if( token.type == \"cmdsep\" ) {\n            endCommand = true;\n          }\n          else if( token.type == \"sep\") {\n            continue;\n          }\n          else {\n            this.throwError( context, \"Unexpected characters in statement call: '\" + token.data +\"'\");\n          }\n        }\n        else {\n          endCommand = true;\n        }\n\n      }\n      else {\n        endCommand = true;\n      }\n\n      if( endCommand  ) {\n        commands.push( command );\n        break;\n      }\n    }\n  }\n\n\tparseLineCommands( context, preTokens ) {\n\n\t\tvar tokens = context.tokens;\n\t\tvar commands = [];\n    var handlers = {};\n\n\t\tvar i=1;\n\t\twhile( true ) {\n\n\t\t\tvar command = {};\n\t\t\tvar token;\n      var keyword = false;\n      var control = false;\n\n\t\t\tcommand.lineNumber = context.lineNumber;\n\n\t\t\ttoken = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif( token.type == \"cmdsep\" ) {\n\t\t\t\t/* empty command */\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif( token.type != \"name\" ) {\n\t\t\t\tif( token.type != \"trash\" ) {\n          this.throwError( context, \"Unexpected token, expected symbolname, got '\" + oken.data +\"'\") ;\n        }\n        else {\n          this.throwError( context, \"Unexpected character, expected \\\"symbolname\\\", got \" + token.detail ) ;\n        }\n\t\t\t}\n\n\t\t\tvar nameToken = token.data;\n\t\t\tvar cmdType = \"unknown\";\n\n\t\t\tif( this.CTRL_KW.indexOf( token.data ) > -1) {\n\t\t\t\t\tcontrol = true;\n\t\t\t}\n\n      if( this.KEYWORDS.indexOf( token.data ) > -1 || token.data == \"XON\") {\n\t\t\t\t\tkeyword = true;\n\t\t\t}\n      else {\n        if( this.SHORTCUT_KW.indexOf( token.data ) > -1) {\n  \t\t\t\t\tkeyword = true;\n  \t\t\t}\n      }\n\n\t\t  token = tokens.shift();\n\t\t\tif( token === undefined ) {\n\t\t\t\ttoken = { type: \"@@@notoken\" };\n\t\t\t}\n\n      if (  control ) {\n\n        this.parseControlStructure( context, preTokens, commands, command, handlers, nameToken, token );\n\n      }\n\t\t\telse if( token.type == \"eq\") {\n\n\t\t\t\tthis.parseAssignment( context, preTokens, commands, command, nameToken, token );\n\t\t\t}\n      else if( token.type == \"bracket\" && token.data==\"(\" && !keyword ) {\n\n\t\t\t\tthis.parseArrayAssignment( context, preTokens, commands, command, nameToken, token );\n\n\t\t\t}\n      else {\n          if( !keyword ) {\n            console.log(\"Dump: \",context, preTokens, commands, command, nameToken, token);\n            this.throwError( context, \"no such command: \" + nameToken );\n          }\n          this.parseStatementCall( context, preTokens, commands, command, nameToken, token );\n\n      }\n\n\t\t}\n\n    var result = {\n        commands: commands,\n        handlers: handlers\n      };\n\n    return result;\n\t}\n\n  logTokens( tokens ) {\n    if( !this.debugFlag ) { return ; }\n\n    var tokensStr = \"\";\n    for( var i=0; i<tokens.length; i++) {\n      var tok = tokens[i];\n      var tokStr = tok.type + \":\" + tok.data;\n      if( tokensStr != \"\" ) {\n        tokensStr += \", \";\n      }\n      tokensStr += tokStr;\n    }\n\n    console.log( tokensStr );\n\n\n    for( var i=0; i<tokens.length; i++) {\n        var tok = tokens[i];\n        console.log(\"token: \",tok);\n    }\n\n  }\n\n\n\n\n  parseErrorLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n\n    errContext=\"tokenizer\";\n    detail=\"init\";\n\t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n    detail=\"parsing tokens\";\n    var tokens = toker.tokenize();\n    if( this.debugFlag ) {\n      console.log(\"Tokens after tokenizer\");\n    }\n    this.logTokens( tokens );\n\n    detail=\"internal\";\n    tokens = this.upperCaseNameTokens( tokens );\n    tokens = this.removePadding( tokens );\n    tokens = this.mergeCompTokens( tokens );\n    tokens = this.mergeBrokenUpTokens( tokens );\n\n\n    if( this.debugFlag ) {\n      console.log(\"Tokens after merge\");\n    }\n    this.logTokens( tokens );\n\n    if( tokens.length == 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif( tokens[0].type == \"num\" ) {\n\t\t\tlineRecord.lineNumber = tokens[0].data;\n      lineNr = tokens[0].data;\n      var lineRest = line.substr( lineNr.length );\n      return this.parseLine( lineNr + \" REM[ERROR] \" + lineRest  );\n    }\n    else {\n      throw \"Expected line number, when reparsing line with error\";\n    }\n\n  }\n\n  parseLine( line ) {\n\n    var lineRecord = {\n      lineNumber: -1,\n      commands: []\n    };\n\n    var errContext, detail, lineNr=-1;\n    try {\n      errContext=\"tokenizer\";\n      detail=\"init\";\n  \t\tvar toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n\n      detail=\"parsing tokens\";\n      var tokens = toker.tokenize();\n      if( this.debugFlag ) {\n        console.log(\"Tokens after tokenizer\");\n      }\n      this.logTokens( tokens );\n\n      detail=\"internal\";\n      tokens = this.upperCaseNameTokens( tokens );\n      tokens = this.removePadding( tokens );\n      tokens = this.mergeCompTokens( tokens );\n      tokens = this.mergeBrokenUpTokens( tokens );\n\n\n      if( this.debugFlag ) {\n        console.log(\"Tokens after merge\");\n      }\n      this.logTokens( tokens );\n\n      if( tokens.length == 0 ) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tif( tokens[0].type == \"num\" ) {\n  \t\t\tlineRecord.lineNumber = tokens[0].data;\n        lineNr = tokens[0].data;\n        tokens.shift();\n      }\n\n  \t\tvar context = {\n        tokens: tokens,\n        lineNumber: lineRecord.lineNumber\n      }\n\n      errContext = \"parser\";\n      detail=\"parsing commands\";\n      var result = this.parseLineCommands( context );\n      var commands = result.commands;\n      lineRecord.commands = commands;\n      lineRecord.raw = line;\n      lineRecord.handlers = result.handlers;\n      return lineRecord;\n    }\n    catch ( e ) {\n\n      if( this.erh.isError( e ) ) {\n        if( e.lineNr == -1 ) {\n          if( lineNr != -1 ) {\n            e.lineNr = lineNr;\n          }\n        }\n        throw e;\n      }\n      this.throwError( null, errContext + \" error (\" +e+ \") while \" + detail );\n    }\n  }\n\n  getTokens( line, merge, noPadding  ) {\n\n    try {\n      var toker = new Tokenizer( new StringReader ( line ), this.KEYWORDS );\n      var tokens = toker.tokenize();\n      if( noPadding) { tokens = this.removePadding( tokens ); }\n      if( merge ) {tokens = this.mergeCompTokens( tokens ); }\n      this.logTokens( tokens );\n      return tokens;\n    }\n    catch ( e ) {\n      console.log( e );\n      this.throwError(null,\"getTokens error\",\"internal\");\n    }\n  }\n}\n\n//--EOC \n\n// ## basictokenizer.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/basictokenizer.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/basictokenizer.js\n\nclass StringReader {\n\n\tconstructor( strIn ) {\n\t\t\tthis.buffer = strIn;\n\t\t\tthis.index = 0;\n\t\t\tthis.lineIndex = 1;\n\t\t\tthis.line = 1;\n\t\t\tvar a={}; a.b=strIn;\n\n\t}\n\n\tpeek() {\n\t\treturn this.buffer.substr( this.index,1 );\n\t}\n\tpeek2() {\n\t\treturn this.buffer.substr( this.index,2 );\n\t}\n\n\n\tunconsume( x ) {\n\t\tthis.index -= x;\n\t}\n\n\tconsume() {\n\n\t\tvar c = this.buffer.substr( this.index,1 );\n\t\tthis.index ++;\n\t\tif( c == \"\\n\") {\n\t\t\tthis.line++;\n\t\t\tthis.lineIndex = 1;\n\t\t}\n\n\t}\n\n\tEOF() {\n\t\tvar len = this.buffer.length;\n\t\tif( this.index < len ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n\nclass Tokenizer {\n\n\tconstructor( reader, keywords ) {\n\t\t\tthis.tokens = [];\n\t\t\tthis.reader = reader;\n\t\t\tthis.keywords = keywords;\n\t\t\tthis.greedy = false;\n\t}\n\n\tisOpChar( ctx ) {\n\n\t\tvar rv = ctx.c.match(\"[+]|[-]|[*]|[/]|[\\\\%]|[\\\\^]|[;]\") != null;\n\n\t\treturn [rv,0];\n\n\t}\n\n\tisCompChar( ctx ) {\n\n\t\tvar rv =  (ctx.c == \"<\" || ctx.c == \">\");\n\t\treturn [rv,0];\n\t}\n\n\tisEqChar( ctx ) {\n\t\t\tif( ctx.c == \"=\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisNameChar( ctx  ) {\n\n\t\t//console.log(\"SEQ: \" + ctx.seq);\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\t\tvar rv = ctx.c.match(\"[a-zA-Z0-9$%?]\") != null;\n\n\t\tif( ctx.c== \"%\" ) {\n\t\t\t\trv = false;\n\t\t\t\tif( ctx.prev != null ) {\n\t\t\t\t\tvar varNameChar = ctx.prev.match(\"[a-zA-Z0-9]\") != null;\n\t\t\t\t\tif( varNameChar ) {\n\t\t\t\t\t\tctx.endFound = true;\n\t\t\t\t\t\trv = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\n\t\tif( ctx.c==\"$\" ) {\n\t\t\tctx.endFound = true;\n\t\t}\n\n\t\tif( this.greedy ) {\n\t\t\tif( this.keywords.indexOf( ctx.seq.toUpperCase() ) >-1 ) {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\telse if( ! (ctx.seq === undefined )) {\n\t\t\t\tvar trappedKW = false;\n\t\t\t\tvar trapped = null;\n\t\t\t\tfor( var i=0; i<this.keywords.length; i++) {\n\t\t\t\t\tvar kw = this.keywords[i];\n\t\t\t\t\tif( ctx.seq.toUpperCase().indexOf( kw ) > 0 )  {\n\t\t\t\t\t\ttrappedKW = true;\n\t\t\t\t\t\ttrapped = kw;\n\t\t\t\t\t\treturn [rv, kw.length ];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn [rv,0];\n\t}\n\n\tisNumChar( ctx  ) {\n\t\treturn [(ctx.c.match(\"[0-9\\.~]\") != null),0];\n\t}\n\n\tisPadChar( ctx  ) {\n\t\t\tif( ctx.c == \" \" || ctx.c == \"\\t\" || ctx.c == \"\\n\" || ctx.c == \"\\r\") {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\n\t\t\treturn [false,0];\n\t}\n\n\tisCommandSepChar( ctx  ) {\n\t\t\tif( ctx.c == \":\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\n\tisSepChar( ctx  ) {\n\t\t\tif( ctx.c == \",\" ) {\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t}\n\n\tisAnyChar( ctx  ) {\n\t\t\treturn [true,0]; /* Will be executed last */\n\t}\n\n\tisBracket( ctx  ) {\n\t\tif( ctx.c == \"(\" || ctx.c == \")\" || ctx.c == \"[\" || ctx.c == \"]\") {\n\t\t\treturn [true,0];\n\t\t}\n\t\treturn [false,0];\n\t}\n\n\n\tisStrChar( ctx ) {\n\n\t\tif( ctx.endFound ) {\n\t\t\treturn [false,0];\n\t\t}\n\n\t\tif( ctx.index == 0) {\n\t\t\tif( ctx.c==\"\\\"\" ) {\n\t\t\t\tctx.inString = true;\n\t\t\t\treturn [true,0];\n\t\t\t}\n\t\t\treturn [false,0];\n\t\t}\n\t\telse if( ctx.inString ) {\n\t\t\tif ( ctx.index > 0 && ctx.c==\"\\\"\") {\n\t\t\t\tctx.endFound = true;\n\t\t\t}\n\t\t\treturn [true,0];\n\t\t}\n\n\t\treturn [false,0];\n\n\t}\n\n\tnormalizeToken( tok0 ) {\n\t\tvar tok = tok0;\n\n\t\ttok.type = tok0.type;\n\n\t\tif( tok.type == \"str\" ) {\n\t\t\t\ttok.data = tok0.data.substr(1,tok0.data.length-2);\n\t\t}\n\t\treturn tok;\n\t}\n\n\treadChars( read, type0, compareF, tokenType ) {\n\t\tvar tok = { type: type0, data : \"\" }\n\t\tvar ctx = { index:0, prev: null, seq: \"\" };\n\n\t\twhile(!read.EOF()) {\n\n\t\t\tvar c = read.peek();\n\n\t\t\tctx.seq += c;\n\t\t\tctx.c = c;\n\n\t\t\tvar rv = this[compareF ] ( ctx );\n\t\t\tif( rv[1] > 0 ) {\n\t\t\t\t\tread.unconsume( rv[1]-1 );\n\t\t\t\t\tctx.seq = ctx.seq.substr(0,ctx.seq.length-rv[1]) ;\n\t\t\t\t\ttok.data = ctx.seq;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( !rv[0] ) {\n\t\t\t\treturn this.normalizeToken( tok );\n\t\t\t}\n\t\t\ttok.data += c;\n\t\t\tread.consume();\n\n\t\t\tctx.index++;\n\t\t\tctx.prev = c;\n\n\t\t\tif( tokenType == \"chr\") {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn this.normalizeToken( tok );\n\t}\n\n\n\ttokenize() {\n\t\tvar read = this.reader;\n\n\t\tvar _this = this;\n\t\tvar tokens = [];\n\n\t\tvar parseRules = [];\n\t\tvar TYPEIX = 0;\n\t\tvar FUNCIX = 1;\n\t\tvar STRINGTYPEIX = 2;\n\n\t\tparseRules.push([\"pad\", \t\t\"isPadChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"str\", \t\t\"isStrChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"num\", \t\t\"isNumChar\"\t\t, \"str\"] );\n\t\tparseRules.push([\"name\", \t\t\"isNameChar\"\t, \"str\"] );\n\t\tparseRules.push([\"op\", \t\t\t\"isOpChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"comp\", \t\t\"isCompChar\"  , \"chr\"] );\n\t\tparseRules.push([\"eq\", \t\t\t\"isEqChar\"   \t, \"chr\"] );\n\t\tparseRules.push([\"bracket\", \"isBracket\"   , \"chr\"] );\n\t\tparseRules.push([\"sep\", \t\t\"isSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"cmdsep\", \t\"isCommandSepChar\"   , \"chr\"] );\n\t\tparseRules.push([\"trash\", \t\"isAnyChar\"   , \"chr\"] );\n\n\t\twhile( !read.EOF() ) {\n\t\t\tvar c = read.peek();\n\t\t\tvar tokenFound = false;\n\n\t\t\tfor( var i=0; i<parseRules.length; i++) {\n\t\t\t\tvar rule = parseRules[ i ];\n\n\t\t\t\tvar ctx = { index: 0, c:c }\n\t\t\t\tvar rv = this[rule[FUNCIX]]( ctx );\n\t\t\t\tif( rv[0] ) {\n\t\t\t\t\t\tvar tok = this.readChars( read, rule[TYPEIX], rule[FUNCIX], rule[STRINGTYPEIX] );\n\n\t\t\t\t\t\tif( tok.type == \"name\") {\n\t\t\t\t\t\t\ttok.data = tok.data.toUpperCase();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( tok.type == \"trash\") {\n\t\t\t\t\t\t\ttok.detail = \"'\" + tok.data + \"' (ASCII-code=\" + tok.data.charCodeAt(0) + \")\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttokens.push( tok );\n\t\t\t\t\t\ttokenFound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//do nothing\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!tokenFound) {\n\t\t\t\tthrow \"syntax error, unexpected character: '\" + c + \"' =>\" + read.line + \":\" + read.lineIndex;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n}\n\n//--EOC \n\n// ## input.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/input.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/input.js\n\nclass Input {\n\n  constructor( sys ) {\n    this.keyPress = [];\n    this.interactive = false;\n    this.sys = sys;\n  }\n\n  setHandler( hc ) {\n    this.handlerClazz = hc;\n  }\n\n  setInterActive( flag ) {\n\n    this.interactive = flag;\n    this.sys.blinkMode( flag  );\n\n  }\n\n\n  getInterActive() {\n\n    return this.interactive;\n\n  }\n\n\n  flush() {\n    this.keyPress = [];\n  }\n\n  inputKeyHandler( e )  {\n\n    var hc = this.handlerClazz;\n\n    if( e.keyLabel == \"Escape\" ) {\n        hc[\"stop\"]();\n        return;\n    }\n\n    hc[\"keyInterrupt\"]( \"keypress\", e );\n\n    if( !this.interactive ) {\n        this.keyPress.push( e );\n    }\n    else {\n        hc[\"interactiveKeyHandler\"]( e );\n      }\n  }\n\n  getKey() {\n    var key = this.keyPress.shift();\n    if( key ) {\n      return key;\n    }\n    return null;\n  }\n\n}\n\nclass MutedInput {\n\n  setHandler( hc ) {}\n  setActive( flag ) {}\n  getKey() { return null; }\n  inputKeyHandler(e) {}\n  getKey() { return null;}\n\n}\n\n//--EOC \n\n// ## processes.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/processes.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/processes.js\n\nclass processes {\n\n\tconstructor( sys ) {\n\n\t\tthis.sys = sys;\n\t\tthis.processes = [];\n\t\tthis.fastProcesses = [];\n\t\tthis.fastProcessesIds = {};\n\t\tthis.count = 0;\n\n\t\tvar _this = this;\n    var processes = _this.processes;\n\n\t\tthis.sys.log(\"Starting process interval\");\n\n\t\t//slow loop\n\t\tsetInterval(function()  {\n\n\t\t\tfor( var i=0; i<processes.length; i++ ) {\n\t\t\t\tif( processes[i] ) {\n\n\t\t\t\t\tvar upd;\n\n\t\t\t\t\tupd = processes[ i ].cycle();\n\t\t\t\t\tif( upd ) {\n\t\t\t\t\t\tvar stat = processes[ i ].getStatus();\n\t\t\t\t\t\t_this.sys.poststatus( i, stat );\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cpuHungry =  processes[ i ].cpuNeeded();\n\t\t\t\t\tvar found = !(_this.fastProcessesIds[ i + \"_\"] === undefined);\n\n\t\t\t\t\tif( cpuHungry && !found) {\n\t\t\t\t\t\t_this.fastProcessesIds[ i + \"_\"] = _this.fastProcesses.length;\n\t\t\t\t\t\t_this.fastProcesses.push( processes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t\telse if( !cpuHungry && found) {\n\t\t\t\t\t\tvar fpID = _this.fastProcessesIds[ i + \"_\"];\n\t\t\t\t\t\tvar nfpArr = [];\n\t\t\t\t\t\tfor( var j=0; j<_this.fastProcesses.length; j++ ) {\n\t\t\t\t\t\t\tvar el = _this.fastProcesses[ j ];\n\t\t\t\t\t\t\tif( j!= fpID ) {\n\t\t\t\t\t\t\t\tnfpArr.push( el );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_this.fastProcesses = nfpArr;\n\t\t\t\t\t\t_this.fastProcessesIds[ i + \"_\"] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 100);\n\n\t\t//fast loop\n\t\tsetInterval(function()  {\n\n\t\t\tfor( var i=0; i<_this.fastProcesses.length; i++ ) {\n\t\t\t\t\tvar dummy = _this.fastProcesses[ i ].cycle();\n\t\t\t}\n\t\t}, 10);\n\t}\n\n\n\n\tgetTicks() {\n\t\treturn this.count;\n\t}\n\n\told_register( obj ) {\n\n\t\tvar newId = this.processes.length-1;\n\n\t\tthis.processes[newId] = obj;\n\t\tobj.processId = newId;\n\n\t\treturn newId;\n\t}\n\n\tget( id ) {\n\t\treturn this.processes[ id ];\n\t}\n\n\tregister( obj ) {\n\n\t\tvar newId = this.processes.length;\n\n\t\tthis.processes.push( obj );\n\n\t\tobj.processId = newId;\n\t\treturn newId;\n\t}\n\n\n\tgetRoot() {\n\n\t\treturn this.processes[ 0 ];\n\t}\n}\n\n//--EOC \n\n// ## commandhelp.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/commandhelp.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/commandhelp.js\n\nclass CommandHelp {\n\n\tconstructor() {}\n\n\n  getCategoriesNormalize(  categoryIndexesInt ) {\n    var categoryIndexes = [\n      Object.getOwnPropertyNames( categoryIndexesInt[0] ),\n      categoryIndexesInt[1]\n    ];\n    return categoryIndexes;\n  }\n\n  getCategoriesIntermediate(  categoryIndexes, clazz ) {\n\n\n    var stats = clazz.getStatements( true );\n    var funs = clazz.getFunctions( true );\n\n    var cat = categoryIndexes[ 0 ];\n    var catLists = categoryIndexes[ 1 ];\n\n    if( cat[ \"general\" ] === undefined ) { cat[ \"general\" ] = 0; catLists[ \"general\" ] = []; }\n\n    for( var i=0;i<stats.length;i++) {\n      var rname = stats[i];\n      var si = rname.replace(\"_stat_\",\"_stat_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) ) { catlabel = clazz[ si ](); }\n      else { catlabel = \"general\"; }\n\n      var f_attribs = {};\n      if( catlabel.indexOf(\":\") >0 ) {\n\n        var partsLen = catlabel.split(\":\" ).length;\n\n        f_attribs.description =  catlabel.split(\":\" )[1];\n        f_attribs.input =   catlabel.split(\":\" )[2];\n        f_attribs.output =  catlabel.split(\":\" )[3];\n\n        catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_stat_\",\"\").toUpperCase();\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    for( var i=0;i<funs.length;i++) {\n      var rname = funs[i];\n      var si = rname.replace(\"_fun_\",\"_fun_info_\");\n\n      var catlabel;\n      if( !( clazz[ si ] === undefined ) ) { catlabel = clazz[ si ](); }\n      else { catlabel = \"general\"; }\n      var f_attribs = {};\n\n      if( catlabel.indexOf(\":\") >0 ) {\n\n          var partsLen = catlabel.split(\":\" ).length;\n\n          f_attribs.description =  catlabel.split(\":\" )[1];\n          f_attribs.input =   catlabel.split(\":\" )[2];\n          f_attribs.output =  catlabel.split(\":\" )[3];\n\n          catlabel=catlabel.split(\":\")[0];\n      }\n\n      rname = rname.replace(\"_fun_\",\"\").replace(\"_DLR_\",\"$\").toUpperCase() + \"()\";\n\n      if( cat[ catlabel ] === undefined ) { cat[ catlabel ] = 0; catLists[ catlabel ] = []; }\n      cat[ catlabel ]++;\n      catLists[ catlabel ].push( {name: rname, attribs: f_attribs } );\n    }\n\n    //var cats = Object.getOwnPropertyNames( cat );\n\n    return [cat,catLists];\n  }\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/textarea.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/textarea.js\n\nclass TextArea {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.cursorOn = false;\n\t\tthis.cols = 80;\n\t\tthis.rows = 30;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.hidden = false;\n\n\t\tthis.dc = false;\n\t\tthis.dcCmd = false;\n\n\t\tthis.colors ={};\n\t\tthis.reverse = false;\n\n\t\tthis.defaultFG = 5;\n\t\tthis.defaultBG = 0;\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.initialized = false;\n\n\t\tthis.changes = { all: false, list: [] };\n\t\tthis.pokeFlush = true;\n\n\n\t\t//this.textArea( this.cols , this.rows , -1, -1 );\n\t}\n\n\tisActive() {\n    return this.initialized && !this.hidden;\n  }\n\n\treInit( w, h ) {\n\t\tthis._int_initMode( w, h );\n\t}\n\n\n\tdestroy() {\n\n\t\t\tthis.cellel = undefined;\n\n\t\t\tthis.changes = { all: false, list: [] };\n\t\t\tthis.initialized = false;\n\t\t}\n\n\n  /* Adding changes, to be posted to MT throught flush */\n\t_int_addChangeAll() {\n\n\t\t this.changes.all = true;\n\t\t this.changes.list = [];\n\n\t }\n\n\n\n\t changeCount() {\n\t\t if( this.changes.all ) { return 65535; }\n\t\t return this.changes.list.length;\n\t }\n\n\t/* Adding single change, to be posted to MT throught flush */\n\t_int_addChange( area ) {\n\n\t\t\tif(  this.changes.all ) {\n\t\t\t\tif( this.changes.list.length > 0 ) {\n\t\t\t\t\t\tthis.changes.list = [];\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar clist = this.changes.list;\n\t\t\tif( clist.length > 0 ) {\n\t\t\t\tvar lc = clist[ clist.length -1 ];\n\t\t\t\tvar nc = area;\n\t\t\t\tif( lc.y1 == lc.y2 && nc.y1 == nc.y2 && lc.y1 == nc.y1) {\n\t\t\t\t\tif( nc.x1 == lc.x2 +1 ) {\n\t\t\t\t\t\t\tvar x2 = lc.x2;\n\t\t\t\t\t\t\tvar temp=1;\n\t\t\t\t\t\t\tvar changesTargetArray = lc.cells[0];\n\t\t\t\t\t\t\tfor( var i=0; i<area.cells[0].length; i++) {\n\t\t\t\t\t\t\t\tvar cell = area.cells[0][i];\n\t\t\t\t\t\t\t\tchangesTargetArray.push( cell );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlc.x2 = nc.x2;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t \tthis.changes.list.push( area );\n\n\t }\n\n\t /* Force flush to MT the whole buffer */\n\t_int_flushAll() {\n\t\t\tthis.changes.all = true;\n\t\t\tthis.changes.list = [];\n\n\t\t\tthis._int_flush();\n\n\t\t}\n\n  /* Utility function to prepare input for addChange (which itself prepares for flush )*/\n\t_int_getArea( x1, y1, x2, y2 ) {\n\t\t\tvar cells = [];\n\n\t\t\tfor( var y=y1; y<=y2; y++) {\n\t\t\t\tvar row = [];\n\t\t\t\tfor( var x=x1; x<=x2; x++) {\n\t\t\t\t\trow.push( this.cellel[ y][ x] );\n\t\t\t\t}\n\t\t\t\tcells.push( row );\n\t\t\t}\n\n\t\t\tvar area =\n\t\t\t{\n\t\t\t\t cells: cells,\n\t\t\t\t x1: x1,\n\t\t\t\t y1: y1,\n\t\t\t\t x2: x2,\n\t\t\t\t y2: y2\n\t\t\t};\n\n\t\t\treturn area;\n\n\t\t}\n\n   /* Flush local changes to Main Thread for actual display updates*/\n\t _int_flush() {\n\n\t\t\tif( this.changes.all ) {\n\t\t\t\tthis.sys.post( \"textupdate-all\",\n\t\t\t\t\t\t{\n \t\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\t\tcells: this.cellel,\n\t\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t\t} );\n\n\t\t\t\tthis.changes.all = false;\n\n\n\t\t\t}\n\t\t\telse if( this.changes.list.length > 0 ) {\n\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  this.changes.list,\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\t\t\t\tthis.changes.list = [];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sys.post( \"textupdate\",\n\t\t\t\t\t{\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor,\n\t\t\t\t\t\tcx: this.x,\n\t\t\t\t\t\tcy: this.y,\n\t\t\t\t\t\tareasList:  [],\n\t\t\t\t\t\tcursorMode: this.cursorMode\n\t\t\t\t\t}  );\n\n\t\t\t}\n\n\t\t}\n\n\t\tattach( w, h ) {\n\t\t\tthis._int_initMode( w, h);\n\t\t}\n\n\t\tsetPokeFlush( flag ) {\n\t\t  this.pokeFlush = flag;\n\t\t}\n\n\n\t\tpeekc( x, y ) {\n\n\t\t\tvar cell = this.cellel[y][x];\n     \treturn cell.txt.codePointAt(0);\n\n\t\t}\n\n\t\tpeekcl( x, y, m ) {\n\n\t\t\tvar cell = this.cellel[y][x];\n\n\t\t\tif( m== 0 ) {\n\t\t\t\treturn cell.fg;\n\t\t\t}\n\t\t\telse if( m== 1 ) {\n\t\t\t\treturn cell.bg;\n\t\t\t}\n\t\t\telse  {\n\t\t\t\treturn cell.fg + (16*cell.bg);\n\t\t\t}\n\t\t}\n\n\t\tpokec( x, y , c ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\n\t\t}\n\n\t\tpokecl( x, y , fg, bg ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\t\t}\n\n\n\t\tpokeccl( x, y , c, fg, bg ) {\n\n\t\t\ttry {\n\t\t\t\tvar cell = this.cellel[y][x];\n\n\t\t\t\tcell.txt = String.fromCodePoint( c );\n\t\t\t\tif( !(fg === undefined )) {\n\t\t\t\t\tcell.fg = fg;\n\t\t\t\t}\n\t\t\t\tif( !(bg === undefined )) {\n\t\t\t\t\tcell.bg = bg;\n\t\t\t\t}\n\n\t\t\t\tvar area = this._int_getArea( x, y, x, y );\n\t\t\t\tthis._int_addChange( area );\n\n\t\t\t\tif( this.pokeFlush ) {\n\t\t\t\t\tthis._int_flush();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tcatch( e ) {\n\t\t\t\tthrow \"Cannot pokec to adress (\" + x + \",\" + y + \")\";\n\t\t\t}\n\t\t}\n\n\t\ttriggerFlush() {\n\n\t\t\tthis._int_flush();\n\t\t}\n\n\t\t_int_initMode( w, h ) {\n\n\t\t\tif( this.initialized ) {\n\t\t\t\tthis.destroy();\n\t\t\t}\n\t\t\tvar sys = this.sys;\n\t\t\t//var msgs = sys.init.queuedMessages; TODO, what to do with queued messages\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\n\t\t\tthis.rows = h;\n\t\t\tthis.cols = w;\n\n\t\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\n\t\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\t\tthis.cellel = [];\n\t\t\tfor( var y=0; y<this.rows; y++) {\n\t\t\t\tvar rowArray = [];\n\t\t\t\tfor( var x=0; x<this.cols; x++) {\n\t\t\t\t\tvar cell = {\n\t\t\t\t\t\ttxt: \" \",\n\t\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t\t}\n\t\t\t\t\trowArray.push( cell );\n\t\t\t\t}\n\t\t\t\tthis.cellel.push( rowArray );\n\t\t\t}\n\n\t\t\tthis.changes = { all: true, list: [] };\n\n \t\t  var _this = this;\n\n\t\t\tthis._int_flushAll();\n\n\t\t\tthis.sys.log(\"TEXTAREA w Ready.\");\n\n\t\t\tthis.initialized = true;\n\t\t\tthis.pokeFlush = true;\n\t\t\t/* if true then all pokes in \"character memory\" will be flushed immediately to the */\n\t\t\t/*main browswer process */\n\t}\n\n\n\tgetDimensions() {\n\t\t\treturn [this.cols, this.rows ];\n\t}\n\n\tgetCurrentLine() {\n\t\tvar y = this.y;\n\t\tvar str = \"\";\n\t\tfor( var i = 0; i< this.acols; i++) {\n\t\t\tvar xi = i + this.ax0;\n\t\t\tstr += this.cellel[ y ][ xi ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\tgetLineFrom( x0, y ) {\n\n\t\tvar str = \"\";\n\t\tvar x2 = this.acols + this.ax0 - 1;\n\n\t\tfor( var i = x0; i< x2; i++) {\n\t\t\tstr += this.cellel[ this.ay0 + y ][ i ].txt;\n\t\t}\n\t\treturn str;\n\t}\n\n\t/* Commands and functions to modify the text area buffer */\n\n\n\tsetDefault( fg, bg ) {\n\t\tthis.defaultBG = bg;\n\t\tthis.defaultFG = fg;\n\n\t}\n\n\n\tcolorReset() {\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\t//this.cellel = [];\n\t\tvar fg = this.defaultFG;\n\t\tvar bg = this.defaultBG;\n\n\t\tfor( var ay=0; ay<this.rows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = ay;\n\t\t\tfor( var ax=0; ax<this.cols; ax++) {\n\n\t\t\t\tvar x = ax;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x];\n\n\t\t\t\tcell.fg = fg;\n\t\t\t\tcell.bg = bg;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis._int_flushAll();\n\t}\n\n\treset() {\n\t\tthis.textArea( this.cols, this.rows, -1, -1 );\n\n\t\tthis.colors.txtBgColor= this.defaultBG;\n\t\tthis.colors.txtColor = this.defaultFG;\n\n\t\tthis.pokeFlush = true;\n\t\tthis.clear();\n\n\t}\n\n\ttextArea( w, h, xo, yo ) {\n\t\tvar divx = this.cols - w;\n\t\tvar divy = this.rows - h;\n\n\t\tif( xo < 0 ) {\n\t\t\t\tthis.ax0 = Math.floor(divx / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ax0 = xo;\n\t\t}\n\n\t\tif( yo < 0 ) {\n\t\t\t\tthis.ay0 = Math.floor(divy / 2);\n\t\t}\n\t\telse {\n\t\t\tthis.ay0 = yo;\n\t\t}\n\n\t\tthis.acols = w;\n\t\tthis.arows = h;\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\t}\n\n\tclear() {\n\n\t\t//this.cellel = [];\n\t\tfor( var ay=0; ay<this.arows; ay++) {\n\t\t\t//var rowArray = [];\n\n\t\t\tvar y = this.ay0 + ay;\n\t\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\t\tvar x = this.ax0 + ax;\n\n\t\t\t\tvar cell = {\n\t\t\t\t\ttxt: \" \",\n\t\t\t\t\tfg: this.colors.txtColor,\n\t\t\t\t\tbg: this.colors.txtBgColor\n\t\t\t\t}\n\t\t\t\tthis.cellel[ y ][ x] = cell;\n\t\t\t}\n\t\t\t//this.cellel.push( rowArray );\n\t\t}\n\n\t\tthis.changes = { all: true, list: [] };\n\n\t\tthis.x = this.ax0;\n\t\tthis.y = this.ay0;\n\n\t\tthis._int_flushAll();\n\t}\n\n\n\tjumpTo( destination ) {\n\t\tif( destination == \"home\" ) {\n\t\t\tthis.y = this.ay0;\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\tif( destination == \"end\" ) {\n\t\t\tthis.y = this.ay0 + this.arows - 1;\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"line-start\" ) {\n\t\t\tthis.x = this.ax0;\n\t\t}\n\t\telse if( destination == \"line-end\" ) {\n\t\t\tthis.x = this.ax0 + this.acols - 1;\n\t\t}\n\t\telse if( destination == \"text-end\" ) {\n\n\t\t\t/* where is the last char -> maxX */\n\t\t\tvar c = \"DC\";\n\t\t\tvar oldx = this.x;\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\n\t\t\tvar maxX = this.x;\n\t\t\t/*-reset, and jump to end of next text area-*/\n\t\t\tthis.x = oldx;\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x< ((this.ax0 + this.acols)-1) && c != \" \") {\n\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\n\n\t\t\t/*make sure we did not jump past last char*/\n\t\t\tif( this.x > maxX ) {\n\t\t\t\tthis.x = maxX;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-end-all\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\tthis.x = ((this.ax0 + this.acols)-1);\n\t\t\tvar max = ((this.ax0 + this.acols)-1);\n\n\t\t\twhile( this.x >= this.ax0 ) {\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t\t\t\tif( c != \" \" ) {\n\t\t\t\t\t\t\tthis.x++;\n\t\t\t\t\t\t\tif( this.x > max) {\n\t\t\t\t\t\t\t\tthis.x = max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( destination == \"text-start\" ) {\n\t\t\tvar c = \"DC\";\n\t\t\twhile( this.x> this.ax0 && c != \" \") {\n\t\t\t\t\t\tthis.x--;\n\t\t\t\t\t\tc = this.cellel[ this.y ][ this.x ].txt;\n\t\t\t}\n\t\t}\n\n\t\tthis._int_flush();\n\t}\n\n\tcursorMove( dir ) {\n\t\tif( dir == \"up\" ) {\n\t\t\tif( this.y>this.ay0) {\n\t\t\t\tthis.y--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"down\" ) {\n\t\t\tif( this.y< ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.y++;\n\t\t\t}\n\t\t\telse if( this.y== ((this.ay0 + this.arows)-1)) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t}\n\t\tif( dir == \"left\" ) {\n\t\t\tif( this.x>this.ax0) {\n\t\t\t\tthis.x--;\n\t\t\t}\n\t\t}\n\t\telse if( dir == \"right\" ) {\n\t\t\tif( this.x< ((this.ax0 + this.acols)-1)) {\n\t\t\t\tthis.x++;\n\t\t\t}\n\t\t}\n\t\tthis._int_flush();\n\t}\n\n\tbackspace() {\n\t\tif( this.x != this.ax0 ) {\n\t\t\t\tthis.x--;\n\t\t}\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tdelete() {\n\n\t\tthis.__int_scrollLineLeftFrom( this.x, this.y );\n\n\t\tvar area = this._int_getArea( this.x, this.y, this.cols-1, this.y, );\n\t\tthis._int_addChange( area );\n\t\tthis._int_flush();\n\t}\n\n\tnl() {\n\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\n\t\t\tif( ya >= this.arows ) {\n\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\n\t\t\t\tthis._int_flushAll();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_nl() {\n\t\t\tthis.x = this.ax0;\n\t\t\tthis.y ++;\n\t\t\tvar ya = this.y - this.ay0;\n\t\t\tif( ya >= this.arows ) {\n\t\t\t\tthis.__int_scrollDown();\n\t\t\t\tthis.y = this.ay0 + (this.arows -1);\n\t\t\t\treturn { scroll: true }\n\t\t\t}\n\t\t\treturn { scroll: false }\n\n\t}\n\n\twriteln( str ) {\n\n\t\t\tfor( var i=0; i<str.length; i++) {\n\t\t\t\tvar c = str.substr(i,1);\n\t\t\t\tthis.__int_write_direct_ch( c );\n\t\t\t}\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\t\t\tthis._int_flush();\n\t}\n\n\t_int_write( str, insert ) {\n\t\tfor (const c of str) {\n\t\t\tthis.__int_write_direct_ch( c, insert );\n\t\t}\n\t}\n\n\twrite( str ) {\n\t\t\tthis._int_write( str );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\tinsert( str ) {\n\t\t\tthis._int_write( str, true );\n\n\t\t\tthis._int_flush();\n\t}\n\n\n\n\n\t__int_scrollLinesDownFrom( y  ) {\n\n\t\t\tfor( var yy=this.rows-1; yy>y; yy-- ) {\n\t\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\t\tvar cell1 = this.cellel[ yy-1  ][ xx ];\n\t\t\t\t\tvar cell2 = this.cellel[ yy  ]  [ xx];\n\n\t\t\t\t\tcell2.fg = cell1.fg;\n\t\t\t\t\tcell2.bg = cell1.bg;\n\t\t\t\t\tcell2.txt = cell1.txt;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( var xx=0; xx<this.cols; xx++ ) {\n\n\t\t\t\tvar cell1 = this.cellel[ yy  ][ xx ];\n\n\t\t\t\tcell1.txt = \" \";\n\n\t\t\t}\n\n\t\t\tthis._int_addChangeAll();\n\n\t}\n\n\n\tScrollDownByCurrentLine() {\n\n\t\tif( (this.y ) < (this.rows-1) ) {\n\t\t\tthis.__int_scrollLinesDownFrom( this.y );\n\t\t\tthis._int_flush();\n\t\t}\n\t}\n\n\t__int_scrollLineRightFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x1; i>x0; i--) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i-1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\t}\n\n\t__int_scrollLineLeftFrom( x0, y  ) {\n\n\t\tvar x = x0;\n\t\tvar x1 = this.ax0 + this.acols - 1;\n\n\t\tif( x0 == x1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=x0; i<x1; i++) {\n\t\t\tvar cell1 = this.cellel[ y  ][ i +1 ];\n\t\t\tvar cell2 = this.cellel[ y  ][ i ];\n\n\t\t\tcell2.fg = cell1.fg;\n\t\t\tcell2.bg = cell1.bg;\n\t\t\tcell2.txt = cell1.txt;\n\t\t}\n\n\n\t}\n\n\t__int_write_direct_ch( ch, insert ) {\n\n\t\tvar code = ch.codePointAt(0);\n\n\t\tif( this.dc && this.dcCmd ) {\n\n\t\t\tthis.dc = false;\n\t\t\tthis.dcCmd = false;\n\t\t\tthis._int_control( this.dcCmdCode, code );\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( this.dc && !this.dcCmd ) {\n\t\t\tthis.dcCmd = true;\n\t\t\tthis.dcCmdCode = code;\n\t\t\treturn;\n\t\t}\n\n\t\tif( code == 17 ) {\n\t\t\t//DC1\n\t\t\tthis.dc = true;\n\t\t\tthis.dcCmd = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar cell = this.cellel[ this.y ][ this.x ];\n\n\t\tif( cell == null ) {\n\t\t\tconsole.log( \"cell at \" + this.x + \",\" + this.y +\" == null \");\n\t\t\treturn;\n\t\t}\n\n\t\tvar area;\n\n\t\tif( insert ) {\n\t\t\tthis.__int_scrollLineRightFrom( this.x, this.y );\n\n\t\t\tarea = this._int_getArea( this.x, this.y, this.ax0 + this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\n\t\t}\n\n\t\tcell.txt = ch;\n\n\t\tif( !this.reverse  ) {\n\t\t\tcell.fg = this.colors.txtColor;\n\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t}\n\t\telse {\n\t\t\tcell.bg = this.colors.txtColor;\n\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t}\n\n\t\tvar oldx = this.x;\n\t\tvar oldy = this.y;\n\n\t\tthis.x++;\n\t\tvar ax = this.x - this.ax0;\n\t\tif( ax > (this.acols-1) ) {\n\t\t\tthis.x = this.ax0;\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\tthis._int_addChangeAll();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tarea = this._int_getArea( oldx, oldy, oldx, oldy );\n\t\tthis._int_addChange( area );\n\t\t//this._int_addChangeAll();\n\n\t}\n\n\twritec( chr ) {\n\n\t\tif( chr == \"\\n\" ) {\n\t\t\tvar stat = this.__int_nl();\n\t\t\tif( stat.scroll ) {\n\t\t\t\t\tthis._int_addChangeAll();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tthis.__int_write_direct_ch( chr );\n\t\tthis._int_flush();\n\t}\n\n\n\t_int_control( chr, data ) {\n\n\t\tif( chr == 16 ) {\n\t\t\tthis.colors.txtColor = data;\n\t\t}\n\t\telse if( chr == 17 ) {\n\t\t\tthis.colors.txtBgColor = data;\n\t\t}\n\t\telse if( chr == 18 ) {\n\t\t\tthis.sys.post( \"border\", { d: data }  );\n\t\t}\n\t\telse if( chr == 24 ) {  //CANCEL -> (we map it to) Clear Screen\n\t\t\tthis.clear();\n\t\t}\n\t\telse if( chr == 12 ) {  //FORMFEED -> (we map it to) RESET SCREEN\n\t\t\tthis.reset();\n\t\t}\n\t\telse if( chr == 25 ) {  //End of Medium -> (we map it to) Hide\n\t\t\t//this.hide();   TODO\n\t\t}\n\t\telse if( chr == 64 ) {\n\t\t\tthis.reverse = false;\n\t\t}\n\t\telse if( chr == 65 ) {\n\t\t\tthis.reverse = true;\n\t\t}\n\t\telse {\n\t\t\tthis.__int_write_direct_ch( \"?\" );\n\t\t}\n\t}\n\n\n\tsetPos( x, y ) {\n\n\t\tthis._int_setPos( x,y );\n\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorMode( mode ) {\n\t\tthis.cursorMode = mode;\n\t\tthis._int_flush();\n\t}\n\n\tsetCursorPos( x, y ) {\n\t\tif( x<0 || y<0 ) { throw \"pos(\"+x+\",\"+y+\") < 0\" ; }\n\n\t\tif( x>=this.acols || y>= this.arows ) { throw \"pos(\"+x+\",\"+y+\") > max\" ; }\n\n\t\tthis.x = x + this.ax0;\n\t\tthis.y = y + this.ay0;\n\n\t\tthis._int_flush();\n\t}\n\n\tgetCursorPos() {\n\t\t\treturn [this.x - this.ax0, this.y - this.ay0 ];\n\t}\n\n\tcontrol( chr, data ) {\n\n\t\tthis._int_control( chr, data );\n\t\tthis._int_flush();\n\n\t}\n\n\n\t_int_setPos( x, y ) {\n\n\t\tif(x >= 0) {\n\t\t\t\tthis.x = x + this.ax0;\n\t\t}\n\t\tif(y >= 0) {\n\t\t\t\tthis.y = y + this.ay0;\n\t\t}\n\n\t\tif( this.x >= this.acols ) { this.x = this.acols-1;}\n\t\tif( this.y >= this.arows ) { this.y = this.arows-1;}\n\t}\n\n\tcenter( str ) {\n\n\t\t\tif( str.length > this.cols ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar l = str.length;\n\t\t\tvar l2 = l/2;\n\n\t\t\tvar wh = [ this.acols, this.arows ];\n\n\t\t\tvar x = Math.floor( (wh[0] / 2)-l2 );\n\t\t\tthis._int_setPos( x, -1 );\n\t\t\tthis._int_write( str );\n\t\t\tthis.__int_nl();\n\n\t\t\tvar area = this._int_getArea( this.ax0, this.y, this.acols-1, this.y );\n\t\t\tthis._int_addChange( area );\n\t\t\tthis._int_flush();\n\n\t}\n\n\t__int_scrollDown() {\n\n\t\tvar ax0 = this.ax0;\n\t\tvar ay0 = this.ay0;\n\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\t\t\tfor( var ay=0; ay<this.arows-1; ay++) {\n\n\t\t\t\tvar y = ay + ay0;\n\n\t\t\t\tvar cell = this.cellel[ y ][ x ];\n\t\t\t\tvar cellyp1 = this.cellel[ y+1 ][ x ];\n\n\t\t\t\tcell.txt = cellyp1.txt;\n\t\t\t\tcell.fg = cellyp1.fg;\n\t\t\t\tcell.bg = cellyp1.bg;\n\t\t\t}\n\t\t}\n\n\t\t//fill last row\n\t\tvar y2 = ay0 + (this.arows-1);\n\t\tfor( var ax=0; ax<this.acols; ax++) {\n\n\t\t\tvar x = ax + ax0;\n\n\t\t\tvar cell = this.cellel[ y2 ][ x ];\n\t\t\tcell.txt = \" \";\n\t\t\tif( !this.reverse  ) {\n\t\t\t\tcell.fg = this.colors.txtColor;\n\t\t\t\tcell.bg = this.colors.txtBgColor;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcell.fg = this.colors.txtBgColor;\n\t\t\t\tcell.bg = this.colors.txtColor;\n\t\t\t}\n\t\t}\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/bitmap.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/bitmap.js\n\nclass BitMap {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n    this.lineColor = 1;\n    this.changes = {};\n    this.changes.flag = false;\n    this.changes.pixels = [];\n\n\t\tthis.origin( 0,0,1,1);\n  }\n\n\n\torigin( ox0, oy0, odx, ody ) {\n\t\tthis.ox0 = ox0;\n\t\tthis.oy0 = oy0;\n\t\tthis.odx = odx;\n\t\tthis.ody = ody;\n\n\t\tvar dir = [\"m\",undefined,\"p\"];\n\t\tvar xdir = \"x\" + dir[ odx + 1 ];\n\t\tvar ydir = \"y\" + dir[ ody + 1 ];\n\t\tvar direction = xdir + ydir;\n\n\t\tthis[\"_int_convertxy\"] = this.getConvertFunc( direction );\n\n\t}\n\n\treInit( w, h ) {\n\t\tthis.width = w;\n    this.height = h;\n\t}\n\n  attach( w, h ) {\n\t\tthis.reInit( w, h );\n\t}\n\n  isActive() {\n    return this.width > 0;\n  }\n\n  getDimensions() {\n\t\t\treturn [this.width, this.height ];\n\t}\n\n  triggerFlush() {\n\n    this._int_flush();\n\n  }\n\n  _int_flush() {\n\n    if( this.changes.flag ) {\n\n      this.sys.post( \"gfxupdate\",\n        {\n          pixels: this.changes.pixels\n        }\n      );\n    }\n\n    pixels: this.changes.pixels = [];\n    this.changes.flag = false;\n\n  }\n\n\tsetLineColor( c ) {\n    this.lineColor = c;\n    this.sys.post( \"nativeout\",{\n      action: \"gcolor\",\n      params: { c: c }\n    });\n  }\n\n\tgetConvertFunc( direction ) {\n\t\tvar __this = this;\n\t\tif( direction == \"xpyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + __this.ox0), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xpym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmyp\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor(y + __this.oy0)];\n\t\t\t}\n\t\t}\n\t\telse if( direction == \"xmym\") {\n\t\t\treturn function( x,y ) {\n\t\t\t\treturn [ Math.floor( __this.ox0 - x ), Math.floor( this.oy0 - y ) ];\n\t\t\t}\n\t\t}\n\t}\n\n/*\n\t_int_convertxy_xpyp( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor(y + this.oy0)];\n\t}\n\n\t_int_convertxy_xpym( x,y ) {\n\t\treturn [ Math.floor(x + this.ox0), Math.floor( this.oy0 - y )];\n\t}\n\n\t_int_convertxy_xmyp( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( y + this.oy0)];\n\t}\n\n\t_int_convertxy_xmym( x,y ) {\n\t\treturn [ Math.floor( this.ox0 - x), Math.floor( this.oy0 - y )];\n\t}\n*/\n\n  plot( x, y ) {\n\t\tvar xy2 = this._int_convertxy( x, y );\n\n    var pixel = { x: xy2[0], y: xy2[1], c:this.lineColor };\n\n    this.changes.pixels.push( pixel );\n    this.changes.flag = true;\n\n  }\n\n\tline( x0,y0, x1, y1 ) {\n\n\t\tvar xy0 = this._int_convertxy( x0, y0 );\n\t\tvar xy1 = this._int_convertxy( x1, y1 );\n\n    this.sys.post( \"nativeout\",{\n      action: \"line\",\n      params: { x0:xy0[0], y0:xy0[1], x1:xy1[0], y1:xy1[1] }\n    });\n  }\n\n\tdestroy() {\n\n\t}\n}\n\n//--EOC \n\n// ## ../../rwbuffers/worker/audio.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/../../rwbuffers/worker/audio.js\n\nclass Audio {\n\n\tconstructor( sys ) {\n\t\tthis.sys = sys;\n\t\tthis.userInput = false;\n  }\n\n\tflagUserInput() {\n\t\tthis.userInput = true;\n\t}\n\n  playBeep( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playBeep\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tplaySound( channel, frequency, len ) {\n\n\t\tif( !this.userInput ) { return; }\n    this.sys.post( \"audio\",\n    {\n          method: \"playSound\",\n\t\t\t\t\tparCount: 3,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: frequency,\n\t\t\t\t\tp3: len\n    }\n    );\n  }\n\n\tvolume( volume ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"setVolume\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: volume\n\t\t}\n\t\t);\n\t}\n\n\treset() {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t\t{\n\t\t\t\t\t\tmethod: \"reset\",\n\t\t\t\t\t\tparCount: 0\n\t\t\t}\n\t\t\t);\n\n\t}\n\n\tattackDecayRelease( channel, attackT, decayT, releaseT ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetAttackDecayRelease\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: attackT,\n\t\t\t\t\tp3: decayT,\n\t\t\t\t\tp4: releaseT\n\t\t}\n\t\t);\n\t}\n\n\tchannelVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelVolume\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\tchannelFrequency( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelFrequency\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\n\tchannelSustainVolume( channel, v ) {\n\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"channelSetSustainLevel\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: v\n\t\t}\n\t\t);\n\t}\n\n\taddEffect( channel,  type , value, time ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"addEffect\",\n\t\t\t\t\tparCount: 4,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: type,\n\t\t\t\t\tp3: value,\n\t\t\t\t\tp4: time\n\t\t}\n\t\t);\n  }\n\n  clearEffect( channel ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"clearEffect\",\n\t\t\t\t\tparCount: 1,\n\t\t\t\t\tp1: channel\n\t\t}\n\t\t);\n\n  }\n\n\tplayEffect( channel, freq ) {\n\t\tif( !this.userInput ) { return; }\n\t\tthis.sys.post( \"audio\",\n\t\t{\n\t\t\t\t\tmethod: \"playEffect\",\n\t\t\t\t\tparCount: 2,\n\t\t\t\t\tp1: channel,\n\t\t\t\t\tp2: freq\n\t\t}\n\t\t);\n\n\t}\n\n}\n\n//--EOC \n\n// ## workerbootstrap_static.js ==========---------- \n// -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -\n//  src/sys/modules/basic/worker/workerbootstrap_static.js\n//  BY packworkers.js -- src/sys/modules/basic/worker/workerbootstrap_static.js\n\nsys.log(\"Starting\");\nstart_sys();\n\n//--EOC \n\n"],"names":["sys","appName","unique","console","post","type","message","postMessage","log","args","Array","prototype","slice","call","arguments","args2","i","length","push","JSON","stringify","logerr","load","rt","path","device","processId","loaddata","label","save","data","delete","dir","setcfg","cfg","this","listfs","poststatus","procId","status","setfs","fs","setDisplayMode","m","blinkMode","html","executeFunction","htmlnode","get","wait_for_result","export","code","destination","signalHideMenu","flag","hide","init_sys","BasicArray","constructor","name","indices","defaultValue","buffer","getIndexCount","_check","detail","set","val","ptr","last","undefined","ErrorHandler","newError","clazz","context","lineNr","throwError","fromSimpleExternalError","s","lineNr0","parts","split","err","extCode0","extCode1","fromSerializedError","isSerializedError","substr","e","startsWith","isError","Object","toString","clss","Editor","output","out","keyMode","addRunTime","runTime","keyHandlerForCLE","keyLabel","shiftKey","ScrollDownByCurrentLine","backspace","ctrlKey","cursorMove","jumpTo","clear","insert","write","setCursorMode","key","command","getCurrentLine","writeln","executeInteractiveLine","interactiveKeyHandler","BasicRuntime","editor","debugFlag","listSpeed","bitmap","bout","input","audio","setHandler","setInterActive","menuEnable","program","runFlag","waitForMessageFlag","waitForMessageVariable","executeLineFlag","goPlayExampleFlag","breakCycleFlag","inputFlag","listFlag","immersiveFlag","statusChanged","gosubReturn","nullTime","Date","getTime","turboMode","cmdCountPerCycleDefault","cmdCountPerCycleTurbo","cmdCountPerCycle","commands","BasicCommands","extendedcommands","ExtendedCommands","erh","vars","functions","loadedData","default","loadedLabel","kbBuffer","yPos","SHORTLINE","LONGLINESTART","LONGLINEEND","forContext","outputCallBacksAll","lineOverFlow","method","scroll","clearScreen","outputCallBacksClScr","synchClock","exitMode","code2colMap","km","symbolTable","up","down","left","right","black","white","red","cyan","purple","green","blue","yellow","orange","brown","pink","grey1","grey2","grey3","backmap","mapInfo","entries","symbolTableBM","flagStatusChange","getScopeVars","getFullVarList","scopes","getFullScopes","varList","si","fullscope","scope","names","getOwnPropertyNames","value","descr","ii","endsWith","cpuNeeded","getStatus","runPointer","vlen","getVars","pgmLen","varLen","displayMode","startWaitForMessage","start","autoStartAfterLoad","path0","getProgramAsText","deleteFile","variable","keyInterrupt","_type","_data","interrupt","_ix","interruptFlag0","interruptFlag1","line","useLabel","handlers","interrupt0","interrupt0ParamIsLabel","interrupt1","interrupt1ParamIsLabel","newScope","runPointer2","variables","setVar","toUpperCase","pgm","len","found","labels","receiveMessage","_message","reInit","textW","textH","bitmapW","bitmapH","mode","printError","reason","pgmData","ok","bootPGM","control","runPGM","stop","insertData","isRunning","list","title","files","fname","enterListMode","currentFs","str","deviceNumberLen","stopAfterMessage","HandleStopped","printReady","runStop","listStop","cxy","getCursorPos","string","getLineFrom","inputStartInputPosX","handleLineInput","x","xy","setCursorPos","toggleMenu","startingProgram","flush","importPGMHandler","content","filename","textLinesToBas","fileName","setProgram","exitProgram","closeWindow","windowId","listPointer","printLine","listFlagBakInteractive","getInterActive","setExitMode","v","nullClock","setHours","setSeconds","setMinutes","setMilliseconds","setTurbo","on","appendProgram","exists","j","sort","a","b","getProgram","getProgramState","setProgramState","pgmState","_setByteBits","bits","byte","_getByteBits","masks","results","upperFirst","supressLine","explicitline","line1","onLineStr","printInfo","printHelp","reverseOn","print","colorReset","colors","setDefault","fg","bg","border","resetConsole","getDimensions","reset","setPos","getMillis","getJiffyTime","millis","Math","floor","hours","minutes","hard","muteReady","writel","clrPGM","compressPGMText","pgmTxt","p","Parser","init","kws","getKeyWordCodes","txt2","kw","replaceAll","toLowerCase","String","fromCharCode","getProgramAsTextNoPETSCII","text","l","prepareLineForExportNoPETSCII","trim","getProgramSize","controlKW","prepareLineForExport","txt0","txt","dst","c","charCodeAt","symdef","charAt","src","str1","str2","rv","indexOf","replace","rebuildNoPETSCIILineString","raw","noPetsciiLine","parseLine","toLower","cc","prevCharIsQuote","nextCharIsQuote","dst2","ResolveStringSymbolToCode","prepareLineForImport","num","parseInt","getProgramLines","padZeros2","evalExpressionPart","parseFloat","PI","varIntName","arr","ai","evalExpression","values","params","par","ecommands","cmds","nFunName","functionName","stc","fName","parValue","restore","functRecord","expr","op","pow","negate","binaryNegate","exitInputState","breakCycle","cycle","cmdCount","lineNumber","isActive","triggerFlush","changeCount","countdown","listCodeLine","bf","runCommands","traceVars","tvi","thisVar","thisValue","oldValue","traceOldValues","traceList","af","executedCount","retreiveRuntimeLine","doReturn","oldPointers","pop","doInterruptReturn","closeScope","gosub","line0","retLine","retCmd","goto","startAsGoto","isListing","isInput","isReady","getDataBlocks","readData","dataPointer","result","getDataLength","setData","label0","typeParts","parseSimpleDataI_CSV","toArr","data2","parseSimpleDataS_CSV","parseSimpleDataS_LINES","printChar","rawLine","rebuildLineString","nr","removePadding","renumbering","addSmartPadding","shortenKeywords","newString","tokens","getTokens","nopadTokens","foundGoto","foundGotoParIndex","newLine","lineIsData","lineIsRem","lineIsSub","renumberProgram","gap","newLineNr","lineNumbers","newLineNr2","ceil","lRec","PETSCIIreplace","keywordCompress","compressProgram","normalizeProgram","restoreDataPtr","normalizeData","dataRec","bak1","bak2","normalize","k","doForInit","from","to","step","varName","cmdPointer","cmdArrayLen","linePointersLen","ctx","ctxv","doForNext","nextVarName","retreiveLine","parseLineNumber","commandToString","cmd","statementName","var","limit","TERMINATE_W_JUMP","end","cnt","cn","onCommand","onExpr","onLineNrs","jump","nextVar","ix","arrRec","arrayNames","pardefs","mycommands","enabled","varType0","varType","arrayAssignment","expression","getArray","getTraceList","setTraceVar","resetTraceVar","old","oldProgram","new","removePgmLine","linenr","pgm2","pl","padSpaces6","no","padSpaces8","insertPgmLine","insertPgmLineLocal","myProgram","lines","exception","parseErrorLine","startConsoleDataInput","inputVars","inputVarsPointer","isInputCommand","qMark","isNaN","basicCmds","runtime","func","statementList","getStatements","stats","stats2","getFunctions","getAllCategories","categoryIndexes","getCategories","categoryIndexes2","CommandHelp","getCategoriesNormalize","getCategoriesIntermediate","_stat_info_help","_stat_help","pars","catRecord","lst","catLists","hlpctx","lbl","attr","attribs","padLen","pad","description","_if_cls","_stat_info_cls","_stat_cls","_stat_info_reset","_stat_reset","_stat_info_menu","_stat_menu","_stat_info_reverse","_stat_reverse","reverse","_stat_info_beep","_stat_beep","playBeep","_stat_info_sound","_stat_sound","playSound","_stat_info_setadr","_stat_setadr","attackDecayRelease","_stat_info_volume","_stat_volume","volume","_stat_info_chfreq","_stat_chfreq","channelFrequency","_stat_info_chvolume","_stat_chvolume","channelVolume","_stat_info_chsvolume","_stat_chsvolume","channelSustainVolume","_stat_info_addfx","_stat_addfx","addEffect","_stat_info_clearfx","_stat_clearfx","clearEffect","_stat_info_playfx","_stat_playfx","freq","playEffect","_stat_info_textarea","_stat_textarea","cols","round","rows","wh","xo","yo","divx","divy","textArea","_stat_info_gcolor","_stat_gcolor","col","setLineColor","_stat_info_origin","_stat_origin","origin","_stat_info_line","_stat_line","_stat_info_plot","_stat_plot","plot","_stat_info_center","_stat_center","center","_stat_info_gtext","_stat_gtext","gtext","_stat_info_immediate","_stat_immediate","setPokeFlush","_stat_info_pokeccl","_stat_pokeccl","pokeccl","_stat_info_pokec","_stat_pokec","pokec","_stat_info_pokecl","_stat_pokecl","pokecl","_stat_info_pokebcl","_stat_pokebcl","_stat_info_locate","_stat_locate","row","_stat_info_hide","_stat_hide","_if_html","_stat_info_html","_stat_html","handleIx","htmlHandle","htmlValue","htmlAppend","exparts","exparts2","_stat_info_htmlnode","_stat_htmlnode","node","_stat_info_htmlbg","_stat_htmlbg","url","_stat_info_color","_stat_color","bgcol","_stat_info_display","_stat_display","modes","screenModes","_stat_info_border","_stat_border","bcol","_stat_info_export","_stat_export","_stat_info_copy","_stat_copy","_stat_info_txtcopy","_stat_txtcopy","_fun_info_peekcl","_fun_peekcl","peekcl","_fun_info_peekc","_fun_peekc","peekc","_fun_info_ucbase","_fun_ucbase","baseLabel","_fun_info_uc_DLR_","_fun_uc_DLR_","fromCodePoint","_fun_info_dc_DLR_","_fun_dc_DLR_","_fun_info_html_DLR_","_fun_html_DLR_","_fun_info_width","_fun_width","_fun_info_height","_fun_height","_fun_info_cols","_fun_cols","_fun_info_columns","_fun_columns","_fun_info_rows","_fun_rows","pgmman","addRuntime","keyLabelCodes","randnrs","random","randIndex","randStep","_stat_info_new","_stat_new","_stat_info_list","_stat_list","_if_get","_if_getkey","_if_read","_if_input","_if_list","_if_run","_stat_info_read","_stat_read","p0","_stat_info_get","_stat_get","getKey","_stat_info_getkey","_stat_getkey","_stat_info_input","_stat_input","con","_stat_info_restore","_stat_restore","_stat_info_load","_stat_load","aSync","_stat_info_setdata","_stat_setdata","_stat_info_datablocks","_stat_datablocks","_stat_info_loaddata","_stat_loaddata","_stat_info_dir","_stat_dir","_stat_info_fs","_stat_fs","_stat_info_renumber","_stat_renumber","_stat_info_vars","_stat_vars","_stat_info_tracevar","_stat_tracevar","_stat_info_clrtracevar","_stat_clrtracevar","_stat_info_boot","_stat_boot","_stat_info_save","_stat_save","_stat_info_delete","_stat_delete","_stat_info_run","_stat_run","_if_print","isNumber","isFinite","normalizeIfNumber","_stat_info_print","_stat_print","nl","_stat_info_clr","_stat_clr","_fun_info_datalen","_fun_datalen","_fun_info_chr_DLR_","_fun_chr_DLR_","_fun_info_str_DLR_","_fun_str_DLR_","number","base","numberStr","_fun_info_abs","_fun_abs","_fun_info_len","_fun_len","_fun_info_asc","_fun_asc","_fun_info_val","_fun_val","_fun_info_hex2dec","_fun_hex2dec","_fun_info_hex_DLR_","_fun_hex_DLR_","_fun_info_exp","_fun_exp","exp","intGetNextRand","intSeedRand","x0","year","day","d","seedModifier","_fun_info_pad_DLR_","_fun_pad_DLR_","ch","dest","toPad","_fun_info_rnd","_fun_rnd","_fun_info_sqr","_fun_sqr","sqrt","_fun_info_log","_fun_log","_fun_info_pos","_fun_pos","getLinePos","_fun_info_left_DLR_","_fun_left_DLR_","_fun_info_right_DLR_","_fun_right_DLR_","_fun_info_mid_DLR_","_fun_mid_DLR_","_fun_info_sin","_fun_sin","sin","_fun_info_tri","_fun_tri","abs","_fun_info_saw","_fun_saw","_fun_info_tan","_fun_tan","tan","_fun_info_atn","_fun_atn","atan","_fun_info_cos","_fun_cos","cos","_fun_info_spc","_fun_spc","_max","_fun_info_int","_fun_int","_fun_info_range","_fun_range","min","max","_fun_info_tab","_fun_tab","_fun_info_sgn","_fun_sgn","_fun_info_millis","_fun_millis","_fun_info_jiffies","_fun_jiffies","ecmds","CTRL_KW","SHORTCUT_KW","KEYWORDS","more","screenCodes2CTRLTable","tab","KWCODES","padArray","missing","clazz2","upperCaseNameTokens","token","tokens2","mergeCompTokens","token2","mergeBrokenUpTokens","splits","p1","p2","p3","whole","r","mergeTokenRange","record","tokens3","parseFunParList","even","endTokens","parseBoolExpression","shift","peekIfNextIsOpenBracket","parseSubExpression","tokensToString","endTokensToString","endTokenArray","et","endToken","isEndToken","endTokenArry","parseSimpleExpression","endLoop","returnValue","pair","endTokens0","first","eList","parseExpression","opData","dbg","dbg2","retExpr","newParts","part","unshift","subEndTokens","isUserDefinedFunctionCall","parameters","subExpression","groupParts","oldExpression","parts0","parts1","parts2","prevPart","subExpr","normalizeStatementName","parseAssignment","preTokens","nameToken","token0","parseArrayAssignment","parseControlStructure","controlToken","expr_fn","nums","onInterrupt","num0","onType","labelFlag","expr_from","expr_to","expr_step","explicit","nextcommand","expr1","block","parseLineCommands","bi","dataArray","parseStatementCall","endCommand","keyword","oken","logTokens","tokensStr","tok","Tokenizer","StringReader","tokenize","lineRest","errContext","lineRecord","toker","merge","noPadding","strIn","index","lineIndex","peek","peek2","unconsume","consume","EOF","reader","keywords","greedy","isOpChar","match","isCompChar","isEqChar","isNameChar","endFound","prev","seq","isNumChar","isPadChar","isCommandSepChar","isSepChar","isAnyChar","isBracket","isStrChar","inString","normalizeToken","tok0","readChars","read","type0","compareF","tokenType","parseRules","tokenFound","rule","categoryIndexesInt","funs","cat","f_attribs","catlabel","rname","processes","fastProcesses","fastProcessesIds","count","_this","setInterval","stat","cpuHungry","fpID","nfpArr","el","getTicks","old_register","obj","newId","id","register","getRoot","keyPress","interactive","hc","handlerClazz","inputKeyHandler","cursorOn","y","hidden","dc","dcCmd","defaultFG","defaultBG","txtBgColor","txtColor","initialized","changes","all","pokeFlush","w","h","_int_initMode","destroy","cellel","_int_addChangeAll","_int_addChange","area","clist","lc","nc","y1","y2","x1","x2","changesTargetArray","cells","cell","_int_flushAll","_int_flush","_int_getArea","cx","cy","cursorMode","areasList","attach","codePointAt","rowArray","acols","xi","ax0","ay0","ay","ax","arows","oldx","maxX","__int_scrollDown","__int_scrollLineLeftFrom","__int_nl","__int_write_direct_ch","_int_write","__int_scrollLinesDownFrom","yy","xx","cell1","cell2","__int_scrollLineRightFrom","_int_control","dcCmdCode","oldy","writec","chr","_int_setPos","l2","cellyp1","lineColor","pixels","ox0","oy0","odx","ody","direction","getConvertFunc","width","height","action","__this","xy2","_int_convertxy","pixel","y0","xy0","xy1","userInput","flagUserInput","channel","frequency","parCount","attackT","decayT","releaseT","p4","time","rootProcId","self","onmessage","messageObject","sub","QPath","windowWidth","windowHeight","blockList"],"sourceRoot":""}